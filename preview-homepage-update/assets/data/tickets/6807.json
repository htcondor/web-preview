{"id": 6807, "title": "Ticket #6807: late materialization digest should support $RANDOM() expansions", "description": "<blockquote>\nCurrently, $RANDOM_INTEGER() and $RANDOM_CHOICE() cannot be used with late materialization because these macros are expanded when the submit digest is created.  To make these useful, these should not be expanded until the jobs are materialized.\n\n<p>This is complicated by the fact that failure to expand a $RANDOM_* macro will abort the process that attempts it.  This is unacceptable when it is the schedd doing the expansion.\n\n</p><p>Also not expanding $RANDOM_CHOICE(foo) implies that foo cannot be pruned from the submit digest. This will only be a problem if foo is one of the prunable attributes, such as <code>fetch_files</code>. This is unlikely to be the case, but we should guard against it anyway. This will require that the code that builds the submit digest know the names of submit keywords that are referenced by $RANDOM_CHOICE() macros - which will require some refactoring of the macro expansion code.</p></blockquote>", "remarks": "<blockquote>\nThis was likely fixed by <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7044\" onclick=\"get_ticket_and_populate_wrapper('7044'); return false;\" title=\"param calls in submit_utils should happen only when used by tools\">#7044</a></span>, but a test is needed.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2020-Feb-04 10:07", "status": "new", "created": "2018-Oct-25 14:25", "fixed_version": "2018-Oct-25 14:25", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "#6166", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}