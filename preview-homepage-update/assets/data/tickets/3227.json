{"id": 3227, "title": "Ticket #3227: JobsAccumPostExecuteTime is incorrect - much too large", "description": "<blockquote>\nstatistics from submit-1 in CHTC are showing values for <code>JobsAccumPostExecuteTime</code> that a much to large to be reasonable. This countier is being mis-calculated in some way.\n\n<p>for example, a recent statistics query shows post-execute as 237* larger than <code>JobsAccumRunningTime</code>, and <code>JobsAccumExecuteTime</code> as 21* larger than <code>JobsAccumRunningTime</code>.\n\n</p><p>This output also shows a large number of jobs restarting, and I suspect that there is a correlation between jobs restarting and invalid values for <code>AccumExecuteTime</code>.\n\n</p><p></p><div class=\"verbatim\">\n<pre>Tue Sep 11 15:30:01 2012 Recent               Lifetime 446070\nSumOfExecTime          470263530 (25828.58%)   1518318173 (293.84%)\nAccumBadputTime             897 (  0.05%)     29938906 (  5.79%)\nAccumChurnTime              898 (  0.05%)       747500 (  0.14%)\nAccumExecuteAltTime     1763132 ( 96.84%)    502947518 ( 97.33%)\nAccumExecuteTime       38592993 (2119.67%)   1161516224 (224.79%)\nAccumPostExecuteTime   431616307 (23705.93%)    349400771 ( 67.62%)\nAccumPreExecuteTime       54230 (  2.98%)      7401178 (  1.43%)\nAccumRunningTime        1819813 ( 99.95%)    486784217 ( 94.21%)\nAccumTimeToStart        9590053 (526.72%)   1245216038 (240.98%)\nCheckpointed                  0                      0\nCompleted                  5236 (100.00%)       526905 (100.00%)\nCoredumped                    0                      0\nDebugLogError                 0                      0\nExecFailed                    0                      0\nExitException               486 (  9.28%)        82880 ( 15.73%)\nExited                     9774 (186.67%)      1302369 (247.17%)\nExitedAndClaimClosing         3 (  0.06%)         1547 (  0.29%)\nExitedNormally             5236 (100.00%)       526905 (100.00%)\nKilled                        0 (  0.00%)          385 (  0.07%)\nMissedDeferralTime            0                      0\nNotStarted                  103 (  1.97%)        18584 (  3.53%)\nShadowNoMemory                0                      0\nShouldHold                  142 (  2.71%)       139118 ( 26.40%)\nShouldRemove                  0                      0\nShouldRequeue              3807 ( 72.71%)       534497 (101.44%)\nStarted                    5320 (101.60%)       527447 (100.10%)\nSubmitted                  4016 ( 76.70%)       531186 (100.81%)\nWierdTimestamps             132 (  2.52%)       130403 ( 24.75%)\nUploading         14 of      50,        0 waiting,             0 wait time\nDownloading        1 of      20,        0 waiting,             0 wait time\nShadows         1238 peak  3238,   857197 started, 444048 recycled, 0 Reconnected\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2012-Sep-12 14:10:39 by johnkn:</em> <br/>\n\nThe problem appears to be that if a job is evicted after transfer output has begun, runs again, and is evicted the second time <em>before</em> transfer output, then the <code>JobCurrentStartTransferOutputDate</code> attribute from the first run is used to calculate execute time for the second run.  This bug impacts 7.8.3 as well, but is worse in 7.9.0 because more statistics are impacted.\n<hr/>\n<em>2012-Sep-19 16:15:53 by zmiller:</em> <br/>\n\nBulk change of target version from v070804 to v070805 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-03 12:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ff28e2207bb52f30942bfd35ac6e35d0d5b68c50\">[33574]</a></span>: editing of 7.8.5 version history items ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3221\" onclick=\"get_ticket_and_populate_wrapper('3221'); return false;\" title=\"negotiator ASSERTs\">#3221</a></span> ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3227\" onclick=\"get_ticket_and_populate_wrapper('3227'); return false;\" title=\"JobsAccumPostExecuteTime is incorrect - much too large\">#3227</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-02 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b31baf0f289ddce937d7375df057606180a56d66\">[33555]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3227\" onclick=\"get_ticket_and_populate_wrapper('3227'); return false;\" title=\"JobsAccumPostExecuteTime is incorrect - much too large\">#3227</a></span>. <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobsAccumExecuteTime\" title=\"Jobs Accum Execute Time\">JobsAccumExecuteTime</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobsAccumPostExecuteTime\" title=\"Jobs Accum Post Execute Time\">JobsAccumPostExecuteTime</a></span> sometimes too large for jobs that have been restarted.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-12 14:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5cde01a74be0964191d72994da00932e91a16e93\">[33324]</a></span>: protect statistics from too large values for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobAccumExecuteTime\" title=\"Job Accum Execute Time\">JobAccumExecuteTime</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobsAccumPostExecuteTime\" title=\"Jobs Accum Post Execute Time\">JobsAccumPostExecuteTime</a></span>. if job is evicted during transfer input. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3227\" onclick=\"get_ticket_and_populate_wrapper('3227'); return false;\" title=\"JobsAccumPostExecuteTime is incorrect - much too large\">#3227</a></span>). Ignore <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobCurrentStartExecutingDate\" title=\"Job Current Start Executing Date\">JobCurrentStartExecutingDate</a></span> unless it is greater than <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStartDate\" title=\"Job Start Date\">JobStartDate</a></span>. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-12 14:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7373da47f492eef704e0f98899ca6746e22176dc\">[33320]</a></span>: fix for too large values for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobAccumExecuteTime\" title=\"Job Accum Execute Time\">JobAccumExecuteTime</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobsAccumPostExecuteTime\" title=\"Jobs Accum Post Execute Time\">JobsAccumPostExecuteTime</a></span>. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3227\" onclick=\"get_ticket_and_populate_wrapper('3227'); return false;\" title=\"JobsAccumPostExecuteTime is incorrect - much too large\">#3227</a></span>) don't use <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobsCurrentStartTransferOutputDate\" title=\"Jobs Current Start Transfer Output Date\">JobsCurrentStartTransferOutputDate</a></span> unless it is later than the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStartDate\" title=\"Job Start Date\">JobStartDate</a></span> for this run. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Oct-02 16:34", "status": "resolved", "created": "2012-Sep-11 15:56", "fixed_version": "2012-Sep-11 15:56", "broken_version": "v070800", "priority": "2", "subsystem": "Daemons", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}