{"id": 1153, "title": "Ticket #1153: per-test-run subdir / allow repeated runs of batch_test.pl", "description": "<blockquote>\nEven if you're luck and \"./batch_test.pl -b -c\" runs without errors, \"./batch_test.pl -b -c &amp;&amp; ./batch_test.pl -b -c\" is pretty much guaranteed to have errors.  Many of the tests pollute the condor_tests directory, and some require no pollution to be present.\n\n<p>As a workaround you can run \"x_makeclean.pl\" which is also available as \"make resubmit\", but that's fundamentally a relatively fragile workaround.  Tests should always run in an isolated subdirectory that they're free to pollute to their hearts content. This will:\n</p><ul>\n<li>Make finding relevant output files easier.\n</li><li>Allow someone to see multiple runs output\n</li><li>Make cleaning up a run easier (rm -rf runs/therun)\n</li><li>If directories nested at least one deep, you can clean up all runs easily (rm -rf runs)\n</li><li>Tests won't risk stomping on each other; you'll be able to run the tests in a loop.\n</li></ul>\n\n<p>Some tests write files in the condor_tests that other tests need, so transitioning will be slow.  We'll probably want to make a whitelist of older tests that are allowed to pollute until we can fix them.</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2010-Oct-20 16:03:30 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:46:04 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1214\" onclick=\"get_ticket_and_populate_wrapper('1214'); return false;\" title=\"Clean up batch_test.pl\">#1214</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nClean up batch_test.pl</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-25 14:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/08b19bfa05fdd604038b5939951316c36cd3f158\">[18275]</a></span>: Further debugging on isolating tests. <span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1153\" onclick=\"get_ticket_and_populate_wrapper('1153'); return false;\" title=\"per-test-run subdir / allow repeated runs of batch_test.pl\">#1153</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-12 16:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e681ace6766aac87bcd24352f3eaa8cd2562c9c8\">[17982]</a></span>: Fixes for batch_test work(#1153). Because the nightlies use a very different code path from a workspace build and test, further changes were needed.  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-12 15:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9948555dfcce5993aedfeb63d4407e91ab501bfc\">[17981]</a></span>: Revert revert, reintroducing batch test work. (<span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1153\" onclick=\"get_ticket_and_populate_wrapper('1153'); return false;\" title=\"per-test-run subdir / allow repeated runs of batch_test.pl\">#1153</a></span>) Per-test-run subdirectories. Many tests are blacklisted, as they cannot run this way without further work. (<span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1214\" onclick=\"get_ticket_and_populate_wrapper('1214'); return false;\" title=\"Clean up batch_test.pl\">#1214</a></span>) Also some cleanup of batch_test.pl. Removed dead -xml code, unified duplicated code, largely remove global variables, simplify multi-print\u00a0[...]\n (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-11 17:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9f53575d56f6a050307c879cc7803f2ddd2ce522\">[17973]</a></span>: Revert \"(<span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1153\" onclick=\"get_ticket_and_populate_wrapper('1153'); return false;\" title=\"per-test-run subdir / allow repeated runs of batch_test.pl\">#1153</a></span>) Per-test-run subdirectories. Many tests are blacklisted, as they cannot run this way without further work.\" This reverts commit 1064585543f3860c0b4cdf916431440399215aa7.  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-10 17:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1064585543f3860c0b4cdf916431440399215aa7\">[17965]</a></span>: (<span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1153\" onclick=\"get_ticket_and_populate_wrapper('1153'); return false;\" title=\"per-test-run subdir / allow repeated runs of batch_test.pl\">#1153</a></span>) Per-test-run subdirectories. Many tests are blacklisted, as they cannot run this way without further work. (<span class=\"ticket\"><a class=\"stalled\" href=\"/wiki-archive/tickets/?ticket=1214\" onclick=\"get_ticket_and_populate_wrapper('1214'); return false;\" title=\"Clean up batch_test.pl\">#1214</a></span>) Also some cleanup of batch_test.pl. Removed dead -xml code, unified duplicated code, largely remove global variables, simplify multi-print blocks, simplified options parsing  (By Alan De Smet )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Mar-30 11:32", "status": "stalled", "created": "2010-Jan-28 16:02", "fixed_version": "2010-Jan-28 16:02", "broken_version": "", "priority": "4", "subsystem": "Tests", "assigned_to": "adesmet", "derived_from": "#1124", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": "20100219"}