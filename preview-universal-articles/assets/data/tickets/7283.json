{"id": 7283, "title": "Ticket #7283: submit utils should provide a $(SUBMIT_TIME) expansion", "description": "<blockquote>\nThere is a fairly hacky way to get the current time formatted in various ways in a submit file like this\n<div class=\"snip\">\n<pre class=\"sniplabel\">submit fragment</pre>\n<pre class=\"snip\">date=formatTime(time(),\"%m_%d\")\nlog = test_$STRING(date).log\n</pre></div>\n\nWhich will produce a file named test_09_04.log on September 4th. But this is fairly obscure, and it won't necessarly  work correctly all of the time because time() gets a new value for each job in the submit.\n\n<p>What is needed is first class access to the submit time (the job's Qdate attribute), and we should expose the most likely use cases as first-class submit variables.\n\n</p><p></p><ul>\n<li><code>$(SUBMIT_TIME)</code>  the unix timestamp value that Qdate will be set to\n</li><li><code>$(YEAR)</code>         the 4 digit year of Qdate\n</li><li><code>$(MONTH)</code>        the 2 digit month of Qdate\n</li><li><code>$(DAY)</code>          the 2 digit day-of-month of Qdate\n</li></ul>\n\n<p>Other time values can be achieved by passing <code>$(SUBMIT_TIME)</code> to the classad time formatting function\n</p><div class=\"snip\">\n<pre class=\"sniplabel\">submit fragment</pre>\n<pre class=\"snip\">isotime=formatTime($(SUBMIT_TIME), \"%Y-%m-%dT%H:%M:%S\")\nArguments = -time \"$STRING(isotime)\"\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2019-Sep-26 10:23:43 by johnkn:</em> <br/>\n\nA test is needed for this, or perhaps a new clause added to an existing test.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Oct-22 15:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ce5bf5c8a06aac35cae7da47ddbbfa5259ea745b\">[58234]</a></span>: Add SUBMIT_TIME, YEAR, MONTH and DAY to man page for condor_submit. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7283\" onclick=\"get_ticket_and_populate_wrapper('7283'); return false;\" title=\"submit utils should provide a $(SUBMIT_TIME) expansion\">#7283</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Oct-22 14:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a663e0c614dc44ca9cd7529f72d81f60f9bca31d\">[58233]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7172\" onclick=\"get_ticket_and_populate_wrapper('7172'); return false;\" title=\"submit_utils should not create custom resources with leading _ names\">#7172</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7283\" onclick=\"get_ticket_and_populate_wrapper('7283'); return false;\" title=\"submit utils should provide a $(SUBMIT_TIME) expansion\">#7283</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7261\" onclick=\"get_ticket_and_populate_wrapper('7261'); return false;\" title=\"Late materialization submit fails when +key used itemdata dict\">#7261</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Sep-25 10:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1e7d680abae22f46ce62be12ea0f25892f7fcce0\">[57919]</a></span>: add $(SUBMIT_TIME) and $(YEAR), $(MONTH), $(DAY) macros to submit_utils <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7283\" onclick=\"get_ticket_and_populate_wrapper('7283'); return false;\" title=\"submit utils should provide a $(SUBMIT_TIME) expansion\">#7283</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Oct-22 15:06", "status": "resolved", "created": "2019-Sep-24 17:01", "fixed_version": "2019-Sep-24 17:01", "broken_version": "", "priority": "3", "subsystem": "", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "", "due_date": ""}