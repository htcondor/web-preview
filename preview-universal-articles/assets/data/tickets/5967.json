{"id": 5967, "title": "Ticket #5967: It should be possible to have multiple negotiators in the collector", "description": "<blockquote>\nIn the CMS global pool, there are currently 3 negotiators, but because of the way the negotiators chooses there Name attribute and also because of the way the collector responds when it gets a Negotiator ad, only one of the negotiators ever shows up in the collector.\n\n<p>This should be changed so that all 3 show up.  by\n\n</p><p></p><ul>\n<li>Change the default Name of the negotiator from $(HOSTNAME) to $(SUBSYS) for the NEGOTIATOR entry in the daemon list.\n</li><li>Change the default Name of the negotiator from $(HOSTNAME) to $(LOCALNAME) for all of the negotiator daemons that have a local-name argument\n</li><li>Remove the code in the collector that purges the negotiator hashtable whenever it gets an update. a new undocumented knob <code>COLLECTOR_ALLOW_ONLY_ONE_NEGOTIATOR</code> will allow the old behavior to be enabled. This knob will default to false.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5717\" onclick=\"get_ticket_and_populate_wrapper('5717'); return false;\" title=\"Handle multiple negotiators in a single pool\">#5717</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nHandle multiple negotiators in a single pool</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-23 14:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ce563b7816e6c44a3b7822f3a36cd472d6002b01\">[49643]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5967\" onclick=\"get_ticket_and_populate_wrapper('5967'); return false;\" title=\"It should be possible to have multiple negotiators in the collector\">#5967</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5969\" onclick=\"get_ticket_and_populate_wrapper('5969'); return false;\" title=\"config should warn about obsolete SUBSYS.LOCALNAME.* prefixes\">#5969</a></span>, <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5988\" onclick=\"get_ticket_and_populate_wrapper('5988'); return false;\" title=\"classad userMap should tokenize arg3 only commas\">#5988</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5882\" onclick=\"get_ticket_and_populate_wrapper('5882'); return false;\" title=\"$ENV in config/submit should support defaults\">#5882</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5980\" onclick=\"get_ticket_and_populate_wrapper('5980'); return false;\" title=\"job transform requirements don't work if TARGET is used\">#5980</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6020\" onclick=\"get_ticket_and_populate_wrapper('6020'); return false;\" title=\"condor-c and jobRouter should delete TotalSubmitProcs\">#6020</a></span> and doc for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5882\" onclick=\"get_ticket_and_populate_wrapper('5882'); return false;\" title=\"$ENV in config/submit should support defaults\">#5882</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Oct-13 17:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e53e5832ffee4623584b282f54da981e13d9056d\">[49432]</a></span>: allow more than one negotiator <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5967\" onclick=\"get_ticket_and_populate_wrapper('5967'); return false;\" title=\"It should be possible to have multiple negotiators in the collector\">#5967</a></span> a new knob. COLLECTOR_ALLOW_ONLY_ONE_NEGOTIATOR will enable the old behavior. it defaults to false. this commit also changes the default name of the negotiator from $(HOSTNAME) to $(SUBSYS) or $(LOCALNAME) and allows it to be set via the new NEGOTIATOR_NAME knob.\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Nov-23 15:37", "status": "resolved", "created": "2016-Oct-13 17:46", "fixed_version": "2016-Oct-13 17:46", "broken_version": "", "priority": "3", "subsystem": "DaemonsCM", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}