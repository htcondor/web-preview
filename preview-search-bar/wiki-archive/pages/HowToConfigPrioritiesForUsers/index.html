<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="HTCondor Homepage">
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/web-preview/preview-search-bar/assets/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/web-preview/preview-search-bar/assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/web-preview/preview-search-bar/assets/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/web-preview/preview-search-bar/assets/images/favicons/site.webmanifest">
    <link rel="mask-icon" href="/web-preview/preview-search-bar/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/web-preview/preview-search-bar/assets/images/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/web-preview/preview-search-bar/assets/images/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Primary Meta Tags -->
    <meta name="title" content="HTCondor">
    <meta name="description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://htcondor.org/">
    <meta property="og:title" content="HTCondor">
    <meta property="og:description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">
    <meta property="og:image" content="https://htcondor.org/assets/images/HTC.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://htcondor.org/">
    <meta property="twitter:title" content="HTCondor">
    <meta property="twitter:description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">
    <meta property="twitter:image" content="https://htcondor.org/assets/images/HTC.png">

    <title>How To Config Priorities For Users</title>

    <script src="/web-preview/preview-search-bar/assets/js/sitewide.js" type="text/javascript" defer></script>
    <script src="/web-preview/preview-search-bar/assets/js/bootstrap.js" type="text/javascript"></script>
    <script src="/web-preview/preview-search-bar/assets/js/lunr.js" type="text/javascript" async></script>
    <script src="/web-preview/preview-search-bar/assets/js/search_bar.js" type="text/javascript" async></script>
    <script src="/web-preview/preview-search-bar/assets/js/default.js" type="text/javascript" defer></script>

    

    

    <meta name="robots" content="noindex">

    

    <link href="/web-preview/preview-search-bar/assets/css/style-v1.css" media="screen, tv, projection" title="Default" rel="stylesheet">
    

</head>
<body class="vh-100 d-flex flex-column">

<!-- For non-visual user agents: -->
<a id="skip-link" href="#main-copy">Skip to main content.</a>

<header id="header">
    <div class="mb-4 container">
        <div class="row">
            <div class="col-12">
                <nav class="navbar navBar navbar-expand-lg navbar-light w-100">
                    <a href="/web-preview/preview-search-bar/index.html" class="d-none d-md-inline"><img height="75" alt="Condor High Throughput Computing" src="/web-preview/preview-search-bar/assets/images/CondorTitle.png" style="border:0"></a>
                    <a href="/web-preview/preview-search-bar/index.html" class="d-inline d-md-none"><img height="65" alt="Condor High Throughput Computing" src="/web-preview/preview-search-bar/assets/images/HTCondor_red_blk.svg" style="border:0"></a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav mb-2 mb-lg-0 ms-auto mt-auto">
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-search-bar/">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-search-bar/new">News</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-search-bar/downloads">Downloads</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-search-bar/publications">Publications</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="mailto:htcondor-admin@cs.wisc.edu">Contact Us</a>
                            </li>
                            <li class="nav-item">
                                <div id="main-search-bar" class="search-bar">
                                    <input type="text" class="form-control" placeholder="Loading..." aria-describedby="button-addon2">
                                    <div class="results-dropdown" class="results-dropdown w-100">
                                        <div class="search-results" ></div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</header>
<main id="main-copy" tabindex="-1">
    <div class="container mb-4">
    <h1>How To Config Priorities For Users</h1>
<div id="content">
 <span class="section">
  <h2>
   How to configure priorities/quotas for groups of users
  </h2>
 </span>
 <p>
  By default, HTCondor provides fair sharing between individual users by keeping track of usage and adjusting their relative user priorities.  Frequently, however, there is a need to allocate resources at a more abstract level.  Suppose you have a single HTCondor pool shared by several sets of users.  Your goal is to configure HTCondor so that each group (set) gets its fair share of the computing resources and within each group, each user gets a fair share relative to other members of the group.  What is defined to be fair depends on circumstances, such as whether some groups own a larger share of the machines than others and whether some groups have a different pattern of usage such as occasional bursts of computation verses steady demand.
 </p>
 <p>
  The following recipes can be adapted to a variety of such situations.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  How to divide the machines by the machine's RANK
 </h3>
 <p>
  You can give a group of users higher priority on a specific set of machines by configuring the
  <code>
   RANK
  </code>
  expression.  Example:
 </p>
 <p>
 </p>
 <div class="code">
  <pre class="code"># This machine belongs to the "biology" group.
MachineOwner = "biology"

# Give high priority on this machine to the group that owns it.
STARTD_ATTRS = $(STARTD_ATTRS) MachineOwner
Rank = TARGET.Group =?= MY.MachineOwner
</pre>
 </div>
 <p>
  The above example requires that jobs be submitted with an additional custom attribute called
  <code>
   href="/web-preview/preview-search-bar/wiki-archive/pages/Group"   </code>
  in this example, that declares what group they belong to.  See
  <span class="wiki">
   <a href="/web-preview/preview-search-bar/wiki-archive/pages/HowToInsertCustomClassAd" title="How To Insert Custom Class Ad">
    How to insert custom ClassAd attributes into a job ad
   </a>
  </span>
  for different ways of doing that.  The user may set this explicitly in the job's submit description file with
 </p>
 <p>
 </p>
 <div class="code">
  <pre class="code">+Group = href="/web-preview/preview-search-bar/wiki-archive/pages/biology" </pre>
 </div>
 <p>
  If group membership is not likely to change frequently, or you really don't want users to have to declare their group membership, you could configure the machine
  <code>
   RANK
  </code>
  expression to look at the built-in
  <code>
   TARGET.User
  </code>
  attribute, rather than relying on the custom attribute
  <code>
   TARGET.Group
  </code>
  .  An example configuration that implements this:
 </p>
 <p>
 </p>
 <div class="code">
  <pre class="code">MachineOwners = "user1@biology.wisc.edu user2@biology.wisc.edu"

STARTD_ATTRS = $(STARTD_ATTRS) MachineOwners
RANK = stringListMember(TARGET.User,MY.MachineOwners)
</pre>
 </div>
 <p>
  Since
  <code>
   RANK
  </code>
  is an arbitrary
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-search-bar/wiki-archive/pages/ClassAd" title="Class Ad">
    ClassAd
   </a>
  </span>
  expression, you can customize the policy in a variety of ways.  For example, there could be a group with second priority on the machines.  Or you could specify that some types of jobs (identified by some other
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-search-bar/wiki-archive/pages/ClassAd" title="Class Ad">
    ClassAd
   </a>
  </span>
  attribute in the job) have higher priorities than others.  In that case, write the expression so that it produces a higher number for higher priority jobs.
 </p>
 <p>
  The down side of
  <code>
   RANK
  </code>
  is that it involves preemption.
  <code>
   RANK
  </code>
  only comes into play when there is an existing job on a machine and the negotiator is considering whether a new job should preempt it.  You can control how quickly the preemption happens in order for the new job to replace the lower priority job using
  <code>
   MaxJobRetirementTime
  </code>
  as described in
  <span class="wiki">
   <a href="/web-preview/preview-search-bar/wiki-archive/pages/HowToDisablePreemption" title="How To Disable Preemption">
    How to disable preemption
   </a>
  </span>
  .  By default, the preemption will happen immediately.  This is most appropriate in HTCondor pools where groups own specific machines and want guaranteed access to them whenever they need them.
 </p>
 <p>
  Given a choice of two machines to run a job on, it is a good idea to steer jobs towards machines that rank them higher so they stand less of a chance of being preempted in the future.  Here is an example configuration that preferentially runs jobs where they are most highly ranked and secondarily prefers to run jobs on idle machines rather than claimed machines:
 </p>
 <p>
 </p>
 <div class="code">
  <pre class="code">NEGOTIATOR_PRE_JOB_RANK = 10 * (MY.RANK) + 1 * (RemoteOwner =?= UNDEFINED)
</pre>
 </div>
 <p>
  Note that preemption by
  <code>
   RANK
  </code>
  trumps considerations of user priority within the pool.  For example, if user A with a high (bad) user priority is competing with another user B with a low (good) user priority, user B, with the better user priority, will be able to claim more idle machines, but user A can then preempt user B if the
  <code>
   RANK
  </code>
  is higher.  The relative user priorities therefore only matter when the
  <code>
   RANK
  </code>
  values are equal or when vying for unclaimed machines.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Group accounting to implement pool shares
 </h3>
 <p>
  Whereas
  <code>
   RANK
  </code>
  can be used to give groups preemptive priority on specific machines, HTCondor's group accounting system can be used to give groups a share of a pool that is not tied to specific machines.  The HTCondor manual sections on Group Accounting  and  Accounting Groups with Hierarchical Group Quotas covers this topic. Please locate the manual sections for descriptions and implementation examples to follow.
 </p>
</div>

</div>
</main>
<div id="footer" class="border-top mt-auto">
    <div class="container py-4">
        <div class="row">
            <div class="col text-center">
                For comments or questions about this website, please email
                <a href="mailto:htcondor-admin@cs.wisc.edu">htcondor-admin@cs.wisc.edu</a><br />
                This work is supported by <a href="https://www.nsf.gov/div/index.jsp?div=OAC">NSF</a> under Cooperative Agreement <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">OAC-2030508</a> as part of the <a href="https://path-cc.io/">PATh Project</a>. <br />
                <script type="text/javascript">
                    document.write("Updated &raquo; "+lastMod(document.lastModified))
                </script>
            </div>
        </div>
    </div>
</div>



</body>
</html>
