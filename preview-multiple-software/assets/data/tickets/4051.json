{"id": 4051, "title": "Ticket #4051: DaemonStartTime can't be used in DAEMON_SHUTDOWN expression", "description": "<blockquote>\nit turns out, that the <code>DaemonStartTime</code> attribute, as well as several other attributes are inserted into the daemon ad just before the ad is sent to the collector. This is AFTER the DAEMON_SHUTDOWN expression is evaluated.\n\n<p>so <code>DaemonStartTime</code> cannot be used in this expression.\n\n</p><p>We need to insert this attribute earlier, and stop using\nDCCollector::sendUpdate as a place to stuff attributes into the ad that\nare unrelated to the update process itself.\n\n</p><p>In particular. <code>DetectedCpus</code> and <code>DetectedMemory</code> are also inserted into every ad passed to <code>DCCollector::sendUpdate</code>.  These attributes don't even belong in every ad, and even if they were, <code>DCCollector::sendUpdate</code> is the wrong place to do that work.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2014-Mar-27 13:49", "status": "new", "created": "2013-Nov-06 16:44", "fixed_version": "2013-Nov-06 16:44", "broken_version": "v080000", "priority": "4", "subsystem": "Daemons", "assigned_to": "johnkn", "derived_from": "#3481", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}