{"id": 923, "title": "Ticket #923: Better handling of released gt2 jobs with no job-manager", "description": "<blockquote>\nWhen a gt2 gram job with the <span class=\"quote\">GridJobId</span> attribute set is released, the gridmanager attempts to determine whether there's a job-manager running on the remote machine for that job by issuing a callback register command to the URL in the gram job contact string. If the result is gram error 79 (GLOBUS_GRAM_PROTOCOL_ERROR_CONTACTING_JOB_MANAGER), the gridmanager assumes there is no job-manager for the job and starts monitoring the job normally.\n\n<p>If the result is gram error 7 (AUTHORIZATION), 10 (PROTOCOL_FAILED), or 156 (JOB_CONTACT_NOT_FOUND), the gridmanager thinks something has gone wrong and tries restarting a job-manager for the job. Error 10 is particularly annoying as the gridmanager first tries to send a stop command to the potentially running job-manager. If that also fails, the job ends up on hold.\n\n</p><p>I believe error 10 is a common result when another service (speaking a different protocol) is using the port that the gridmanager is trying to contact. Errors 7, 10, and 156 will occur frequently when a relatively small port range restriction (a couple hundred ports or less) is in place on the CE.\n\n</p><p>When trying to contact a potentially running job-manager for a job that's just been released, all of these errors should be treated the same: assume there's no job-manager running for this job and resume normal monitoring (what's currently done for error 79).</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Dec-04 10:51:42 by jfrey:</em> <br/>\n\nPushed fix to V7_4-branch for 7.4.1.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Nov-09 16:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c146069b72d8173dafc2807edf9cbd4d5899bfcc\">[16272]</a></span>: Better handling of released gt2 grid jobs. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=923\" onclick=\"get_ticket_and_populate_wrapper('923'); return false;\" title=\"Better handling of released gt2 jobs with no job-manager\">#923</a></span> A gt2 job that has just been released most likely doesn't have a job-manager running on the remote system. Treat gram errors that strongly suggest as much as confirmation.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Nov-19 07:14", "status": "resolved", "created": "2009-Nov-09 15:02", "fixed_version": "2009-Nov-09 15:02", "broken_version": "v070400", "priority": "4", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "s7831", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}