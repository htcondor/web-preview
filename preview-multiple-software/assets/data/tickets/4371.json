{"id": 4371, "title": "Ticket #4371: Recommended change to documentation for run_as_owner", "description": "<blockquote>\nI recently tried implementing running jobs as their submitting owner on a test execute node.  The documentation suggests that this setting is default, but I found it tricky to implement.  Relevant documentation included:\n\n<p><a class=\"external\" href=\"http://research.cs.wisc.edu/htcondor/manual/v8.1/3_3Configuration.html#18927\">http://research.cs.wisc.edu/htcondor/manual/v8.1/3_3Configuration.html#18927</a> (text search for STARTER_ALLOW_RUNAS_OWNER)\n\n</p><p><a class=\"external\" href=\"http://research.cs.wisc.edu/htcondor/manual/v8.1/3_6Security.html#sec:RunAsNobody\">http://research.cs.wisc.edu/htcondor/manual/v8.1/3_6Security.html#sec:RunAsNobody</a>\n\n</p><p>Neither is extremely helpful, but the second is more helpful (although the title is misleading), as it gives some conditions.  Namely:\n\n</p><p></p><ul>\n<li>The StartD configuration variable STARTER_ALLOW_RUNAS_OWNER must be True\n</li><li>The jobad must have <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RunAsOwner\" title=\"Run As Owner\">RunAsOwner</a></span> = True\n</li><li>The UID_DOMAIN configuration variable must be the same on StartD and SchedD\n</li></ul>\n\n<p>However, extrapolating these requirements for just getting running as owner to work was not intuitively obvious.  Using bullets or logic tables might help.\n\n</p><p>Also, there is a fourth factor that is not mentioned.  The UID_DOMAIN must be trusted.  If the Starter does a reverse-dns lookup on the SchedD and finds that the result doesn't match the UID_DOMAIN, then your jobs will run as \"nobody\".  This condition does not show up in default logging.  It does show up when Starter_Debug = D_ALL.\n\n</p><p>So, if your SchedD's DNS reverse-resolution is not the same as the UID_DOMAIN configuration variable, the following must be set on the StartD:\n\n</p><p>TRUST_UID_DOMAIN = True\n\n</p><p>If it is not, then you will not be able to run your jobs as owner.  I think this should be in the documentation.\n\n</p><p>To summarize:\n\n</p><p></p><ul>\n<li>Split the article at <a class=\"external\" href=\"http://research.cs.wisc.edu/htcondor/manual/v8.1/3_6Security.html#sec:RunAsNobody\">http://research.cs.wisc.edu/htcondor/manual/v8.1/3_6Security.html#sec:RunAsNobody</a> into three sub-articles:\n<ul>\n<li>Running Jobs as Owner\n</li><li>Running Jobs as Slot Users\n</li><li>Running Jobs as Nobody\n</li></ul>\n</li><li>Make it more clear what settings (configuration variables and jobad/machinead attributes) need to be set for running as Owner/Slot/Nobody\n</li><li>Make it clear that if you want to run as owner,  TRUST_UID_DOMAIN = True must be set when submit-node DNS reverse-lookup doesn't match the UID_DOMAIN configuration variable\n</li></ul>\n\n<p>-Moate</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-28 15:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d3c6bd7521e5d76141c40c80b7a305c734562448\">[42444]</a></span>: rewrite much of section 3.6.13.2 to fulfill <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4371\" onclick=\"get_ticket_and_populate_wrapper('4371'); return false;\" title=\"Recommended change to documentation for run_as_owner\">#4371</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-21 17:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/97d571f482c4180ac45638360eb60ec55b7e27d9\">[42305]</a></span>: a tiny start to manual section 3.6.13.2 re-write for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4371\" onclick=\"get_ticket_and_populate_wrapper('4371'); return false;\" title=\"Recommended change to documentation for run_as_owner\">#4371</a></span>  (By Karen Miller )</td></tr>\n</tbody></table>", "type": "doc", "last_change": "2015-Jan-28 15:10", "status": "resolved", "created": "2014-May-19 18:57", "fixed_version": "2014-May-19 18:57", "broken_version": "v080106", "priority": "4", "subsystem": "DaemonsExecNode", "assigned_to": "smoler", "derived_from": "", "creator": "moate", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "nyehle@cs.wisc.edu", "due_date": ""}