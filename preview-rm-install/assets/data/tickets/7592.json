{"id": 7592, "title": "Ticket #7592: Add an include dir feature to condor mapfiles", "description": "<blockquote>\nFor HTCondor-CE, we'd like the ability to add lines to our condor_mapfiles to include directories containing additional mapfiles. We were imagining a syntax like the following:\n\n<p></p><div class=\"verbatim\">\n<pre>SCITOKENS https://demo.scitokens.org bbockelm@users.opensciencegrid.org\nSCITOKENS https://iam-escape.cloud.cnaf.infn.it/ bbockelm@users.opensciencegrid.org\nSCITOKENS https://scitokens.org/dteam dteam@users.opensciencegrid.org\n@include /path/to/mapfiles.d/\n</pre></div>\n\n\n<p>Where lines in the mapfile would be parsed in order, then when an include dir line is encountered, HTCondor would parse files in the directory in lexicographical order.\n\n</p><p>We'd also like the ability to have multiple include directories in a single mapfile for default mappings and admin overrides (and therefore should be able to handle empty directories).</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Apr-10 10:38:23 by zmiller:</em> <br/>\n\nThat all seems reasonable.  Seems like admin overrides would just be an include at the top of the file, since first match wins.  And defaults could just go last.  So something like this?\n\n<p></p><div class=\"verbatim\">\n<pre>@include /path/to/admin_override_file\nSCITOKENS https://demo.scitokens.org bbockelm@users.opensciencegrid.org\nSCITOKENS https://iam-escape.cloud.cnaf.infn.it/ bbockelm@users.opensciencegrid.org\nSCITOKENS https://scitokens.org/dteam dteam@users.opensciencegrid.org\n@include /path/to/specific/map_file\n@include /path/to/a/directory/mapfiles.d/\n@include /path/to/specific/map_file_defaults_if_nothing_else_matched\n</pre></div>\n\n\n<p>Multiple <code>@include &lt;thing&gt;</code> statements are allowed, and <code>&lt;thing&gt;</code> can be either a file or a directory.  Include files can include additional files. (Up to a default <code>MAX_MAP_INCLUDE_DEPTH=20</code> deep in case someone decides to make a cycle.)\n\n</p><p>Sound good?\n\n</p><p></p><hr/>\n<em>2020-Apr-10 10:45:07 by blin:</em> <br/>\n\nYeah, that all sounds great!\n\n<p></p><hr/>\n<em>2020-Nov-02 14:24:26 by blin:</em> <br/>\n\nMoved to Jira: <a class=\"external\" href=\"https://opensciencegrid.atlassian.net/browse/HTCONDOR-46\">https://opensciencegrid.atlassian.net/browse/HTCONDOR-46</a></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "todo", "last_change": "2020-Nov-16 13:34", "status": "abandoned", "created": "2020-Apr-10 10:23", "fixed_version": "2020-Apr-10 10:23", "broken_version": "", "priority": "2", "subsystem": "Security", "assigned_to": "zmiller", "derived_from": "#4555", "creator": "blin", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "zmiller@cs.wisc.edu blin@cs.wisc.edu matyas@cs.wisc.edu bbockelman@morgridge.org", "due_date": ""}