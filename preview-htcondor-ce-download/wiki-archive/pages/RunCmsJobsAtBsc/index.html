<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="HTCondor Homepage">
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/web-preview/preview-htcondor-ce-download/assets/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/web-preview/preview-htcondor-ce-download/assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/web-preview/preview-htcondor-ce-download/assets/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/web-preview/preview-htcondor-ce-download/assets/images/favicons/site.webmanifest">
    <link rel="mask-icon" href="/web-preview/preview-htcondor-ce-download/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/web-preview/preview-htcondor-ce-download/assets/images/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/web-preview/preview-htcondor-ce-download/assets/images/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Primary Meta Tags -->
    <meta name="title" content="HTCondor">
    <meta name="description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://htcondor.org/">
    <meta property="og:title" content="HTCondor">
    <meta property="og:description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">
    <meta property="og:image" content="https://htcondor.org/assets/images/HTC.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://htcondor.org/">
    <meta property="twitter:title" content="HTCondor">
    <meta property="twitter:description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">
    <meta property="twitter:image" content="https://htcondor.org/assets/images/HTC.png">

    <title>Run Cms Jobs At Bsc</title>

    <script src="/web-preview/preview-htcondor-ce-download/assets/js/sitewide.js" type="text/javascript" defer></script>
    <script src="/web-preview/preview-htcondor-ce-download/assets/js/bootstrap.js" type="text/javascript"></script>
    

    

    <meta name="robots" content="noindex">

    

    <link href="/web-preview/preview-htcondor-ce-download/assets/css/style-v1.css" media="screen, tv, projection" title="Default" rel="stylesheet">
    

</head>
<body class="vh-100 d-flex flex-column">

<!-- For non-visual user agents: -->
<a id="skip-link" href="#main-copy">Skip to main content.</a>

<header id="header">
    <div class="mb-4 container">
        <div class="row">
            <div class="col-12">
                <nav class="navbar navBar navbar-expand-lg navbar-light w-100">
                    <a href="/web-preview/preview-htcondor-ce-download/index.html" class="d-none d-md-inline"><img height="75" alt="Condor High Throughput Computing" src="/web-preview/preview-htcondor-ce-download/assets/images/CondorTitle.png" style="border:0"></a>
                    <a href="/web-preview/preview-htcondor-ce-download/index.html" class="d-inline d-md-none"><img height="65" alt="Condor High Throughput Computing" src="/web-preview/preview-htcondor-ce-download/assets/images/HTCondor_red_blk.svg" style="border:0"></a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav mb-2 mb-lg-0 ms-auto mt-auto">
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-htcondor-ce-download/">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-htcondor-ce-download/new">News</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-htcondor-ce-download/downloads">Downloads</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-htcondor-ce-download/publications">Publications</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="mailto:htcondor-admin@cs.wisc.edu">Contact Us</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <div class="row">
            

<script async src="https://cse.google.com/cse.js?cx=1056a9a876b1d1474"></script>
<div class="gcse-searchbox-only"></div>


        </div>
    </div>
</header>
<main id="main-copy" tabindex="-1">
    <div class="container mb-4">
    <h1>Run Cms Jobs At Bsc</h1>
<div id="content">
 <span class="section">
  <h2>
   Running CMS Jobs at BSC via a Shared Filesystem
  </h2>
 </span>
 <p>
  CMS researchers at PIC (Port d’Informació Científica) are interested in running jobs originating at CERN on the Mare Nostrum system at BSC (Barcelona Supercomputing Center). Access to Mare Nostrum is highly restrictive, particularly with regards to networking. We are experimenting with a solution where jobs are forwarded to Mare Nostrum execute nodes via a shared filesystem link. The approach is outlined in this document:
 </p>
 <p>
  <a class="external" href="https://docs.google.com/document/d/1GGOc3pgidfv_qunaKqzjbvKPF8CD_RF30KkqMtwBC0U/edit?usp=sharing">
   https://docs.google.com/document/d/1GGOc3pgidfv_qunaKqzjbvKPF8CD_RF30KkqMtwBC0U/edit?usp=sharing
  </a>
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Implementation Details
 </h3>
 <p>
  We have a working proof-of-concept implementation, which has been tested with 4
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-htcondor-ce-download/wiki-archive/pages/MareNostrum" title="Mare Nostrum">
    MareNostrum
   </a>
  </span>
  nodes running sleep jobs. Here, we give details of the current code.
 </p>
 <p>
  Machines:
 </p>
 <ul>
  <li>
   vocms0824.cern.ch: A CMS submit point that flocks to the test pool at PIC.
  </li>
  <li>
   cm05-hpc.pic.es: The central manager for the test pool.
  </li>
  <li>
   htcbridge01.pic.es: Runs the proxy startds that talk with the schedd and actual execute nodes (via filesystem).
  </li>
  <li>
   td513.pic.es: A stand-in execute node to allow testing without any BSC machines.
  </li>
  <li>
   dt01.bsc.es:
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-htcondor-ce-download/wiki-archive/pages/MareNostrum" title="Mare Nostrum">
     MareNostrum
    </a>
   </span>
   data transfer machine, used for sshfs.
  </li>
  <li>
   mn1.bsc.es:
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-htcondor-ce-download/wiki-archive/pages/MareNostrum" title="Mare Nostrum">
     MareNostrum
    </a>
   </span>
   login machine, used for Slurm job submission.
  </li>
 </ul>
 <p>
  All of the code is available under /home/jfrey/bsc_glidein/ on htcbridge01.pic.es. A copy is saved at /afs/cs.wisc.edu/p/condor/workspaces/jfrey/bsc_glidein.tar.gz. It relies on some changes to the condor_starter, which currently sit on an unmerged branch in the HTCondor repository (see
  <span class="ticket">
   <a class="active" href="../../tickets/?ticket=6843" title="Allow starter to forward its job to a remote resource for execution">
    #6843
   </a>
  </span>
  ).
The Condor binaries used on htcbrid01.pic.es are in /home/jfrey/condor-remoteproc/.The condor_starter (plus libraries) that runs on the
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-htcondor-ce-download/wiki-archive/pages/MareNostrum" title="Mare Nostrum">
    MareNostrum
   </a>
  </span>
  nodes is pre-installed in /home/ifae96/ifae96618/release_dir/.
 </p>
 <p>
  To run the current system, a user must have accounts on cm05-hpc.pic.es and mn1.bsc.es. They then run the following command on cm05-hpc.pic.es:
 </p>
 <ul>
  <li>
   /home/jfrey/bsc_glidein/bin/launch_glidein &lt;bsc-username&gt; &lt;node-cnt&gt;
  </li>
 </ul>
 <p>
  This will create an sshfs mount to BSC, submit a Slurm job at
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-htcondor-ce-download/wiki-archive/pages/MareNostrum" title="Mare Nostrum">
    MareNostrum
   </a>
  </span>
  , and configure and launch a startd locally.
 </p>
 <p>
  The shut down an instance of the current system, the user should run the following command from the same directory on cm05-hpc.pic.es:
 </p>
 <ul>
  <li>
   /home/jfrey/bsc_glidein/bin/stop_glidein
  </li>
 </ul>
 <p>
  This will remove the sshfs mount and stop the Condor daemons. It doesn't remove the Slurm job.
 </p>
 <h3>
  Attachments:
 </h3>
 <blockquote>
  <ul>
   <li>
    <a href="attach_get/1062/bsc_glidein.tar.gz">
     bsc_glidein.tar.gz
    </a>
    6699 bytes added by jfrey on 2021-Jun-29 19:16:29 UTC.
    <br/>
    Scripts for BSC split-starter setup.
    <br/>
   </li>
  </ul>
 </blockquote>
</div>

</div>
</main>
<div id="footer" class="border-top mt-auto">
    <div class="container py-4">
        <div class="row">
            <div class="col text-center">
                For comments or questions about this website, please email
                <a href="mailto:htcondor-admin@cs.wisc.edu">htcondor-admin@cs.wisc.edu</a><br />
                This work is supported by <a href="https://www.nsf.gov/div/index.jsp?div=OAC">NSF</a> under Cooperative Agreement <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">OAC-2030508</a> as part of the <a href="https://path-cc.io/">PATh Project</a>. <br />
                <script type="text/javascript">
                    document.write("Updated &raquo; "+lastMod(document.lastModified))
                </script>
            </div>
        </div>
    </div>
</div>



</body>
</html>
