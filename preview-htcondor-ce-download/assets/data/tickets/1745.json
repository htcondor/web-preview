{"id": 1745, "title": "Ticket #1745: condor_wait can't open a file for read authorized user", "description": "<blockquote>\nCondor_wait opens log files with read-write permission, however read-write permission is not actually required for condor_wait.  This should be changed to open files read-only to support users without write permission.\n\n<p>To reproduce with current condor_wait:\n\n</p><p></p><div class=\"verbatim\">\n<pre>$ ls -al a\nls: cannot access a: No such file or directory\n$ touch a\n$ ls -al a\n0 -rw-------. 1 matt matt 0 Nov  1 06:15 a\n$ condor_wait a\nThis log does not mention any jobs!\n$ chmod u-w a\n$ condor_wait a\nCouldn't open a: Permission denied\n$ ls -al a\n0 -r--------. 1 matt matt 0 Nov  1 06:15 a\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2010-Nov-01 14:12:59 by tmckay:</em> <br/>\n\nNote, the patch contains a null-test around deletion of a pointer in addition to the file permission change.  Not sure if there is a UW coding standard for this, so I left it in although it is arguably superfluous.\n\n<p></p><hr/>\n<em>2010-Nov-01 14:50:48 by jrt:</em> <br/>\n\nI put the null test in the patch because delete without a test caused a seg fault in condor_userlog. The code is fairly similar between the condor_wait and condor_userlog.\n\n<p></p><hr/>\n<em>2010-Nov-02 13:59:52 by tmckay:</em> <br/>\n\nDan,\n\n<p></p><pre>  forgot to mention, credit for the patch on commit should go to\n</pre>\n\n<p>Jon Thomas &lt;jthomas@redhat.com&gt;\n\n</p><p></p><hr/>\n<em>2010-Dec-03 11:07:18 by matt:</em> <br/>\n\nLooks good...\n\n<p></p><div class=\"verbatim\">\n<pre>$ ident $(which condor_wait)\n/usr/bin/condor_wait:\n     $CondorPlatform: X86_64-LINUX_F13 $\n     $CondorVersion: 7.4.5 Dec  1 2010 BuildID: RH-7.4.5-0.2.el5 PRE-RELEASE $\n     $CondorVersion: %d.%d.%d %s %d %d $\n$ ls -al a\nls: cannot access a: No such file or directory\n$ touch a\n$ ls -al a\n0 -rw-------. 1 matt matt 0 Dec  3 09:02 a\n$ condor_wait a\nThis log does not mention any jobs!\n$ chmod u-w a\n$ condor_wait a\nThis log does not mention any jobs!\n$ ls -al a\n0 -r--------. 1 matt matt 0 Dec  3 09:02 a\n</pre></div>\n\n\n<p>...though unfortunate that defaults from read_user_log.h had to be embedded.\n\n</p><p>Go for commit, remember to set --author.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/239/condor_wait.patch\">condor_wait.patch</a>\n748 bytes added by tmckay on 2010-Nov-01 19:10:11 UTC.\n<br/>\nPatch to wait.cpp, output from git diff<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Dec-14 15:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a492b919f27c72f4969edaf1349e44eff8309744\">[19652]</a></span>: Change condor_wait to open log files with read access instead of readwrite (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1745\" onclick=\"get_ticket_and_populate_wrapper('1745'); return false;\" title=\"condor_wait can't open a file for read authorized user\">#1745</a></span>) Committer: tmckay  (By Jon Thomas )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Dec-14 15:44", "status": "resolved", "created": "2010-Nov-01 14:08", "fixed_version": "2010-Nov-01 14:08", "broken_version": "v070403", "priority": "4", "subsystem": "Tools", "assigned_to": "tmckay", "derived_from": "", "creator": "tmckay", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}