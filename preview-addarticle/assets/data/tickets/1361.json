{"id": 1361, "title": "Ticket #1361: Error reported from execute node incomplete for IWD access failure", "description": "<blockquote>\nNote, this bug is also mentioned in:\n<a class=\"external\" href=\"http://condor-wiki.cs.wisc.edu/index.cgi/tktview?tn=1015\">http://condor-wiki.cs.wisc.edu/index.cgi/tktview?tn=1015</a>\n\n<p>Description of problem:\n\n</p><p>A failure to access a job's IWD during execution reports a confusing error\nmessage in the job's <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReason\" title=\"Hold Reason\">HoldReason</a></span>.\n\n</p><p>Version-Release number of selected component (if applicable):\n\n</p><p>All up to and including condor 7.4.3-0.4\n\n</p><p>How reproducible:\n\n</p><p>100%\n\n</p><p>Steps to Reproduce:\n</p><ol>\n<li>2 machine setup: 1) schedd, 2) startd\n</li><li>mkdir /tmp/wontexist\n</li><li>echo -e\n\"cmd=/bin/true\\niwd=/tmp/wontexist\\nrequirements=Machine=!=\\\"$HOSTNAME\\\"\\nqueue\"\n| condor_submit\n</li><li>let the job go to H[eld] in condor_q\n</li><li>condor_q -l | grep ^HoldReason and observe \"Error from slot1@startd-machine:\nFailed to execute '/bin/true': No such file or directory\n</li><li>on startd machine look in /var/log/condor/StarterLog.slot1 and observe:\n<div class=\"code\">\n<pre class=\"code\"> Create_Process: Cannot access specified cwd \"/tmp/wontexist\": errno = 2 (No\nsuch file or directory)\n ERROR \"Create_Process(/bin/true,, ...) failed: No such file or directory\" at\nline 530 in file os_proc.cpp\n</pre></div>\n\n</li></ol>\n\n<p>Expected results:\n\n</p><p>The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReason\" title=\"Hold Reason\">HoldReason</a></span> to include information about access to cwd (say iwd!) failing.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Apr-16 16:12:36 by adesmet:</em> <br/>\n\nThere is no particular benefit to dragging std::string in; core_daemon_core.* is already using <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span>.\n\n<p>More importantly, you'll overrun the errbuf buffer if strlen(cwd) &gt; 481(ish).  MyString::sprintf will accomplish the same thing in a simpler fashion that avoids the complication of buffer sizes.\n\n</p><p>In condor_Starter.V6.1/os_proc.cpp: are we guaranteed strerror() never returns anything longer than 500ish bytes?  MyString::sprintf again seems safer.  In particular, if create_process_err_msg is a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span>, you could use create_process_err_msg.sprintf_cat, eliminating the need for errbuf entirely.\n\n</p><p></p><hr/>\n<em>2010-Jun-01 16:06:24 by adesmet:</em> <br/>\n\n\"#include &lt;string&gt;\" in src/condor_daemon_core.V6/condor_daemon_core.h seems unnecessary, since the code no longer uses std::string.  But otherwise, it looks fine by me.\n<hr/>\n<em>2010-Aug-23 17:42:37 by adesmet:</em> <br/>\n\nBulk change of target version from v070403 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n<hr/>\nPinging to get this in for 7.6\n<hr/>\n<em>2011-Feb-01 16:08:44 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/157/gt_1361.patch\">gt_1361.patch</a>\n4293 bytes added by eje on 2010-Apr-16 20:24:47 UTC.\n<br/>\nPatch to obtain less ambiguous error info out of Create_Process, particularly in case of IWD access failure, although could also be used in future to also reduce ambiguity from other error returns, as the need arises.<br/>\n</li><li><a href=\"../files/159/gt_1361_MyString.patch\">gt_1361_MyString.patch</a>\n4218 bytes added by eje on 2010-Apr-29 03:10:24 UTC.\n<br/>\nFix for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1361\" onclick=\"get_ticket_and_populate_wrapper('1361'); return false;\" title=\"Error reported from execute node incomplete for IWD access failure\">#1361</a></span> using <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span><br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Feb-08 14:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e3213f43eb3b1ef021b902f1c8e189b99c99ec53\">[20332]</a></span>: Improved <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReason\" title=\"Hold Reason\">HoldReason</a></span> when job execution fails to access IWD, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1361\" onclick=\"get_ticket_and_populate_wrapper('1361'); return false;\" title=\"Error reported from execute node incomplete for IWD access failure\">#1361</a></span> Committer: Matthew Farrellee  (By Erik Erlandson )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Feb-08 14:57", "status": "resolved", "created": "2010-Apr-16 14:51", "fixed_version": "2010-Apr-16 14:51", "broken_version": "v070401", "priority": "3", "subsystem": "Daemons", "assigned_to": "eje", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu,eje@redhat.com", "due_date": ""}