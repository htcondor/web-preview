{"id": 3392, "title": "Ticket #3392: Update DAGMan documentation for RETRY + SPLICE", "description": "<blockquote>\nI had the following exchange with Igor:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">Date: Wed, 19 Dec 2012 08:35:33 -0600\nFrom: Nathan Panike &lt;nwp@cs.wisc.edu&gt;\nTo: Igor Sfiligoi &lt;sfiligoi@fnal.gov&gt;\nCc: wenger@cs.wisc.edu\nSubject: Re: Q about mixing retry with splices\n\nOn Tue, Dec 18, 2012 at 05:55:18PM -0800, Igor Sfiligoi wrote:\n&gt; Hi Nathan.\n&gt;\n&gt; Quick question about mixing RETRY statements and splices in dagman.\n&gt; (I could not find an explicit reference in the manual)\n&gt;\n&gt; If I have a DAG like this:\n&gt; JOB A a.sub\n&gt; SPLICE B b.dag\n&gt; SPLICE C c.dag\n&gt; JOB D d.sub\n&gt; PARENT A CHILD B C\n&gt; PAREND B C CHILD D\n&gt; RETRY A 3\n&gt; RETRY B 3\n&gt; RETRY C 3\n&gt; RETRY D 3\n&gt;\n&gt; Will it work?\n&gt; What will be the semantics if B fails? Will it re-run the whole b.dag? Only the failed nodes?\n\nIgor,\n\nIt won't work.  Internally, SPLICE expands into a bunch of nodes, and\nRETRY only works on a node at a time.  If you want to retry the whole\nb.dag, you must change to SUBDAG EXTERNAL.\n\nWhat I expect to happen: SPLICE expands to a bunch of nodes, named\n(say): B+A, B+B, B+C.  DAGMan will look at the RETRY statement and not\nfind a node B that matches. So the complaint would be something akin to\n\"No node B found\".  I have not tried it.  Hopefully DAGMan will give a\nhelpful error message, and not silently fail.\n\nThis is something I have been working on (eliminating the differences\nbetween SPLICE and SUBDAG EXTERNAL), but my changes break rescue and\nrecovery and I have not worked all that out.\n\n&gt;\n&gt; Thanks,\n&gt;   Igor\n</pre></div>\n\n\n<p>Probably would be helpful to clarify this in the manual...</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Mar-05 14:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/76c24971890007816af039e6dd545df879339fa8\">[35071]</a></span>: clarify that RETRY cannot be used on an entire SPLICE in DAGMan ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3392\" onclick=\"get_ticket_and_populate_wrapper('3392'); return false;\" title=\"Update DAGMan documentation for RETRY + SPLICE\">#3392</a></span>  (By Karen Miller )</td></tr>\n</tbody></table>", "type": "doc", "last_change": "2013-Mar-05 14:35", "status": "resolved", "created": "2012-Dec-19 12:40", "fixed_version": "2012-Dec-19 12:40", "broken_version": "v070807", "priority": "3", "subsystem": "Dag", "assigned_to": "smoler", "derived_from": "", "creator": "nwp", "rust": "", "customer_group": "other", "visibility": "public", "notify": "sfiligoi@fnal.gov smoler@cs.wisc.edu wenger@cs.wisc.edu", "due_date": ""}