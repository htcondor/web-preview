{"id": 235, "title": "Ticket #235: GLEXEC_JOB: Handle proxy expiration", "description": "<blockquote>\nIn GLEXEC_JOB mode, we rely on repeated calls to GLExec to do things like alter the sandbox, start the job, and send signals to the job. Some of these operations (like removing the sandbox after the job exits) are essential for proper cleanup. Unfortunately, our reliance on GLExec for these operations means that if the job's proxy expires we are unable to properly clean up. We should at the very least have a timer that fires shortly before proxy expiration and evicts the job if it hasn't completed yet to avoid this problem.\n\n<p>TODO:\n</p><ul>\n<li>test\n</li><li>regression test\n</li><li>documentation</li></ul>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3280\" onclick=\"get_ticket_and_populate_wrapper('3280'); return false;\" title=\"glexec jobs go on hold after x509 update\">#3280</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nglexec jobs go on hold after x509 update</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3283\" onclick=\"get_ticket_and_populate_wrapper('3283'); return false;\" title=\"glexec job not put on hold when proxy expires\">#3283</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nglexec job not put on hold when proxy expires</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-15 16:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/86fdfd662e4f39415472b68a85c1acb8700b2e15\">[30922]</a></span>: cleanly put the job on hold and exit. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=235\" onclick=\"get_ticket_and_populate_wrapper('235'); return false;\" title=\"GLEXEC_JOB: Handle proxy expiration\">#235</a></span>)  (By Zach Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Feb-17 15:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/66c487afa7d841516e9764bee9b9e697d24c261b\">[30640]</a></span>: use an actual hold code (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=235\" onclick=\"get_ticket_and_populate_wrapper('235'); return false;\" title=\"GLEXEC_JOB: Handle proxy expiration\">#235</a></span>)  (By Zach Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Feb-17 15:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7a2e80e34de1720aa80955e9c31a70038ecfd49a\">[30639]</a></span>: if the proxy expires, only hold the job when actually using glexec (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=235\" onclick=\"get_ticket_and_populate_wrapper('235'); return false;\" title=\"GLEXEC_JOB: Handle proxy expiration\">#235</a></span>)  (By Zach Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Feb-09 12:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7de9ddfa4e10dd3dbee1b29c8bf96ba8e0b509d0\">[30557]</a></span>: have the starter put the job on hold before the proxy expires, which is necessary for glexec. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=235\" onclick=\"get_ticket_and_populate_wrapper('235'); return false;\" title=\"GLEXEC_JOB: Handle proxy expiration\">#235</a></span>)  (By Zach Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Dec-17 12:37", "status": "resolved", "created": "2009-Feb-23 09:37", "fixed_version": "2009-Feb-23 09:37", "broken_version": "v070000", "priority": "2", "subsystem": "Security", "assigned_to": "zmiller", "derived_from": "#2753", "creator": "zmiller", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": "20120216"}