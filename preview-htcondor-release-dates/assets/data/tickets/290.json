{"id": 290, "title": "Ticket #290: Schedd load balancing w/ Condor-C does not work as expected", "description": "<blockquote>\nWith Vanilla job matchmaking, if rank expressions are equal than the negotiator will automatically load balance across different startds by randomizing the match order.\n\n<p>Perhaps this randomization of equally ranked matches is not happening if the match is re-used, as is commonly the case w/ Condor-C and Condor-G ?</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Mar-05 11:02:08 by gthain:</em> <br/>\n\n3/3 long phone call with Parag @ Dzero.  A lot of this is in rust 19054.\n\n<p>Match list caching is off, they are currently trying to set machine rank to influence which schedd to use if multiple schedds match.\n\n</p><p></p><hr/>\n<em>2009-Mar-05 11:23:42 by tannenba:</em> <br/>\n\nSetting machine rank to influence which schedd to use will <strong>not</strong> help.  Machine rank has no semantic meaning in any grid universe (Condor-G/Condor-C) setting.\n\n<p></p><hr/>\n<em>2009-Mar-10 19:25:37 by gthain:</em> <br/>\n\nI've talked to them telephonically, and worked out a test rig using condor-c looping back to the them schedd.  I've attached a sample site ad and job ad for this to work.\n\n<p>Setting job rank correctly will do want they want, but they currently have a funny, custom classad function which computes the rank.  If we can change this to add in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurMatches\" title=\"Cur Matches\">CurMatches</a></span>, I think all will be well will them.\n\n</p><p></p><hr/>\n<em>2009-Mar-10 19:27:55 by gthain:</em> <br/>\n\nAlso, I'm going to change the default condor-g matchmaking so that if multiple resources match, then we'll round-robin between all the matching ones.  This more closely matches what we do with normal matchmaking.\n\n<p></p><hr/>\n<em>2009-Mar-11 09:09:12 by gthain:</em> <br/>\n\nIt occurs to me that maybe condor is just doing the right thing at dzero.  If their custom job rank function is directing jobs to the site with the most files cached, maybe they get bursts of jobs with basically the same i/o requirements, so their rank function always sends them to the same schedd?\n\n<p></p><hr/>\n<em>2009-Mar-13 15:35:14 by gthain:</em> <br/>\n\nI believe they are all well know with the rank changes, and knowing that the new matchmaker works as desired.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Mar-10 19:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a510616d03dec631caaed0f5d4caa14adf3347b1\">[14207]</a></span>: When a condor-g matchmaking ad matches, shuffle to the end <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=290\" onclick=\"get_ticket_and_populate_wrapper('290'); return false;\" title=\"Schedd load balancing w/ Condor-C does not work as expected\">#290</a></span> This allows for round-robin matching to multiple gatekeepers with the same rank, condor-admin 19054  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Aug-07 12:01", "status": "resolved", "created": "2009-Mar-02 16:55", "fixed_version": "2009-Mar-02 16:55", "broken_version": "v070200", "priority": "4", "subsystem": "Grid", "assigned_to": "gthain", "derived_from": "", "creator": "tannenba", "rust": "a19054", "customer_group": "fermi", "visibility": "public", "notify": "tannenba@cs.wisc.edu", "due_date": ""}