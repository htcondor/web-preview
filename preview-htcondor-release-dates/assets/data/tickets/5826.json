{"id": 5826, "title": "Ticket #5826: Improve documentation of concurrent job limits", "description": "<blockquote>\nFrom htcondor-support #8571:\n\n<p>I was thinking it would be a good idea to add some verbiage to the manual\nin the section on concurrency limits about the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitterUserResourcesInUse\" title=\"Submitter User Resources In Use\">SubmitterUserResourcesInUse</a></span>\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span>, and how it can be used to limit the number of concurrent jobs\nthrough the requirements expression without having to implement a\nconfiguration change on the system:\n\n</p><p>requirements = (isUndefined(SubmitterUserResourcesInUse) ||\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitterUserResourcesInUse\" title=\"Submitter User Resources In Use\">SubmitterUserResourcesInUse</a></span> &lt;= 100)\n\n</p><p>... or whatever the correct incantation is. Presently, this <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> is\nonly mentioned in the \"Priorities in Negotiation and Preemption\" section\nof the manual, and so most \"howto\" guides you find online don't mention\nthis as a way to enforce concurrency limits.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Aug-04 14:02:57 by wenger:</em> <br/>\n\nHmm -- I've been playing around with this to understand things, and I'm not sure it works the way it should...\n\n<p>If my requirements expression is this:\n\n</p><p></p><pre>  requirements = (isUndefined(SubmitterUserResourcesInUse) || SubmitterUserResourcesInUse &lt;= 0)\n</pre>\n\n<p>only one job runs at a time, as you'd expect.\n\n</p><p>But if the requirements expression is this:\n\n</p><p></p><pre>  requirements = (isUndefined(SubmitterUserResourcesInUse) || SubmitterUserResourcesInUse &lt;= 1)\n</pre>\n\n<p>as many jobs run as I have slots available.\n\n</p><p>I'm trying to figure out whether there's something I'm missing...\n\n</p><p></p><hr/>\n<em>2016-Aug-04 14:39:39 by tannenba:</em> <br/>\n\nIt basically works, but only if you disable matchlist caching by adding to the condor_config in your central manager\n\n<p></p><pre>   # Disable Matchlist caching (defaults to True)\n   NEGOTIATOR_MATCHLIST_CACHING = False\n</pre>\n\n<p>Note disabling this cache can result in substantially increasing the time it takes to do a negotiation cycle.  In pools with just a few hundred slots it probably doesn't make much difference.  But in pools with many thousands of slots, it explode the negotiation time by an order of magnitude.\n\n</p><p>I'm not sure we should be recommending this technique to people without a big warning about the impact to scalability...\n\n</p><p></p><hr/>\n<em>2016-Aug-04 14:48:10 by wenger:</em> <br/>\n\nOkay, good to know that -- I'll put some kind of warning in the docs.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "doc", "last_change": "2017-Jun-01 13:24", "status": "stalled", "created": "2016-Aug-04 09:35", "fixed_version": "2016-Aug-04 09:35", "broken_version": "v080500", "priority": "2", "subsystem": "Unknown", "assigned_to": "", "derived_from": "", "creator": "wenger", "rust": "s8571", "customer_group": "support", "visibility": "public", "notify": "wenger@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}