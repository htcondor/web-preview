{"id": 7685, "title": "Ticket #7685: Formatting bug in D_SUBSECOND", "description": "<blockquote>\n<div class=\"code\">\n<pre class=\"code\">06/14/20 14:29:04.1000 (D_TEST) pcccDumpTable(): dumping table...\n06/14/20 14:29:04.1000 (D_TEST) pcccDumpTable(): ... done dumping PCCC table.\n06/14/20 14:29:04.1000 (D_TEST) Dumping match records (with now jobs)...\n06/14/20 14:29:05.000 (D_TEST) ... done dumping match records.\n</pre></div>\n\n\n<p>There is no millisecond 1000.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Jun-14 17:22:18 by tlmiller:</em> <br/>\n\nTest run is <a class=\"external\" href=\"https://batlab.chtc.wisc.edu/results/run-details.php?runid=506258\">here</a>.\n\n<p></p><hr/>\n<em>2020-Jun-14 17:24:23 by tlmiller:</em> <br/>\n\nAssigning TJ the review before the tests are done to make sure I don't forget.\n\n<p></p><hr/>\n<em>2020-Jun-17 10:07:42 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> : looks good.  in retrospect that's a pretty obvious bug...\n\n<p></p><hr/>\n<em>2020-Aug-14 08:58:58 by tlmiller:</em> <br/>\n\nThe new patch fixes a bug (accidentally incrementing the struct tm pointer rather than the seconds value), and hopefully introduces no new ones.\n\n<p>The other option is to truncate instead of trying to round.\n\n</p><p></p><hr/>\n<em>2020-Oct-07 14:43:37 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> this is better, but it seems like it would be safer to just truncate microseconds to 999999 when it is 1000000 or more rather than trying to round with carry.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Aug-14 08:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bdedf75acadf070c6bba2002af826071055ff4bd\">[60451]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7685\" onclick=\"get_ticket_and_populate_wrapper('7685'); return false;\" title=\"Formatting bug in D_SUBSECOND\">#7685</a></span>) The patch in V8_9-gt7501-branch has a roll-over bug. Regenerate the struct tm after incrementing the seconds, instead.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Aug-12 13:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6abaf8667fad816877b1f38c35907b335527d20c\">[60440]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7685\" onclick=\"get_ticket_and_populate_wrapper('7685'); return false;\" title=\"Formatting bug in D_SUBSECOND\">#7685</a></span>) Increment info.tm-&gt;tm_sec, not info.tm the pointer.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jul-28 15:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a6a076e3368d75b6e8b94afc62c5d07aef28b227\">[60262]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7685\" onclick=\"get_ticket_and_populate_wrapper('7685'); return false;\" title=\"Formatting bug in D_SUBSECOND\">#7685</a></span>) Release note.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jul-27 16:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/35f365f5086e420fbeaea83c0405143f277ec825\">[60245]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7685\" onclick=\"get_ticket_and_populate_wrapper('7685'); return false;\" title=\"Formatting bug in D_SUBSECOND\">#7685</a></span>) Keep msec versus usec straight  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-14 17:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4d3b40eca67c06967a092122234348b46312a173\">[59871]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7685\" onclick=\"get_ticket_and_populate_wrapper('7685'); return false;\" title=\"Formatting bug in D_SUBSECOND\">#7685</a></span>) In the D_SUB_SECOND timestamp, round up to the next second instead of to millisecond \"1000\".  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Oct-10 11:09", "status": "resolved", "created": "2020-Jun-14 14:32", "fixed_version": "2020-Jun-14 14:32", "broken_version": "", "priority": "2", "subsystem": "", "assigned_to": "johnkn", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, karpel@wisc.edu", "due_date": ""}