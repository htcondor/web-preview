{"id": 1015, "title": "Ticket #1015: USER_JOB_WRAPPER and no file transfer broken", "description": "<blockquote>\n<ol>\n<li>Have a USER_JOB_WRAPPER (Hey, CS does. Handy!).\n</li><li>Submit this job:\n<div class=\"code\">\n<pre class=\"code\">universe=vanilla\nexecutable=/bin/sleep\narguments=3\nnotification=never\nlog=eraseme.log\nshould_transfer_files=yes\nwhen_to_transfer_output=on_exit\nqueue\n</pre></div>\n\n</li><li>Observe that the job runs as expected.\n</li><li>Submit this job:\n<div class=\"code\">\n<pre class=\"code\">universe=vanilla\nexecutable=/bin/sleep\narguments=3\nnotification=never\nlog=eraseme.log\nqueue\n</pre></div>\n\n</li><li>Observe that the job goes on hold with an error something like:\n<div class=\"code\">\n<pre class=\"code\">007 (9920.000.000) 11/30 17:26:39 Shadow exception!\n        Error from slot1@p22.cs.wisc.edu: Failed to execute '/unsup/condor/etc/cs_cluster_job_wrapper' with arguments 3: No such file or directory\n        0  -  Run Bytes Sent By Job\n        0  -  Run Bytes Received By Job\n...\n012 (9920.000.000) 11/30 17:26:39 Job was held.\n        Error from slot1@p22.cs.wisc.edu: Failed to execute '/unsup/condor/etc/cs_cluster_job_wrapper' with arguments 3: No such file or directory\n        Code 6 Subcode 2\n...\n</pre></div>\n\n</li></ol>\n\n<p>Checking the remote logs, indeed the starter is trying to run \"/unsup/condor/etc/cs_cluster_job_wrapper 3\" instead of \"/unsup/condor/etc/cs_cluster_job_wrapper condor_exec.exe 3\" as expected.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Dec-02 10:01:45 by gthain:</em> <br/>\n\nThis isn't really a bug, except perhaps with the error message.  From the starterlog:\n\n<p></p><div class=\"verbatim\">\n<pre>11/30 17:26:39 IWD: /scratch/adesmet/rust/admin-20012\n11/30 17:26:39 Input file: /dev/null\n11/30 17:26:39 Output file: /dev/null\n11/30 17:26:39 Error file: /dev/null\n11/30 17:26:39 Renice expr \"5\" evaluated to 5\n11/30 17:26:39 Using wrapper /unsup/condor/etc/cs_cluster_job_wrapper to exec 3\n11/30 17:26:39 Env = _CONDOR_SLOT=1 _CONDOR_MACHINE_AD=/scratch/condor/execute/dir_2407/.machine.ad _CONDOR_SCRATCH_DIR=/scra\ntch/condor/execute/dir_2407 _CONDOR_JOB_AD=/scratch/condor/execute/dir_2407/.job.ad _CONDOR_WRAPPER_ERROR_FILE=/scratch/condo\nr/execute/dir_2407/.job_wrapper_failure\n11/30 17:26:39 ENFORCE_CPU_AFFINITY not true, not setting affinity\n11/30 17:26:39 Create_Process: Cannot access specified cwd \"/scratch/adesmet/rust/admin-20012\": errno = 2 (No such file or di\nrectory)\n11/30 17:26:39 ERROR \"Create_Process(/unsup/condor/etc/cs_cluster_job_wrapper,3, ...) failed: No such file or directory\" at l\nine 530 in file os_proc.cpp\n11/30 17:26:39 ShutdownFast all jobs.\n</pre></div>\n\n\n<p>So, without filetransfer on, the execute node is trying to cd to the cwd of the submitter, which doesn't exit, and the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CreateProcess\" title=\"Create Process\">CreateProcess</a></span> fails.\n\n</p><p></p><hr/>\n<em>2009-Dec-02 15:56:08 by adesmet:</em> <br/>\n\nRe-opening.\n\n<p></p><ol>\n<li>This doesn't explain the profoundly suspicious \"Create_Process(/unsup/condor/etc/cs_cluster_job_wrapper,3, ...)\" where one would expect \"Create_Process(/unsup/condor/etc/cs_cluster_job_wrapper,condor_exec.exe,3, ...)\" or similar.\n\n<p></p></li><li>The error message should be improved.\n</li></ol>\n\n<p></p><hr/>\n<em>2010-May-15 11:38:31 by matt:</em> <br/>\n\n<div class=\"verbatim\">\n<pre>echo \"cmd=/bin/sleep\\nargs=1m\\nremote_initialdir=/tmp/nope\\nnotification=never\\nqueue\" | condor_submit\n</pre></div>\n\n\n<p>Before...\n\n</p><p></p><div class=\"verbatim\">\n<pre>05/15 09:24:02 IWD: /tmp/nope\n05/15 09:24:02 Using wrapper /home/matt/Documents/Condor/Installation/wrapper.sh to exec 1m\n05/15 09:24:02 Create_Process: Cannot access specified iwd \"/tmp/nope\": errno = 2 (No such file or directory)\n05/15 09:24:02 ERROR \"Create_Process(/home/matt/Documents/Condor/Installation/wrapper.sh,1m, ...) failed: Cannot access specified iwd \"/tmp/nope\" (errno=2: 'No such file or directory')\" at line 542 in file os_proc.cpp\n</pre></div>\n\n\n<p>After...\n\n</p><p></p><div class=\"verbatim\">\n<pre>05/15 09:36:23 IWD: /tmp/nope\n05/15 09:36:23 Using wrapper /home/matt/Documents/Condor/Installation/wrapper.sh to exec /bin/sleep 1m\n05/15 09:36:23 Create_Process: Cannot access specified iwd \"/tmp/nope\": errno = 2 (No such file or directory)\n05/15 09:36:23 ERROR \"Create_Process(/home/matt/Documents/Condor/Installation/wrapper.sh,/bin/sleep 1m, ...) failed: Cannot access specified iwd \"/tmp/nope\" (errno=2: 'No such file or directory')\" at line 541 in file os_proc.cpp\n</pre></div>\n\n\n<p>This is an improvement on two counts, 1) the normal \"Using wrapper\" message, 2) ERROR message</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-15 11:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2a5c15ea616807cfbe65f79451f616dd78cf8e4d\">[18006]</a></span>: Improved log messages about what is being exec'd when using user job wrapper (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1015\" onclick=\"get_ticket_and_populate_wrapper('1015'); return false;\" title=\"USER_JOB_WRAPPER and no file transfer broken\">#1015</a></span>)  (By Matthew Farrellee )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-May-15 11:40", "status": "resolved", "created": "2009-Nov-30 17:35", "fixed_version": "2009-Nov-30 17:35", "broken_version": "v070400", "priority": "2", "subsystem": "", "assigned_to": "matt", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}