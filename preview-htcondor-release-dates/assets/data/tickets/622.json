{"id": 622, "title": "Ticket #622: DAGMan does not check node state consistency in recovery mode", "description": "<blockquote>\nI just checked, and in recovery mode DAGMan does not detect any problem if it sees an event marking a node as terminated, if the node's parent is not yet terminated.  In, fact, it happily runs the parent after recovery mode is done, and also doesn't complain that when the parent finishes its children are already marked as done!\n\n<p>I suspect that LIGO's problem referenced in the RUST ticket was caused by something like stale NFS handles temporarily rendering some log files unreadable, and therefore getting the internal state of the DAG into an incorrect state.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Sep-24 15:29:02 by wenger:</em> <br/>\n\nHmm -- this seems to have actually missed 7.3.2 (and 7.4.0, unless we cherry-pick it over).  I must have committed it to the master <strong>after</strong> the 7.3.2 branch was made.\n\n<p></p><hr/>\n<em>2009-Sep-25 12:54:52 by wenger:</em> <br/>\n\nOkay, I've cherry-picked this over to 7.4, and also documented it in the 7.4.0 version history.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-25 12:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0421d99fc17a2e5245f0b887d94c9c41325a244a\">[24987]</a></span>: Documented the fix to gittrac <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=622\" onclick=\"get_ticket_and_populate_wrapper('622'); return false;\" title=\"DAGMan does not check node state consistency in recovery mode\">#622</a></span> in the 7.4 version history.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-25 11:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/08627b8dbb6c3afe167430220caee8907bdea393\">[15757]</a></span>: Cherry-picked the commits of the test for gittrac <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=622\" onclick=\"get_ticket_and_populate_wrapper('622'); return false;\" title=\"DAGMan does not check node state consistency in recovery mode\">#622</a></span> (68f343394b485e113dedbdd560fa468bbadfdd52, c8b113debe2df13151ca98a8c572102a7400f5b7, and 1753a0fb349d981bbfde9883a666ead2734a5be1) and manually resolved conflicts in the Imakefile.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-25 11:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/88a495b22f65d5e88b9503cd579f1e928428f391\">[15754]</a></span>: Cherry-picked the fix to gittrac <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=622\" onclick=\"get_ticket_and_populate_wrapper('622'); return false;\" title=\"DAGMan does not check node state consistency in recovery mode\">#622</a></span> (3750c2b21bd1380b828783944cc23445d2fc8043) and manually fixed conflicts in src/condor_dagman/dagman_main.h.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-03 16:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3750c2b21bd1380b828783944cc23445d2fc8043\">[15622]</a></span>: Fixed gittrac <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=622\" onclick=\"get_ticket_and_populate_wrapper('622'); return false;\" title=\"DAGMan does not check node state consistency in recovery mode\">#622</a></span> (DAGMan does not check node state consistency in recovery mode); also changed Job::Dump() to print node <strong>names</strong> instead of node <strong>IDs</strong> for parents and children.  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Jan-31 13:40", "status": "defer", "created": "2009-Jul-09 11:54", "fixed_version": "2009-Jul-09 11:54", "broken_version": "v070301", "priority": "5", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "", "creator": "wenger", "rust": "a19456", "customer_group": "ligo", "visibility": "public", "notify": "wenger@cs.wisc.edu, psilord@cs.wisc.edu,pcouvare@caltech.edu", "due_date": ""}