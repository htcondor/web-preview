{"id": 653, "title": "Ticket #653: Detect operating system, distribution, and version", "description": "<blockquote>\nWe would benefit from having code that detects the operating system, distribution, and version.  The dependent tickets below require such functionality to exist.\n\n<p>Random notes:\n</p><ul>\n<li>Detection on Windows is probably just <a class=\"external\" href=\"http://msdn.microsoft.com/en-us/library/ms724451%28VS.85%29.aspx\">GetVersionEx</a>.\n</li><li>Detection on Linux probably involves grovelling around on disk, looking at things like /etc/redhat-release, /etc/SuSE-release, /etc/issue (unreliable, but maybe a good fallback), and more. <a class=\"external\" href=\"http://www.novell.com/coolsolutions/feature/11251.html\">Novel on detecting distribution</a>, <a class=\"external\" href=\"http://linuxmafia.com/faq/Admin/release-files.html\">a longer list of distribution specific files </a>\n</li></ul>\n\n<p>Proposed development order:\n</p><ol>\n<li>Create new subdirectory for this work.  condor_osdetect, perhaps.\n</li><li>Create simple command line program that reports the detected OS.  At first it won't do anything useful.  It should link in various Condor libraries, notably c++_util, since we will likely eventually need safe_open_wrapper and the like.  Also set up the Imake/autoconf stuff.\n</li><li>Create a new static library for the os detection code.  At first it should always report that it's unable to detect anything.\n</li><li>The command line program should link in the library and use it to not do anything useful yet.\n</li><li>Start adding actual detection capabilities to the library.  At this point the command line program should be useful on at least one platform.\n</li><li>Write a new test that runs the command line program and confirms the output.\n</li><li>Add new detection and matching tests until we have \"a bunch\"\n</li><li>Modify the condor_master to link this library and pass the information on.  At this point the system is useful to local administrators.\n</li><li>Modify the condor_collector to collect the information from many master ads and pass it on in the global ad.  At this point the system is useful to Condor developers.\n</li><li>while(there_are_undetected_platforms()) { add_more_detection_routines(); }</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2009-Aug-04 12:02:10 by adesmet:</em> <br/>\n\nPossible STUDENTTASK\n\n<p></p><hr/>\n<em>2010-Jul-28 13:33:42 by tstclair:</em> <br/>\n\nIt's considered \"bad form\" to put using namespace xyz into the .h files, .cpp files are fine.\n\n<p>Some folks call it: \"namespace/symbol pollution.\"\n\n</p><p></p><hr/>\n<em>2010-Sep-02 11:54:00 by adesmet:</em> <br/>\n\nThis ticket originally included the details now in <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=1636\" onclick=\"get_ticket_and_populate_wrapper('1636'); return false;\" title=\"Report operating system, distribution, and version in world ads\">#1636</a></span>.  I've broken them apart so they stay focused.  This task is underway.  <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=1636\" onclick=\"get_ticket_and_populate_wrapper('1636'); return false;\" title=\"Report operating system, distribution, and version in world ads\">#1636</a></span> requires staff consideration and design.\n<hr/>\n<em>2010-Oct-20 15:59:08 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:21:33 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=1636\" onclick=\"get_ticket_and_populate_wrapper('1636'); return false;\" title=\"Report operating system, distribution, and version in world ads\">#1636</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nReport operating system, distribution, and version in world ads</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=1637\" onclick=\"get_ticket_and_populate_wrapper('1637'); return false;\" title=\"Remote distribution and distro version in machine ads\">#1637</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nRemote distribution and distro version in machine ads</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/202/osdetect.cpp\">osdetect.cpp</a>\n1197 bytes added by huebner on 2010-Jul-28 16:41:35 UTC.\n</li><li><a href=\"../files/203/osdetect.h\">osdetect.h</a>\n303 bytes added by huebner on 2010-Jul-28 16:41:51 UTC.\n</li></ul>\n</blockquote></body></html>", "check_ins": "", "type": "enhance", "last_change": "2011-Feb-01 14:51", "status": "new", "created": "2009-Aug-04 12:01", "fixed_version": "2009-Aug-04 12:01", "broken_version": "", "priority": "4", "subsystem": "Daemons", "assigned_to": "huebner", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}