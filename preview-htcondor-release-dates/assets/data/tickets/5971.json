{"id": 5971, "title": "Ticket #5971: Feature request: SUBMIT_REQUIREMENT_<NAME> should have WARN knob", "description": "<blockquote>\nLIGO is beginning to make real use of <code>SUBMIT_REQUIREMENT_*</code>. But we would be interested in a knob like <code>SUBMIT_REQUIREMENT_&lt;NAME&gt;_WARN</code>. If this knob were set to <code>True</code>, jobs would be submitted even when <code>SUBMIT_REQUIREMENT_&lt;NAME&gt;</code> evaluates to <code>False</code> but <code>SUBMIT_REQUIREMENT_&lt;NAME&gt;_REASON</code> would still be printed for the user. If <code>SUBMIT_REQUIREMENT_&lt;NAME&gt;_WARN</code> is <code>Undefined</code> or <code>False</code>, the behavior would be as it is now: reject jobs and print the reason.\n\n<p>The idea is to phase-in a visible warning period prior to proper enforcement.</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Mar-06 15:41:23 by bbockelm:</em> <br/>\n\nThis might be a bit difficult to implement from the schedd side.\n\n<p>Would it be acceptable if the warning happened from the client side?  The danger would be the chance that the schedd submit requirements and the client submit requirements would differ...\n\n</p><p></p><hr/>\n<em>2017-Oct-04 17:32:04 by tlmiller:</em> <br/>\n\n... make sure any implementation for this includes (or at least documents ignoring) the python bindings.\n\n<p></p><hr/>\n<em>2017-Oct-05 15:38:20 by tlmiller:</em> <br/>\n\n.. and writes to the event log.\n\n<p></p><hr/>\n<em>2017-Oct-06 12:03:36 by tpdownes:</em> <br/>\n\nI happen to be assembling agenda for Wednesay right now. Could you summarize the behavior of this knob?\n\n<p></p><hr/>\n<em>2017-Oct-06 13:42:04 by tlmiller:</em> <br/>\n\nGiven the configuration\n\n<p></p><div class=\"file\">\n<pre class=\"filelabel\">/etc/condor/config.d/arbitrary.warning</pre>\n<pre class=\"file\">SUBMIT_REQUIREMENT_NAMES = $(SUBMIT_REQUIREMENT_NAMES) ARBITRARY\nSUBMIT_REQUIREMENT_ARBITRARY = FALSE\nSUBMIT_REQUIREMENT_ARBITRARY_REASON = \"Because we hate you, that's why.\"\nSUBMIT_REQUIREMENT_ARBITRARY_IS_WARNING = TRUE\n</pre></div>\n\n\n<p>you will see the following when you submit a job\n\n</p><p></p><div class=\"term\">\n<pre class=\"term\">$ condor_submit ./vanilla.submit\nSubmitting job(s).\nWARNING: Committed job submission into the queue with the following warning:\nWARNING: Because we hate you, that's why.\n\n1 job(s) submitted to cluster 452.\n</pre></div>\n\n\n<p>and the following in the job's log\n\n</p><p></p><div class=\"file\">\n<pre class=\"filelabel\">vanilla.log</pre>\n<pre class=\"file\">000 (453.000.000) 10/06 13:40:45 Job submitted from host: &lt;128.105.136.53:37317?addrs=128.105.136.53-37317+[fc00--1]-37317&amp;noUDP&amp;sock=19966_e869_5&gt;\n    WARNING: Committed job submission into the queue with the following warning: Because we hate you, that's why.\n...\n</pre></div>\n\n\n<p>I think that covers everything.\n\n</p><p></p><hr/>\n<em>2017-Oct-06 14:01:04 by tpdownes:</em> <br/>\n\nThat looks good! I like that it essentially looks like the output of a failed job. I have 2 comments.\n\n<p></p><ol>\n<li>Will I be able to use all the same strcat magic with classads to customize the warning? For example, I'm able to customize a warning that ensures I don't misspell my name in a job tag we use for accounting.\n<div class=\"verbatim\">\n<pre>[pcdev3:wrapper-testing] condor_submit sleep.sub\nSubmitting job(s).\nERROR: Failed to commit job submission into the queue.\nERROR: Invalid value for search user: thomas.downe\n       Valid values are: thomas.downes,tpdownes\n</pre></div>\n\n\n<p></p></li><li>\"commit job submission into the queue\" is a bit wordy but it's similar to the wording above. Something more like \"Job successfully submitted, but received the following warning: \" and \"Job was rejected for submission due to the following error:\".\n</li></ol>\n\n<p>I could understand not wanting to change the stdout/stderr of a job. So if the answer to comment 1 is \"yes\" then we're done!\n\n</p><p></p><hr/>\n<em>2017-Oct-06 15:02:01 by tlmiller:</em> <br/>\n\n<div class=\"verbatim\">\n<pre>&gt; Will I be able to use all the same strcat magic with classads to customize the\n&gt; warning? For example, I'm able to customize a warning that ensures I don't\n&gt; misspell my name in a job tag we use for accounting.\n</pre></div>\n\n\n<p>I didn't touch the code for SUBMIT_REQUIREMENT_*_REASON, and I've confirmed that strcat( \"...\", Owner ) does what you'd expect.\n\n</p><p>The wording was selected, as you noticed, to be similar to the existing wording.  That seemed easier than arguing about trying to improve both of them. :)\n\n</p><p></p><hr/>\n<em>2017-Oct-25 16:28:16 by tim:</em> <br/>\n\n<strong>Doc review:</strong> Looks good</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=6446\" onclick=\"get_ticket_and_populate_wrapper('6446'); return false;\" title=\"Only last submit warning reported.\">#6446</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nOnly last submit warning reported.</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-10 14:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bf95eea4b5be9110388cdb16254ec3ab1edfb31d\">[52543]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) Documentation and release note.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-09 14:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2c3f30561d396d435a2d1acd21e890316c52c3e2\">[52524]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) Forgot to check for NULL. :(  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-09 13:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/dccc4235f1b43e97b2e02fceb852cfe1a1559dc6\">[52523]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) Work around a problem where the client doesn't have version information but the server does.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-09 13:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/16674864c62fedd6d1054e77e17d4c36d8a8b780\">[52522]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) More bad-API work-arounds. Should eliminate null warnings.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-09 11:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9bf03fee91ddec57bca5c844018c28632c37fdd7\">[52521]</a></span>: Fix copy-paste error in <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span> Committer: Tim Theisen  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-09 09:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d13843dddcb9d007f337424594ad09100b036a30\">[52520]</a></span>: Fix copy-paste error in <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-06 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b5ab9b16f6b24a46341a6db55a2c9c9020b45990\">[52504]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7fe915fb798e4845591a07f6645e1b5a57992eaf\">[52494]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/448efd2363b8edd5d176c862816a4ef93c64986e\">[52498]</a></span>, Merge branch 'V8_7-submit_warnings-branch' (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>)  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-06 11:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/58fbe08249ddeab1bedc8378f7f525f9635d0c09\">[52502]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eda164d6fce33dda23a7522d58d4917ea35a69d7\">[52491]</a></span>, Merge branch 'V8_7-submit_warnings-branch' (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>)  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-05 15:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/448efd2363b8edd5d176c862816a4ef93c64986e\">[52498]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) Write warning(s) to event log.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-05 13:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7fe915fb798e4845591a07f6645e1b5a57992eaf\">[52494]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) Use easily-misunderstood API correctly. Forward and backwards compatability with 8.6.6 confirmed.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-05 10:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eda164d6fce33dda23a7522d58d4917ea35a69d7\">[52491]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5971\" onclick=\"get_ticket_and_populate_wrapper('5971'); return false;\" title=\"Feature request: SUBMIT_REQUIREMENT_&lt;NAME&gt; should have WARN knob\">#5971</a></span>) Implement _IS_WARNING knob for submit requirements.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Oct-25 16:28", "status": "defer", "created": "2016-Oct-18 13:32", "fixed_version": "2016-Oct-18 13:32", "broken_version": "v080507", "priority": "5", "subsystem": "", "assigned_to": "tlmiller", "derived_from": "", "creator": "tpdownes", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "downes@uwm.edu,pcouvare@caltech.edu", "due_date": ""}