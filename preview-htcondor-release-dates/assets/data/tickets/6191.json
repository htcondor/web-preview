{"id": 6191, "title": "Ticket #6191: collector should have a knob to set what queries are handled in-proc", "description": "<blockquote>\nThe collector should have a knob that can be used to control what sort of queries are handled in proc (instead of forking).\n\n<p>The knob will be\n\n</p><p><code>HANDLE_QUERY_IN_PROC_POLICY</code>\n\n</p><p>it it will take one of the following values (case insenstive)\n\n</p><p></p><ul>\n<li><code>always</code> Always handle in-proc (Never fork), 1 and <code>true</code> will behave like <code>always</code>\n</li><li><code>never</code>  Always fork, 0 and <code>false</code> will behave like <code>never</code>\n</li><li><code>small_table</code> Handle small tables in-proc. Small tables are all tables except STARTD, MASTER, GENERIC, and ANY\n</li><li><code>small_query</code> Handle small queries in-proc. Small queries are locate queries, or those with both a projection and a result limit &lt; 10\n</li><li><code>small_table_and_query</code> Handle small queries of small tables in-proc\n</li><li><code>small_table_or_query</code> Handle in proc if either small table or small query.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2017-Mar-14 11:19:29 by johnkn:</em> <br/>\n\ncommit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/314642b54db470372c1673a73749d07a9325026a\">[50311]</a></span> adds the knob to the collector, but it still needs to be added to the param table (maybe?) and documented (maybe?)\n\n<p></p><hr/>\n<em>2017-Mar-14 11:23:38 by johnkn:</em> <br/>\n\nsmall_query test should include result_limit &gt; 0, also the config code should print out the unrecognised value.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Apr-20 11:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3ae6cb388559962758ca421538cf6c337bad90e6\">[50516]</a></span>: doc and version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6191\" onclick=\"get_ticket_and_populate_wrapper('6191'); return false;\" title=\"collector should have a knob to set what queries are handled in-proc\">#6191</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-14 10:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/314642b54db470372c1673a73749d07a9325026a\">[50311]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6191\" onclick=\"get_ticket_and_populate_wrapper('6191'); return false;\" title=\"collector should have a knob to set what queries are handled in-proc\">#6191</a></span>, add HANDLE_QUERY_IN_PROC_POLICY configuration knob for controlling which queries the collector handles in-process rather than by forking a child. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Apr-20 12:08", "status": "resolved", "created": "2017-Mar-14 10:55", "fixed_version": "2017-Mar-14 10:55", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "johnkn", "derived_from": "#6093", "creator": "johnkn", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}