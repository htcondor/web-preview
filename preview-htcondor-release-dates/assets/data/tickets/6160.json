{"id": 6160, "title": "Ticket #6160: Schedd should track job counts by status and condor_q should show them", "description": "<blockquote>\nThe SCHEDD should keep track of counts of idle/running/held/etc jobs overall and also by user and it should report those counts to condor_q and possibly to other places.\n\n<p>The goal here is to make it so external programs can get fully accurate counts of idle and running jobs at any time without making the schedd stop and scan the entire job queue, or waiting until the schedd does it's periodic count_jobs pass.\n\n</p><p>The new counters will be reported in the final ad that condor_q (v3 protocol) receives and condor_q should be modified to print those values rather than caculating job counts itself.\n\n</p><p>Also, condor_q -tot should pass a flag in the v3 query ad to tell the schedd that it ONLY cares about the job counts and the schedd should send only the counts.</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Feb-23 14:54:56 by johnkn:</em> <br/>\n\nfor this commit there is a temporary knob to enable 'legacy' total display in condor_q. <code>CONDOR_Q_SHOW_OLD_SUMMARY</code>.  It defaults to TRUE for now, and will until we fix some of the tests.  Hopefully before we ship 8.7.1 it will default to false.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Apr-20 14:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e49c7db8da739dcb98ec280fd9fa91d0fba4b39b\">[50520]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6160\" onclick=\"get_ticket_and_populate_wrapper('6160'); return false;\" title=\"Schedd should track job counts by status and condor_q should show them\">#6160</a></span>) make version history match the code  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Apr-20 09:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9b90dac0f44e325c924e4c3331aae86f8465def6\">[50514]</a></span>: doc and version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6160\" onclick=\"get_ticket_and_populate_wrapper('6160'); return false;\" title=\"Schedd should track job counts by status and condor_q should show them\">#6160</a></span>.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-23 12:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/08024914ed691c683adb8b4dcaad7872022ad52a\">[50194]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6160\" onclick=\"get_ticket_and_populate_wrapper('6160'); return false;\" title=\"Schedd should track job counts by status and condor_q should show them\">#6160</a></span>, have the schedd track job counts by state, overall and per owner and have it return the counts in the final ad if the condor_q v3 query. Also have condor_q print out the count values and have condor_q -tot request that ONLY the final ad be returned. condor_q will only print its own totals\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Apr-20 09:55", "status": "resolved", "created": "2017-Feb-23 12:46", "fixed_version": "2017-Feb-23 12:46", "broken_version": "", "priority": "4", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}