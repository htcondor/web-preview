{"id": 4613, "title": "Ticket #4613: General Auto-cluster query tool", "description": "<blockquote>\nNote: the limited-scope autocluster query needed by glidinWMS is now <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4792\" onclick=\"get_ticket_and_populate_wrapper('4792'); return false;\" title=\"simple option to condor_q to query the negotiator's autocluster\">#4792</a></span>. This ticket is now for the larger-scope general aggregated query command.\n\n<p>It would be useful to be able to request that the schedd send back aggregated results as a result of a query from condor_q.  A SQL-style GROUP_BY aggregation is actually very similar to what the SCHEDD does when it builds its autoclusters.   If the SCHEDD could be configured to build other (named) autoclusters that could be queried by condor_q.  or if it could build and report an autocluster using a set of significant attributes supplied by condor_q, the result could be used to improve the standard condor_q output.\n\n</p><p>A design doc for this proposed change is currently on google docs.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Feb-18 14:01:20 by johnkn:</em> <br/>\n\nThe user visible work for this ended up in <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4792\" onclick=\"get_ticket_and_populate_wrapper('4792'); return false;\" title=\"simple option to condor_q to query the negotiator's autocluster\">#4792</a></span></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nGeneral Auto-cluster query tool</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-08 10:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3030721b7cdacfd5d2a9b14d711aca11fcdef1ef\">[42136]</a></span>: Make Clang happy about converting between JOB_ID_KEY and PROC_ID. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-07 16:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8717a2243e919370d72dd8465b4375ba31fa4991\">[42131]</a></span>: Make newer Clang happy with <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ConstructClassAdLogTableEntry\" title=\"Construct Class Ad Log Table Entry\">ConstructClassAdLogTableEntry</a></span>. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span> Clang insists on a user-provided default constructor when const variable <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DefaultMakeClassAdLogTableEntry\" title=\"Default Make Class Ad Log Table Entry\">DefaultMakeClassAdLogTableEntry</a></span> is declared.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-05 10:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d028bb2bf461e815d971f04d0c1bb0798a64b8fb\">[42093]</a></span>: In support of <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span>, convert schedd functions to use the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobQueueJob\" title=\"Job Queue Job\">JobQueueJob</a></span> object Make a formal distinction in use of header files between code inside the schedd and clients of the schedd. Code inside the schedd must always #include qmgmt.h before condor_qmgr.h. Code outside the schedd should never include\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-10 16:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e3822384d33785078822deab8512020d95e43de5\">[41889]</a></span>: convert some qmgmt functions to use the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobQueueJob\" title=\"Job Queue Job\">JobQueueJob</a></span> object. for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span> This commit converts <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SetAttribute\" title=\"Set Attribute\">SetAttribute</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=InitJobQueue\" title=\"Init Job Queue\">InitJobQueue</a></span> to use the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobQueueJob\" title=\"Job Queue Job\">JobQueueJob</a></span> class  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-08 09:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e3960169ee9a490aa5b1e91b71c2c3ab2139e9ac\">[41835]</a></span>: fix whitespace errors in previous commmit to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-06 11:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/726c1c30a6189e004a563d450c1b2d52e4f313db\">[41833]</a></span>: For <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span> Change schedd (qmgmt) to class derived from <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> in the job queue and a class derived from PROC_ID as the key. With this commit <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GetJobAd\" title=\"Get Job Ad\">GetJobAd</a></span> now returns a instance of the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobQueueJob\" title=\"Job Queue Job\">JobQueueJob</a></span> class.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-02 12:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/61733b676ab5e5d8c94c777d8f30b7fa4203d30c\">[41832]</a></span>: templatize <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAdLog\" title=\"Class Ad Log\">ClassAdLog</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAdCollection\" title=\"Class Ad Collection\">ClassAdCollection</a></span> so that the hashtable payload can be an arbitrary class for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span> This commit defines a class derived from the compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> class and uses it in the schedd job queue. The new class provides a place to store runtime information with the job. which will be\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Nov-19 09:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/48c2b81d210dfa7074023337eb03d1a90db656b9\">[41678]</a></span>: Template-ize the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAdCollection\" title=\"Class Ad Collection\">ClassAdCollection</a></span> class use by the job queue in support of <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4613\" onclick=\"get_ticket_and_populate_wrapper('4613'); return false;\" title=\"General Auto-cluster query tool\">#4613</a></span> creating an auto-cluster query tool.  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Feb-18 14:01", "status": "resolved", "created": "2014-Sep-25 09:00", "fixed_version": "2014-Sep-25 09:00", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "#4613", "creator": "johnkn", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}