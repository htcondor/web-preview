{"id": 1978, "title": "Ticket #1978: Bad hack in condor_tests causes git annoyance", "description": "<blockquote>\nThese files in <code>condor_tests/</code> have a very stupid piece of code in them:\n\n<p></p><div class=\"verbatim\">\n<pre>cmd_wait_shows-all.run:runcmd(\"chmod -R 777 .\");\ncmd_wait_shows-base.run:runcmd(\"chmod -R 777 .\");\ncmd_wait_shows-notimeout.run:#runcmd(\"chmod -R 777 .\");\ncmd_wait_shows-partial.run:runcmd(\"chmod -R 777 .\");\njob_core_priority_van.run:system(\"chmod -R 777 .\");\n</pre></div>\n\n\n<p>Since in the new cmake world we must do in source tests, the above causes many tracked files to change permission. Then git status/diff notices this and pollute the system with extraneous changes. It makes it annoying and time consuming to deal with the mess the above chmods leave.\n\n</p><p>With your cwd in the condor_tests directory, this will fix the above damage\nthat had been done. Hopefully, you don't have changes to any executable files\nin that directory, in which case this will mess it up, however, it'll be a\nsmaller set of file perms to fix by hand.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">&gt; git diff | grep diff | awk '{print $3}' | sed -e 's@a/src/condor_tests/@@' | xargs chmod 644\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\nBetter might be the following pipeline assuming you have staged ( <code>git add</code> )ed the files you plan to commit:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">&gt; git ls-files -z -m src/condor_tests | git checkout-index -f -z --stdin\n</pre></div>\n\n\n<p></p><hr/>\n<em>2011-Mar-22 08:47:04 by gthain:</em> <br/>\n\nOr, you could just remove the darn chmod from the source.  I just did that, with no apparent bad side effects.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Mar-22 08:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ed3ab9e11cbf3440d8008418993c81ef8a169b34\">[21109]</a></span>: Remove superfluous \"chmod -R 777 .\" from condor_tests <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1978\" onclick=\"get_ticket_and_populate_wrapper('1978'); return false;\" title=\"Bad hack in condor_tests causes git annoyance\">#1978</a></span> I have no idea why the tests were doing this, they don't need it, and it was causing all kinds of collateral damage.  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-May-03 09:18", "status": "resolved", "created": "2011-Mar-17 11:55", "fixed_version": "2011-Mar-17 11:55", "broken_version": "v070506", "priority": "3", "subsystem": "Tests", "assigned_to": "gthain", "derived_from": "#1124", "creator": "psilord", "rust": "", "customer_group": "other", "visibility": "public", "notify": "psilord@cs.wisc.edu", "due_date": ""}