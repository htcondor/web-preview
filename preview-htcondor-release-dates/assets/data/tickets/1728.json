{"id": 1728, "title": "Ticket #1728: cmd_q_shows-sub-1 does not wait for schedd to update collector", "description": "<blockquote>\nThe test 'cmd_q_shows-sub-1' fails when run against a newly-created personal Condor.  (Long story below.)  See\n\n<p><a class=\"external\" href=\"http://nmi-s004.cs.wisc.edu/rundir/nmi-devel/2010/10/nmi-devel_nmi-s004.cs.wisc.edu_1287584045_20324/userdir/nmi:x86_deb_5.0/cmd_q_shows-sub-1.out\">http://nmi-s004.cs.wisc.edu/rundir/nmi-devel/2010/10/nmi-devel_nmi-s004.cs.wisc.edu_1287584045_20324/userdir/nmi:x86_deb_5.0/cmd_q_shows-sub-1.out</a>\n\n</p><p>for the exact error message(s), but the problem appears to be that the submit hook doesn't give the schedd any time to update the collector before running the 'condor_q -sub ...' command that fails.  I don't know why this succeeds when the personal condor has existed for a while, although I suspect, since the submitter doesn't change from test to test, it's getting back old information for this particular check, and it happens to work.\n\n</p><p>As far as I can tell, this is a race condition that would be easy to trigger in other circumstances, but I don't know if this has shown up in this test intermittently failing.\n\n</p><p>(Long story abbreviation: I'm trying to add the ability to run tests concurrently to Metronome, using a DAG running on the execute node.  Condor always cleans up after jobs -- including remote_pre, which deliberately leaves a personal condor running for the tests to share.  While this improves test isolation, it does lead to some problems.  (Including discovering a bug in detecting whether or not the personal condor is actually runinng.))</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2011-Jan-27 14:50:47 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 16:20:02 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=1729\" onclick=\"get_ticket_and_populate_wrapper('1729'); return false;\" title=\"soap_job_tests-1 does not wait for schedd to update collector\">#1729</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nsoap_job_tests-1 does not wait for schedd to update collector</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2011-Feb-01 16:20", "status": "new", "created": "2010-Oct-21 14:15", "fixed_version": "2010-Oct-21 14:15", "broken_version": "v070400", "priority": "2", "subsystem": "Tests", "assigned_to": "", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "batlab", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}