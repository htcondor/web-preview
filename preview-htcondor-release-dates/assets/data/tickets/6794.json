{"id": 6794, "title": "Ticket #6794: HTCondor should start up after nfs and automounter", "description": "<blockquote>\nI have a pool configuration system which uses a shared configuration directory in an NFS-mounted /home/condor path. When HTCondor is started by systemd before the automounter and nfs-client units are online, it fails to read most of its configuration and starts up in a disconnected state.\n\n<p>Adding the nfs.client.target and autofs.service to the \"after\" list for the condor.service unit file will provide the necessary ordering for sites which need it without having any effect on sites which don't.\n\n</p><p>The autofs.service does not reference the nfs-client target, since it doesn't necessarily need an NFS filesystem to automount something, so both of them are needed in the after list.\n\n</p><p>If you can recommend any configuration approaches that might achieve the same thing without needing a unit file change - maybe an include pipe? - then I'd appreciate that as well.\n\n</p><p>Thanks!\n\n</p><p>-Michael Pelletier.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Oct-22 15:17:07 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>To be clear, since this tripped me up the first time I looked at this: the second commit removes what had been a Debian-specific patch by applying it to all platforms.  I suppose one benefit of systemd was always supposed to be more consistency between the start-up scripts of different distributions. ;)\n\n</p><p>Code looks good.</p></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7638\" onclick=\"get_ticket_and_populate_wrapper('7638'); return false;\" title=\"Typo in systemd targets to start after\">#7638</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nTypo in systemd targets to start after</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-25 22:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f301c2f74908a3c2dd3b15b7ae655d3fc51118fc\">[55632]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6794\" onclick=\"get_ticket_and_populate_wrapper('6794'); return false;\" title=\"HTCondor should start up after nfs and automounter\">#6794</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6796\" onclick=\"get_ticket_and_populate_wrapper('6796'); return false;\" title=\"Short-lived Docker jobs report spurious usage\">#6796</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-25 22:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f55aae95dcb1fe4aef629f5d547ddc301099be0a\">[55631]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6794\" onclick=\"get_ticket_and_populate_wrapper('6794'); return false;\" title=\"HTCondor should start up after nfs and automounter\">#6794</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6796\" onclick=\"get_ticket_and_populate_wrapper('6796'); return false;\" title=\"Short-lived Docker jobs report spurious usage\">#6796</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-10 08:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/32e2bbec7621a012fcc76548f658082040fb6438\">[55546]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6794\" onclick=\"get_ticket_and_populate_wrapper('6794'); return false;\" title=\"HTCondor should start up after nfs and automounter\">#6794</a></span>) Remove obsolete syslog.target  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-09 16:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4f46481b6145310aa339bf4c11c86c5aa4167f43\">[55543]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6794\" onclick=\"get_ticket_and_populate_wrapper('6794'); return false;\" title=\"HTCondor should start up after nfs and automounter\">#6794</a></span>) HTCondor should start after NFS and automounter are online  (By Tim Theisen )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2018-Oct-25 15:01", "status": "resolved", "created": "2018-Oct-09 16:20", "fixed_version": "2018-Oct-09 16:20", "broken_version": "v080600", "priority": "2", "subsystem": "Packaging", "assigned_to": "tim", "derived_from": "", "creator": "tim", "rust": "s92384", "customer_group": "support", "visibility": "public", "notify": "", "due_date": ""}