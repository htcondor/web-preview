{"id": 804, "title": "Ticket #804: DAGMan should pass current JobPrio to children", "description": "<blockquote>\n<em>Note: This ticket abandoned, as similar work was done in</em> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2167\" onclick=\"get_ticket_and_populate_wrapper('2167'); return false;\" title=\"Propagate DAG node priorities down to job priorities\">#2167</a></span>\n\n<p>DAGMan should pass any <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobPrio\" title=\"Job Prio\">JobPrio</a></span> assigned to it onto the individual jobs it runs.\n\n</p><p>Use case: I'm a user with dozens of DAGs submitted.  I realize that they're all fighting for limited resources and that I'm likely to have them all finish at about the same time, instead of finishing one DAG before moving on to the next.  I have a few specific running DAGs that I would like to prioritize.\n\n</p><p>Current solution: Add a cron or Condor-Cron job that runs \"condor_q -constraint 'DAGManJobId==12345' | xargs condor_prio -p 10\" for each DAG I care about (replacing 12345 with the appropriate job ID).  The cron job should run frequently.\n\n</p><p>Desired solution: I simply say \"condor_prio -set 10 12345\".\n\n</p><p>Proposed implementation: just before submitting a job, possibly throttled to once or minute, condor_dagman will ask the condor_schedd what its current <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobPrio\" title=\"Job Prio\">JobPrio</a></span> is.  Newly submitted jobs will have the current <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobPrio\" title=\"Job Prio\">JobPrio</a></span> applied to them (\"condor_submit -append priority=10\").  On a regular basis, perhaps every five minutes, condor_dagman will check its own priority and will use condor_prio or similar to adjust its children if they have changed.\n\n</p><p>In a perfect world the schedd would be able to alert condor_dagman to priority changes, eliminating the need to poll.\n\n</p><p>Complications: What if a user really wants different priorities for different parts of the DAG, or even DAGman itself?  Is that a realistic concern?</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2010-Oct-20 15:59:08 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2010-Nov-17 11:26:40 by wenger:</em> <br/>\n\nIf we implement this option, I think there should be a config macro to turn it off, because for really large DAGs the performance hit could be significant, and some people won't want this feature.\n\n<p>Another option that Matt just suggested is to set job prio == dag submit time, so that DAGs submitted earlier will automatically have a better priority for their jobs.  Again, if we do that it should have some way of turning it on and off.\n</p><hr/>\n<em>2011-Jan-27 14:46:04 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2012-Feb-07 15:17:34 by nwp:</em> <br/>\n\nThis is addressed tangentially in <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2167\" onclick=\"get_ticket_and_populate_wrapper('2167'); return false;\" title=\"Propagate DAG node priorities down to job priorities\">#2167</a></span></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1992\" onclick=\"get_ticket_and_populate_wrapper('1992'); return false;\" title=\"Implement First Come, First Served for dagman jobs\">#1992</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nImplement First Come, First Served for dagman jobs</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2167\" onclick=\"get_ticket_and_populate_wrapper('2167'); return false;\" title=\"Propagate DAG node priorities down to job priorities\">#2167</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nPropagate DAG node priorities down to job priorities</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6703\" onclick=\"get_ticket_and_populate_wrapper('6703'); return false;\" title=\"Use JobPrio to prioritize scheduler universe jobs\">#6703</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nUse <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobPrio\" title=\"Job Prio\">JobPrio</a></span> to prioritize scheduler universe jobs</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2015-Mar-11 11:02", "status": "abandoned", "created": "2009-Oct-01 11:11", "fixed_version": "2009-Oct-01 11:11", "broken_version": "", "priority": "3", "subsystem": "Dag", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, psilord@cs.wisc.edu", "due_date": ""}