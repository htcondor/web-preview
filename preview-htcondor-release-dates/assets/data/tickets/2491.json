{"id": 2491, "title": "Ticket #2491: schedd crash after failed $$ expansion", "description": "<blockquote>\nThere is a problem when $$ substitution fails.  This causes the job to go on hold.  In 7.7.1, this causes an immediate search for a new job to run on the claim associated with the held job (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1314\" onclick=\"get_ticket_and_populate_wrapper('1314'); return false;\" title=\"matches in M_STARTD_CONTACT_LIMBO are not removed as soon as desired\">#1314</a></span>).  If no job is found, the claim is relinquished.  When we eventually pop up the stack to the caller of <code>GetJobAd()</code>, this dereferences the deleted match rec, which causes the schedd to crash.\n\n<p>All callers of <code>GetJobAd()</code> with the \"expand $$ macros\" option set to true must therefore be prepared for the match rec to be deleted.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-22 12:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5f4efe9d68846d8f6cdc3760a929bbcee8374684\">[27339]</a></span>: Documented fix for schedd crash after failed $$ expansion. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2491\" onclick=\"get_ticket_and_populate_wrapper('2491'); return false;\" title=\"schedd crash after failed $$ expansion\">#2491</a></span> ===VersionHistory:Complete===  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-22 12:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9519047ef29ff665c15f698b4e7935cee6ec415b\">[27338]</a></span>: Fixed schedd crash after failed $$ expansion. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2491\" onclick=\"get_ticket_and_populate_wrapper('2491'); return false;\" title=\"schedd crash after failed $$ expansion\">#2491</a></span>  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Sep-22 12:10", "status": "resolved", "created": "2011-Sep-22 11:40", "fixed_version": "2011-Sep-22 11:40", "broken_version": "v070701", "priority": "4", "subsystem": "", "assigned_to": "danb", "derived_from": "#1314", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}