{"id": 2829, "title": "Ticket #2829: ssh_to_job client can leave behind a process", "description": "<blockquote>\nI noticed some 'condor_ssh_to_job -proxy' processes chewing up CPU for several days after I had aborted several condor_ssh_to_job sessions.  This was an unusual case, because there was a noisy job wrapper on the execute node that messed up the output stream from sshd.\n\n<p></p><div class=\"verbatim\">\n<pre>[dan@login01:~]$ gstack 17223\n#0  0x00002b100905f8c0 in __write_nocancel () from /lib64/libpthread.so.0\n#1  0x000000000056fb50 in SocketProxy::execute() ()\n#2  0x00000000004a6218 in SSHToJob::execute_proxy() ()\n#3  0x00000000004a77c2 in SSHToJob::execute() ()\n#4  0x00000000004a784c in main ()\n[dan@login01:~]$ lsof -p 17223\nCOMMAND     PID USER   FD   TYPE DEVICE    SIZE      NODE NAME\ncondor_ss 17223  dan  cwd    DIR  253,6    4096  64160867 /scratch/dan/condor-7.6.5-395387-x86_64_rhap_5-stripped/local.login01\ncondor_ss 17223  dan  rtd    DIR  253,0    1024         2 /\ncondor_ss 17223  dan  txt    REG  253,6 4516920  64160448 /scratch/dan/condor-7.6.5-395387-x86_64_rhap_5-stripped/bin/condor_ssh_to_job\ncondor_ss 17223  dan  mem    REG  253,0            114699 /lib64/ld-2.5.so (path inode=53350)\ncondor_ss 17223  dan  mem    REG  253,2  217016    491523 /var/db/nscd/passwd\ncondor_ss 17223  dan  mem    REG  253,0             53264 /lib64/libdl-2.5.so (path inode=53262)\ncondor_ss 17223  dan  mem    REG  253,0             53284 /lib64/libresolv-2.5.so (path inode=53379)\ncondor_ss 17223  dan  mem    REG  253,0             53261 /lib64/libcrypt-2.5.so (path inode=53260)\ncondor_ss 17223  dan  mem    REG  253,4  973680    917762 /usr/lib64/libstdc++.so.6.0.8\ncondor_ss 17223  dan  mem    REG  253,0             53266 /lib64/libm-2.5.so (path inode=53360)\ncondor_ss 17223  dan  mem    REG  253,0   56072    114697 /lib64/libgcc_s-4.1.2-20080825.so.1\ncondor_ss 17223  dan  mem    REG  253,0             53282 /lib64/libpthread-2.5.so (path inode=53281)\ncondor_ss 17223  dan  mem    REG  253,0             53256 /lib64/libc-2.5.so (path inode=53255)\ncondor_ss 17223  dan    1w  FIFO    0,6         182815507 pipe\ncondor_ss 17223  dan    2u   CHR  136,5                 7 /dev/pts/5 (deleted)\ncondor_ss 17223  dan    3u  sock    0,5         182815434 can't identify protocol\n[dan@login01:~]$ strace -p 17223\nProcess 17223 attached - interrupt to quit\n--- SIGPIPE (Broken pipe) @ 0 (0) ---\nselect(2, [], [1], [], NULL)            = 1 (out [1])\nwrite(1, \"CernVM-FS: using public key /scr\"..., 69) = -1 EPIPE (Broken pipe)\n(repeats over and over)\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Jul-16 12:03:42 by bbockelm:</em> <br/>\n\nClosing ticket as it is not obvious it is reproducible.  Please open a new one if it happens on a supported release.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2014-Jul-16 12:03", "status": "abandoned", "created": "2012-Feb-15 16:08", "fixed_version": "2012-Feb-15 16:08", "broken_version": "v070600", "priority": "4", "subsystem": "", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}