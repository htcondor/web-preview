{"id": 2412, "title": "Ticket #2412: UW-built rpms don't contain any symlinks", "description": "<blockquote>\nThe CPack script Condor uses to create RPMs omits symlinks when creating the list of files to include in the RPM. We're using a modified version of CPackRPM.cmake taken from cmake 2.8.0. In cmake 2.8.3, the dropping of symlinks is fixed.\n\n<p>In Condor 7.7.1, the only symlinks are libclassad.so and libclassad.so.2. With tickets <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2389\" onclick=\"get_ticket_and_populate_wrapper('2389'); return false;\" title=\"Dynamically link Globus and VOMS libraries in UW builds\">#2389</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1135\" onclick=\"get_ticket_and_populate_wrapper('1135'); return false;\" title='\"Real\" dynamic binary releases'>#1135</a></span>, we'll have many more shared library files that will be affected, which will prevent Condor from running.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Aug-24 08:55:31 by tstclair:</em> <br/>\n\nI believe Thawan added something to that file which is why he carried it.  He's the original maintainer.\n\n<p></p><hr/>\n<em>2011-Aug-24 10:20:44 by jfrey:</em> <br/>\n\nThe change adds a CPACK_RPM_SPEC_IGNORE_FILES macro that can be used to exclude files from the RPM. We then use it to exclude <code>/etc/condor/condor_config</code>, <code>/etc/condor/condor_config.local</code>, and <code>/etc/init.d/condor</code>. But it doesn't appear to work properly, as those files still end up in the spec file and the RPM.\n\n<p>I'm going to try removing the modified CPackRPM.cmake.\n\n</p><p></p><hr/>\n<em>2011-Aug-24 14:09:52 by jfrey:</em> <br/>\n\nRemoving the modified CPackRPM.cmake doesn't change the contents of the RPM.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-24 11:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f020423cf35cedbb566d30c4263f541211f09e7c\">[26954]</a></span>: Remove our modified version of CPackRPM.cmake. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2412\" onclick=\"get_ticket_and_populate_wrapper('2412'); return false;\" title=\"UW-built rpms don't contain any symlinks\">#2412</a></span> Our modification to CPackRPM.cmake doesn't appear to do anything. The files we try to exclude from the RPM appear anyway. And it appears we want those files. So remove the modified CPackRPM.cmake and the use of CPACK_RPM_SPEC_IGNORE_FILES.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-23 16:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e6bc3b3e9278c5c64f8c045629f9e8a0a20b9afb\">[26953]</a></span>: Update our CPackRPM.cmake to not omit symlinks from RPMs. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2412\" onclick=\"get_ticket_and_populate_wrapper('2412'); return false;\" title=\"UW-built rpms don't contain any symlinks\">#2412</a></span> We're using a modified version of CPackRPM.cmake taken from cmake 2.8.0. That version omits all symlinks from the RPMs it creates. Cmake 2.8.3 fixes this. Now, our modified CPackRPM.cmake is based on cmake 2.8.3.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Aug-24 14:10", "status": "resolved", "created": "2011-Aug-23 16:25", "fixed_version": "2011-Aug-23 16:25", "broken_version": "v070600", "priority": "2", "subsystem": "Packaging", "assigned_to": "jfrey", "derived_from": "#2389", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}