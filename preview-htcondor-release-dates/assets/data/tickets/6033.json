{"id": 6033, "title": "Ticket #6033: dagman not appending accounting_group info to submitted jobs", "description": "<blockquote>\nI understand that in 8.5.6+, if you run \"condor_submit_dag -append accounting_group=x -append accounting_group_user=y file.dag\" then jobs will be submitted with these values appended. I am not seeing that and I'm seeing the warning I'd expect for jobs that don't have accounting group information.\n\n<p>Note that I'm using a wrapper defined by DAGMAN_CONDOR_SUBMIT_EXE which I'll retire at the same time as I upgrade from 8.5.7 to 8.5.8.\n\n</p><p></p><div class=\"verbatim\">\n<pre>11/30/16 20:29:36 From submit: ERROR: the job contained an invalid accounting group or an\n11/30/16 20:29:36 From submit: invalid accounting_group_user and was rejected by the\n11/30/16 20:29:36 From submit: HTCondor job scheduler. Please fix this by visiting\n11/30/16 20:29:36 From submit:\n11/30/16 20:29:36 From submit: https://ldas-gridmon.ligo.caltech.edu/ldg_accounting/user\n11/30/16 20:29:36 From submit:\n11/30/16 20:29:36 From submit: or contacting uwm-help@cgca.uwm.edu and modifying your submit\n11/30/16 20:29:36 From submit: file appropriately.\n11/30/16 20:29:36 failed while reading from pipe.\n11/30/16 20:29:36 Read so far: ERROR: the job contained an invalid accounting group or aninvalid accounting_group_user and was rejected by theHTCondor job scheduler. Please fix this by visitinghttps://ldas-gridmon.ligo.caltech.edu/ldg_accounting/useror contacting uwm-help@cgca.uwm.edu and modifying your submitfile appropriately.\n11/30/16 20:29:36 ERROR: submit attempt failed\n11/30/16 20:29:36 submit command was: /usr/local/bin/condor_submit -a dag_node_name' '=' 'A -a +DAGManJobId' '=' '2046925 -a DAGManJobId' '=' '2046925 -batch-name sleep.dag+2046925 -a submit_event_notes' '=' 'DAG' 'Node:' 'A -a dagman_log' '=' '/localscratch/tpdownes/dag-logs/sleep.dag-2046925.nodes.log -a +DAGManNodesMask' '=' '\"0,1,2,4,5,7,9,10,11,12,13,16,17,24,27\" -a DAG_STATUS' '=' '0 -a FAILED_COUNT' '=' '0 -a +KeepClaimIdle' '=' '20 -a notification' '=' 'never -a +DAGParentNodeNames' '=' '\"\" sleep.sub\n</pre></div>\n\n\n<p>The DAG/jobs in question...\n\n</p><p></p><div class=\"verbatim\">\n<pre>[pcdev3:wrapper-testing] cat sleep.dag\nJOB A sleep.sub\nJOB B sleep.sub\nJOB C sleep.sub\nJOB D sleep.sub\nPARENT A CHILD B C\nPARENT B C CHILD D\n[pcdev3:wrapper-testing] cat sleep.sub\nExecutable = sleep.sh\nUniverse = vanilla\nError = sleep-$(ClusterId).err\nOutput = sleep-$(ClusterId).out\nLog = sleep-$(ClusterId).log\ngetEnv = True\ntransfer_executable     = true\nshould_transfer_files   = true\nnotification = Never\nnotify_user = thomas.downes@ligo.org\nQueue 1\n[pcdev3:wrapper-testing] cat sleep.sh\n#!/bin/bash\nsleep 600\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2016-Dec-02 12:42:16 by wenger:</em> <br/>\n\nOkay, here's what's going on (from Tom Downes):\n\n<p>Ah. I bet I know what is happening. Does condor_dagman look at its own classad for AcctGroup,AcctGroupUser and submit them along with jobs/subDAGs?\n\n</p><p>If so, I'm removing those classads on purpose! I know this seems all roundabout, its because we advertised to users that we'll do our usage accounting with accounting_group tags, but we decided not to actually switch to group-based scheduling. So I want the values to propagate down but to be transformed according to previous discussions on this list.\n\n</p><p></p><hr/>\n<em>2016-Dec-07 10:39:28 by wenger:</em> <br/>\n\nTom, I think maybe we discussed this before -- but would it help you guys to be able to specify arbitrary <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> attributes to condor_submit_dag that get passed to all parts of the workflow?\n\n<p></p><hr/>\n<em>2016-Dec-07 13:41:24 by wenger:</em> <br/>\n\nOkay, as per today's LIGO phone conference, I'm going to resolve this ticket, and if we eventually want to have the ability to pass arbitrary attributes through condor_submit_dag to node jobs, that should become a new ticket.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/972/sleep.dag.dagman.out.xz\">sleep.dag.dagman.out.xz</a>\n5544 bytes added by tpdownes on 2016-Dec-01 21:42:11 UTC.\n</li></ul>\n</blockquote></body></html>", "check_ins": "", "type": "defect", "last_change": "2016-Dec-07 14:46", "status": "defer", "created": "2016-Dec-01 11:37", "fixed_version": "2016-Dec-01 11:37", "broken_version": "v080507", "priority": "5", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "", "creator": "tpdownes", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "wenger@cs.wisc.edu, downes@uwm.edu,pcouvare@caltech.edu", "due_date": ""}