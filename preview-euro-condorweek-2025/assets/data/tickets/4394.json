{"id": 4394, "title": "Ticket #4394: Scheduler universe doesn't work right in tests on Windows", "description": "<blockquote>\nOn Windows, scheduler universe jobs within the test suite get an error like this:\n\n<p></p><pre>  012 (002.000.000) 05/29 14:57:41 Job was held.\n          File 'C:\\condor\\execute\\dir_27232\\userdir\\condor_tests\\./x_sleep.pl'\n          is missing or not executable\n          Code 6 Subcode 13\n</pre>\n\n<p>When you get the results tarball back, all of the .pl files in condor_tests have permissions 644, so whatever the equivalent of that is on the Windows side of things apparently prevents the jobs from running correctly.  If the job is vanilla universe, it runs okay, because in vanilla universe Condor actually chmods the executable to make sure it has execute permissions.\n\n</p><p>I guess the question is whether this is something that should be fixed in the tests (fixing the permissions of the .pl files) or fixed in scheduler universe somehow...</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Oct-23 15:14:24 by wenger:</em> <br/>\n\nActually (according to TJ) the file permissions are not the problem -- it's that Windows just doesn't think a file is executable unless it has some recognized extension like .exe, .bat, or .cmd.  We could just change the .pl files to .bat, but the the \"#! /usr/bin/env perl\" won't work in Windows.  There's some magic code that's supposed to run on either Windows or *nix, but I haven't gotten that in place yet.\n\n<p>Also, just using \"perl\" for your executable doesn't work.\n\n</p><p>Note:  I'm not sure whether local universe would work around this problem or not.  Vanilla universe <strong>does</strong> work.\n\n</p><p></p><hr/>\n<em>2014-Dec-01 15:29:05 by wenger:</em> <br/>\n\nI just tried the job_dagman_rm test (on Linux) with all node jobs changed to vanilla universe -- and that <strong>did</strong> work!  (I was thinking that maybe tests where a node job condor_rm's condor_dagman might not work if the node job isn't scheduler universe.)\n\n<p>So it looks like the easiest way to fix the DAGMan tests, at least, is to just make all of the node jobs vanilla universe (or maybe local universe, if that also fixes the \"Windows doesn't think scripts are executable\" problem).</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-May-06 11:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b077a09fe63caf1bc729d1a2670d745e1b4c13b1\">[44795]</a></span>: Squashed commit of the following: commit 138b863503f2a5bda1777cf5f6a352c48d7db3a2 Author: Todd L Miller &lt;tlmiller@cs.wisc.edu&gt; Date: Tue May 5 15:03:24 2015 -0500\u00a0[...]\n (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-30 15:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8e5f5e7279c8b8340fb9f5621fac1268f69e5049\">[44769]</a></span>: (<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=4394\" onclick=\"get_ticket_and_populate_wrapper('4394'); return false;\" title=\"Scheduler universe doesn't work right in tests on Windows\">#4394</a></span>) Advertise v1 strings. Update v1 strings to permit round-trip conversion from original to v1 and back again. Add some support for automated testing of v1 strings.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-29 14:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/792d98c486f968f1a2d189cf3e4e73f0287c2e47\">[44752]</a></span>: (<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=4394\" onclick=\"get_ticket_and_populate_wrapper('4394'); return false;\" title=\"Scheduler universe doesn't work right in tests on Windows\">#4394</a></span>) Fix to milestone 1: clients using UDP must also choose their addresses wisely.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Dec-01 15:29", "status": "new", "created": "2014-Jun-03 09:39", "fixed_version": "2014-Jun-03 09:39", "broken_version": "v080106", "priority": "3", "subsystem": "Tests", "assigned_to": "", "derived_from": "#4361", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, bt@cs.wisc.edu", "due_date": ""}