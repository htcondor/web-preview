<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>CONDOR-2012-0003</title>
        <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
        <meta name="description" content="HTCondor Homepage">
        <script src="/web-preview/preview-test/assets/js/sitewide.js" type="text/javascript"></script>
        <link href="/web-preview/preview-test/assets/css/style.css" media="screen, tv, projection" title="Default" rel="stylesheet">
        
        
            <meta name="robots" content="noindex">
        
    </head>
<body>

    <!-- For non-visual user agents: -->
    <div id="top"><a href="#main-copy" class="doNotDisplay doNotPrint">Skip to main content.</a></div>

    <div id="container">

    <!-- ##### Header ##### -->

    <div id="header">
    <div class="midHeader">
        <div class="iconHeader">
            <a href="/web-preview/preview-test/index.html"><img height="75" alt="Condor High Throughput Computing" src="/web-preview/preview-test/assets/images/CondorTitle.gif" style="border:0"></a>
        </div>

        <div class="navAndSearch">
            <div class="navBar">
                <span class="doNotDisplay">Navigation:</span>
                <a href="/web-preview/preview-test/index.html">Home</a> |
                <a href="/web-preview/preview-test/new.html">News</a> |
                <a href="/web-preview/preview-test/downloads.html">Download</a> |
                <a href="/web-preview/preview-test/publications.html">Publications</a> |
                <a href="mailto:htcondor-admin@cs.wisc.edu">Contact Us</a>
            </div>

            <div class="searchForm" >
                <script>
                (function() {
                    var cx = '010754594835990937497:xijuwhbknew';
                    var gcse = document.createElement('script');
                    gcse.type = 'text/javascript';
                    gcse.async = true;
                    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                        '//www.google.com/cse/cse.js?cx=' + cx;
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(gcse, s);
                })();
                </script>
                <gcse:searchbox-only></gcse:searchbox-only>
            </div>
        </div>
    </div>
</div>

    <div id="main-copy">
        <link href="/web-preview/preview-test/assets/css/vulnerabilities.css" rel="stylesheet">

<h1>
    CONDOR-2012-0003
</h1>
<hr>
<table width='100%' summary='whole page'>
<tr>
    <td width='25%'><p class='h'>Summary:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	Condor installations that support Standard Universe jobs and run the
	daemons on the submit machine as root are vulnerable to local privilege
	escalation.  If a user submits a job into the standard universe, the user
	job may then execute code on the submit machine as the root user.  If your
	Condor installation does not contain the condor_shadow.std executable, then
	you are not affected by this vulnerability.
  <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-5390">CVE-2012-5390</a>
    </p></td>
</tr>
<tr><td colspan='2'>
<br><table class='sumtable' width='100%' summary='short values'>
<tr>
<th width='20%'>Component</th>
<th width='20%'>Vulnerable Versions</th>
<th width='20%'>Platform</th>
<th width='20%'>Availability</th>
<th width='20%'>Fix Available</th>
</tr>
<tr>
<td class='sv'>Condor standard universe shadow</td>
<td class='sv'>7.7.3 to 7.7.6, 7.8.0 to 7.8.4, and 7.9.0</td>
<td class='sv'>Linux</td>
<td class='sv'>not known to be publicly available</td>
<td class='sv'>7.8.5</td>
</tr>
<tr>
<th width='20%'>Status</th>
<th width='20%'>Access Required</th>
<th width='20%'>Host Type Required</th>
<th width='20%'>Effort Required</th>
<th width='20%'>Impact/Consequences</th>
</tr>
<tr>
<td class='sv'>Verified</td>
<td class='sv'>ability to submit jobs to the condor_schedd</td>
<td class='sv'>n/a</td>
<td class='sv'>low</td>
<td class='sv'>high</td>
</tr>
<tr>
<th width='20%'>Fixed Date</th>
<th width='20%'>Credit</th>
</tr>
<tr>
<td class='sv'>2012-Oct-22</td>
<td class='sv'>Zach Miller<br>Condor team</td>
</tr>
</table>
</td></tr>
<tr>
    <td width='25%'><p class='h'>Access Required:</p></td>
	<td class='sv'><p class='v'>
	ability to submit jobs
	</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	Any person who can submit standard universe jobs to the condor_schedd can
	exploit this.  Submissions are authenticated and are typically done
	locally.  However, if Condor is configured to allow remote submits, jobs
	submitted remotely into the standard universe can also exploit this.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Effort Required:</p></td>
    <td class='sv'><p class='v'>low</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
    To exploit this, an attacker just needs to know the correct sequence of
	communications with the condor_shadow.std.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Impact/Consequences:</p></td>
    <td class='sv'><p class='v'>high</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
    If an attacker is successfully able to communicate correctly with the
	condor_shadow.std, they may instruct the shadow to run arbitrary code
	as the root user, including spawning additional processes.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Cause:</p></td>
    <td class='sv'><p class='v'>Missing privilege check</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	Condor should never spawn user processes as root, and makes explicit checks
	in most places to ensure this never happens.  In the standard universe
	shadow, an unrelated change opened a new code path where privilege checking
	did not exist.
	
      </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Proposed Fix:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	Remove the code, as it should never be used.
      </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Actual Fix:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  As proposed.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Workaround:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	If you do not need to run standard universe jobs, simply delete the
	condor_shadow.std from your installation.
    </p></td>
</tr>
</table>


    </div>

    <div id="footer">
    For comments or questions about this website, please
<a href="mailto:htcondor-admin@cs.wisc.edu">email htcondor-admin@cs.wisc.edu</a><br />
    This work is supported by <a href="https://www.nsf.gov/div/index.jsp?div=OAC">NSF</a> under Cooperative Agreement <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">OAC-2030508</a> as part of the <a href="https://path-cc.io/">PATh Project</a>. <br />
  <script type="text/javascript">
      document.write("Updated &raquo; "+lastMod(document.lastModified))
  </script>
</div>


    </div>
</body>
</html>
