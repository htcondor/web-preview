<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>CONDOR-2008-0001</title>
        <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
        <meta name="description" content="HTCondor Homepage">
        <script src="/web-preview/preview-test/assets/js/sitewide.js" type="text/javascript"></script>
        <link href="/web-preview/preview-test/assets/css/style.css" media="screen, tv, projection" title="Default" rel="stylesheet">
        
        
            <meta name="robots" content="noindex">
        
    </head>
<body>

    <!-- For non-visual user agents: -->
    <div id="top"><a href="#main-copy" class="doNotDisplay doNotPrint">Skip to main content.</a></div>

    <div id="container">

    <!-- ##### Header ##### -->

    <div id="header">
    <div class="midHeader">
        <div class="iconHeader">
            <a href="/web-preview/preview-test/index.html"><img height="75" alt="Condor High Throughput Computing" src="/web-preview/preview-test/assets/images/CondorTitle.gif" style="border:0"></a>
        </div>

        <div class="navAndSearch">
            <div class="navBar">
                <span class="doNotDisplay">Navigation:</span>
                <a href="/web-preview/preview-test/index.html">Home</a> |
                <a href="/web-preview/preview-test/new.html">News</a> |
                <a href="/web-preview/preview-test/downloads.html">Download</a> |
                <a href="/web-preview/preview-test/publications.html">Publications</a> |
                <a href="mailto:htcondor-admin@cs.wisc.edu">Contact Us</a>
            </div>

            <div class="searchForm" >
                <script>
                (function() {
                    var cx = '010754594835990937497:xijuwhbknew';
                    var gcse = document.createElement('script');
                    gcse.type = 'text/javascript';
                    gcse.async = true;
                    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                        '//www.google.com/cse/cse.js?cx=' + cx;
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(gcse, s);
                })();
                </script>
                <gcse:searchbox-only></gcse:searchbox-only>
            </div>
        </div>
    </div>
</div>

    <div id="main-copy">
        <link href="/web-preview/preview-test/assets/css/vulnerabilities.css" rel="stylesheet">

<h1>
    CONDOR-2008-0001
</h1>
<hr>
<table width='100%' summary='whole page'>
<tr>
    <td width='25%'><p class='h'>Summary:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  It is possible for a user that can submit jobs to a condor_schedd to modify
  arbitrary attributes of the job, including attributes an ordinary user should
  not be able to modify.  For instance, a user can change the owner of their
  job to run as any non-root user.
    </p></td>
</tr>
<tr><td colspan='2'>
<br><table class='sumtable' width='100%' summary='short values'>
<tr>
<th width='20%'>Component</th>
<th width='20%'>Vulnerable Versions</th>
<th width='20%'>Platform</th>
<th width='20%'>Availability</th>
<th width='20%'>Fix Available</th>
</tr>
<tr>
<td class='sv'>condor_schedd</td>
<td class='sv'>6.8.0 - 6.8.8<br>7.0.0 - 7.0.4<br>7.1.0 - 7.1.2</td>
<td class='sv'>all</td>
<td class='sv'>not known to be publicly exploited</td>
<td class='sv'>6.8.9<br>7.0.5<br>7.1.3</td>
</tr>
<tr>
<th width='20%'>Status</th>
<th width='20%'>Access Required</th>
<th width='20%'>Host Type Required</th>
<th width='20%'>Effort Required</th>
<th width='20%'>Impact/Consequences</th>
</tr>
<tr>
<td class='sv'>Verified</td>
<td class='sv'>local ordinary user with a condor authorization</td>
<td class='sv'>submission host</td>
<td class='sv'>low</td>
<td class='sv'>high</td>
</tr>
<tr>
<th width='20%'>Fixed Date</th>
<th width='20%'>Credit</th>
</tr>
<tr>
<td class='sv'>2008-Oct-07</td>
<td class='sv'>Greg Thain</td>
</tr>
</table>
</td></tr>
<tr>
    <td width='25%'><p class='h'>Access Required:</p></td>
    <td class='sv'><p class='v'>local ordinary user with a condor authorization</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  This vulnerability requires local access on a machine where the user has
  write authorization to the condor_schedd (i.e., a host and account where the
  user can submit a job).
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Effort Required:</p></td>
    <td class='sv'><p class='v'>low</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  The use of ordinary condor command line tools is all that is required to
  exploit this vulnerability.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Impact/Consequences:</p></td>
    <td class='sv'><p class='v'>high</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  The attacker can run arbitrary code as a non-root user on the execute host
  or submission host depending on the job type.  This can allow attacks on
  other users accounts or system resources.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Full Details:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  There is a list of sensitive job attributes that an ordinary user is not
  allowed to modify to ensure the security of the system.  These include the
  "owner" attribute.  When a job is submitted, its attributes are checked and 
  a sensitive attribute is not allowed to be set.
<p>  The user can also use <code>condor_qedit</code> to change attributes of a
  job.  When this tool is used, the attribute and value are passed to
  condor_schedd as separate values and the attribute name from the user is
  checked to verify that it is not a sensitive attribute by comparing the user
  supplied name against a list.  Unfortunately an attacker can surround the
  the attribute name with whitespace and the attribute will not test as being
  a sensitive attribute.  Later code then removes whitespace from the attribute
  name and inserts it into the job ad.  The following will change the owner
  of job 1.0 to the "condor" user:
<p>  <pre><code>
        condor_qedit 1.0 ' owner' '"condor"'
  </pre></code>
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Cause:</p></td>
    <td class='sv'><p class='v'>injection<br>failure to validate input</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  The attribute name supplied from <code>condor_qedit</code> to the
  condor_schedd was not validated to prevent illegal characters in the name,
  nor was the name transformed into a canonical form so the attribute name used
  in the test is the same name that is changed in the job ad.
    </p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Actual Fix:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
  Whitespace and other illegal characters in the attribute name are now
  rejected in the check of attribute names supplied by
  <code>condor_qedit</code> and in the lower level code that inserts or
  replaces an attribute in the job ad.
    </p></td>
</tr>
</table>


    </div>

    <div id="footer">
    For comments or questions about this website, please
<a href="mailto:htcondor-admin@cs.wisc.edu">email htcondor-admin@cs.wisc.edu</a><br />
    This work is supported by <a href="https://www.nsf.gov/div/index.jsp?div=OAC">NSF</a> under Cooperative Agreement <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">OAC-2030508</a> as part of the <a href="https://path-cc.io/">PATh Project</a>. <br />
  <script type="text/javascript">
      document.write("Updated &raquo; "+lastMod(document.lastModified))
  </script>
</div>


    </div>
</body>
</html>
