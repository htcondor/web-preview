#######################################################################
#
#  Makefile for MW sources
#
#######################################################################

# Turn off default suffixes
.SUFFIXES:
.SUFFIXES: .C .o

SHELL = /bin/sh

INCLUDES = -I./ -I../ -I./RMComm 

prefix = @prefix@
exec_prefix = @exec_prefix@
includedir = @include_dir@
libdir = @libdir@
bindir = @bindir@
srcdir = @srcdir@
top_srcdir = @top_srcdir@

CXX = @CXX@
CPPFLAGS = @CPPFLAGS@ $(INCLUDES)
CXXFLAGS = @CXXFLAGS@
LDFLAGS = @LDFLAGS@
DEFS = @DEFS@
LIBS = @LIBS@
INSTALL = @INSTALL@
DOCXX = @DOCXX@

srcdir = @srcdir@
VPATH = @srcdir@
top_srcdir = @top_srcdir@



# Define some macros
MWMASTERSRC = ${srcdir}/MWDriver.C \
	${srcdir}/MWTask.C \
	${srcdir}/MWWorkerID.C \
	${srcdir}/MWStats.C \
	${srcdir}/MWprintf.C

MWMASTEROBJ = $(MWMASTERSRC:.C=.o)

MWWORKERSRC = ${srcdir}/MWWorker.C \
	${srcdir}/MWTask.C \
	${srcdir}/MWprintf.C \
	${srcdir}/MWWorkerID.C

MWWORKEROBJ = $(MWWORKERSRC:.C=.o)

MWHEADERS = ${srcdir}/MW.h \
	${srcdir}/MWDriver.h \
	${srcdir}/MWStats.h \
	${srcdir}/MWTask.h \
	${srcdir}/MWWorker.h \
	${srcdir}/MWWorkerID.h \
	${srcdir}/MWprintf.h

#
#

# Now the targets
all : mw mwfile mwcondorpvm


mw : $(MWMASTEROBJ) $(MWWORKEROBJ)
	ar cr libMW.a $(MWMASTEROBJ) $(MWWORKEROBJ); ranlib libMW.a

mwfile: 
	cd ${srcdir}/RMComm/MW-File; make all; cd ${srcdir}

mwcondorpvm:
	cd ${srcdir}/RMComm/MW-CondorPVM; make all; cd ${srcdir}

clean:
	rm -f $(MWMASTEROBJ) $(MWWORKEROBJ)
	cd ${srcdir}/RMComm/MW-File; make clean; cd ${srcdir}
	cd ${srcdir}/RMComm/MW-CondorPVM; make clean; cd ${srcdir}

distclean: clean
	rm -f *~ Makefile	

# default rule
.C.o:
	${CXX} -c ${DEFS} ${CPPFLAGS} ${CXXFLAGS} $<

