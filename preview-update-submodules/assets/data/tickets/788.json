{"id": 788, "title": "Ticket #788: Valgrind report of collector", "description": "<blockquote>\nI valgrinded the ghost pool collector.  The full report is attached.  There were no use-after-free or other really bad problems, but a couple of memory leaks bear investigation.  In particular, this one:\n\n<p></p><div class=\"verbatim\">\n<pre>==1999== 2,108,380 bytes in 281,120 blocks are definitely lost in loss record 195 of 202\n==1999==    at 0x40057F5: operator new[](unsigned) (vg_replace_malloc.c:195)\n==1999==    by 0x818D7AB: strnewp(char const*) (strnewp.cpp:27)\n==1999==    by 0x81EBDA4: AttrList::CopyAttribute(char const*, char const*, AttrList*) (attrlist.cpp:2861)\n==1999==    by 0x81EBF28: AttrList::CopyAttribute(char const*, AttrList*) (attrlist.cpp:2844)\n==1999==    by 0x8149363: CollectorEngine::collect(int, ClassAd*, sockaddr_in*, int&amp;, Sock*) (collector_engine.cpp:641)\n==1999==    by 0x814A41D: CollectorEngine::collect(int, Sock*, sockaddr_in*, int&amp;) (collector_engine.cpp:456)\n==1999==    by 0x812E1C1: CollectorDaemon::receive_update(Service*, int, Stream*) (collector.cpp:695)\n==1999==    by 0x814BD45: DaemonCore::CallCommandHandler(int, Stream*, bool) (daemon_core.cpp:3535)\n==1999==    by 0x815F103: DaemonCore::HandleReq(Stream*, Stream*) (daemon_core.cpp:4877)\n==1999==    by 0x815F4EC: DaemonCore::HandleReq(int, Stream*) (daemon_core.cpp:3757)\n==1999==    by 0x815FABC: DaemonCore::CallSocketHandler_worker(int, bool, Stream*) (daemon_core.cpp:3453)\n==1999==    by 0x815FC7D: DaemonCore::CallSocketHandler_worker_demarshall(void*) (daemon_core.cpp:3407)\n==1999==    by 0x81D1C46: CondorThreads::pool_add(void (*)(void*), void*, int*, char const*) (condor_threads.cpp:1101)\n==1999==    by 0x815208C: DaemonCore::CallSocketHandler(int&amp;, bool) (daemon_core.cpp:3397)\n==1999==    by 0x8153A56: DaemonCore::Driver() (daemon_core.cpp:3311)\n==1999==    by 0x8169BDD: main (daemon_core_main.cpp:2245)\n==1999==\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2010-Aug-23 17:42:37 by adesmet:</em> <br/>\n\nBulk change of target version from v070403 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2012-Mar-14 12:10:57 by gthain:</em> <br/>\n\nThis seems to have gone away in 7.6</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2012-Mar-14 12:11", "status": "resolved", "created": "2009-Sep-29 08:57", "fixed_version": "2009-Sep-29 08:57", "broken_version": "v070400", "priority": "2", "subsystem": "", "assigned_to": "gthain", "derived_from": "#759", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}