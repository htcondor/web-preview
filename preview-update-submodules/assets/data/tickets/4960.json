{"id": 4960, "title": "Ticket #4960: Change DAGMan to accommodate submit file globbing", "description": "<blockquote>\nWe want to modify DAGMan to deal with the new condor_submit globbing feature that can be used to submit multiple-job clusters.  I see two aspects of this (at a high level):\n<ul>\n<li>Fix any ways in which this could break DAGMan functionality (e.g., if you use the globbing feature, will DAGMan get confused?).\n</li><li>Possibly modify DAGMan to take advantage of this feature to add new functionality.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2015-Mar-26 09:50:51 by wenger:</em> <br/>\n\nSee the following tickets for condor_submit-related changes: <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4913\" onclick=\"get_ticket_and_populate_wrapper('4913'); return false;\" title=\"submit files should support if/else and include like config files\">#4913</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4933\" onclick=\"get_ticket_and_populate_wrapper('4933'); return false;\" title=\"Condor_submit should allow -queue statement on command line\">#4933</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4944\" onclick=\"get_ticket_and_populate_wrapper('4944'); return false;\" title=\"New $macro expansion functions for submit\">#4944</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4819\" onclick=\"get_ticket_and_populate_wrapper('4819'); return false;\" title='\"queue\" for multiple files'>#4819</a></span>.\n\n<p>At minimum, I suspect that using the functionality in <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4819\" onclick=\"get_ticket_and_populate_wrapper('4819'); return false;\" title='\"queue\" for multiple files'>#4819</a></span> will break DAGMAN_PROHIBIT_MULTI_JOBS.\n\n</p><p>Also, DAGMan should report an error if a submit file doesn't have a queue statement in it.\n\n</p><p>At minimum, we should add some tests using DAGMan in combination with the new condor_submit features.\n\n</p><p></p><hr/>\n<em>2015-Mar-26 10:16:18 by wenger:</em> <br/>\n\nNote that we might be able to use the new condor_submit -dry-run flag to avoid parsing submit files to figure out whether they're queuing multiple jobs within a proc.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-29 16:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8eef105e341dcfdfdefcb4c5f7095880114ed05f\">[44757]</a></span>: Minor edit of 8.3.6 version history item. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4960\" onclick=\"get_ticket_and_populate_wrapper('4960'); return false;\" title=\"Change DAGMan to accommodate submit file globbing\">#4960</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-23 09:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0eefb88d1da7818a3002d6c6596bb6690a6efd51\">[44710]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4960\" onclick=\"get_ticket_and_populate_wrapper('4960'); return false;\" title=\"Change DAGMan to accommodate submit file globbing\">#4960</a></span>: Oops! Fixed job_dagman_subdag_multi_prohibit-C test to match DAGMan changes.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-22 16:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/26c5c6340c107ae6be19d9d6cdbee6d35045a9b8\">[44704]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4960\" onclick=\"get_ticket_and_populate_wrapper('4960'); return false;\" title=\"Change DAGMan to accommodate submit file globbing\">#4960</a></span>: Added version history item, since I did actually end up changing the DAGMan code a little.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-22 15:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ed783a046513aa19c1025a58442f0ac3e4be54f5\">[44702]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4960\" onclick=\"get_ticket_and_populate_wrapper('4960'); return false;\" title=\"Change DAGMan to accommodate submit file globbing\">#4960</a></span>: Added tests to make sure this works. We no longer try to parse the submit file to figure out how many procs it submits, because some of the new syntax options confuse things. We now always do a condor_rm of our node jobs when aborting, because if we abort because of DAGMAN_PROHIBIT_MULTI_JOBS\u00a0[...]\n (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Jun-04 14:41", "status": "resolved", "created": "2015-Mar-25 12:19", "fixed_version": "2015-Mar-25 12:19", "broken_version": "v080305", "priority": "3", "subsystem": "Dag", "assigned_to": "", "derived_from": "", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, zmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}