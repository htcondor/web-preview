{"id": 3015, "title": "Ticket #3015: GAHP should set GLOBUS_LOCATION for new blahp", "description": "<blockquote>\nThe newest blahp (1.18.x) will want to delegate proxies if present.  To do this, it will invoke grid-proxy-info with:\n\n<p>$GLOBUS_LOCATION/bin/grid-proxy-info\n\n</p><p>If $GLOBUS_LOCATION is not set, /opt/globus is used.\n\n</p><p>/opt/globus is almost never going to be the correct location anymore.  I propose we default to /usr, as in the following patch.\n\n</p><p></p><div class=\"verbatim\">\n<pre>\n--- a/src/condor_gridmanager/gahp-client.cpp\n+++ b/src/condor_gridmanager/gahp-client.cpp\n@@ -703,6 +703,16 @@ GahpServer::Startup()\n                free( tmp_char );\n        }\n\n+       // GLOBUS_LOCATION needs to be set for the blahp; otherwise, it defaults to /opt/globus,\n+       // which is likely never correct anymore\n+       tmp_char = param(\"GLOBUS_LOCATION\");\n+       if ( tmp_char ) {\n+               newenv.SetEnv( \"GLOBUS_LOCATION\", tmp_char );\n+               free( tmp_char );\n+       } else if (getenv(\"GLOBUS_LOCATION\") == NULL) {\n+               newenv.SetEnv( \"GLOBUS_LOCATION\", \"/usr\" );\n+       }\n+\n        // For amazon ec2 ca authentication\n        tmp_char = param(\"SOAP_SSL_CA_FILE\");\n        if( tmp_char ) {\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3431\" onclick=\"get_ticket_and_populate_wrapper('3431'); return false;\" title=\"Remove blahp's dependence on external Globus tools\">#3431</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nRemove blahp's dependence on external Globus tools</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-11 12:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4079a295be80f8f7c938ccf47dd242d3d9f9a732\">[34618]</a></span>: minor edit of 7.9.3 version history item ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3015\" onclick=\"get_ticket_and_populate_wrapper('3015'); return false;\" title=\"GAHP should set GLOBUS_LOCATION for new blahp\">#3015</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-10 14:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/162c92c3fe1ea3b1e6aaa0f921d87afba2193154\">[34600]</a></span>: Docs for GLOBUS_LOCATION blahp fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3015\" onclick=\"get_ticket_and_populate_wrapper('3015'); return false;\" title=\"GAHP should set GLOBUS_LOCATION for new blahp\">#3015</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-29 11:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/635875f4c9aa343e9f014a95fd5f57a8fd354837\">[34223]</a></span>: Always set GLOBUS_LOCATION for the blahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3015\" onclick=\"get_ticket_and_populate_wrapper('3015'); return false;\" title=\"GAHP should set GLOBUS_LOCATION for new blahp\">#3015</a></span> If GLOBUS_LOCATION isn't set in the blahp's environment, then it tries to invoke proxy-handling tools under /opt/globus, which is almost never going to be the correct location anymore. /usr is a better default.\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Jan-10 14:42", "status": "resolved", "created": "2012-May-29 19:00", "fixed_version": "2012-May-29 19:00", "broken_version": "v070800", "priority": "4", "subsystem": "Daemons", "assigned_to": "jfrey", "derived_from": "#1376", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "", "due_date": ""}