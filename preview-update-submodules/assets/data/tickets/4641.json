{"id": 4641, "title": "Ticket #4641: feature request: MAX_JOBS_PER_OWNER", "description": "<blockquote>\nIn the Syracuse campus pool, we've had repeated instances of users bringing down a schedd by accidentally submitting too many jobs (in this case &gt;100k).\n\n<p>Can Condor limit the number of jobs a user is allowed to submit to a given schedd (i.e., add a MAX_JOBS_SUBMITTED_PER_USER knob), to prevent a runaway user from bringing it down?\n\n</p><p>I know DAGMan can be used to throttle submissions, but this is an anti-DoS schedd robustness feature request, not a question of what smart users <strong>should</strong> be doing.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Jun-04 14:26:06 by parag:</em> <br/>\n\nIs the real problem large number of jobs owned by the user in a given schedd or is it a submission with queue xxxx where xxxx is O(K+)\nIn our experience from FIFE, its the later that would cause problem with the schedd at times.\n\n<p></p><hr/>\n<em>2015-Jun-04 14:28:49 by parag:</em> <br/>\n\nI dont mean to imply that MAX_JOBS_PER_OWNER is not useful. It is surely helpful and required as well\n\n<p></p><hr/>\n<em>2015-Jun-04 14:45:20 by tlmiller:</em> <br/>\n\nNo, that's a good point.  Would you use MAX_JOBS_PER_SUBMISSION if we added it?  Are you unable to use MAX_JOBS_PER_OWNER to get the same effect?  I can see why conceptually the size of the queue and protecting the schedd against typos are different, but the difference would in practice only arise if the size of the largest safe submission is smaller than the largest safe size of the queue.  If that seems to be true for you, please let us know, and we can add this circuit breaker.  (And maybe a ticket for handling large submissions better?)\n\n<p></p><hr/>\n<em>2015-Jun-04 15:05:26 by parag:</em> <br/>\n\nYes I think something like MAX_JOBS_PER_SUBMISSION will also be useful.\n\n<p></p><hr/>\n<em>2015-Jun-08 14:18:12 by johnkn:</em> <br/>\n\nCODE_REVIEW: looks good. -tj</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5081\" onclick=\"get_ticket_and_populate_wrapper('5081'); return false;\" title=\"MAX_JOBS_PER_SUBMISSION\">#5081</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nMAX_JOBS_PER_SUBMISSION</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5946\" onclick=\"get_ticket_and_populate_wrapper('5946'); return false;\" title=\"MAX_JOBS_PER_OWNER broken if job specifies an accounting_group\">#5946</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nMAX_JOBS_PER_OWNER broken if job specifies an accounting_group</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-09 13:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a5afe92f9ea959b3b43cb2967706e53ef2ad4d22\">[45009]</a></span>: edit version history and defn of new knob MAX_JOBS_PER_OWNER <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4641\" onclick=\"get_ticket_and_populate_wrapper('4641'); return false;\" title=\"feature request: MAX_JOBS_PER_OWNER\">#4641</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-08 17:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ec57672fcf44dcd9df83a78c02c3c87b3ee5b884\">[45002]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4641\" onclick=\"get_ticket_and_populate_wrapper('4641'); return false;\" title=\"feature request: MAX_JOBS_PER_OWNER\">#4641</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5081\" onclick=\"get_ticket_and_populate_wrapper('5081'); return false;\" title=\"MAX_JOBS_PER_SUBMISSION\">#5081</a></span>) Add to the configuration section of the manual, correct typos in previous commit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-08 16:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9d8fe326f6ea1b7589d85c71a4af5f07965b7b09\">[45000]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4641\" onclick=\"get_ticket_and_populate_wrapper('4641'); return false;\" title=\"feature request: MAX_JOBS_PER_OWNER\">#4641</a></span>) Add version history item.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-04 13:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/beaf6ec08edb6ad2baff8e01e9125a0d1fb48513\">[44967]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4641\" onclick=\"get_ticket_and_populate_wrapper('4641'); return false;\" title=\"feature request: MAX_JOBS_PER_OWNER\">#4641</a></span>) Implement MAX_JOBS_PER_OWNER. Note that the count of jobs per owner is not updated live, but only when we count jobs. Legal submits may therefore be temporarily refused.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Jun-08 17:47", "status": "resolved", "created": "2014-Oct-09 13:09", "fixed_version": "2014-Oct-09 13:09", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "tlmiller", "derived_from": "", "creator": "pfc", "rust": "a27391", "customer_group": "osg", "visibility": "public", "notify": "pfcouvar@syr.edu, tannenba@cs.wisc.edu, parag@fnal.gov", "due_date": ""}