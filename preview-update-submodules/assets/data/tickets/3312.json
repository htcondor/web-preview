{"id": 3312, "title": "Ticket #3312: Accumulated idle time (aka wait time, ?time to start?) attribute", "description": "<blockquote>\nThe ability to tell how long a job is queued and runnable before running is a highly desired feature, as is its aggregate across jobs.\n\n<p>An aggregate is provided via scheduler statistics on the condor_schedd's ad. It is based on QDate - <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStartDate\" title=\"Job Start Date\">JobStartDate</a></span>. <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStartDate\" title=\"Job Start Date\">JobStartDate</a></span> is the first time a job started. For comparison, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobCurrentStartDate\" title=\"Job Current Start Date\">JobCurrentStartDate</a></span> is the most recent time a job started.\n\n</p><p>No such attribute exists for a job, presumably because QDate - <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStartDate\" title=\"Job Start Date\">JobStartDate</a></span> is available.\n\n</p><p>However, QDate - <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStartDate\" title=\"Job Start Date\">JobStartDate</a></span> only provides the wait time from submission until the first time the job starts, it does not factor in time the job spent when it was not runnable, e.g. on hold, and it does not factor in multiple starts of a job.\n\n</p><p>For example, job transitions over time -\n\n</p><p> I(5)-&gt;R-&gt;I(5)-&gt;R-&gt;C, has waited idle for 10 seconds\n\n</p><p> I(5)-&gt;R-&gt;X, has waited idle for 5 seconds\n\n</p><p> I(5)-&gt;H(10)-&gt;I(3)-&gt;R, has waited idle for 8 seconds\n\n</p><p>The current statistics for these jobs will report wait time of 5 seconds for the first two jobs and 20 seconds for the last.\n\n</p><p>An attribute capturing the amount of time spent idle should be added to jobs and aggregated across jobs in a schedd.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Nov-09 09:04:17 by johnkn:</em> <br/>\n\nthe schedd stats are aggregated each time Scheduler::jobExitCode is called, this is basically when a shadow exits, so I believe that accumulated wait time is captured because a shadow exit occurs whenever we leave the R state. (shadows pretend to exit on shadow re-use)\n\n<p>For instance, if you have an  I(5)-&gt;R-&gt;I(4)-&gt;R-&gt;C set of job transitions,\nthe (5) is captured on the first R-&gt;I transition, and the (4) is captured\non the R-&gt;C transition.\n\n</p><p>The accumulated idle is not stored in the job in any case.\n\n</p><p></p><hr/>\n<em>2012-Nov-13 08:33:13 by matt:</em> <br/>\n\n<a class=\"external\" href=\"https://github.com/htcondor/htcondor/blob/master/src/condor_schedd.V6/schedd.cpp#L8030\">https://github.com/htcondor/htcondor/blob/master/src/condor_schedd.V6/schedd.cpp#L8030</a>\n\n<p>It looks like the JobsAccumTimeToStart++ is predicated on first run.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2012-Nov-13 08:33", "status": "new", "created": "2012-Nov-09 07:35", "fixed_version": "2012-Nov-09 07:35", "broken_version": "", "priority": "4", "subsystem": "Daemons", "assigned_to": "", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}