{"id": 992, "title": "Ticket #992: problems with GSI in 7.4.0", "description": "<blockquote>\nit seems the server does not trust a client when the client is using a proxy.  it seems to work correctly when the client has a cert/key combo.</blockquote>", "remarks": "<blockquote>\n<em>2009-Nov-20 15:05:31 by zmiller:</em> <br/>\n\ni started up a personal condor with GSI authentication enabled and was able to authenticate using a proxy.  so things aren't completely broken.  now i need to understand what is different between my setup and fermi's, and also what changed between condor 7.2.4 (globus 4.2.0) and condor 7.4.0 (globus 4.2.1) that could cause this.\n\n<p></p><hr/>\n<em>2009-Nov-20 16:10:08 by zmiller:</em> <br/>\n\nnew information:  condor GSI authentication works fine if you are using a \"legacy\" proxy.  these are created by default with older versions grid-proxy-init (e.g. 0.9), and by using the \"-old\" flag to newer versions of grid-proxy-init (e.g. 0.18).  the proxy that fermilab is using is type \"Proxy draft (pre-RFC) compliant impersonation proxy\" which does indeed not work when using GSI authentication in 7.4.0.\n\n<p>i offered them the workaround of using \"-old\" while i investigate the problem further.\n\n</p><p></p><hr/>\n<em>2009-Nov-25 11:02:14 by danb:</em> <br/>\n\nvoms-proxy-init produces a legacy proxy by default, which probably explains why Igor's GSI-authenticated glidein test did not catch this.\n\n<p></p><hr/>\n<em>2009-Nov-25 15:21:52 by danb:</em> <br/>\n\nThe problem appears to be caused by <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f2f9cae44d7d687d6b9f3440c1589a3f0d066dea\">[15796]</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=786\" onclick=\"get_ticket_and_populate_wrapper('786'); return false;\" title=\"VOMS static initializer allocates memory even when VOMS not used\">#786</a></span> (Remove VOMS static initializer).\n\n<p></p><hr/>\n<em>2009-Nov-25 16:05:25 by zmiller:</em> <br/>\n\nsetting USE_VOMS_ATTRIBUTES = FALSE in the condor_config works around the problem and GSI authentication works using any style of proxy (legacy, pre-RFC, RFC).  i've given this same advice to fermi as a temporary workaround while we fix the problem.\n\n<p></p><hr/>\n<em>2009-Dec-03 08:55:47 by zmiller:</em> <br/>\n\nfermi is content to wait until 7.4.1 to get the fix to this problem.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1019\" onclick=\"get_ticket_and_populate_wrapper('1019'); return false;\" title=\"ssl and voms interaction breaks some uses of GSI authentication\">#1019</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nssl and voms interaction breaks some uses of GSI authentication</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-03 14:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a7740a14ba8923db1d25e46b1ec13c5be3ac3523\">[16480]</a></span>: Change VOMS external to version 1.8.8_2. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1019\" onclick=\"get_ticket_and_populate_wrapper('1019'); return false;\" title=\"ssl and voms interaction breaks some uses of GSI authentication\">#1019</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=992\" onclick=\"get_ticket_and_populate_wrapper('992'); return false;\" title=\"problems with GSI in 7.4.0\">#992</a></span> This is the version used by the VDT. This version doesn't have the memory bloat that <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=786\" onclick=\"get_ticket_and_populate_wrapper('786'); return false;\" title=\"VOMS static initializer allocates memory even when VOMS not used\">#786</a></span> attempted to fix. It also doesn't have the GSI authentication problem introduced by <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=786\" onclick=\"get_ticket_and_populate_wrapper('786'); return false;\" title=\"VOMS static initializer allocates memory even when VOMS not used\">#786</a></span>, which is detailed in <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=992\" onclick=\"get_ticket_and_populate_wrapper('992'); return false;\" title=\"problems with GSI in 7.4.0\">#992</a></span>.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "incident", "last_change": "2009-Dec-11 10:58", "status": "resolved", "created": "2009-Nov-20 13:47", "fixed_version": "2009-Nov-20 13:47", "broken_version": "v070400", "priority": "1", "subsystem": "Security", "assigned_to": "zmiller", "derived_from": "", "creator": "zmiller", "rust": "a19980", "customer_group": "fermi", "visibility": "public", "notify": "dan@hep.wisc.edu,jfrey@cs.wisc.edu", "due_date": ""}