{"id": 6431, "title": "Ticket #6431: slurm_status.py script misparses memory usage field", "description": "<blockquote>\nWhen slurm_status.py parses the memory usage field (<code>MaxRSS</code>) from sacct, it assumes the value be a number followed by the letter 'K' (indicating a value in kilobytes). The value can instead be followed by one of the letters 'M', 'G', 'T', or 'P', to indicate larger values. These larger suffixes are only used if the value is an exact multiple of 1024, so they don't occur very often. Currently, the script will fail if one of these other suffixes is encountered. This leads to the job being held with the hold reason \"Error parsing classad or job not found\".</blockquote>", "remarks": "<blockquote>\n<em>2017-Oct-06 11:16:18 by jfrey:</em> <br/>\n\nThis funky formatting of values is done by convert_num_unit() in the SLURM code, which called by print_fields() in src/sacct/print.c. This was observed in SLURM 2.5.1.\n\n<p></p><hr/>\n<em>2017-Oct-25 08:52:15 by jpatton:</em> <br/>\n\n<strong>CODE REVIEW:</strong> Looks good, assuming RAM doesn't hit exabytes any time soon :)\n\n<p></p><hr/>\n<em>2017-Oct-28 18:49:11 by tim:</em> <br/>\n\n<strong>Doc Review:</strong> I added version history for Jaime.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-27 21:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d3d7fab71535c67806d959356c96f213a7360ec8\">[52695]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6431\" onclick=\"get_ticket_and_populate_wrapper('6431'); return false;\" title=\"slurm_status.py script misparses memory usage field\">#6431</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6454\" onclick=\"get_ticket_and_populate_wrapper('6454'); return false;\" title=\"copy_to_spool does useless extra copies of executable over the network\">#6454</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-06 11:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/72943d14e6ce330729cd0d4738c0937385c20bf5\">[52501]</a></span>: Fix parsing of SLURM job memory usage fields. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6431\" onclick=\"get_ticket_and_populate_wrapper('6431'); return false;\" title=\"slurm_status.py script misparses memory usage field\">#6431</a></span> Sometimes, the memory usage fields from sacct will have a suffix of M, G, T, or P, instead of the usual K. The blahp's status script needs to check for these other suffixes and scale the number appropriately.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Oct-28 18:49", "status": "resolved", "created": "2017-Oct-06 11:01", "fixed_version": "2017-Oct-06 11:01", "broken_version": "", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}