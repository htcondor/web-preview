{"id": 5849, "title": "Ticket #5849: Resolve log configuration madness for \"clone\" daemons.", "description": "<blockquote>\nIt's highly likely that the following configuration, even with <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5769\" onclick=\"get_ticket_and_populate_wrapper('5769'); return false;\" title=\"Fix HAD|REPLICATION configuration incompability.\">#5769</a></span>, will result in the second negotiator (for example) writing to <code>$(LOG)/NegotiatorLog</code>.\n\n<p></p><div class=\"verbatim\">\n<pre>SECOND_NEGOTIATOR = $(NEGOTIATOR)\nSECOND_NEGOTIATOR_LOG = $(LOG)/SecondNegotiatorLog\n</pre></div>\n\n\n<p>Arguably, the correct configuration is <code>SECOND_NEGOTIATOR.LOG</code>, but the master currently complains if &lt;DAEMON_NAME&gt;_LOG isn't defined.  One part of the fix might be to change the master not to complain (or complain about &lt;DAEMON_NAME&gt;.LOG, instead).  We'll have to think about if we want to try to make &lt;DAEMON_NAME&gt;_LOG work, since a bunch of our examples include it.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Aug-17 16:22:44 by johnkn:</em> <br/>\n\nUm <code>LOG</code> is the the knob that specifies the log directory.  The 'correct' way to specify a log file for a secondary daemon is <code>LOCALNAME.&lt;SUBSYSTEM&gt;_LOG</code>.\n\n<p>What we should do is in the dprintf_config code.  check for a localname, and if one is defined, do NOT lookup <code>SUBSYSTEM_LOG</code>, instead lookup <code>LOCALNAME.&lt;SUBSYSTEM&gt;_LOG</code>.  If that has no value, default the log file to  <code>$(LOG)/LocalnameLog</code> as the logfile.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Sep-28 16:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e405c7a4e7043d020196a384d3d359dcfdffba11\">[49331]</a></span>: Fixup version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5849\" onclick=\"get_ticket_and_populate_wrapper('5849'); return false;\" title='Resolve log configuration madness for \"clone\" daemons.'>#5849</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4024\" onclick=\"get_ticket_and_populate_wrapper('4024'); return false;\" title=\"Problems with DAG node priority implementation\">#4024</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Aug-23 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/55bfc32deee137ad30f7b25463b74a5644909195\">[49057]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5767\" onclick=\"get_ticket_and_populate_wrapper('5767'); return false;\" title=\"Automatically detect DaemonCore daemons.\">#5767</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5768\" onclick=\"get_ticket_and_populate_wrapper('5768'); return false;\" title=\"DC daemons should automatically get -localname flag if appropriate.\">#5768</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5849\" onclick=\"get_ticket_and_populate_wrapper('5849'); return false;\" title='Resolve log configuration madness for \"clone\" daemons.'>#5849</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5769\" onclick=\"get_ticket_and_populate_wrapper('5769'); return false;\" title=\"Fix HAD|REPLICATION configuration incompability.\">#5769</a></span>) Documentation.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Aug-23 11:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/07677a64a3c86ebe9bf787aee1b77494160cc53b\">[49056]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5849\" onclick=\"get_ticket_and_populate_wrapper('5849'); return false;\" title='Resolve log configuration madness for \"clone\" daemons.'>#5849</a></span>) Add a comment to help explain the logic and correct a memory leak.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Aug-17 17:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/505d45c9525410f2bc29559eede48b451e284a70\">[49036]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5849\" onclick=\"get_ticket_and_populate_wrapper('5849'); return false;\" title='Resolve log configuration madness for \"clone\" daemons.'>#5849</a></span>) Change default for dprintf() logs. If the local name is defined, check for the parameter &lt;LOCALNAME&gt;.&lt;SUBSYSTEM&gt;_LOG. If that's not set, use $(LOG)/LocalnameLog (with that capitalization). (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Aug-24 14:12", "status": "resolved", "created": "2016-Aug-17 15:31", "fixed_version": "2016-Aug-17 15:31", "broken_version": "", "priority": "4", "subsystem": "Libs", "assigned_to": "tlmiller", "derived_from": "#5768", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, johnkn@cs.wisc.edu", "due_date": ""}