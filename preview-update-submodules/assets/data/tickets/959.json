{"id": 959, "title": "Ticket #959: Linking both old and new ClassAds on AIX", "description": "<blockquote>\nBuilding V7_3-new_classads-branch on AIX is failing due to this error:\n<code>ld: 0711-781 ERROR: TOC overflow. TOC size: 67584\tMaximum size: 65536</code>\n\n<p>It appears including both old and new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> takes us over the normal limit on global symbols in the schedd. There is a <code>-Wl,-bbigtoc</code> flag to increase the size, but it comes with a performance hit.\n\n</p><p>We should try to link in only one of old and new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> for executables that don't explicitly need both (e.g. the job router or better analyze).\n\n</p><p>Here are some links with more information:\n</p><ul>\n<li><a class=\"external\" href=\"http://www-949.ibm.com/software/rational/cafe/blogs/ccpp-commercial/2008/12/23/toc-overflow-what-is-it-and-why-should-you-care\">http://www-949.ibm.com/software/rational/cafe/blogs/ccpp-commercial/2008/12/23/toc-overflow-what-is-it-and-why-should-you-care</a>\n</li><li><a class=\"external\" href=\"http://www-949.ibm.com/software/rational/cafe/blogs/ccpp-commercial/2009/01/23/dealing-with-toc-overflow-the-traditional-approach\">http://www-949.ibm.com/software/rational/cafe/blogs/ccpp-commercial/2009/01/23/dealing-with-toc-overflow-the-traditional-approach</a>\n</li><li><a class=\"external\" href=\"http://www-949.ibm.com/software/rational/cafe/blogs/ccpp-commercial/2009/04/19/toc-overflow-getting-help-from-the-xl-compilers\">http://www-949.ibm.com/software/rational/cafe/blogs/ccpp-commercial/2009/04/19/toc-overflow-getting-help-from-the-xl-compilers</a></li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2009-Nov-16 23:08:04 by matt:</em> <br/>\n\nIs this AIX laughing at us for having huge amounts of global symbols?\n\n<p>What programs failed to link? I'd venture a guess and say the Collector and Schedd.\n\n</p><p></p><hr/>\n<em>2010-Jan-14 15:57:18 by jfrey:</em> <br/>\n\nAdd these command-line options to gcc eliminate the problem: <code>-mno-fp-in-toc -mno-sum-in-toc -mminimal-toc</code></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jan-12 16:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4932a2427ed646d51c3a34be66025c8180bc2337\">[16870]</a></span>: Fix build failure on AIX. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=619\" onclick=\"get_ticket_and_populate_wrapper('619'); return false;\" title=\"Write compatibility functions for conversion from old to new ClassAds\">#619</a></span> The linking of condor_schedd was failing due to an overflow of the TOC (Table Of Contents). Add some gcc flags to reduce the number of symbols put into the TOC.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Feb-05 15:38", "status": "resolved", "created": "2009-Nov-16 17:08", "fixed_version": "2009-Nov-16 17:08", "broken_version": "v070500", "priority": "4", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "#619", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}