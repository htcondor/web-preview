{"id": 1543, "title": "Ticket #1543: Startd handles statfs overflow poorly", "description": "<blockquote>\nThe condor startd, via sysapi, calls statfs to get the free disk space.  statfs measures free disk space in an unsigned long number of blocks.  If the number of free blocks is more than an unsigned long, statfs returns -1 and sets errno to EOVERFLOW.  This is happening for igor when running on lustre-mounted huge distributed filesystem.  The Disk startd attribute then doesn't get set and no jobs match.\n\n<p>This patch checks for EOVERFLOW, and sets the free space to INT_MAX number of k.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Jul-28 16:47:49 by matt:</em> <br/>\n\nTodo or Defect?\n\n<p></p><hr/>\n<em>2010-Jul-28 16:49:17 by matt:</em> <br/>\n\nSetting INT_MAX is a rather ugly hack. If a 64 bit compiled Condor has a problem that should just be logged and fixed. The user should run 64 bit versions of Condor to avoid statfs overflowing.\n\n<p></p><hr/>\n<em>2010-Jul-28 17:08:57 by gthain:</em> <br/>\n\nThe ultimate problem is that this info is recorded and forwarded as a classad integral value, and classad integers are always 32 bits.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-29 22:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c3ebc230425a50833afafadfe76baba703b40062\">[25591]</a></span>: Updated version hitory for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1543\" onclick=\"get_ticket_and_populate_wrapper('1543'); return false;\" title=\"Startd handles statfs overflow poorly\">#1543</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-29 15:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/511c8eba120984d6149de60730266019c4ebfb87\">[18662]</a></span>: Fix overflow problems with large filesystems <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1543\" onclick=\"get_ticket_and_populate_wrapper('1543'); return false;\" title=\"Startd handles statfs overflow poorly\">#1543</a></span> If statfs returns EOVERFLOW, force the number of free blocks to INT_MAX.  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Nov-19 07:08", "status": "resolved", "created": "2010-Jul-28 16:16", "fixed_version": "2010-Jul-28 16:16", "broken_version": "", "priority": "1", "subsystem": "Daemons", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "s7941", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}