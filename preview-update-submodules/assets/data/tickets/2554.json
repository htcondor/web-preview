{"id": 2554, "title": "Ticket #2554: IPv6 x86_64_rhap_6.1-updated Condor C tests fail. Is using ::1", "description": "<blockquote>\nFor example: <a class=\"external\" href=\"http://nmi-s006.cs.wisc.edu/results/Run-condor-details.php?runid=376802&amp;type=test&amp;user=adesmet\">http://nmi-s006.cs.wisc.edu/results/Run-condor-details.php?runid=376802&amp;type=test&amp;user=adesmet</a></blockquote>", "remarks": "<blockquote>\n<em>2011-Oct-20 14:56:49 by adesmet:</em> <br/>\n\ncondor_status is being passed \"-pool localhost\".  The /etc/hosts file maps localhost to BOTH 127.0.0.1 and ::1.\n\n<p></p><hr/>\n<em>2011-Oct-21 17:33:23 by adesmet:</em> <br/>\n\nWhen using get_fqdn_and_ip_from_hostname() (which calls condor_getaddrinfo()) to find an IP address:\n<ol>\n<li>It asks for all IP addresses, IPv4 and IPv4, not caring if IPv6 mode is enabled.\n</li><li>It blinding takes the first one; in practice we would really need to test them all.\n</li></ol>\n\n<p>Immediate fix (being tested): change get_default_hint to only ask for IPv4 addresses if IPv6 mode isn't enable.  Patch forthcoming.\n\n</p><p>Medium term consideration: should we bother filtering\nin get_fqdn_and_ip_from_hostname (<a class=\"file\" href=\"rlog?f=src/condor_utils/ipv6_hostname.cpp\">/src/condor_utils/ipv6_hostname.cpp</a> around line 207) to reject if ai_family isn't expected (AF_INET always and possibly AF_INET6)?  Hopefully the fix above will ensure we never see them.\n\n</p><p>Long term fix: may need to track a list of IP addresses and try them in order. Likely to be a more involved and pervasive.\n\n</p><p></p><hr/>\n<em>2011-Oct-31 12:43:41 by adesmet:</em> <br/>\n\nShort term solution in place.\n\n<p></p><hr/>\n<em>2014-Jul-29 10:28:36 by adesmet:</em> <br/>\n\nAbandoned as old. Open a new ticket if re-observed.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Oct-25 10:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ed1b643bc1d8aff0d21eddf7d5daa0fb7d728e8c\">[27974]</a></span>: Fix <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=2554\" onclick=\"get_ticket_and_populate_wrapper('2554'); return false;\" title=\"IPv6 x86_64_rhap_6.1-updated Condor C tests fail. Is using ::1\">#2554</a></span> - Only ask for IPv4 addresses if we're in IPv4 mode. Solves problem of using ::1 when we should be using 127.0.0.0.1  (By Alan De Smet )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Jul-29 10:28", "status": "abandoned", "created": "2011-Oct-17 12:36", "fixed_version": "2011-Oct-17 12:36", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "adesmet", "derived_from": "#2466", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}