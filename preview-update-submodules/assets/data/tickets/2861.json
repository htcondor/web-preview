{"id": 2861, "title": "Ticket #2861: Add global event log-related tests", "description": "<blockquote>\nNote: I split this out from <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2858\" onclick=\"get_ticket_and_populate_wrapper('2858'); return false;\" title='Unwriteable global event log prevents writing to \"normal\" job logs'>#2858</a></span> because the new tests need to go into 7.7, whereas the actual fix for the problem should go into 7.6.\n\n<p>I think there should be at least two aspects of fixing the tests:\n</p><ol>\n<li>The global event log should be turned on for all tests (or at least all DAGMan tests).  I guess at least one test should check that events actually show up in the global event log (!).\n</li><li>There should be at least one DAGMan test where the global event log is unwriteable, and we make sure that DAGMan still runs okay.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2012-Mar-06 09:44:41 by wenger:</em> <br/>\n\nTo turn on the global event log for the normal nightly tests, you need to modify src/condor_scripts/batch_test.pl.  Something like this:\n\n<p></p><pre>          print FIX \"MAX_MASTER_LOG          = $logsize\\n\";\n          print FIX \"MASTER_DEBUG            = D_COMMAND\\n\";\n</pre>\n\n<p></p><pre>  +       print FIX \"EVENT_LOG               = \\$(LOG)/EventLog\\n\";\n  +       print FIX \"EVENT_LOG_MAX_SIZE      = $logsize\\n\";\n  +\n          if($iswindows == 1) {\n                  print FIX \"WINDOWS_SOFTKILL_LOG = \\$(LOG)\\\\SoftKillLog\\n\";\n          }\n</pre>\n\n<p></p><hr/>\n<em>2012-Mar-10 10:38:29 by nwp:</em> <br/>\n\njob_dagman_global_event_log-A tests that events are actually written to the event log.\n\n<p>job_dagman_global_event_log-B tests that events are written to the user log when the event log is not writable.\n\n</p><p>The test worked in <a class=\"external\" href=\"http://submit-2.batlab.org/results/branch.php?branch=workspace%3A+2861-3&amp;user=nwp\">this test</a>.  I checked the output for the necessary semantics.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-12 10:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7c65106de6b867454bbfbd139234a7b692cd767a\">[30885]</a></span>: Use correct stat ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2861\" onclick=\"get_ticket_and_populate_wrapper('2861'); return false;\" title=\"Add global event log-related tests\">#2861</a></span>  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-10 10:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e2c68887e04c987d9361af00725d94ff815e5f83\">[30882]</a></span>: Test the global event log ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2861\" onclick=\"get_ticket_and_populate_wrapper('2861'); return false;\" title=\"Add global event log-related tests\">#2861</a></span>  (By Nathan W. Panike )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2012-Mar-15 11:06", "status": "resolved", "created": "2012-Mar-05 11:43", "fixed_version": "2012-Mar-05 11:43", "broken_version": "v070705", "priority": "1", "subsystem": "Tests", "assigned_to": "nwp", "derived_from": "#2858", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": "20120313"}