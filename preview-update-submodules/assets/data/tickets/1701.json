{"id": 1701, "title": "Ticket #1701: Soap code calls realpath() incorrectly", "description": "<blockquote>\nFunction serve_file() in <code>src/condor_daemon_core.V6/soap_core.cpp</code> calls libc function realpath() incorrectly on non-linux unix machines. It relies on a glibc extension that will malloc space for the function's answer if NULL is passed as the second argument. On AIX and Solaris, this causes the call to fail. On Mac OS X 10.4 and 10.5, this causes the program to crash. Mac OS X 10.6 adds the extended behavior.\n\n<p>serve_file() should be changed to pass in a buffer of size PATH_MAX.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Oct-07 16:36:34 by jfrey:</em> <br/>\n\nThe SOAP test didn't catch this because it never tries to retrieve a file from any of the daemons, not even a WSDL file. That should be added to the test.\n\n<p></p><hr/>\n<em>2010-Oct-07 17:24:40 by jfrey:</em> <br/>\n\nPushed a commit to V7_4-branch for 7.4.4. We now call realpath() correctly.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Oct-13 11:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2b6f271ee86960dc3bfbbb33414a6f6d73f8b9d9\">[25727]</a></span>: Add version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1699\" onclick=\"get_ticket_and_populate_wrapper('1699'); return false;\" title=\"Gridmanager should react to Cream job state CANCELLED\">#1699</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1700\" onclick=\"get_ticket_and_populate_wrapper('1700'); return false;\" title=\"Gridmanager should retry failed purge command for Cream jobs\">#1700</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1701\" onclick=\"get_ticket_and_populate_wrapper('1701'); return false;\" title=\"Soap code calls realpath() incorrectly\">#1701</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Oct-07 17:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d93bb3572ffbdb0b0d43384cb43eb6f6f1ff10de\">[19138]</a></span>: Fix daemon-core http get for non-linux unix platforms. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1701\" onclick=\"get_ticket_and_populate_wrapper('1701'); return false;\" title=\"Soap code calls realpath() incorrectly\">#1701</a></span> Function serve_file() in src/condor_daemon_core.V6/soap_core.cpp calls libc function realpath() incorrectly on non-linux unix machines. It relies on a glibc extension that will malloc space for the function's answer if NULL is passed as the\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jan-30 14:13", "status": "resolved", "created": "2010-Oct-07 16:19", "fixed_version": "2010-Oct-07 16:19", "broken_version": "v070400", "priority": "4", "subsystem": "Daemons", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "a21107", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}