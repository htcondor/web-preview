{"id": 205, "title": "Ticket #205: realpath() on Win32", "description": "<blockquote>\nWe'd like an implementation of <code>realpath</code> for Windows that meets the POSIX.1-2008 specification; this is used in the static web server code.\n\n<p><code>realpath(path, NULL)</code> should resolve all components in <code>path</code> to canonical names (e.g. resolving <code>..</code> and <code>.</code> elements) and return a newly-allocated C string containing the canonical name for <code>path</code>, or <code>NULL</code> if <code>path</code> does not exist.\n\n</p><p>On Windows, <code>realpath</code> should also convert every pathname component to the \"long file name\" version, resolve any substituted drive names, and resolve any reparse points.\n\n</p><p>See <a class=\"external\" href=\"http://bit.ly/4dh6wb\">http://bit.ly/4dh6wb</a> for more details on <code>realpath</code> and the POSIX.1-2008 amendments.  (CERT mentions that canonicalizing pathnames on Windows is complex, but their alternate solutions are not obviously applicable to our problem.)</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Feb-10 09:03:08 by willb:</em> <br/>\n\nCurrently, we use the following macro in my rewrite of the HTTP GET support (not yet upstream):\n\n<p></p><div class=\"code\">\n<pre class=\"code\">#ifdef WIN32\n#define realpath(P,B) _fullpath((B),(P),_MAX_PATH)\n#endif\n</pre></div>\n\n\n<p>This doesn't handle reparse points and doesn't behave the same way as POSIX <code>realpath</code> in the event that the path doesn't exist.\n\n</p><p></p><hr/>\n<em>2009-Oct-20 17:01:46 by tannenba:</em> <br/>\n\nSomewhat related --- see <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=790\" onclick=\"get_ticket_and_populate_wrapper('790'); return false;\" title=\"locking problem between shadows on windows in user job log\">#790</a></span> : would be nice to have a complete realpath Win32 implementation for dealing w/ that ticket as well.\n<hr/>\n<em>2010-Aug-23 17:07:50 by adesmet:</em> <br/>\n\nBulk change of target version from v070402 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2013-Jun-04 11:47:52 by tannenba:</em> <br/>\n\nImplementing <code>realpath()</code> on Windows in terms of a macro using <code>_fullpath()</code> as Will describes, while not perfect, is good enough and already being used in multiple places in the code.  As such I am resolving this ticket.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Sep-27 16:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7d5e0f7497092b3e33aa8cbdb93466333f25158c\">[64491]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4dced977ccb1e384cd59b31304a4efa601903a01\">[64259]</a></span>, Merge pull request <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=205\" onclick=\"get_ticket_and_populate_wrapper('205'); return false;\" title=\"realpath() on Win32\">#205</a></span> from htcondor/V9_1-HTCONDOR-680-disappearing-execute-dir Improve handling of execute directory disappearing. HTCONDOR-680 Committer: <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GitHub\" title=\"Git Hub\">GitHub</a></span>  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Aug-04 11:40", "status": "abandoned", "created": "2009-Feb-10 08:55", "fixed_version": "2009-Feb-10 08:55", "broken_version": "v070201", "priority": "4", "subsystem": "Win32", "assigned_to": "johnkn", "derived_from": "", "creator": "willb", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}