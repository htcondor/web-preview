{"id": 2402, "title": "Ticket #2402: Improve the DAGMan node retry test", "description": "<blockquote>\nIt looks like the current state of the fix for gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2057\" onclick=\"get_ticket_and_populate_wrapper('2057'); return false;\" title=\"Always run POST script, even if PRE script fails\">#2057</a></span> may break node retries in some cases (when the PRE script fails and we aren't running the POST script anyhow, it looks like node retries don't happen).\n\n<p>The existing DAGMan node retry test seems like a very minimal case -- I think it should be expanded.  For example, a node with a PRE and a POST script:\nTry 1: PRE script fails\nTry 2: job fails\nTry 3: POST script fails\nTry 4: success\n\n</p><p>Also, we should try all combinations of nodes with and without PRE and POST scripts.  The test script should make sure that the right retries happened, not just that things eventually succeeded.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Aug-22 14:11:23 by wenger:</em> <br/>\n\nI've finished up a new retry test that tests a bunch of different combinations of PRE and POST scripts, so I'm going to resolve this ticket.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-22 15:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/421663df89d8122f12294c357ae05729f6e4acc6\">[26898]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2402\" onclick=\"get_ticket_and_populate_wrapper('2402'); return false;\" title=\"Improve the DAGMan node retry test\">#2402</a></span>: added tests for a bunch of different conditions; added the overall test script, and added the test to the list of tests to run. Also fixed a small problem in a regexp in a bunch of the DAGMan tests (which I just happened to find while working on <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2402\" onclick=\"get_ticket_and_populate_wrapper('2402'); return false;\" title=\"Improve the DAGMan node retry test\">#2402</a></span>).\u00a0[...]\n (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-22 14:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4b9cf371434a7f68d81c68d294bafcdb25af2ce6\">[26894]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2402\" onclick=\"get_ticket_and_populate_wrapper('2402'); return false;\" title=\"Improve the DAGMan node retry test\">#2402</a></span>: added tests for a bunch of different conditions; added the overall test script, and added the test to the list of tests to run. Also fixed a small problem in a regexp in a bunch of the DAGMan tests (which I just happened to find while working on <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2402\" onclick=\"get_ticket_and_populate_wrapper('2402'); return false;\" title=\"Improve the DAGMan node retry test\">#2402</a></span>).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-19 17:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a3b6d2070fe794c3a2901204c6b8c0fcb1f4004a\">[26888]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2402\" onclick=\"get_ticket_and_populate_wrapper('2402'); return false;\" title=\"Improve the DAGMan node retry test\">#2402</a></span>: initial version of DAG in place, but the test script isn't yet -- I'm committing so I can cherry pick this over to V7_7-always_run_post_script_even_if_pre_script_fails-branch to test things there...  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-19 17:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d01e3aec3134189ce43e22531a857c17fc23b711\">[26886]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2402\" onclick=\"get_ticket_and_populate_wrapper('2402'); return false;\" title=\"Improve the DAGMan node retry test\">#2402</a></span>: initial version of DAG in place, but the test script isn't yet -- I'm committing so I can cherry pick this over to V7_7-always_run_post_script_even_if_pre_script_fails-branch to test things there...  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Aug-22 16:08", "status": "resolved", "created": "2011-Aug-19 16:24", "fixed_version": "2011-Aug-19 16:24", "broken_version": "v070700", "priority": "1", "subsystem": "Tests", "assigned_to": "wenger", "derived_from": "#2057", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu", "due_date": ""}