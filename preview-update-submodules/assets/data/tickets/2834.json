{"id": 2834, "title": "Ticket #2834: Potential problem w/ DMTCP shim scripts", "description": "<blockquote>\nChris P is reporting problems using the Condor/DMTCP integration (shim_dmtcp) on the Condor/DMTCP test program.  It apparently \"works\" on the command line.\n\n<p>shim_dmtcp says:\n</p><div class=\"code\">\n<pre class=\"code\">[DELETED 02/16/12 13:27:03 CST]: starting the dmtcp_coordinator process\n[DELETED 02/16/12 13:27:03 CST]: started dmtcp_coordinator on port 37947 with checkpoint interval 1800\n[DELETED 02/16/12 13:27:03 CST]: sleeping 2 seconds\n[DELETED 02/16/12 13:27:05 CST]: Setting signal trap for SIGINT [2]\n[DELETED 02/16/12 13:27:05 CST]: running application for the first time\n[DELETED 02/16/12 13:27:05 CST]: wait returned with value 99!\n[nemoDELETED 02/16/12 13:27:05 CST]: Program terminated.\n</pre></div>\n\n\n<p>Info dump:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">$ ./dmtcp_checkpoint --version\ndmtcp_checkpoint (DMTCP + MTCP) 1.2.4\n\n$ cat /etc/debian_version\n6.0.4\n\n$ uname -a\nLinux DELETED 2.6.32-5-amd64 #1 SMP Mon Jan 16 16:22:28 UTC 2012 x86_64 GNU/Linux\n</pre></div>\n\n\n<p>(Email thread is \"help with DMTCP and checkpointing Python\" on the CondorLIGO mailing list.  Much of the discussion was moved off list.)</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Mar-08 05:55:56 by mih:</em> <br/>\n\nFor the record\n\n<p></p><pre>  http://bugs.debian.org/663078\n</pre>\n\n<p>this is probably unrelated, but also qualifies as \"Potential problem w/ DMTCP shim scripts\" -- also happening with DMTCP 1.2.4 and on Debian 6.0.4.\n\n</p><p></p><hr/>\n<em>2012-Jun-28 15:07:19 by adesmet:</em> <br/>\n\nPossibly (probably?) related: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3094\" onclick=\"get_ticket_and_populate_wrapper('3094'); return false;\" title=\"DMTCP doesn't work in 7.8; SIGINT ignored\">#3094</a></span>: DMTCP doesn't work in 7.8; SIGINT ignored\n\n<p></p><hr/>\n<em>2012-Jun-28 17:15:19 by gene:</em> <br/>\n\nHi Chris.  We support DMTCP at our site.  So, we didn't see the Condor trouble ticket.  In the future, you can additionally report any problems with DMTCP via dmtcp.sourceforge.net .\n\n<p>We saw this same problem of ignoring SIGINT independently from a different Condor user.  If you send me e-mail ( gene@ccs.neu.edu ), we can exchange further information.  Here are the things that we know so far:\n\n</p><p>1.  The \"unrelated bug\" in DMTCP-1.2.4 has now been fixed in DMTCP-1.2.5 (latest Debian package).\n\n</p><p>2.  The issue of ignoring SIGINT turns out to be unrelated to DMTCP.  When this bug is present, all Condor jobs will ignore SIGINT.  (Could you verify that this is also the case at your site?)\n\n</p><p>3.  To see if the bug is present, it's enough to do something like:\n\n</p><p></p><pre>    cat /proc/`pgrep condor_master`/status | grep SigIgn\n</pre>\n\n<p>where `pgrep condor_master` is the pid of condor_master on the machine that starts Condor.  If the bug is present, you will see something like:\n\n</p><p></p><pre>    SigIgn:\t0000000000001002\n</pre>\n\n<p>The 2 in that bitmastk expands into 0010 in binary.  The 1 bit (second from the right) says that signal 2 (SIGINT) is being ignored.  You will see this for all condor_* processes -- not just condor_master.\n\n</p><p>4.  We're still trying to track down what configuration of Condor or Debian could cause this behavior.  We're seeing this on Debian squeeze (2.6.32-5-amd64 kernel) with Condor 2.8.1.  On our site, /bin/sh is a link to /bin/dash.  At your site, how much of these characteristics do you also see?\n\n</p><p>Thanks,\n- Gene Cooperman\n\n</p><p></p><hr/>\n<em>2012-Jul-01 02:52:14 by mih:</em> <br/>\n\nFYI: There seems to be an issue with changing <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SigIgn\" title=\"Sig Ign\">SigIgn</a></span> masks on Debian when concurrency booting is enabled. It is tracked here:\n\n<p><a class=\"external\" href=\"http://bugs.debian.org/679630\">http://bugs.debian.org/679630</a>\n\n</p><p></p><hr/>\n<em>2012-Jul-02 14:39:32 by gene:</em> <br/>\n\n... and a fuller description of the Debian bug, including a workaround, is now included in Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3094\" onclick=\"get_ticket_and_populate_wrapper('3094'); return false;\" title=\"DMTCP doesn't work in 7.8; SIGINT ignored\">#3094</a></span>.\n\n<p></p><hr/>\n<em>2012-Jul-03 17:25:26 by adesmet:</em> <br/>\n\nResolved as <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3094\" onclick=\"get_ticket_and_populate_wrapper('3094'); return false;\" title=\"DMTCP doesn't work in 7.8; SIGINT ignored\">#3094</a></span>.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "incident", "last_change": "2012-Jul-03 17:26", "status": "defer", "created": "2012-Feb-20 13:15", "fixed_version": "2012-Feb-20 13:15", "broken_version": "", "priority": "5", "subsystem": "", "assigned_to": "adesmet", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "tstclair@redhat.com,pcouvare@caltech.edu", "due_date": ""}