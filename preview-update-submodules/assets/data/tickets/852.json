{"id": 852, "title": "Ticket #852: Shadow and local starter may skip final job ad update to sched", "description": "<blockquote>\nBoth the shadow and the starter (for local universe) use the <span class=\"quote\">QmgrJobUpdater</span> class to forward job ad updates to the schedd. <span class=\"quote\">QmgrJobUpdater</span> contains an optimization that skips the final update to the schedd if there's no history file. The theory is that if the job ad is about to be removed from the queue and won't be saved anywhere, we can save some of the schedd's time.\n\n<p>This ignores a number of cases where the job ad doesn't disappear into the ether on completion or removal:\n</p><ul>\n<li><span class=\"quote\">LeaveJobInQueue</span> = True\n</li><li>Quill\n</li><li>PER_JOB_HISTORY_DIR\n</li></ul>\n\n<p>Rather than try to check for these cases and any future ones, <span class=\"quote\">QmgrJobUpdater</span> should always do the final update.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Oct-14 14:17:21 by jfrey:</em> <br/>\n\nPushed a fix to V7_4-branch for 7.4.1.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Oct-14 14:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fe83e4b95aed6a60fa64fab8ffc250604a53dd14\">[16051]</a></span>: Never skip the final update to the schedd in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=QmgrJobUpdater\" title=\"Qmgr Job Updater\">QmgrJobUpdater</a></span>. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=852\" onclick=\"get_ticket_and_populate_wrapper('852'); return false;\" title=\"Shadow and local starter may skip final job ad update to sched\">#852</a></span>)  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2009-Dec-17 13:39", "status": "resolved", "created": "2009-Oct-14 12:49", "fixed_version": "2009-Oct-14 12:49", "broken_version": "v070302", "priority": "2", "subsystem": "Daemons", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}