{"id": 4017, "title": "Ticket #4017: HTCondor-G -> NorduGrid -> HTCondor gives scrambled output", "description": "<blockquote>\nWhen Condor-G is used to submit jobs to a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NorduGrid\" title=\"Nordu Grid\">NorduGrid</a></span> ARC server that submits into a Condor pool, the job's stdout/err gets mixed up with ARC's internal logs. This because both the gridmanager and the starter/shadow name the stdout/err files <code>_condor_stdout</code> and <code>_condor_stderr</code>. If ARC submitted the job directly to Condor, this would work fine. But ARC wraps the job in its own wrapper script. When the wrapper runs the job, it redirects the stdout/err to the names given by the submitter (i.e. the Condor gridmanager). The wrapper's stdout/err is directed to <code>_condor_stdout/err</code> by the Condor starter. Thus, the output of the wrapper and the job end up in the same files.\n\n<p>This problem doesn't occur if Condor's file transfer isn't used. In that case, the starter doesn't change the filenames of the wrappers stdout/err.\n\n</p><p>I believe the best fix for this is to change the filenames used by the gridmanager when submitting jobs to <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NorduGrid\" title=\"Nordu Grid\">NorduGrid</a></span> ARC.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Oct-28 14:59:35 by tannenba:</em> <br/>\n\nPerhaps just append the global job id to the end of output and error filenames when the gridmanager submits ?\n\n<p></p><hr/>\n<em>2014-Feb-13 10:40:51 by tannenba:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n\n<p>Patch looks very good, thanks, only suggestion would be to add more comments in the source code itself.  The commit message gives a good description of what is changing and why, but this wisdom in the commit message does not appear in any sort of comments in the source code itself...\n\n</p><p></p><hr/>\n<em>2014-Feb-13 11:02:03 by jfrey:</em> <br/>\n\nI've added a comment to the code.\n\n<p></p><hr/>\n<em>2015-Jul-07 16:53:42 by jfrey:</em> <br/>\n\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NorduGrid\" title=\"Nordu Grid\">NorduGrid</a></span> ARC added a change to work around this problem on their side. This allowed ARC CE 4.2 to work with older Condor-G clients. Early releases of ARC CE 5.0 partially undid that workaround, causing older Condor-G client to have problems again. A later release 5.0 restored the workaround.\n\n<p>Details:\n<a class=\"external\" href=\"https://ggus.eu/index.php?mode=ticket_info&amp;ticket_id=113745\">https://ggus.eu/index.php?mode=ticket_info&amp;ticket_id=113745</a>\n<a class=\"external\" href=\"http://bugzilla.nordugrid.org/show_bug.cgi?id=3489\">http://bugzilla.nordugrid.org/show_bug.cgi?id=3489</a></p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Feb-13 10:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/adf1737c7cf2f6d9078082cd7658cf52696bebba\">[39410]</a></span>: Add comment about nordugrid stdout/err file naming. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4017\" onclick=\"get_ticket_and_populate_wrapper('4017'); return false;\" title=\"HTCondor-G -&gt; NorduGrid -&gt; HTCondor gives scrambled output\">#4017</a></span> Explain in the code why we have multiple naming conventions for stdout/err for nordugrid jobs, and try using both sets of names.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-27 09:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/05be898e7b4bf3882d4cec8a4ea0b4d241a7c12e\">[38869]</a></span>: minor edit of 8.0.5 version history item <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4017\" onclick=\"get_ticket_and_populate_wrapper('4017'); return false;\" title=\"HTCondor-G -&gt; NorduGrid -&gt; HTCondor gives scrambled output\">#4017</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-21 16:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4471e668ce80e5b40eccca84fa8cbdd3203d6793\">[38813]</a></span>: Local variables named 'stdout' or 'stderr' don't compile on solaris <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4017\" onclick=\"get_ticket_and_populate_wrapper('4017'); return false;\" title=\"HTCondor-G -&gt; NorduGrid -&gt; HTCondor gives scrambled output\">#4017</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-21 11:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/80baa1075dafabf275a77e07a68ffc2024ee001c\">[38790]</a></span>: Docs for nordugrid stdout/err scrambling bugfix. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4017\" onclick=\"get_ticket_and_populate_wrapper('4017'); return false;\" title=\"HTCondor-G -&gt; NorduGrid -&gt; HTCondor gives scrambled output\">#4017</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-21 10:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e9dc0f2af135a473153c9dc9d46797329580c4b5\">[38789]</a></span>: Fix filename collision when <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NorduGrid\" title=\"Nordu Grid\">NorduGrid</a></span> ARC submits into HTCondor. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4017\" onclick=\"get_ticket_and_populate_wrapper('4017'); return false;\" title=\"HTCondor-G -&gt; NorduGrid -&gt; HTCondor gives scrambled output\">#4017</a></span> When the gridmanager submits a job to nordugrid, it names the stdout/err files _condor_stdout/err. When a Condor vanilla universe job uses file transfer, it also names the stdout/err files _condor_stdout/err. <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NorduGrid\" title=\"Nordu Grid\">NorduGrid</a></span> ARC wraps the\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Jul-07 16:53", "status": "resolved", "created": "2013-Oct-28 14:43", "fixed_version": "2013-Oct-28 14:43", "broken_version": "v080000", "priority": "2", "subsystem": "Grid", "assigned_to": "tannenba", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "jfrey@cs.wisc.edu,tannenba@cs.wisc.edu,andrew.lahiff@stfc.ac.uk,bbockelm@cse.unl.edu", "due_date": ""}