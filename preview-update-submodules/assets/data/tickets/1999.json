{"id": 1999, "title": "Ticket #1999: Perform Debian 6 full port of Condor", "description": "<blockquote>\nPerform a full port of Condor to x86 and x86_64 Debian 6.\n\n<p>It seems Nick already did a partial clipped port on the master.\n\n</p><p>I finished the clipped port and backported it to V7_6-branch. It wasn't hard.\n\n</p><p>I'm now working on the full port.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Apr-01 15:37:01 by psilord:</em> <br/>\n\nThis is stalled due to not having enough time to work on it.\n\n<p></p><hr/>\n<em>2011-Jun-01 14:22:44 by psilord:</em> <br/>\n\nI have time now. I've started hacking.\n\n<p></p><hr/>\n<em>2011-Jun-01 16:09:11 by psilord:</em> <br/>\n\nIt seems the rhel 6 fixes made the externals compile for this platform. Also, it appears that deb 6 x86_64 was on the master, so I'm enabling it on the V7_6-branch too with full externals.\n\n<p></p><hr/>\n<em>2011-Jun-01 16:29:16 by psilord:</em> <br/>\n\nI finished the clipped port with all externals and put it into the nightlies for V7_6-branch and the master. If it passes for a couple of days, then the clipped port is finished.\n\n<p></p><hr/>\n<em>2011-Jun-02 14:34:58 by psilord:</em> <br/>\n\nI noticed the deb 6 port was failing in creating the native packages and this\nhad something to do with libvirt. After consulting with Jamie, it was determined that two things happened, and one masked the other.\n\n<p>First, a while ago, libvirt was made to be dynamically linked instead of statically. This is the change that actually broke deb 6 native packaging since deb 6 has libvirt in its repo but it isn't installed by default. This caused the native packaging tool to fail.\n\n</p><p>Second, in the same day the above change was made, an externals caching error arose which masked the first error. This took a while to get fixed. After it was fixed the original libvirt problem became visible.\n\n</p><p>So, the fix is to tell NMI that they need to install the libvirt debian package on deb 6 so the dependency manager finds it. Scot Kronenfeld is taking care of this request. Hopefully in a day or two the packaging problem will vanish and deb 6 will be ready to go.\n\n</p><p></p><hr/>\n<em>2011-Jul-19 13:57:17 by psilord:</em> <br/>\n\nThe deb 6 port was ready to go and has been building for a while.\n\n<p></p><hr/>\n<em>2011-Jul-19 13:58:49 by psilord:</em> <br/>\n\nI've started upon the full port for the Debian 6 x86_64 port. I've figured out how to download and patch the glibc required for this distro. It turns out we still need the enable-static-nss patch. Now I'm fixing the Condor source code itself to compile with stduniv. Hopefully I'll finish that today.\n\n<p></p><hr/>\n<em>2011-Jul-19 16:40:13 by psilord:</em> <br/>\n\nOk, the source compiles, and the test suite compiles. Now I'm getting ready to run the test suite itself and see what happens.\n\n<p></p><hr/>\n<em>2011-Jul-20 19:17:15 by psilord:</em> <br/>\n\nAfter some pounding upon a subtle \"do what I mean\" implementation of open3() by the perl developers (if the command \"looks complex\" wrap it in /bin/sh, otherwise just exec it!) which was squashing a signal exit code into a non-signal exit code, I finally have the whole test suite passing. It will be checked in soon.\n\n<p></p><hr/>\n<em>2011-Jul-28 12:04:17 by psilord:</em> <br/>\n\nThis port is finished and in the nightly builds. The stduniv tests look stable.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-21 12:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7a5ce46bddd56c855d00eeb8285683f9048aa0ba\">[22567]</a></span>: ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span> Added the full port of x86_64_deb_6.0-updated into the nightly builds. Also, got rid of some turned off externals for this build which were incorrect. All externals that need to be built are built for this platform. It is stale information. ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span> ===VersionHistory=== Debain\u00a0[...]\n (By Peter Keller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-21 11:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5de3f3bbcdfa808626403cf252810332ab43d558\">[22561]</a></span>: ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span> This test is very sensitive to how runcmd()'s open3() functions. So, I turned of the sh wrapping that runcmd() does because it corrupts the return value of the test job when it is a signal.  (By Peter Keller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-21 11:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b33a0713650fa095cdc450dba7aacc1f2559ddc2\">[22560]</a></span>: ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span> It turns out the perl's open3() can put /bin/sh -c infront if it thinks the command it is running is \"complex\". This appears to be similar logic to perl's system(), but is vaguely documented for open3()--more of an inference between multiple perl man pages, really. So, I added a new option\u00a0[...]\n (By Peter Keller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-19 15:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6758e24cf6172113719e0feeb8653b7f9f8cc43f\">[22559]</a></span>: ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span> Build changes necessary to get Condor to frank as a full port to Debian 6 x86_64. Mostly this involved verifying places that we used the GLIBC212 symbol as being valid for GLIBC211 too.  (By Peter Keller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-19 13:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/274944196475e25140ccefe115214d8985048695\">[22558]</a></span>: ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span> Figured out how to get and build the patched glibc revision for Debian 6 x86-64. It so far needs the enable-static-nss.patch file to produce the static version of the glibc. I've put it into the external system and it builds.  (By Peter Keller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jun-01 16:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/83524385c03679d10d26075c1667f65cddbd94f6\">[22074]</a></span>: Turns out the rhel 6 external changes for compilation made the externals for deb 6 compile as well. So I'm enabling it on the V7_6-branch too. This is for ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1999\" onclick=\"get_ticket_and_populate_wrapper('1999'); return false;\" title=\"Perform Debian 6 full port of Condor\">#1999</a></span>.  (By Peter Keller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Oct-19 11:06", "status": "resolved", "created": "2011-Mar-24 14:51", "fixed_version": "2011-Mar-24 14:51", "broken_version": "", "priority": "2", "subsystem": "", "assigned_to": "psilord", "derived_from": "", "creator": "psilord", "rust": "", "customer_group": "other", "visibility": "public", "notify": "psilord@cs.wisc.edu", "due_date": "20110815"}