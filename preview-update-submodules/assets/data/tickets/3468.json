{"id": 3468, "title": "Ticket #3468: Negotiator rank expressions don't work with boolean values", "description": "<blockquote>\nStarting in Condor 7.9.0, the various negotiator job and preemption rank expressions failed to sort properly if they evaluated to a boolean value. This includes the default NEGOTIATOR_PRE_JOB_RANK of <span class=\"quote\">RemoteOwner =?= UNDEFINED</span>.\n\n<p>The issue is that classad::Value::IsNumber() doesn't consider boolean values to be numbers, even though they are treated as numbers in arithmetic operations in a classad expression. We plan to change IsNumber() to treat boolean values as numbers (True is 1, False is 0). Callers who care about values that are specifically integers or reals can use Value::IsIntegerValue() and Value::IsRealValue().</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Jan-29 13:21:06 by tstclair:</em> <br/>\n\nIs this a regression or has it always been that way?\n\n<p></p><hr/>\n<em>2013-Jan-29 14:41:12 by jfrey:</em> <br/>\n\nRegression in 7.9.0.\n\n<p></p><hr/>\n<em>2013-Jan-29 14:43:38 by tstclair:</em> <br/>\n\nShouldn't we target for 7.8.X then?\n\n<p></p><hr/>\n<em>2013-Jan-29 17:36:07 by jfrey:</em> <br/>\n\nCondor 7.9.0 introduced the regression. Condor 7.8.x is unaffected.\n\n<p></p><hr/>\n<em>2013-Feb-04 15:29:43 by tstclair:</em> <br/>\n\nIt would be nice to add a classad test for this.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-31 15:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0377836fce884ca6b4636e0e257ce8261b2cba3b\">[34812]</a></span>: Condor -&gt; HTCondor and ad -&gt; <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> for 7.9.4 version history item ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3468\" onclick=\"get_ticket_and_populate_wrapper('3468'); return false;\" title=\"Negotiator rank expressions don't work with boolean values\">#3468</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-29 18:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3cee79eb415a01f2c63388598da469645b54416d\">[34793]</a></span>: Version history for boolean values in RANK expressions. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3468\" onclick=\"get_ticket_and_populate_wrapper('3468'); return false;\" title=\"Negotiator rank expressions don't work with boolean values\">#3468</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-29 18:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/57ab57487b9e3ad78d1c5d01cfc6af9114403388\">[34792]</a></span>: classad::Value::IsNumber() now considers booleans as numbers. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3468\" onclick=\"get_ticket_and_populate_wrapper('3468'); return false;\" title=\"Negotiator rank expressions don't work with boolean values\">#3468</a></span> Boolean values can be used in arthimetic operations in a classad expression, and it's common for preemption rank expressions in Condor to evaluate to a boolean. In fact, use of Value::IsNumber() in the negotiator was causing the default\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Feb-04 15:29", "status": "resolved", "created": "2013-Jan-28 15:50", "fixed_version": "2013-Jan-28 15:50", "broken_version": "v070900", "priority": "2", "subsystem": "Daemons", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}