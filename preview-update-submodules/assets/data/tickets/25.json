{"id": 25, "title": "Ticket #25: Make static char* EMPTY_DESCRIP const", "description": "<blockquote>\nstatic char* EMPTY_DESCRIP = \"&lt;NULL&gt;\";\n\n<p>This causes hundreds of warnings from gcc 4.3 because \"&lt;NULL&gt;\" is a constant string.\n\n</p><p>Changing it to be const results in errors that go at least as deep as:\n\n</p><p> void free_descrip(char *p) { if(p &amp;&amp;  p != EMPTY_DESCRIP) free(p); }\n\n</p><p>It is rather creepy that the event_descrip on Timer (actually struct tagTimer in condor_timer_manager.h) is not const in this way.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-May-05 17:15:40 by jfrey:</em> <br/>\n\nThis code is intended to save the space and time of copying and freeing a default description string for daemon-core's Register_*() methods. I checked a couple daemons and they always supply description strings. So making EMPTY_DESCRIP constant and strdup()ing it shouldn't cause any noticeable overhead.\n\n<p></p><hr/>\n<em>2010-May-05 17:50:35 by jfrey:</em> <br/>\n\nPushed a fix to master for 7.5.3. EMPTY_DESCRIP is now constant and is strdup()d anytime it's used.\n\n<p></p><hr/>\n<em>2010-May-06 11:16:03 by jfrey:</em> <br/>\n\nPushed a fix to master for 7.5.3. Compiler warnings about EMPTY_DESCRIP should be gone now.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-06 11:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b07159e9ff7c2dd172200a59dd58d755bad65675\">[17947]</a></span>: Move EMPTY_DESCRIP declaration to remove warnings. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=25\" onclick=\"get_ticket_and_populate_wrapper('25'); return false;\" title=\"Make static char* EMPTY_DESCRIP const\">#25</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-05 17:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9164ae51d012a7ac390f00a526c9b6cc20cff96c\">[17942]</a></span>: Make EMPTY_DESCRIP constant in daemon-core. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=25\" onclick=\"get_ticket_and_populate_wrapper('25'); return false;\" title=\"Make static char* EMPTY_DESCRIP const\">#25</a></span> EMPTY_DESCRIP is a default description string for daemon-core's Register_*() methods. It's assigned a constant value but is declared non-constant so that it doesn't have to be strdup()d every time a caller passes NULL to one of the Register_*() methods.\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-May-06 11:16", "status": "resolved", "created": "2009-Jan-15 15:24", "fixed_version": "2009-Jan-15 15:24", "broken_version": "v070000", "priority": "4", "subsystem": "", "assigned_to": "jfrey", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}