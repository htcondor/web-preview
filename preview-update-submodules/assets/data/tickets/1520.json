{"id": 1520, "title": "Ticket #1520: paths specified in transfer_output_files have undefined meaning", "description": "<blockquote>\nWhen something other than a basename is specified in the transfer output file list, the meaning of this is not well defined.\n\n<p>We propose that a path in the transfer output file list should indicate the path from which the output file on the execute machine should be read.  Relative paths are relative to the job's scratch directory on the execute machine.\n\n</p><p>The path to which the output file is written on the submit machine is defined by the output file remaps.  If no remap is specified, the basename is used.\n\n</p><p>There are two known problems with paths in the output file list:\n\n</p><p></p><ol>\n<li>For spooled jobs, the output file list is rewritten by the schedd in the reaper of the input file spooler.  It takes the basename of each item in the list and prepends the path to the spool directory.  When we try to stage out from the execute machine, we then try to read the output files from these paths into the spool directory, which is just wrong.  If we do not mess with the paths in the output file list, stage-out from the execute node works, but then stage-out from the spool (e.g. using condor_transfer_data) fails, because the files in the spool are stored as the basename of the original path, but we are still trying to read from the original path.\n\n<p></p></li><li>When condor_submit checks accessibility of output files, it assumes that the path that will be written to is identical to the path in the transfer output files list, rather than applying remaps or taking its basename.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-23 13:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d05970d77892e33a778f752782f9a4e726221b30\">[18630]</a></span>: Added support for directory trees in Condor's file transfer mode. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1522\" onclick=\"get_ticket_and_populate_wrapper('1522'); return false;\" title=\"support directories in the input/output file transfer lists\">#1522</a></span> This does NOT cause auto-selection of output to look in subdirectories.\u00a0[...]\n (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-23 12:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c69f63eed6de424ba4844c3ad93d0dc31d420e91\">[18629]</a></span>: Make condor_submit file access checks correctly deal with paths in the output file list. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1520\" onclick=\"get_ticket_and_populate_wrapper('1520'); return false;\" title=\"paths specified in transfer_output_files have undefined meaning\">#1520</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-21 16:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f7b4e7bb618c5ca434e6db2c8307fa181c4b8dae\">[18611]</a></span>: Do not rewrite the output file list after spooling input files. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1520\" onclick=\"get_ticket_and_populate_wrapper('1520'); return false;\" title=\"paths specified in transfer_output_files have undefined meaning\">#1520</a></span> If an output file contained path information, the schedd was rewriting it into a path pointing into the spool directory. During stage-out, the starter would then try to read the output file from the spool directory, which makes no\u00a0[...]\n (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Jul-23 17:05", "status": "resolved", "created": "2010-Jul-21 16:01", "fixed_version": "2010-Jul-21 16:01", "broken_version": "v070000", "priority": "4", "subsystem": "", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "other", "visibility": "public", "notify": "dan@hep.wisc.edu,jfrey@cs.wisc.edu", "due_date": ""}