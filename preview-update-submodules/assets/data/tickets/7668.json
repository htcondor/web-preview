{"id": 7668, "title": "Ticket #7668: Make Python bindings Schedd constructor location_ad argument optional", "description": "<blockquote>\nThe <code>Schedd</code> constructor is an overloaded function with two signatures,\n<div class=\"code\">\n<pre class=\"code\">    __init__(_object* self)\n    __init__(_object* self, ClassAdWrapper location_ad)\n</pre></div>\n\nThe intent is that in the first form, it finds the local schedd, and in the other form, it contacts a remote schedd. This works, but because the location ad is required, if you're writing a wrapper function where someone may or may not pass in a location ad, you have to do something like this:\n<div class=\"code\">\n<pre class=\"code\">def get_schedd(location_ad = None):\n    if location_ad is None:\n        return Schedd()\n    else:\n        return Schedd(location_ad)\n</pre></div>\n\ninstead of the more convenient\n<div class=\"code\">\n<pre class=\"code\">def get_schedd(location_ad = None):\n    return Schedd(location_ad)\n</pre></div>\n\nwhich right now emits an error like\n<div class=\"code\">\n<pre class=\"code\">Boost.Python.ArgumentError: Python argument types in\n    Schedd.__init__(Schedd, NoneType)\ndid not match C++ signature:\n    __init__(_object* self)\n    __init__(_object* self, ClassAdWrapper location_ad)\n</pre></div>\n\n\n<p>I checked another constructor for consistency, <code>Startd</code>, and found a similar problem:\n</p><div class=\"code\">\n<pre class=\"code\">$ python -c \"import htcondor; htcondor.Startd(None)\"\nTraceback (most recent call last):\n  File \"&lt;string&gt;\", line 1, in &lt;module&gt;\n  File \"/home/jkarpel/.python/lib/python3.7/site-packages/htcondor/_lock.py\", line 77, in wrapper\n    rv = func(*args, **kwargs)\nTypeError: No registered converter was able to produce a C++ rvalue of type ClassAdWrapper from this Python object of type NoneType\n</pre></div>\n\nwhich is confusing because the C++ declaration implies that it can take a <code>None</code> as its argument. It must be failing internally, once the <code>None</code> has already been passed through Boost into our code.\n\n<p>In all these cases, passing the location ad as <code>None</code> should work identically to not passing it at all (and it should always be called either <code>ad</code> or <code>location_ad</code>; they are mixed right now (maybe we save that for a later date...)).</p></blockquote>", "remarks": "<blockquote>\nfixed as a side effect of <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7670\" onclick=\"get_ticket_and_populate_wrapper('7670'); return false;\" title=\"Python bindings daemon objects should know their own address\">#7670</a></span></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Oct-05 09:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c6a9681fa9b2f945120a713aef4b428d876d835a\">[61418]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7874\" onclick=\"get_ticket_and_populate_wrapper('7874'); return false;\" title=\"Late materialization jobs that fail SUBMIT_REQUIREMENTS abort schedd\">#7874</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7668\" onclick=\"get_ticket_and_populate_wrapper('7668'); return false;\" title=\"Make Python bindings Schedd constructor location_ad argument optional\">#7668</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7670\" onclick=\"get_ticket_and_populate_wrapper('7670'); return false;\" title=\"Python bindings daemon objects should know their own address\">#7670</a></span>  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Oct-05 09:51", "status": "resolved", "created": "2020-May-28 15:42", "fixed_version": "2020-May-28 15:42", "broken_version": "", "priority": "3", "subsystem": "PythonBinding", "assigned_to": "johnkn", "derived_from": "#7670", "creator": "karpel", "rust": "", "customer_group": "other", "visibility": "public", "notify": "karpel@wisc.edu", "due_date": ""}