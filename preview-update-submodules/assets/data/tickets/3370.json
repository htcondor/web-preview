{"id": 3370, "title": "Ticket #3370: condor_submit attempts (incorrectly) to set remote owner", "description": "<blockquote>\nWhen I do a remote condor_submit:\n\n<p></p><div class=\"verbatim\">\n<pre>condor_submit /home/cse496/bbockelm/projects/condor-ce/src/.submit_15925_REvGfM -debug -remote tusker-ce1.unl.edu -pool tusker-ce1.unl.edu:9619\n</pre></div>\n\n\n<p>I get back the following error:\n\n</p><p></p><div class=\"verbatim\">\n<pre>ERROR: Failed to set Owner=\"bbockelm\" for job 94.0 (13)\n\nERROR: Failed to queue job.\n</pre></div>\n\n\n<p>This is because, on the remote host, I map as a different user (uscmsPool018).  From the schedd log:\n\n</p><p></p><div class=\"verbatim\">\n<pre>12/11/12 20:58:23 schedd: NewCluster rval 94 errno 0\n12/11/12 20:58:23 schedd: NewProc rval 0 errno 0\n12/11/12 20:58:24 SetAttribute security violation: setting owner to \"bbockelm\" when active owner is \"uscmsPool018\"\n</pre></div>\n\n\n<p>It appears that it's really not plausible to \"condor_submit\" to a remote schedd, unless I am missing something.\n\n</p><p>This affects our debugging tools for Condor-CE.  The client is approximately week-old trunk.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Dec-18 07:18:17 by matt:</em> <br/>\n\nTo force the condor_schedd to set the owner based on authenticated identity use +Owner=UNDEFINED in your submit file.\n\n<p></p><hr/>\n<em>2012-Dec-18 09:07:23 by jfrey:</em> <br/>\n\nI propose that condor_submit should set Owner=UNDEFINED whenever -remote or -spool is given on the command line. In a non-spooling condor_submit case, you're likely to run into problems if condor_submit and condor_schedd disagree on the job owner's username. The schedd will be reading and writing the job files as a different user than the one who ran condor_submit. But when the job files are spooled, it's ok for these usernames to be different, as all files are sent over the network. And when submitting to a remote machine, it's much more likely that the usernames will be different.\n\n<p></p><hr/>\n<em>2012-Dec-18 10:11:14 by bbockelm:</em> <br/>\n\nProposal sounds good to me.  I can confirm that adding +Owner=UNDEFINED manually to the submit file also fixes the issue.\n\n<p></p><hr/>\n<em>2012-Dec-18 12:49:10 by tannenba:</em> <br/>\n\njfrey's suggestion above sounds good to me as well, plus it is a tiny/simple change\n\n<p></p><hr/>\n<em>2012-Dec-19 05:48:51 by matt:</em> <br/>\n\n@jfrey what cases stop us from having condor_submit always set Owner=UNDEFINED?\n\n<p>Possibly hostbased auth or special@host mappings (special =? {anonymous, ssl, gsi, condor_pool})\n\n</p><p></p><hr/>\n<em>2012-Dec-19 09:39:12 by jfrey:</em> <br/>\n\nI'm concerned about the non-spooling case where the submitter is expecting to be mapped to their own username, but isn't due to a misconfiguration. The user is likely to run into trouble if the schedd is reading/writing job files as a different user. I'm open to the idea of letting the submission proceed in this case if condor_submit prints a warning.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Mar-14 11:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c740909db7b149e66176ea893662852f1e8e4eb1\">[35159]</a></span>: minor editing of 7.9.5 version history item. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3370\" onclick=\"get_ticket_and_populate_wrapper('3370'); return false;\" title=\"condor_submit attempts (incorrectly) to set remote owner\">#3370</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Mar-04 17:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/717d93f7c74d1bef89911752d93f22f808e2764e\">[35059]</a></span>: condor_submit should allow schedd to set Owner for remote submits. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3370\" onclick=\"get_ticket_and_populate_wrapper('3370'); return false;\" title=\"condor_submit attempts (incorrectly) to set remote owner\">#3370</a></span> When spooling files with condor_submit, set Owner=Undefined in the job ad. This will tell the schedd to set Owner based on the user name that came from the authentication step. When spooling files, there's no need or expectation\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Mar-04 17:26", "status": "resolved", "created": "2012-Dec-11 21:03", "fixed_version": "2012-Dec-11 21:03", "broken_version": "v070800", "priority": "4", "subsystem": "", "assigned_to": "jfrey", "derived_from": "#3275", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "bbockelm@cse.unl.edu, matt@cs.wisc.edu, tstclair@redhat.com", "due_date": ""}