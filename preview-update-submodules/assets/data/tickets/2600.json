{"id": 2600, "title": "Ticket #2600: Use idempotent EC2 RunInstances", "description": "<blockquote>\nThe ec2_gahp still use the trick of creating a keypair for tracking each instance. This means a keypair is created for each instance and users do not have the option of using their own keypair.\n\n<p>AWS implemented an idempotent instance creation in Sept 2010, see <a class=\"external\" href=\"http://aws.typepad.com/aws/2010/09/new-amazon-ec2-feature-idempotent-instance-creation.html\">http://aws.typepad.com/aws/2010/09/new-amazon-ec2-feature-idempotent-instance-creation.html</a>\n\n</p><p>We should be using it.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Jan-04 15:02:24 by matt:</em> <br/>\n\nCommits are in branch master-ec2-idempotent-runinstances-and-tagging\n\n<p>The branch does not have support for ec2_keypair_file, which may be needed before merging to master. ec2_keypair_file should be marked deprecated.\n\n</p><p></p><hr/>\n<em>2012-Jan-17 13:47:18 by tstclair:</em> <br/>\n\nReview Notes:\n\n<p>1.) remove (using namespace std) from a header file [*DONE*]\n\n</p><p>2.) Why not remove the <strong>_keypair</strong> f(n)'s\n\n</p><p></p><hr/>\n<em>2012-Jan-17 13:48:08 by tstclair:</em> <br/>\n\nmarked as pending waiting to chat with ToddT about ssh key issue.\n\n<p></p><hr/>\n<em>2012-Jan-17 13:54:38 by matt:</em> <br/>\n\nRe review note (2) - anticipation that popular opinion will not let ec2_keypair_file die.\n\n<p></p><hr/>\n<em>2012-Feb-08 14:44:31 by tstclair:</em> <br/>\n\nwaiting for master to become V7.9 for merging.  Modifications to add back keypair generation are done.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Feb-08 14:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a9a387a75f697b1409ed5caaa53e856f255ce593\">[30522]</a></span>: Add back support for keypair generation, but keep the state machine ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2600\" onclick=\"get_ticket_and_populate_wrapper('2600'); return false;\" title=\"Use idempotent EC2 RunInstances\">#2600</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2742\" onclick=\"get_ticket_and_populate_wrapper('2742'); return false;\" title=\"Add support for EC2 Instance Resource Tagging\">#2742</a></span>  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jan-17 13:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e436e762cf2f0ce339db7f5d4298c3c6a3890aec\">[29131]</a></span>: Minor updates from review ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2600\" onclick=\"get_ticket_and_populate_wrapper('2600'); return false;\" title=\"Use idempotent EC2 RunInstances\">#2600</a></span> ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2742\" onclick=\"get_ticket_and_populate_wrapper('2742'); return false;\" title=\"Add support for EC2 Instance Resource Tagging\">#2742</a></span>  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jan-04 14:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6b27dc309c22cb7c49038fe80660bfdc8b3a3f3a\">[28979]</a></span>: Documentation for EC2KeyPair and ec2_tag_names, ec2_tag_&lt;name&gt;, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2600\" onclick=\"get_ticket_and_populate_wrapper('2600'); return false;\" title=\"Use idempotent EC2 RunInstances\">#2600</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2742\" onclick=\"get_ticket_and_populate_wrapper('2742'); return false;\" title=\"Add support for EC2 Instance Resource Tagging\">#2742</a></span>  (By Matthew Farrellee )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jan-04 14:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4a5206c07b10380697bdc94eea2328d278c3c6ac\">[28971]</a></span>: Re-implementation of EC2Job using idemponent <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RunInstances\" title=\"Run Instances\">RunInstances</a></span>, removes EC2KeyPairFile support, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2600\" onclick=\"get_ticket_and_populate_wrapper('2600'); return false;\" title=\"Use idempotent EC2 RunInstances\">#2600</a></span>  (By Matthew Farrellee )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2012-Apr-03 10:46", "status": "resolved", "created": "2011-Oct-30 19:53", "fixed_version": "2011-Oct-30 19:53", "broken_version": "v070700", "priority": "4", "subsystem": "Daemons", "assigned_to": "tstclair", "derived_from": "#2150", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu,tstclair@redhat.com", "due_date": ""}