{"id": 3229, "title": "Ticket #3229: total local resources per slot for dynamic slots is always zero", "description": "<blockquote>\nThe total per slot for the local resource has different behaviour than total per slot for cpus|memory|disk. The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TotalSlotCpus\" title=\"Total Slot Cpus\">TotalSlotCpus</a></span> shows number of used cpus for dynamic slots whilst TotalSlot[Local_Resource_Name] is always zero for dynamic slots.</blockquote>", "remarks": "<blockquote>\n<em>2012-Sep-13 18:23:01 by eje:</em> <br/>\n\nREPRO:\n\n<p>Use the following configuration with a local 'gpu' resource configured:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">NUM_CPUS = 2\n\n# configure two 'gpu' resources:\nMACHINE_RESOURCE_NAMES = gpu\nMACHINE_RESOURCE_gpu = 2\n\nSLOT_TYPE_1 = 100%\nSLOT_TYPE_1_PARTITIONABLE = True\nNUM_SLOTS_TYPE_1 = 1\n</pre></div>\n\n\n<p>Spin up the pool, and verify a single p-slot:\n</p><div class=\"code\">\n<pre class=\"code\">$ ccdump condor_status SlotType TotalSlotCpus Cpus TotalSlotGpu Gpu\nPartitionable | 2 | 2 | 2 | 2\n</pre></div>\n\n\n<p>Submit a simple job that uses one cpu and one gpu:\n</p><div class=\"code\">\n<pre class=\"code\">universe = vanilla\ncmd = /bin/sleep\nargs = 600\nshould_transfer_files = if_needed\nwhen_to_transfer_output = on_exit\nrequest_gpu = 1\nqueue 1\n</pre></div>\n\n\n<p>Once the job negotiates, you should see a new dynamic slot.  The d-slot's value for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TotalSlotGpu\" title=\"Total Slot Gpu\">TotalSlotGpu</a></span> is zero.   (we would like it to be the same as Gpu, that is 1):\n</p><div class=\"code\">\n<pre class=\"code\">$ ccdump condor_status SlotType TotalSlotCpus Cpus TotalSlotGpu Gpu\nDynamic | 1 | 1 | 0 | 1\nPartitionable | 2 | 1 | 2 | 1\n</pre></div>\n\n\n<p></p><hr/>\n<em>2012-Sep-13 18:24:49 by eje:</em> <br/>\n\nTEST:\n\n<p>to test fix, run the same repro described above.   However, once the job negotiates, the value for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TotalslotGpu\" title=\"Totalslot Gpu\">TotalslotGpu</a></span> on the dynamic slot should now be 1:\n</p><div class=\"code\">\n<pre class=\"code\">$ ccdump condor_status SlotType TotalSlotCpus Cpus TotalSlotGpu Gpu\nDynamic | 1 | 1 | 1 | 1\nPartitionable | 2 | 1 | 2 | 1\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 18:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/098cd7e33b818768483d5a7efbb15dfbe740b651\">[33336]</a></span>: ===VersionHistory:Completed=== ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3229\" onclick=\"get_ticket_and_populate_wrapper('3229'); return false;\" title=\"total local resources per slot for dynamic slots is always zero\">#3229</a></span>  (By Erik Erlandson )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 18:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/81909a98bc87b2f509aaef753b7c942066987340\">[33335]</a></span>: Fill values for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TotalSlotXxx\" title=\"Total Slot Xxx\">TotalSlotXxx</a></span> from configurable resources on dynamic slots in a way consistent with standard resources such as <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TotalSlotCpus\" title=\"Total Slot Cpus\">TotalSlotCpus</a></span> ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3229\" onclick=\"get_ticket_and_populate_wrapper('3229'); return false;\" title=\"total local resources per slot for dynamic slots is always zero\">#3229</a></span>  (By Erik Erlandson )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Sep-13 18:29", "status": "resolved", "created": "2012-Sep-13 12:44", "fixed_version": "2012-Sep-13 12:44", "broken_version": "", "priority": "3", "subsystem": "Daemons", "assigned_to": "eje", "derived_from": "", "creator": "eje", "rust": "", "customer_group": "other", "visibility": "public", "notify": "eje@cs.wisc.edu, tstclair@redhat.com", "due_date": ""}