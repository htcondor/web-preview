{"id": 7007, "title": "Ticket #7007: Add Box multifile transfer plugin", "description": "<blockquote>\nNow that we have OAuth tokens and the multifile transfer plugin system, we should make a few file transfer plugins that use these features to give users an easy mechanism for transferring files from/to their varied storage providers. This ticket is for one of the first implementations using Box.\n\n<p>It's hard to tell if this is a typical workflow for storage provider API, but here's how it works for Box:\n\n</p><p></p><ol>\n<li>The user specifies in their <code>transfer_input_files</code> a URL that specifies the token and provider names in the scheme and then the path to a file in their Box account. For example, <code>transfer_input_files = (foo+)box://htcondor_files/input.tar.gz</code> would use my Box token (optionally named \"foo\") to pull the file <code>input.tar.gz</code> from the <code>htcondor_files</code> folder in my Box account.\n</li><li>The Box file transfer plugin uses the specified Box token to query the Box folder and file API endpoints to find the file id for each file given by the user, then uses the file ids to download the files to the user's sandbox.\n</li></ol>\n\n<p>Traversing the user's account to find the right file id does add time to how long the plugin has to run, especially if the user's file is many folders deep with many files in each folder to iterate over. Is this the case with most storage provider APIs?\n\n</p><p>This first implementation is for download only, upload capability will be added later.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Apr-18 10:04:49 by jpatton:</em> <br/>\n\nThe first iteration <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9b41f31193572403939b5000cde7b908da6d9b78\">[56663]</a></span> does require python-requests to be installed on the execute machine. Since it's not C++, it has been placed in <a class=\"file\" href=\"rlog?f=src/condor_scripts/box_plugin\">/src/condor_scripts/box_plugin</a> .\n\n<p></p><hr/>\n<em>2019-Apr-19 14:37:19 by jpatton:</em> <br/>\n\nTurns out that the output of \"&lt;plugin&gt; -classad\" must use old style <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>. Fixed in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/79b4bb1f5b64dd4aaa839bfa0396f91a61debfed\">[56669]</a></span>.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7085\" onclick=\"get_ticket_and_populate_wrapper('7085'); return false;\" title=\"Add uploads to Box multifile transfer plugin\">#7085</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd uploads to Box multifile transfer plugin</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7136\" onclick=\"get_ticket_and_populate_wrapper('7136'); return false;\" title=\"Add Google Drive multifile transfer plugin\">#7136</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd Google Drive multifile transfer plugin</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-31 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/648590c00ba30c29568d87ba3b48c61030f842c5\">[57017]</a></span>: Adding version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7007\" onclick=\"get_ticket_and_populate_wrapper('7007'); return false;\" title=\"Add Box multifile transfer plugin\">#7007</a></span>  (By Jason Patton )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-09 18:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/87ec2d8ed1500043f1cebf85c9528b6e6ad52216\">[56835]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7007\" onclick=\"get_ticket_and_populate_wrapper('7007'); return false;\" title=\"Add Box multifile transfer plugin\">#7007</a></span>) Package box_plugin in RPMs and debs  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Apr-19 14:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/79b4bb1f5b64dd4aaa839bfa0396f91a61debfed\">[56669]</a></span>: Fixing -classad output of box_plugin <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7007\" onclick=\"get_ticket_and_populate_wrapper('7007'); return false;\" title=\"Add Box multifile transfer plugin\">#7007</a></span>  (By Jason Patton )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Apr-18 10:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9b41f31193572403939b5000cde7b908da6d9b78\">[56663]</a></span>: Adding first iteration of Box file transfer plugin <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7007\" onclick=\"get_ticket_and_populate_wrapper('7007'); return false;\" title=\"Add Box multifile transfer plugin\">#7007</a></span>  (By Jason Patton )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-May-31 10:12", "status": "resolved", "created": "2019-Apr-18 09:23", "fixed_version": "2019-Apr-18 09:23", "broken_version": "", "priority": "2", "subsystem": "FileTransfer", "assigned_to": "jpatton", "derived_from": "#6859", "creator": "jpatton", "rust": "", "customer_group": "scitokens", "visibility": "public", "notify": "coatsworth@cs.wisc.edu,tannenba@cs.wisc.edu,bbockelman@morgridge.org", "due_date": ""}