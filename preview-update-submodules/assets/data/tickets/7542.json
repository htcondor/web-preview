{"id": 7542, "title": "Ticket #7542: SLOT_TYPE_N configuration works START, not for RANK, etc", "description": "<blockquote>\nCHTC tried to use a <code>SLOT_TYPE_&lt;n&gt;_RANK</code> to have different rank expressions for different slot types, but all slots ended up with either the default rank expression or 0. This is because there is a bug in the code that loads <code>SLOT_TYPE_&lt;N&gt;</code> overrides for any of the standard policy knobs - the code repeatedly loads START, while looping through a table of knob names.\n\n<p>here is the list:\n\n</p><p></p><pre>    SUSPEND, CONTINUE, PREEMPT, KILL,\n    SUSPEND_VANILLA, CONTINUE_VANILLA, PREEMPT_VANILLA, KILL_VANILLA,\n    WANT_SUSPEND, WANT_VACATE,\n    WANT_HOLD, WANT_HOLD_REASON, WANT_HOLD_SUBCODE,\n    WANT_SUSPEND_VANILLA, WANT_VACATE_VANILLA,\n    CLAIM_WORKLIFE, MaxJobRetirementTime, MachineMaxVacateTime,\n    PERIODIC_CHECKPOINT, RunBenchmarks, Rank,\n    START_BACKFILL, EVICT_BACKFILL, FetchWorkDelay,\n    HIBERNATE, Unhibernate,\n    SlotWeight, IsOwner, CpuBusy,</pre>\n</blockquote>", "remarks": "<blockquote>\n<em>2020-Mar-16 16:20:33 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>This change looks good.\n</p><hr/>\n<em>2020-Apr-10 07:43:03 by tim:</em> <br/>\n\nBulk change of target version from v080808 to v080809 using ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-21 12:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/aaa85b7edad7854308d925d88a799982217e2bfa\">[59431]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7553\" onclick=\"get_ticket_and_populate_wrapper('7553'); return false;\" title=\"Collector can hang when a port scanner probes it\">#7553</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7521\" onclick=\"get_ticket_and_populate_wrapper('7521'); return false;\" title=\"p-slot child rollup should contain evaluated d-slot values\">#7521</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7542\" onclick=\"get_ticket_and_populate_wrapper('7542'); return false;\" title=\"SLOT_TYPE_N configuration works START, not for RANK, etc\">#7542</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7605\" onclick=\"get_ticket_and_populate_wrapper('7605'); return false;\" title=\"condor_gpu_discovery crashes on PowerPC\">#7605</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7360\" onclick=\"get_ticket_and_populate_wrapper('7360'); return false;\" title=\"macro default does not allow - character and workaround is broken\">#7360</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7591\" onclick=\"get_ticket_and_populate_wrapper('7591'); return false;\" title=\"preempting claim in a GPU slot attempts to add another GPU and fails\">#7591</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7479\" onclick=\"get_ticket_and_populate_wrapper('7479'); return false;\" title=\"MAX_PROCD_LOG does not honor units suffix\">#7479</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Mar-09 15:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1232dd8b6625d26790aca153aa452cba31cafd15\">[59105]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7542\" onclick=\"get_ticket_and_populate_wrapper('7542'); return false;\" title=\"SLOT_TYPE_N configuration works START, not for RANK, etc\">#7542</a></span>, SLOT_TYPE_&lt;N&gt; config works for STARTD, but not RANK or other policy knobs. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Apr-21 12:09", "status": "resolved", "created": "2020-Mar-09 11:31", "fixed_version": "2020-Mar-09 11:31", "broken_version": "v080000", "priority": "3", "subsystem": "", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "", "due_date": ""}