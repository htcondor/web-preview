{"id": 6339, "title": "Ticket #6339: Don't EXCEPT() when setting NETWORK_INTERFACE to an IPv6 address.", "description": "<blockquote>\nWhen looking for the scope ID of an IPv6 address, HTCondor unconditionally attempts to create a condor_sockaddr from the interface's address.  This will fail because condor_sockaddr refuses to create addresses of types we don't know how to use (everything except AF_INET, AF_INET6, and AF_UNIX).  Instead, since we're looking for an IPv6-specific thing anyway, check to see if the interface is IPv6 before doing anything with.</blockquote>", "remarks": "<blockquote>\n<em>2017-Jul-11 12:31:15 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong>:  Why keep iterating <code>ifa</code> after finding a result?  Or maybe a better question is, in what case would there be multiple matches between <code>addr</code> and the retreived <code>ifaddrs</code>, and do we always want to return the scope from the last match?\n\n<p></p><hr/>\n<em>2017-Jul-11 13:47:39 by tlmiller:</em> <br/>\n\nThe code originally did return immediately after finding a result.  A commit in 2014 fixed the resulting memory leak (ifaddr is dynamically allocated), but neglected to break out of the loop when it obtained the first result.  I'll insert a break for clarity.\n\n<p></p><hr/>\n<em>2017-Jul-11 16:16:03 by zmiller:</em> <br/>\n\nAre you adding the break; in a separate ticket?\n\n<p></p><hr/>\n<em>2017-Jul-11 16:33:50 by tlmiller:</em> <br/>\n\nSee <span class=\"chng\"><a href=\"/404.html\">[51584]</a></span>.\n\n<p></p><hr/>\n<em>2017-Jul-11 19:20:21 by zmiller:</em> <br/>\n\nI was just following up... I'm guessing you hadn't \"git push\"ed when I wrote my remark, even the the ticket was resolved.  No big deal and this is all resolved.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-11 13:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d53d437eb6bd587495c64f6b4bf1c3580527027a\">[51856]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6338\" onclick=\"get_ticket_and_populate_wrapper('6338'); return false;\" title=\"Reverse resolututions should never return the IP address as a string\">#6338</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6339\" onclick=\"get_ticket_and_populate_wrapper('6339'); return false;\" title=\"Don't EXCEPT() when setting NETWORK_INTERFACE to an IPv6 address.\">#6339</a></span>) Release notes are all that's needed for these bugfixes.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-11 13:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9ba23a1d905a086ecf4546218137dd7c9980ca9b\">[51854]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6339\" onclick=\"get_ticket_and_populate_wrapper('6339'); return false;\" title=\"Don't EXCEPT() when setting NETWORK_INTERFACE to an IPv6 address.\">#6339</a></span>) Insert missing break for clarity after code review.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-07 14:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fbdeb85beef23cc7b2d62380d45e72c4911cfb51\">[51837]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6339\" onclick=\"get_ticket_and_populate_wrapper('6339'); return false;\" title=\"Don't EXCEPT() when setting NETWORK_INTERFACE to an IPv6 address.\">#6339</a></span>) Only check for scope IDs on interfaces with IPv6 addresses.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Jul-11 19:20", "status": "resolved", "created": "2017-Jul-07 14:13", "fixed_version": "2017-Jul-07 14:13", "broken_version": "", "priority": "2", "subsystem": "Libs", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu, zmiller@cs.wisc.edu", "due_date": ""}