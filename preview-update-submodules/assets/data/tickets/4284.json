{"id": 4284, "title": "Ticket #4284: Improve synchronization of the job log.", "description": "<blockquote>\nFor updates, there's no reason to use fsync (which sync's data and metadata) on the job_queue.log; only fdatasync (which only sync's data) is really needed.\n\n<p>The metadata probably only needs to be synchronized on rotation...\n\n</p><p>...speaking of which, our current code for job_queue.log rotation is not safe.  We use rename() to rotate the file; there's no guarantee which copy of the data is in which file after a crash.  To make sure the rename persists, we need to call fsync on the directory to make sure the directory metadata is on disk.</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Mar-29 14:42:17 by bbockelm:</em> <br/>\n\nMust have hit submit twice; duplicate of <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4283\" onclick=\"get_ticket_and_populate_wrapper('4283'); return false;\" title=\"Improve synchronization of the job log.\">#4283</a></span>.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2014-Aug-04 11:38", "status": "abandoned", "created": "2014-Mar-28 09:10", "fixed_version": "2014-Mar-28 09:10", "broken_version": "", "priority": "4", "subsystem": "DaemonsSubmitNode", "assigned_to": "", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}