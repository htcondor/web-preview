{"id": 2862, "title": "Ticket #2862: Schedd should collect statistics on sub-sets of completed jobs.", "description": "<blockquote>\nNow that we have statitics on completed/failed jobs in the SCHEDD. we would like to be able to collect the same sorts of statistics on subsets of the jobs.  In particular we would like to have separate numbers for local vs. flocked jobs. or statistics for particular users.\n\n<p>In order to accomplish this.  I propose to add a new parameter that will enable the administrator to define a separate sets of schedd statistics with a prefix for each of the statistics values, and a <span class=\"quote\">ClassAd</span> expression that will define whether a job should be counted in that set of statistics.\n\n</p><p>a new set of params that match the pattern SCHEDD_COLLECT_STATS_FOR_(.+) will define the statistics set.  the last part of the param name will be used as a prefix for the attributes published in that set.  The value of the param will be a <span class=\"quote\">ClassAd</span> expression that evaluates to a boolean value against a completed job ad.  TRUE will cause that job to be counted in that set.\n\n</p><p>So, for instance.\n</p><div class=\"verbatim\">\n<pre>SCHEDD_COLLECT_STATS_FOR_GLIDEIN = regexp(\"^glidein\",RemoteHost)\n</pre></div>\n\nwould define a statistics set having the prefix 'Glidein' that would include statistics for any job whose <span class=\"quote\">RemoteHost</span> value begins with the text \"glidein\".\n\n<p>As a future task, It might also be nice to create open-ended sets of stats pools - where the prefix would contain the string valued result of the class ad Expression.  so\n</p><div class=\"verbatim\">\n<pre>SCHEDD_COLLECT_STATS_BY_USER = User\n</pre></div>\n\nwould make a separate set of statistics prefixed with \"User_???_\" for each unique value of the class-ad attribute User.</blockquote>", "remarks": "<blockquote>\n<em>2012-Mar-19 12:58:15 by nwp:</em> <br/>\n\n<strong>CODE REVIEW</strong>\nReviewed by Nathan Panike.\n\n<p></p><hr/>\n<em>2012-Mar-19 15:33:52 by johnkn:</em> <br/>\n\nNote: code for SCHEDD_COLLECT_STATS_FOR_xxx config value is complete and reviewed.  SCHEDD_COLLECT_STATS_BY_xxx is incomplete.\n\n<p></p><hr/>\n<em>2012-Apr-17 13:57:24 by johnkn:</em> <br/>\n\ncheckin <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c7afc6d570f879f5df455d66950bd5e7689411ff\">[31678]</a></span> adds SCHEDD_CREATE_STATS_BY_XXX and SCHEDD_EXPIRE_STATS_BY_xxx config variables to 7.9.0\n\n<p></p><hr/>\n<em>2012-Nov-29 08:55:26 by nwp:</em> <br/>\n\nSee derived tickets for associated commits.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3344\" onclick=\"get_ticket_and_populate_wrapper('3344'); return false;\" title=\"SCHEDD_COLLECT_STATS_FOR_xxx\">#3344</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nSCHEDD_COLLECT_STATS_FOR_xxx</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3345\" onclick=\"get_ticket_and_populate_wrapper('3345'); return false;\" title=\"SCHEDD_COLLECT_STATS_BY_xxx\">#3345</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nSCHEDD_COLLECT_STATS_BY_xxx</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2014-Aug-26 14:54", "status": "resolved", "created": "2012-Mar-05 13:15", "fixed_version": "2012-Mar-05 13:15", "broken_version": "", "priority": "2", "subsystem": "Daemons", "assigned_to": "johnkn", "derived_from": "#2197", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}