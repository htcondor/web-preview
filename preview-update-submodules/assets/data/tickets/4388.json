{"id": 4388, "title": "Ticket #4388: Machines with more than 9 dynamic slots fail to start jobs on Windows", "description": "<blockquote>\n<a class=\"external\" href=\"https://lists.cs.wisc.edu/archive/htcondor-users/2014-May/msg00088.shtml\">Alex in htcondor-users reports</a> that jobs are trying to start on slots 10 through 32, but get killed immediately due to a 10054 error. It looks like the user used to run these jobs ( condor-reuse-slot1_XX ) cannot be created, thus resulting in permission errors. Windows usernames appear to have a limit of 20chars, which looks like it's causing the 21-character condor username to fail ( condor-reuse-slot1_X is OK but condor-reuse-slot1_XX is not ).\n\n<p>The proposed fix is to simply get rid of the word \"reuse\", so that the logins will look like condor-slotX_YY, and thus have plenty of space.  The only small downside is sites that upgrade from an older release of HTCondor may end up with abandoned (but disabled) accounts on their system with the old name.</p></blockquote>", "remarks": "<blockquote>\n<em>2014-May-29 14:43:17 by tannenba:</em> <br/>\n\nFor folks running HTCondor older than v8.2.0, some potential work-around ideas (warning! I have not tested these work-arounds...):\n\n<p><span class=\"subsubsection\"></span></p><h4>Idea 1</h4>\nCreate a set of static slot local user accounts (SLOT1_USER=xxxx etc) in condor_config as <a class=\"external\" href=\"http://research.cs.wisc.edu/htcondor/manual/v8.0/3_6Security.html#sec:RunAsNobody\">outlined in the manual</a> and use <code>condor_store_cred</code> to stash the passwords for these accounts.  This way HTCondor will simply use the account created by the admin instead of trying to dynamically create an account.\n\n<p></p><pre>   OR\n</pre>\n\n<p><span class=\"subsubsection\"></span></p><h4>Idea 2</h4>\nIf the user is willing to use a short slot prefix name than \"slot\" in their pool, that could solve the issue.  For instance, set in condor_config\n\n<p></p><pre>   STARTD_RESOURCE_PREFIX = sl\n</pre>\n\n<p>which will result in condor_status show <code>sl1@foo.com</code>, <code>sl2@foo.com</code>, etc. But will also result in the login name being shorter, e.g. condor-reuse-sl1_XX.\n\n</p><p></p><pre>   OR\n</pre>\n\n<p><span class=\"subsubsection\"></span></p><h4>Idea 3</h4>\nIn condor_config set\n\n<p></p><pre>   REUSE_CONDOR_RUN_ACCOUNT = False\n</pre>\n\n<p>This will make HTCondor create a new account for every job (and delete it upon job completion).   The login created will be <code>condor-run-XXX</code>, where XXX is the pid of the condor_starter.  This is few enough characters to avoid the problem.  However, constantly creating and destroying accounts with every job could a) be slower than enabling/disabling the same account, and b) creating/destroying accounts could potentially bloat the registry over many many months.\n\n</p><p></p><hr/>\n<em>2014-Jun-13 10:40:02 by tim:</em> <br/>\n\n<strong>Code Review:</strong> It's good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-11 14:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d7b94aab9c890599718540b790aa5c8a87dadbb7\">[40398]</a></span>: change windows.tex to account for change from condor-reuse- to condor- for default slot username. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4388\" onclick=\"get_ticket_and_populate_wrapper('4388'); return false;\" title=\"Machines with more than 9 dynamic slots fail to start jobs on Windows\">#4388</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-09 10:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1bffeb2a16baac97f6e6158c5c20e9994d2044a7\">[40364]</a></span>: Enhance version history item and remove a usage of the no-longer-used 'condor-reuse-slot&lt;N&gt;' user name <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4388\" onclick=\"get_ticket_and_populate_wrapper('4388'); return false;\" title=\"Machines with more than 9 dynamic slots fail to start jobs on Windows\">#4388</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-29 15:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ce5b19015d54263f5d2d33efeb9e940c97d75b50\">[40275]</a></span>: Version history entry for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4388\" onclick=\"get_ticket_and_populate_wrapper('4388'); return false;\" title=\"Machines with more than 9 dynamic slots fail to start jobs on Windows\">#4388</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-29 14:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0b8c6603f08f36f65fea6606d65a2badc114f922\">[40274]</a></span>: Shorten login name of condor reuse run account on Windows. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4388\" onclick=\"get_ticket_and_populate_wrapper('4388'); return false;\" title=\"Machines with more than 9 dynamic slots fail to start jobs on Windows\">#4388</a></span>  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Jun-13 10:40", "status": "resolved", "created": "2014-May-29 14:21", "fixed_version": "2014-May-29 14:21", "broken_version": "v070600", "priority": "2", "subsystem": "Win32", "assigned_to": "johnkn", "derived_from": "", "creator": "tannenba", "rust": "", "customer_group": "users", "visibility": "public", "notify": "achubaty@sfu.ca, tannenba@cs.wisc.edu", "due_date": ""}