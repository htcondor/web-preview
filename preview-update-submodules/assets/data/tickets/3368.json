{"id": 3368, "title": "Ticket #3368: Red Hat linuxes fail to stop the condor service on shutdown", "description": "<blockquote>\nThe beginning of <a class=\"file\" href=\"rlog?f=src/condor_examples/condor.init\">/src/condor_examples/condor.init</a> has the lines\n\n<p></p><div class=\"code\">\n<pre class=\"code\"># The program being managed\nprog=condor_master\n\nlockfile=/var/lock/subsys/$prog\n</pre></div>\n\n\n<p>The end result is that any redhattish linux will not stop\nHTCondor with the shutdown script, because the\nname of the lock file <code>/var/lock/subsys/condor_master</code>\ndoes not match the <code>/var/lock/subsys/condor</code> that the /etc/rc.d/rc\nscript is looking for on shutdown.  The rc script concludes that\nHTCondor is not running because the lock file isn't there and thus\nnever runs the shutdown script.\n\n</p><p>An unpleasant consequence of the above is when a sysadmin does a fast shutdown of the machine, they may get tons of emails from the master claiming\n\n</p><p></p><pre>   \"/usr/sbin/condor_startd\" on \"fnpc2024.fnal.gov\" died due to signal 6 (Aborted).\n</pre>\n\n<p>resulting from the hard kill coming from the system at the very\nend of shutdown.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Dec-10 14:50:03 by tannenba:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n\n<p>TJ did a code review, all happy</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Dec-10 14:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8c630c8444b45c2bdb6102fe3ddf20a0e44f9c20\">[34336]</a></span>: Fixed condor.init bug preventing stopping of HTCondor on shutdown. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3368\" onclick=\"get_ticket_and_populate_wrapper('3368'); return false;\" title=\"Red Hat linuxes fail to stop the condor service on shutdown\">#3368</a></span> The system shutdown script on Red Hat Linuxes would fail to stop the condor service because the name of the lock file did not match the name of the service, as expected by the rc script.  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Dec-10 14:50", "status": "resolved", "created": "2012-Dec-10 14:21", "fixed_version": "2012-Dec-10 14:21", "broken_version": "v070600", "priority": "3", "subsystem": "Packaging", "assigned_to": "tannenba", "derived_from": "", "creator": "tannenba", "rust": "a23538", "customer_group": "fermi", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}