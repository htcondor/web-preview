{"id": 3111, "title": "Ticket #3111: DAGMan log events do not get written in local universe", "description": "<blockquote>\nLooks like changes in <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=2807\" onclick=\"get_ticket_and_populate_wrapper('2807'); return false;\" title=\"Have DAGMan use a single node job user log file\">#2807</a></span> break DAGMan wrt local universe.  If I run a DAGMan job in local universe, only the submit event gets written.  DAGMan never sees the job execute and complete.  This obviously causes the DAG to stall.</blockquote>", "remarks": "<blockquote>\n<em>2012-Jul-11 14:08:19 by tannenba:</em> <br/>\n\nDo we have any examples where sites run DAGMan as local universe vs scheduler universe?\n\n<p></p><hr/>\n<em>2012-Jul-11 20:38:24 by nwp:</em> <br/>\n\nI stumbled on this when I was testing DAGMan myself, and submitting jobs to local universe.\n\n<p></p><hr/>\n<em>2012-Aug-22 13:42:22 by nwp:</em> <br/>\n\nTurns out local universe is running all the tests in Batlab\n\n<p></p><hr/>\n<em>2012-Aug-22 13:49:00 by tlmiller:</em> <br/>\n\nStrictly speaking, Metronome submits the \"i/o-intensive\" (e.g., checking out source code) jobs on the submit node as the local universe.  (Why?  Because DAGMan jobs run in the scheduler universe, and we don't care how many copies of DAGMan are running... but we do care how much disk I/O we're using.)  More-or-less randomly, the execute node DAG (running in C2) /also/ uses the local universe to run user-defined tasks (e.g., remote_pre).  As a result of the former, the whole run is blocked waiting for the source code (or binaries to test, or whatever), and no remote jobs run.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3316\" onclick=\"get_ticket_and_populate_wrapper('3316'); return false;\" title=\"Spurious newline in condor_submit output\">#3316</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nSpurious newline in condor_submit output</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-12 10:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ec0d965bf397455b61768f446b22e33ee0775deb\">[34076]</a></span>: Remove spurious newline from output <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3316\" onclick=\"get_ticket_and_populate_wrapper('3316'); return false;\" title=\"Spurious newline in condor_submit output\">#3316</a></span> Effects the fix for the issue reported on condor-fw: Date: Fri, 9 Nov 2012 14:15:07 -0600 From: Nathan Panike &lt;nwp@cs.wisc.edu&gt; To: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Cc: Condor Flightworthy &lt;condor-fw@cs.wisc.edu&gt; Subject: Re: [htcondor-fw] condor_submit output\u00a0[...]\n (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-05 11:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d816b946609bd6083898f0110a474a238bc1f5de\">[33277]</a></span>: minor edit and spelling correction for 7.9.1 version history item ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3111\" onclick=\"get_ticket_and_populate_wrapper('3111'); return false;\" title=\"DAGMan log events do not get written in local universe\">#3111</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-31 20:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3b6956f770cdc952e969f8f70102d2898d100d3e\">[33245]</a></span>: Regression test for local universe jobs running under DAGMan <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3111\" onclick=\"get_ticket_and_populate_wrapper('3111'); return false;\" title=\"DAGMan log events do not get written in local universe\">#3111</a></span>  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-31 16:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cd907dd21b57683d334828bc667c5998328e2664\">[33244]</a></span>: Do not clear logs unnecessarily <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3111\" onclick=\"get_ticket_and_populate_wrapper('3111'); return false;\" title=\"DAGMan log events do not get written in local universe\">#3111</a></span> These lines were inserted as part of an attempted fix, and should have been removed before pushing.  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-31 14:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2834e640e7086646048ee2594191e00122ceb99b\">[33239]</a></span>: Fix DAGMan problems in local universe <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3111\" onclick=\"get_ticket_and_populate_wrapper('3111'); return false;\" title=\"DAGMan log events do not get written in local universe\">#3111</a></span> Push down recognition of multiple userlogs into the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=WriteUserLog\" title=\"Write User Log\">WriteUserLog</a></span> class.  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-31 14:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6e9f0ff8343310d15ba97f3c68d2808a91623450\">[33240]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3111\" onclick=\"get_ticket_and_populate_wrapper('3111'); return false;\" title=\"DAGMan log events do not get written in local universe\">#3111</a></span>  (By Nathan W. Panike )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Sep-01 08:21", "status": "resolved", "created": "2012-Jul-05 22:41", "fixed_version": "2012-Jul-05 22:41", "broken_version": "v070900", "priority": "2", "subsystem": "Dag", "assigned_to": "nwp", "derived_from": "#2807", "creator": "nwp", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tannenba@cs.wisc.edu", "due_date": ""}