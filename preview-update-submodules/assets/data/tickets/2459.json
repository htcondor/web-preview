{"id": 2459, "title": "Ticket #2459: CREAM hold message contains garbage characters", "description": "<blockquote>\nWe have observed a number of cases in the UCSD glidein factory where jobs had hold reasons of the following form, where XXXX is replaced by random garbage characters:\n\n<p></p><pre>   \"CREAM error: CREAM_Job_Register Error: XXXXodName=[jobRegister] ErrorCode=[0] Description=[The CREAM service cannot accept jobs at the moment] FaultCause=[Submissions are disabled!] Timestamp=[Wed 07 Sep 2011 17:54:52]\"\n</pre>\n\n<p>When these garbage characters contained (char)255, this caused the schedd to fail to restart, because it couldn't read the transaction log.  This problem was fixed in <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2450\" onclick=\"get_ticket_and_populate_wrapper('2450'); return false;\" title=\"schedd fails to parse its transaction log\">#2450</a></span>.\n\n</p><p>The remaining question is why CREAM hold messages contain these garbage characters.  When the garbage is not there, XXXX = Meth.\n\n</p><p>I believe the message comes from an exception that is caught in thread_cream_job_register():\n\n</p><p></p><pre>    catch(std::exception&amp; ex) {\n        delete cp;\n        for ( AbsCreamProxy::RegisterArrayRequest::iterator it = reqs.begin();\n              it != reqs.end(); it++ ) {\n            delete *it;\n\t}\n        char *msg = escape_spaces(ex.what());\n        for( vector&lt;string&gt;::const_iterator it = reqids.begin();\n             it != reqids.end(); it++ ) {\n\t    result_line = (*it) + \" CREAM_Job_Register\\\\ Error:\\\\ \" + msg;\n            enqueue_result(result_line);\n        }\n        free(msg);\n</pre>\n\n<p></p><pre>        return 1;\n    }\n</pre>\n\n<p>I have not traced it further than that.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Oct-27 13:18:00 by danb:</em> <br/>\n\nIn <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=2592\" onclick=\"get_ticket_and_populate_wrapper('2592'); return false;\" title=\"cream gahp crash\">#2592</a></span> cream_gahp crashes in an exception handler due to memory corruption.  It is not the same exception message that is corrupted in this ticket, but the general symptom seems related.\n\n<p></p><hr/>\n<em>2011-Oct-27 17:13:34 by jfrey:</em> <br/>\n\nThe failure message could also be coming from the second if statement in the for loop after exception catch.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "incident", "last_change": "2013-Jan-30 14:29", "status": "new", "created": "2011-Sep-12 21:13", "fixed_version": "2011-Sep-12 21:13", "broken_version": "v070602", "priority": "5", "subsystem": "", "assigned_to": "jfrey", "derived_from": "#2450", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "isfiligoi@ucsd.edu,dan@hep.wisc.edu", "due_date": ""}