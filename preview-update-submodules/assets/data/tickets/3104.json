{"id": 3104, "title": "Ticket #3104: Crash during file spooling results in schedd releasing job", "description": "<blockquote>\nWhen spooling input files for a job, the schedd creates a child process to do the actual transfer. If the child's exit status is anything other than a normal exit code of 0, the schedd considers the transfer a success and releases the job. This includes if the child process crashes.\n\n<p>The schedd should only consider the transfer a success if the child process's exit status is a normal exit code of 1 (the child's indication of success). In particular, generalJobFilesWorkerThread() returns TRUE for success and FALSE for failure. These values become the child process's exit code. The check of the exit status in spoolJobFilesReaper() and transferJobFilesReaper() needs to be changed.</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2012-Aug-23 14:11:20 by zmiller:</em> <br/>\n\nBulk change of target version from v070802 to v070803 using ./ticket-target-mover.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4328\" onclick=\"get_ticket_and_populate_wrapper('4328'); return false;\" title=\"Failed file transfers can be treated as successful by schedd/shadow\">#4328</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nFailed file transfers can be treated as successful by schedd/shadow</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-02 14:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4e91f6b1b39a61d4dd330f8930fc01405b086869\">[32566]</a></span>: Improve failure detection of file staging in schedd, part 2. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3104\" onclick=\"get_ticket_and_populate_wrapper('3104'); return false;\" title=\"Crash during file spooling results in schedd releasing job\">#3104</a></span> Add parantheses to suppress compiler warning.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-02 13:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6b61c425a7dc057f0c088bb325f511c3965bc29d\">[32564]</a></span>: Improve failure detection of file staging in schedd. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3104\" onclick=\"get_ticket_and_populate_wrapper('3104'); return false;\" title=\"Crash during file spooling results in schedd releasing job\">#3104</a></span> The schedd should consider file transfer successful only if the worker exits with TRUE. If it exits with a signal, that should indicate a failure.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Aug-23 14:11", "status": "resolved", "created": "2012-Jul-02 11:43", "fixed_version": "2012-Jul-02 11:43", "broken_version": "v070800", "priority": "4", "subsystem": "Daemons", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}