{"id": 6475, "title": "Ticket #6475: preen erroneously removes submit digests for active clusters", "description": "<blockquote>\ncondor_preen removes the spooled submit digest files that are created for late materialization job factories while the cluster in which they belong is still active.   This causes late materialization job factories to stop materializing jobs after the schedd is restarted.</blockquote>", "remarks": "<blockquote>\n<em>2018-Jan-23 14:18:05 by tannenba:</em> <br/>\n\nCouple comments:\n\n<p></p><ol>\n<li>The commit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2d16c8c5cea9c2c1b043fe95e4347060f58116ab\">[52771]</a></span> completely breaks condor_preen in v8.7.6, causing it to remove files for active jobs because proc_exists() was modified to always return false.  The only thing saving us from disaster here is v8.7.6 also had another preen bug introduced that caused preen to core dump before it erroneously removed files. Whew!\n\n<p></p></li><li>Why was this ticket resolved without any version history entry?</li></ol>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jan-24 16:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9303b38646f82b54a54d08f5a27c0b6bf6db2f54\">[54174]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ef88b1a49866902b768ee5d0a8091ad843490c4d\">[54172]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/55a55c73b49bdcf58d2cb7d3e39c2fcf59cf4ac6\">[54173]</a></span>, Fixed segfault + overzealous deletion bugs in preen devel (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6521\" onclick=\"get_ticket_and_populate_wrapper('6521'); return false;\" title=\"Optimal preen connections to schedd\">#6521</a></span>) (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6475\" onclick=\"get_ticket_and_populate_wrapper('6475'); return false;\" title=\"preen erroneously removes submit digests for active clusters\">#6475</a></span>)  (By Mark Coatsworth )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jan-24 15:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9b8bc33dd64ed78bac9a6ce8ee22aa8a4cdb3a2d\">[54181]</a></span>: Fixed preen segfault + overzealous deletions in 8.7.6 (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6521\" onclick=\"get_ticket_and_populate_wrapper('6521'); return false;\" title=\"Optimal preen connections to schedd\">#6521</a></span>) (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6475\" onclick=\"get_ticket_and_populate_wrapper('6475'); return false;\" title=\"preen erroneously removes submit digests for active clusters\">#6475</a></span>)  (By Mark Coatsworth )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jan-24 13:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/55a55c73b49bdcf58d2cb7d3e39c2fcf59cf4ac6\">[54173]</a></span>: Fixed overzealous deletion bug in preen stable (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6475\" onclick=\"get_ticket_and_populate_wrapper('6475'); return false;\" title=\"preen erroneously removes submit digests for active clusters\">#6475</a></span>)  (By Mark Coatsworth )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Nov-09 09:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2d16c8c5cea9c2c1b043fe95e4347060f58116ab\">[52771]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6475\" onclick=\"get_ticket_and_populate_wrapper('6475'); return false;\" title=\"preen erroneously removes submit digests for active clusters\">#6475</a></span>, condor_preen erroneously removes submit digests for active clusters ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2018-Jan-23 14:18", "status": "resolved", "created": "2017-Nov-07 12:45", "fixed_version": "2017-Nov-07 12:45", "broken_version": "v080703", "priority": "1", "subsystem": "", "assigned_to": "johnkn", "derived_from": "#6457", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tannenba@cs.wisc.edu tim@cs.wisc.edu coatsworth@cs.wisc.edu", "due_date": ""}