{"id": 7571, "title": "Ticket #7571: use feature : GPUsMonitor disables? other cronjobs", "description": "<blockquote>\nMat reports:\n\n<p>Got an OSG admin who just upgraded from 8.6 to 8.8.8. When he adds use </p><div class=\"code\">\n<pre class=\"code\">feature:gpus</pre></div>\n to his config, his startd_crons stop running.\n\n<p>here's the working condor_config_val output:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">[root@blade-20 condor]# condor_config_val -dump | grep -i cron\nSCHEDD_CRON_NAME =\nSTARTD_CRON_AUTOPUBLISH =\nSTARTD_CRON_CONFIG_VAL = $(RELEASE_DIR)/bin/condor_config_val\nSTARTD_CRON_JOBLIST =  LOCALCHECK\nSTARTD_CRON_LOCALCHECK_EXECUTABLE = $(MODULES)/condor_cron_script.sh\nSTARTD_CRON_LOCALCHECK_JOB_LOAD = 0.2\nSTARTD_CRON_LOCALCHECK_MODE = Periodic\nSTARTD_CRON_LOCALCHECK_PERIOD = 10m\nSTARTD_CRON_LOCALCHECK_PREFIX = LOCALCHECK_\nSTARTD_CRON_MAX_JOB_LOAD = 0.2\nSTARTD_CRON_NAME =\n#\t/etc/condor/config.d/25-cron.config\n</pre></div>\n\n\n<p>and broken:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">[root@blade-20 ~]# condor_config_val -dump | grep -i cron\nSCHEDD_CRON_NAME =\nSTARTD_CRON_AUTOPUBLISH =\nSTARTD_CRON_CONFIG_VAL = $(RELEASE_DIR)/bin/condor_config_val\nSTARTD_CRON_GPUs_MONITOR_EXECUTABLE = $(LIBEXEC)/condor_gpu_utilization\nSTARTD_CRON_GPUs_MONITOR_METRICS = SUM:GPUs, PEAK:GPUsMemory\nSTARTD_CRON_GPUs_MONITOR_MODE = WaitForExit\nSTARTD_CRON_GPUs_MONITOR_PERIOD = 1\nSTARTD_CRON_JOBLIST =  LOCALCHECK GPUs_MONITOR GPUs_MONITOR\nSTARTD_CRON_LOCALCHECK_EXECUTABLE = $(MODULES)/condor_cron_script.sh\nSTARTD_CRON_LOCALCHECK_JOB_LOAD = 0.2\nSTARTD_CRON_LOCALCHECK_MODE = Periodic\nSTARTD_CRON_LOCALCHECK_PERIOD = 10m\nSTARTD_CRON_LOCALCHECK_PREFIX = LOCALCHECK_\nSTARTD_CRON_MAX_JOB_LOAD = 0.2\nSTARTD_CRON_NAME =\n#\t/etc/condor/config.d/25-cron.config\n</pre></div>\n\n\n<p>I also asked him to try replacing use feature:gpus with\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">MACHINE_RESOURCE_INVENTORY_GPUs=$(LIBEXEC)/condor_gpu_discovery -properties $(GPU_DISCOVERY_EXTRA)\nENVIRONMENT_FOR_AssignedGPUs=GPU_DEVICE_ORDINAL=/(CUDA|OCL)//  CUDA_VISIBLE_DEVICES\nENVIRONMENT_VALUE_FOR_UnAssignedGPUs=10000\n</pre></div>\n\n\n<p>i.e. use feature:gpus without use feature:gpusmonitor\nand that did work for him</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Mar-31 10:25:30 by tlmiller:</em> <br/>\n\n<a class=\"external\" href=\"http://login-1.hep.caltech.edu/~jbalcas/StartLog\">http://login-1.hep.caltech.edu/~jbalcas/StartLog</a></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "incident", "last_change": "2020-Mar-31 10:25", "status": "new", "created": "2020-Mar-27 16:34", "fixed_version": "2020-Mar-27 16:34", "broken_version": "v080808", "priority": "4", "subsystem": "", "assigned_to": "matyas", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}