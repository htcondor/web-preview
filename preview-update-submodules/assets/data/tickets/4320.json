{"id": 4320, "title": "Ticket #4320: Slots on GPU machines that have no GPU still need environment set", "description": "<blockquote>\nWhen a slot on a machine with GPUs is NOT assigned any GPUs, environment variables showing the (lack of) assignment must still be set otherwise the job will believe that it has access to ALL of the GPUs.\n\n<p>To generalize this.  An new configuration parameter will define what the value of the environment should be for slots that have no assigned TAG where tag is the resource name (i.e. TAG is GPUs for gpu resources).\n\n</p><p></p><pre>    ENVIRONMENT_VALUE_FOR_UnAssigned&lt;Tag&gt;=&lt;value&gt;\n</pre>\n\n<p>where &lt;Tag&gt; will be GPUs for gpu resources and &lt;value&gt; should be some integer that is not a valid GPU id (according to the CUDA documentation).  10000 is suggested.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-15 11:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4e984c63876992640c3149e65462562a61c47de5\">[40162]</a></span>: manual definition of new knobs and edit 8.1.6 version history item <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4320\" onclick=\"get_ticket_and_populate_wrapper('4320'); return false;\" title=\"Slots on GPU machines that have no GPU still need environment set\">#4320</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-13 16:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/04b6da400b7745c2bd66d0ac942105beff94ca51\">[40119]</a></span>: Version history for <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4320\" onclick=\"get_ticket_and_populate_wrapper('4320'); return false;\" title=\"Slots on GPU machines that have no GPU still need environment set\">#4320</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-18 09:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/75ccbc5da096984bbe91998cc530de0a6f36e836\">[39985]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4320\" onclick=\"get_ticket_and_populate_wrapper('4320'); return false;\" title=\"Slots on GPU machines that have no GPU still need environment set\">#4320</a></span>) set CUDA_VISIBLE_DEVICES, etc in environment of jobs on machines that have GPUs even when the job itself has no GPUs allocated. This requirement is generalized into a new knob: ENVIRONMENT_VALUE_FOR_UnAssigned&lt;tag&gt; which defines the value that will be set into the environment when the slot has\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-May-21 10:49", "status": "defer", "created": "2014-Apr-17 17:09", "fixed_version": "2014-Apr-17 17:09", "broken_version": "v080105", "priority": "5", "subsystem": "", "assigned_to": "johnkn", "derived_from": "#3386", "creator": "johnkn", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "pcouvare@caltech.edu", "due_date": ""}