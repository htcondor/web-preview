{"id": 2221, "title": "Ticket #2221: condor_ssh_to_job fails if /bin/sh is not bash on remote machine", "description": "<blockquote>\n(Dan, Greg said to assign this to you)\n\n<p>When /bin/sh does not link to /bin/bash, condor_ssh_to_job does not work.  This is reproducible in NMI using x86_64_deb_6.0-updated.  On Debian 6 /bin/sh points at /bin/dash (note the 'd').  Here is the error message the client receives:\n\n</p><p></p><div class=\"restricted\">\n<pre>tmp$ condor_ssh_to_job 2274741.0\nslot2@nmi-v030.batlab.cs.wisc.edu: condor_ssh_to_job_sshd_setup failed: /usr/local/condor/libexec/condor_ssh_to_job_sshd_setup: 25: Syntax error: Bad fd number\n</pre>\n</div>I logged into the machine, switched /bin/sh to point to bash (instead of dash) and then condor_ssh_to_job works correctly.\n\n<p>To reproduce this, submit this job to NMI and then try to connect to it using condor_ssh_to_job:\n\n</p><p></p><div class=\"restricted\">\n<pre>Universe   = vanilla\nExecutable = /bin/sleep\nArguments  = 500\nLog        = simple.log\nOutput     = simple.out\nError      = simple.error\nshould_transfer_files   = YES\nwhen_to_transfer_output = ON_EXIT\nRequirements = ( nmi_platform == \"x86_64_deb_6.0-updated\" &amp;&amp; Arch != \"\" &amp;&amp; OpSys != \"\" &amp;&amp; Memory &gt;= 0 ) &amp;&amp; ( TARGET.HasFileTransfer )\nQueue\n</pre>\n</div></blockquote>", "remarks": "<blockquote>\n<em>2011-Jun-09 14:27:10 by kronenfe:</em> <br/>\n\nOh - I didn't investigate when this issue occurred.  The version I know it is broken on is 7.5.6 - but I bet that it's been happening well before that (possibly forever) and it is not a regression in 7.5.6.\n\n<p></p><hr/>\n<em>2011-Jun-29 14:21:31 by danb:</em> <br/>\n\nCommit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eee02161818798a6274c5568f73ff9278a8a5312\">[22341]</a></span> was erroneously flagged as a fix for <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=2235\" onclick=\"get_ticket_and_populate_wrapper('2235'); return false;\" title=\"condor_ssh_to_job does not work on fedora 14\">#2235</a></span>.  It was actually a fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2221\" onclick=\"get_ticket_and_populate_wrapper('2221'); return false;\" title=\"condor_ssh_to_job fails if /bin/sh is not bash on remote machine\">#2221</a></span>.  I edited the commit message in gittrac to at least make the information correct in gittrac.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jun-29 13:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eee02161818798a6274c5568f73ff9278a8a5312\">[22341]</a></span>: Fix for ssh_to_job on systems that link /bin/sh to /bin/dash. ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2221\" onclick=\"get_ticket_and_populate_wrapper('2221'); return false;\" title=\"condor_ssh_to_job fails if /bin/sh is not bash on remote machine\">#2221</a></span> ===VersionHistory=== condor_ssh_to_job did not work on systems using the dash shell for /bin/sh.  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Jun-29 14:22", "status": "resolved", "created": "2011-Jun-09 14:26", "fixed_version": "2011-Jun-09 14:26", "broken_version": "v070506", "priority": "2", "subsystem": "Tools", "assigned_to": "danb", "derived_from": "", "creator": "kronenfe", "rust": "", "customer_group": "other", "visibility": "public", "notify": "gthain@cs.wisc.edu, kronenfe@cs.wisc.edu", "due_date": ""}