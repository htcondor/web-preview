{"id": 6079, "title": "Ticket #6079: CMake cleanup for newer versions of cmake and visual studio", "description": "<blockquote>\nOur cmake scripts currently have several shortcoming that look easy to fix-\n\n<p></p><ol>\n<li>They spew out scary deprecation warnings when using current versions of cmake 3.x, and as a result we tell everyone to only use ancient cmake 2.x versions.\n\n<p></p></li><li>Support for new versions of Visual Studio looks to be a pain in the rear to add, since in several places we look at the explicit version of Visual studio instead of a version range (i.e. anything newer than this version, do this...).\n\n<p></p></li><li>On Windows, we build the condor_utils lib first using just one CPU core.  Once the utils lib is built, we then build everything else using multiple cores. A simple patch would allow the utils lib to build with multiple cores as well.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2017-Jan-25 15:45:32 by tannenba:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n\n<p>Did side-by-side review with johnkn - commit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9a1b7452e59cf7dfe1b43624338d412050f7154d\">[49925]</a></span> fixed warnings in\ncmake 3.x but caused different warning in cmake 2.x on Windows, so\nthis was fixed in commit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/40cfcfc335f0a2b10e82089113d4e5ca6c6c4a32\">[50056]</a></span>.  At this point all looks good,\nso resolving this ticket.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-25 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/40cfcfc335f0a2b10e82089113d4e5ca6c6c4a32\">[50056]</a></span>: Remove uneeded Cmake quoting for Windows that cause warnings. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6079\" onclick=\"get_ticket_and_populate_wrapper('6079'); return false;\" title=\"CMake cleanup for newer versions of cmake and visual studio\">#6079</a></span> The quoting in these rules work for cmake 3.x, but now cause issues in cmake 2.x. Fact is the quotes or these rules themselves are completely reduntant, so best fix is to simply remove them.  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-05 14:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d031f39cd531cd149b01500fee7435b1f523aab0\">[49927]</a></span>: Improve cmake scripts to aid supporting newer Visual Studio versions. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6079\" onclick=\"get_ticket_and_populate_wrapper('6079'); return false;\" title=\"CMake cleanup for newer versions of cmake and visual studio\">#6079</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-05 14:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e34729144b027ef1009c48f9b866575a91d4eee7\">[49926]</a></span>: On Windows, build condor_utils library faster with multiple cores. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6079\" onclick=\"get_ticket_and_populate_wrapper('6079'); return false;\" title=\"CMake cleanup for newer versions of cmake and visual studio\">#6079</a></span> We do this by setting the /MP flag when building source files in condor_utils, so we get task-level parallelism when the utils lib is built on its own first. We do not want to use the /MP other modules, since we already are using\u00a0[...]\n (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-05 14:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9a1b7452e59cf7dfe1b43624338d412050f7154d\">[49925]</a></span>: Get rid of warnings when building with cmake 3.x. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6079\" onclick=\"get_ticket_and_populate_wrapper('6079'); return false;\" title=\"CMake cleanup for newer versions of cmake and visual studio\">#6079</a></span>  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Jan-25 15:46", "status": "resolved", "created": "2017-Jan-05 14:21", "fixed_version": "2017-Jan-05 14:21", "broken_version": "", "priority": "3", "subsystem": "Packaging", "assigned_to": "tannenba", "derived_from": "", "creator": "tannenba", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tannenba@cs.wisc.edu johnkn@cs.wisc.edu", "due_date": ""}