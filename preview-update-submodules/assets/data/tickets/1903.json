{"id": 1903, "title": "Ticket #1903: Temporarily larger JobLeaseDuration", "description": "<blockquote>\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseDuration\" title=\"Job Lease Duration\">JobLeaseDuration</a></span> defaults to 20 minutes, which is a reasonable default for brief, unexpected outages.  But it's not long enough for a longer outage, especially a planned one.  \"We're doing a major rewiring, and the network will be down for the day,\" or \"We're doing a major hardware upgrade on the submit machine\" type outages.  A administrator could benefit from the ability to say, \"Temporarily extend all <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseDurations\" title=\"Job Lease Durations\">JobLeaseDurations</a></span> to X hours from now.\"  At now + X, the old <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseDurations\" title=\"Job Lease Durations\">JobLeaseDurations</a></span> reassert themselves.  Notably, running jobs would also need to respect the updated duration, something not currently done, (see ticket <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=1904\" onclick=\"get_ticket_and_populate_wrapper('1904'); return false;\" title=\"qedit JobLeaseDuration doesn't work on running jobs.\">#1904</a></span>).\n\n<p>Strawman proposal: add <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseNoEarlierThan\" title=\"Job Lease No Earlier Than\">JobLeaseNoEarlierThan</a></span>, which is a timestamp (set to now +X).  In the various locations where either side is considering the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseDuration\" title=\"Job Lease Duration\">JobLeaseDuration</a></span>, if the current time &lt; <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseNoEarlierThan\" title=\"Job Lease No Earlier Than\">JobLeaseNoEarlierThan</a></span>, then the lease is considered still valid\n\n</p><p>Another strawman proposal: <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseIsValid\" title=\"Job Lease Is Valid\">JobLeaseIsValid</a></span>, which defaults to:\n\n</p><p><span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseIsValid\" title=\"Job Lease Is Valid\">JobLeaseIsValid</a></span> = ((<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=LastJobLeaseRenewal\" title=\"Last Job Lease Renewal\">LastJobLeaseRenewal</a></span> + <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseDuration\" title=\"Job Lease Duration\">JobLeaseDuration</a></span>) &gt; <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurrentTime\" title=\"Current Time\">CurrentTime</a></span>) || <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseNoEarlierThan\" title=\"Job Lease No Earlier Than\">JobLeaseNoEarlierThan</a></span> &gt; <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurrentTime\" title=\"Current Time\">CurrentTime</a></span>\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLeaseNoEarlierThan\" title=\"Job Lease No Earlier Than\">JobLeaseNoEarlierThan</a></span> = 0\n\n</p><p>On the up side this is more flexible and potentially allows very clever policies (\"The lease is 20 minutes, except it's 60 minutes between midnight and 1 AM when nightly maintenance takes place.\")  On the down side, it becomes very possible to write a policy so that the schedd and startd will come up with different answers, potentially leaving a job \"running\" when the startd drops it, or having a job return to idle while the startd is still running it (violating the \"once at a time\" promise).  Credit to psilord for mentioned that it should be an expression.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2011-Feb-07 16:07", "status": "new", "created": "2011-Feb-07 14:31", "fixed_version": "2011-Feb-07 14:31", "broken_version": "v070400", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}