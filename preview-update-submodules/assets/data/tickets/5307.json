{"id": 5307, "title": "Ticket #5307: preemption policy Limit_Job_Runtimes likely doesn't work", "description": "<blockquote>\nThe corresponding entry for PREEMPT in src/condor_utils/param_info.in is misspelled:\n\n<p></p><pre>  [$POLICY.LIMIT_JOB_RUNTIMES]\n  friendly_name=Limit job runtimes to 24 hours\n  default : @end\n          MAX_JOB_RUNTIME=24*3600\n          PREMPT=(Activity == \"Busy\") &amp;&amp; ((time() - EnteredCurrentActivity) &gt; $(MAX_JOB_RUNTIME))\n  @end\n  review=?\n</pre>\n\n<p>I would also describe the manual as vague on the policy. It doesn't limit runtimes to MAX_JOB_RUNTIME. It limits individual shadow starts to that time. The naming of \"Always_Run_Jobs\" also doesn't give a naive user a sense of why the two policies might be compatible.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Oct-13 13:13:15 by tpdownes:</em> <br/>\n\nIs there an equivalent to condor_config_val -dump to figure out what a policy corresponds to?\n\n<p></p><hr/>\n<em>2015-Oct-19 17:36:06 by tannenba:</em> <br/>\n\nAgree with everything above.  Besides being unclear about if this limits one run instance of a job or the total run time of the job, the above config does not properly deal with the situation of if the job becomes suspended (which will reset <code>EnteredCurrentActivity</code>).  It also is unclear how this is supposed to behave if the job still has retirement time.\n\n<p>To answer above question, you can view the value of metaknobs with condor_config_val, like so:\n</p><div class=\"code\">\n<pre class=\"code\">\n% condor_config_val use policy\nuse POLICY accepts\n  ALWAYS_RUN_JOBS\n  DESKTOP\n  LIMIT_JOB_RUNTIMES\n  UWCS_DESKTOP\n\n% condor_config_val use policy:limit_job_runtimes\nuse POLICY:LIMIT_JOB_RUNTIMES is\n        MAX_JOB_RUNTIME=24*3600\n        PREMPT=(Activity == \"Busy\") &amp;&amp; ((time() - EnteredCurrentActivity) &gt; $(MAX_JOB_RUNTIME))\n\n</pre></div>\n\n\n<p></p><hr/>\n<em>2016-Apr-01 11:49:21 by tpdownes:</em> <br/>\n\nPlease see my <a class=\"external\" href=\"https://github.com/htcondor/htcondor/pull/9\">pull request</a>\n\n<p></p><hr/>\n<em>2016-Apr-04 15:11:03 by tannenba:</em> <br/>\n\nTJ, could you leave a remark in the ticket about why opted to rejected one of the commits in the pull request (i.e. looks like you only merged in one of the two commits Tom requested pulled) ?    Thanks.\n\n<p></p><hr/>\n<em>2016-Apr-07 10:41:54 by tpdownes:</em> <br/>\n\nThat may be a glitch in how github presents pull requests. I made the second change after the first and, since it showed up in the web interface, I made the assumption that it managed to sneak in on the PR.\n\n<p>But maybe, behind the scenes, it doesn't. They are easy commits so I'd prefer that you cut-and-paste rather than asking for another PR.\n\n</p><p></p><hr/>\n<em>2016-Apr-18 13:53:10 by tim:</em> <br/>\n\n<strong>CODE REVIEW</strong> It is good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-20 10:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b148dffec170c9af8584a0ad79e34697c3443c85\">[48257]</a></span>: version history for <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5307\" onclick=\"get_ticket_and_populate_wrapper('5307'); return false;\" title=\"preemption policy Limit_Job_Runtimes likely doesn't work\">#5307</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5147\" onclick=\"get_ticket_and_populate_wrapper('5147'); return false;\" title=\"condor_advertise -multiple error if first line blank\">#5147</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5575\" onclick=\"get_ticket_and_populate_wrapper('5575'); return false;\" title=\"condor does not properly identify Windows 10 in opsysandver\">#5575</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-01 12:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3925ea1d59e9dedff116018eac5195317f065fdd\">[48152]</a></span>: Resolve CHTC ticket <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5307\" onclick=\"get_ticket_and_populate_wrapper('5307'); return false;\" title=\"preemption policy Limit_Job_Runtimes likely doesn't work\">#5307</a></span> (misspelling in POLICY) [Ticket 5307](https://htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=5307,4) Committer: John (TJ) Knoeller  (By Tom Downes )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Apr-20 10:23", "status": "defer", "created": "2015-Oct-13 13:11", "fixed_version": "2015-Oct-13 13:11", "broken_version": "v080208", "priority": "5", "subsystem": "Unknown", "assigned_to": "johnkn", "derived_from": "", "creator": "tpdownes", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "tannenba@cs.wisc.edu,pcouvare@caltech.edu", "due_date": ""}