{"id": 2398, "title": "Ticket #2398: Setting hold=true when spooling a job's files causes it to fail", "description": "<blockquote>\nIf you put 'hold=true' in your submit file and then submit your job with the -spool or -remote option to condor_submit, the schedd doesn't modify the file paths in the job ad to point at the spool directory. The schedd will then be unable to run the job.\n\n<p>The schedd looks at the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReasonCode\" title=\"Hold Reason Code\">HoldReasonCode</a></span> of a newly-submitted job to determine whether to expect spooling of the job's files. It's expecting the value to be CONDOR_HOLD_CODE_SpoolingInput. But when 'hold=true' appears in the submit file, condor_submit sets <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReasonCode\" title=\"Hold Reason Code\">HoldReasonCode</a></span> to CONDOR_HOLD_CODE_SubmittedOnHold. The subsequent spooling of files releases the job, negating the effect of the hold attribute.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Aug-17 15:03:16 by jfrey:</em> <br/>\n\nFix committed to V7_6-branch for 7.6.3.\n\n<p></p><hr/>\n<em>2011-Aug-17 15:17:36 by zmiller:</em> <br/>\n\n<strong>REVIEW DONE, CODE OKAY FOR STABLE SERIES</strong>\n\n<p>however, i would suggest making a child ticket to fix the actual problem in the development branch.  i agree however that that's a larger change than we would want to make in the stable series.\n\n</p><p></p><hr/>\n<em>2011-Aug-17 21:21:12 by matt:</em> <br/>\n\nSame as <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1005\" onclick=\"get_ticket_and_populate_wrapper('1005'); return false;\" title=\"submit -s overrides hold = true\">#1005</a></span>?\n\n<p></p><hr/>\n<em>2011-Aug-18 08:46:28 by jfrey:</em> <br/>\n\nClosely related to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1005\" onclick=\"get_ticket_and_populate_wrapper('1005'); return false;\" title=\"submit -s overrides hold = true\">#1005</a></span>. The central bug in this ticket is that the job can't run when hold=true and -submit are used together. The patch in this ticket addresses both problems by not allowing this combination of options. As Zach notes, we should consider a better fix that allows both options to be used together.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=2399\" onclick=\"get_ticket_and_populate_wrapper('2399'); return false;\" title=\"Make hold=true work properly when spooling job files\">#2399</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nMake hold=true work properly when spooling job files</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-17 14:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8b303f3656194ff77c1a5fd500034439be75628a\">[26827]</a></span>: Disallow hold=true when spooling job files. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2398\" onclick=\"get_ticket_and_populate_wrapper('2398'); return false;\" title=\"Setting hold=true when spooling a job's files causes it to fail\">#2398</a></span> hold=true conflicts with job-file spooling. Both want to set a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReason\" title=\"Hold Reason\">HoldReason</a></span>. If the wrong <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HoldReason\" title=\"Hold Reason\">HoldReason</a></span> is set, the schedd doesn't modify the paths in the job ad to refer to the spool area. Also, the job ends up in the idle state once spooling completes. Now,\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Aug-23 12:25", "status": "resolved", "created": "2011-Aug-17 13:55", "fixed_version": "2011-Aug-17 13:55", "broken_version": "v070602", "priority": "2", "subsystem": "Unknown", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}