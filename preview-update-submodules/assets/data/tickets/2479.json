{"id": 2479, "title": "Ticket #2479: startd SUSPEND trumps user continue, and user suspend trumps startd CO", "description": "<blockquote>\nSo this may be a bit different then what we had discussed and after some thought the following seems to make the most sense.\n\n<p>STARTD SUSPEND trumps user continue\n\n</p><p>user suspend trumps STARTD CONTINUE\n\n</p><p>Please post comments below.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Sep-20 13:00:43 by matt:</em> <br/>\n\n+1\n\n<p>You don't want the Startd policy CONTINUE trumping the user desire to suspend their job. The user is making a move in a direction to limit resource use on the machine represented by the Startd, instead of trying to use more resources.\n\n</p><p>A middle ground may be to mark the job in such a way that the Startd CONTINUE policy can conditionally follow the user's desire. However, this may be complex as following the user's desire should be the default behavior.\n\n</p><p></p><hr/>\n<em>2011-Sep-23 09:59:16 by tstclair:</em> <br/>\n\nFor the sake of brevity (not opening another ticket) I've also updated the logic to ensure it will try to reconnect when in the SUSPENDED state.  Both items were discussed during FW on 9/19/11\n\n<p></p><hr/>\n<em>2011-Oct-04 16:06:22 by psilord:</em> <br/>\n\nStill no checkins for this ticket. What is it that I'm to review?\n\n<p></p><hr/>\n<em>2011-Oct-04 21:50:06 by tstclair:</em> <br/>\n\nI have no idea why GT is not showing it, but here is the commit\n\n<p><a class=\"external\" href=\"https://github.com/htcondor/htcondor/commit/daa99a035fb59153f1fc3ce086d9b641b5042209\">[27365]</a>\n\n</p><p></p><hr/>\n<em>2011-Oct-10 11:40:42 by psilord:</em> <br/>\n\nIn Resource::eval_continue, if m_bUserSuspended is true, then we don't evaluate the continue expression. How many places is the Resource::eval_continue expression called and do all of them expect this type of behavior?\n\n<p>If I recall, when a job is moving from the claimed/suspended state to the vacating/killing state, the job is first continued in order to send it the killsig (which you can specify in the submit file) so the job can checkpoint or\nclean up or whatever. So, is this behavior still preserved or will the continue\nbe missed, then the KILL timeout is consumed in totality (wasting time), and then ultimately the suspended processes are simply sent SIGKILL?\n\n</p><p></p><hr/>\n<em>2011-Oct-10 13:38:35 by tstclair:</em> <br/>\n\nTesting the vacate route, I've verified it functions correctly.\n\n<p></p><hr/>\n<em>2011-Oct-10 13:54:02 by psilord:</em> <br/>\n\ntstclair states it functions correctly. That was my only concern. Resolving.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Nov-22 12:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a21ced69e0f8cee9db9c5d7a0ed234f0f8ce4a97\">[28400]</a></span>: Update to show suspended jobs in condor_q summary line ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2479\" onclick=\"get_ticket_and_populate_wrapper('2479'); return false;\" title=\"startd SUSPEND trumps user continue, and user suspend trumps startd CO\">#2479</a></span>  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-23 10:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/daa99a035fb59153f1fc3ce086d9b641b5042209\">[27365]</a></span>: <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2479\" onclick=\"get_ticket_and_populate_wrapper('2479'); return false;\" title=\"startd SUSPEND trumps user continue, and user suspend trumps startd CO\">#2479</a></span> Update _suspend &amp; _continue logic to fall in line with expectation. ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2479\" onclick=\"get_ticket_and_populate_wrapper('2479'); return false;\" title=\"startd SUSPEND trumps user continue, and user suspend trumps startd CO\">#2479</a></span> ===VersionHistory:None===  (By Timothy St. Clair )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Oct-10 13:54", "status": "resolved", "created": "2011-Sep-20 08:27", "fixed_version": "2011-Sep-20 08:27", "broken_version": "v070702", "priority": "3", "subsystem": "Daemons", "assigned_to": "psilord", "derived_from": "#2368", "creator": "tstclair", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu, tstclair@redhat.com, tannenba@cs.wisc.edu, psilord@cs.wisc.edu", "due_date": ""}