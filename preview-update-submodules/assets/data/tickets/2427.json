{"id": 2427, "title": "Ticket #2427: condor_check_userlogs appears to be broken", "description": "<blockquote>\n(Note: this is probably a problem in the underlying log reading code, as opposed to the condor_check_userlogs tool itself.  This came up because DAGMan hit a log reading error, and I ran condor_check_userlogs in the course of investigating that.)\n\n<p></p><pre>  [wenger@submit 2660]$ condor_check_userlogs wrapup.log\n  Error monitoring log file wrapup.log: ReadMultipleUserLogs:9004:Error initializing log file wrapup.log|MultiLogFiles:9001:Error (13, Permission denied) opening file wrapup.log for creation or truncation\n  Log outcome: ULOG_NO_EVENT\n  08/26/11 16:39:59 ReadMultipleUserLogs error: Didn't find LogFileMonitor object for log file wrapup.log (2113:8592006)!\n  08/26/11 16:39:59 All log monitors:\nError unmonitoring log file wrapup.log: ReadMultipleUserLogs:9004:Didn't find LogFileMonitor object for log file wrapup.log (2113:8592006)!\n  Log(s) have error(s)\n</pre>\n\n<p>When I ran the 7.6.3 condor_check_userlogs on that same log file, everything was fine.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Aug-26 16:58:32 by wenger:</em> <br/>\n\nOkay, it looks like this is something funky about file permissions -- it looks like maybe the log file reading code can only open the file if you are the owner of it.  Here are the permissions on that log file:\n\n<p></p><pre>  -rw-r--r--  1 bt bt 637 Aug 26 14:27 wrapup.log\n</pre>\n\n<p>condor_check_userlogs fails on that (even though I can look at the file with any other tool).\n\n</p><p>If I just copy the file (in the same directory) I get this:\n\n</p><p></p><pre>  -rw-r--r--  1 wenger wenger 637 Aug 26 16:55 wrapup.log.kent\n</pre>\n\n<p>condor_check_userlogs works fine on that one:\n\n</p><p></p><pre>  [wenger@submit 2660]$ condor_check_userlogs wrapup.log.kent\n  Log event: ULOG_SUBMIT (3807014.0.0) (\"DAG Node: wrapup\")\n   Total submitted: 1; net submitted: 1\n</pre>\n\n<p></p><pre>  Log event: ULOG_EXECUTE (3807014.0.0)\n  Log event: ULOG_JOB_TERMINATED (3807014.0.0)\n   Total submitted: 1; net submitted: 0\n</pre>\n\n<p></p><pre>  Log outcome: ULOG_NO_EVENT\n  Log(s) are okay\n</pre>\n\n<p></p><hr/>\n<em>2011-Aug-26 17:02:11 by wenger:</em> <br/>\n\nOops, the problem isn't ownership, per se, it's that you have to have write permission on a log file to read it:\n\n<p></p><pre>  [wenger@submit 2660]$ chmod 444 wrapup.log.kent\n  [wenger@submit 2660]$ condor_check_userlogs !$\n  condor_check_userlogs wrapup.log.kent\n  Error monitoring log file wrapup.log.kent: ReadMultipleUserLogs:9004:Error initializing log file wrapup.log.kent|MultiLogFiles:9001:Error (13, Permission denied) opening file wrapup.log.kent for creation or truncation\n  Log outcome: ULOG_NO_EVENT\n  08/26/11 17:00:19 ReadMultipleUserLogs error: Didn't find LogFileMonitor object for log file wrapup.log.kent (2113:8593701)!\n  08/26/11 17:00:19 All log monitors:\n  Error unmonitoring log file wrapup.log.kent: ReadMultipleUserLogs:9004:Didn't find LogFileMonitor object for log file wrapup.log.kent (2113:8593701)!\n  Log(s) have error(s)\n</pre>\n\n<p>Okay, I just tried the 7.6.3 condor_check_userlogs on a file I can't write, and I got the same error, so I guess this is nothing new...\n\n</p><p></p><hr/>\n<em>2011-Aug-28 09:11:21 by matt:</em> <br/>\n\nSee <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1745\" onclick=\"get_ticket_and_populate_wrapper('1745'); return false;\" title=\"condor_wait can't open a file for read authorized user\">#1745</a></span> and consider eliminating the write permission requirement.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2011-Aug-28 09:11", "status": "abandoned", "created": "2011-Aug-26 16:43", "fixed_version": "2011-Aug-26 16:43", "broken_version": "v070701", "priority": "1", "subsystem": "Tools", "assigned_to": "", "derived_from": "", "creator": "wenger", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "wenger@cs.wisc.edu, cweiss@cs.wisc.edu, bt@cs.wisc.edu, matt@cs.wisc.edu", "due_date": ""}