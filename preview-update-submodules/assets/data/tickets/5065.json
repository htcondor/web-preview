{"id": 5065, "title": "Ticket #5065: Provide support for immutable job attributes (esp. x509 ones)", "description": "<blockquote>\nSUBMIT_REQUIREMENTS provides a powerful tool for sysadmins - jobs must pass a given expression in order to be accepted in the queue.  This is great for making sure jobs enter the queue in a certain state - but because of <code>condor_qedit</code>, there's no guarantee they stay in that state.\n\n<p>We propose adding a new configuration knobs:\n</p><ul>\n<li><code>IMMUTABLE_JOB_ATTRS</code> a list of attributes provided by the admin that, once they have committed values, cannot be changed.\n</li><li><code>SYSTEM_IMMUTABLE_JOB_ATTRS</code> same as above, but would be hard-coded in the param table by the developers to contain items like <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClusterId\" title=\"Cluster Id\">ClusterId</a></span>, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ProcId\" title=\"Proc Id\">ProcId</a></span>, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyType\" title=\"My Type\">MyType</a></span>, etc.\n</li><li><code>PROTECTED_JOB_ATTRS</code> a list of attributes provided by the admin that, once they have committed values, can only be altered by the queue super-user.\n</li><li><code>SYSTEM_PROTECTED_JOB_ATTRS</code> same as above, but would be hard-coded in the param table by the developers.\n</li></ul>\n\n<p>Example use cases:\n\n</p><p></p><ol>\n<li><strong>Accounting groups</strong>: If <code>SUBMIT_REQUIREMENTS</code> checks the validity of an accounting group (for example, by validating that a given user is indeed a member of a certain unix group), then we shouldn't allow users to change it post-submit.\n</li><li><strong>X509 attributes</strong>: If we implement <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5064\" onclick=\"get_ticket_and_populate_wrapper('5064'); return false;\" title=\"Set x509 job attributes from authenticated socket\">#5064</a></span>, we would automatically set X509/VOMS attributes from cryptographically secure sources (connected socket, delegated proxy).  We shouldn't allow these to be changed later.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Feb-17 15:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7e6d96cb05fd8b326d409937f547a79c12547b43\">[47615]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5065\" onclick=\"get_ticket_and_populate_wrapper('5065'); return false;\" title=\"Provide support for immutable job attributes (esp. x509 ones)\">#5065</a></span>) documentation for immutable and protected job attributes  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-25 16:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bcd16ca97ad21d022894b721d60ed5338512e64c\">[47494]</a></span>: fix broken dprintf's that prevent previous commit to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5065\" onclick=\"get_ticket_and_populate_wrapper('5065'); return false;\" title=\"Provide support for immutable job attributes (esp. x509 ones)\">#5065</a></span> from building on Fedora (and from working correctly on any platform).  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-24 22:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/55305b308a42a2ea0ecb2f7563aba3ae1352d7d6\">[47491]</a></span>: First pass at immutable and protected job attributes. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5065\" onclick=\"get_ticket_and_populate_wrapper('5065'); return false;\" title=\"Provide support for immutable job attributes (esp. x509 ones)\">#5065</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-May-26 08:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/363347daf5c09fbc2355118e82d52b577a9953d1\">[44883]</a></span>: NOTE: THIS PATCH WAS NOT ACCEPTED. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5065\" onclick=\"get_ticket_and_populate_wrapper('5065'); return false;\" title=\"Provide support for immutable job attributes (esp. x509 ones)\">#5065</a></span> Initial suggested patch for immutable job attributes - attributes that cannot be changed once set.  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Feb-18 15:29", "status": "resolved", "created": "2015-May-26 08:04", "fixed_version": "2015-May-26 08:04", "broken_version": "", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "tannenba", "derived_from": "#4490", "creator": "bbockelm", "rust": "", "customer_group": "cern", "visibility": "public", "notify": "bbockelm@cse.unl.edu", "due_date": ""}