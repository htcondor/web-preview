{"id": 1017, "title": "Ticket #1017: Unable to restart collector with condor_restart on remote node", "description": "<blockquote>\nUnable to restart collector remotely by 'condor_restart -subsystem collector\n-name &lt;target hostname&gt;'</blockquote>", "remarks": "<blockquote>\n<em>2009-Dec-02 17:15:07 by zmiller:</em> <br/>\n\nrob, can you attach your patch?\n\n<p>from what you told me, i think this patch will solve the problem short term and i will probably put it in to the stable series (after i see it).  long term though, we want to move away from forcing FQDN to be present in the name so that condor doesn't have to rely on DNS.\n\n</p><p>there is currently hard-coded logic to look for an '@' sign in the name, and if it's present, we query the collector for that name and it actually doesn't matter if whatever comes after the '@' is a real hostname or not.\n\n</p><p>the problem is if there is no '@', then we assume whatever is there IS a valid hostname, and that's where this breaks.  IMHO opinion we should remove this logic so that whatever is specified in name can be a free-form string (although there does need to be a little bit of logic for being able to use a short hostname \"north\" in place of a FQDN, \"north.cs.wisc.edu\".)  however, that change is not something i'd do in the stable series.\n\n</p><p>given the current state of things, i'd probably recommend NOT adding the FQDN if the Name already contains an '@' sign.  otherwise append '@FQDN' to the COLLECTOR_NAME, or just use the hostname if COLLECTOR_NAME is blank.\n\n</p><p></p><hr/>\n<em>2009-Dec-02 18:17:52 by matt:</em> <br/>\n\nWhen I was last in this part of the code I got the impression that DNS is used a lot to assist in the shorthand you mention, north -&gt; north.cs.wisc.edu. I imagine that was from days before regexp in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>. We should probably use that instead these days.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/126/collector_name.patch\">collector_name.patch</a>\n864 bytes added by rrati on 2009-Dec-03 21:03:06 UTC.\n<br/>\nThis patch will append @FQDN to the COLLECTOR_NAME when registering it's daemon ad if the COLLECTOR_NAME doesn't have an @ in it.<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jan-06 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/874ec926ee319f5b667075dcf400c3e56fe37d45\">[16832]</a></span>: Collectors now use $(COLLECTOR_NAME)@FQDN as their name when registering with other collectors. This allows a collector to be restarted remotely, whereas attempting to do so would fail. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1017\" onclick=\"get_ticket_and_populate_wrapper('1017'); return false;\" title=\"Unable to restart collector with condor_restart on remote node\">#1017</a></span>) Committer: Dan Bradley  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jan-06 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/39c851798797d2fadec9a50f28c30e012256e71c\">[16833]</a></span>: Append @FQDN if COLLECTOR_NAME doesn't have an @, otherwise the name used in the daemon ad will be just the COLLECTOR_NAME (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1017\" onclick=\"get_ticket_and_populate_wrapper('1017'); return false;\" title=\"Unable to restart collector with condor_restart on remote node\">#1017</a></span>) Committer: Dan Bradley  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-23 17:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/96531df41f095551e516b34cdeeb75ca85b22833\">[16782]</a></span>: Collectors now use $(COLLECTOR_NAME)@FQDN as their name when registering with other collectors. This allows a collector to be restarted remotely, whereas attempting to do so would fail. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1017\" onclick=\"get_ticket_and_populate_wrapper('1017'); return false;\" title=\"Unable to restart collector with condor_restart on remote node\">#1017</a></span>) Committer: Alan De Smet  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-23 17:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1610769ab1d1202f54d854b59f11d1a0e1134c4c\">[16783]</a></span>: Append @FQDN if COLLECTOR_NAME doesn't have an @, otherwise the name used in the daemon ad will be just the COLLECTOR_NAME (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1017\" onclick=\"get_ticket_and_populate_wrapper('1017'); return false;\" title=\"Unable to restart collector with condor_restart on remote node\">#1017</a></span>) Committer: Alan De Smet  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-23 10:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f7730089f0c74b376d7a621e2976ec4d6a6ec7a2\">[16770]</a></span>: Append @FQDN if COLLECTOR_NAME doesn't have an @, otherwise the name used in the daemon ad will be just the COLLECTOR_NAME (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1017\" onclick=\"get_ticket_and_populate_wrapper('1017'); return false;\" title=\"Unable to restart collector with condor_restart on remote node\">#1017</a></span>)  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-23 10:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ba3f66a8bb58f9c74078a2efaf4817e2dca9a5fa\">[16769]</a></span>: Collectors now use $(COLLECTOR_NAME)@FQDN as their name when registering with other collectors. This allows a collector to be restarted remotely, whereas attempting to do so would fail. (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1017\" onclick=\"get_ticket_and_populate_wrapper('1017'); return false;\" title=\"Unable to restart collector with condor_restart on remote node\">#1017</a></span>)  (By Robert Rati )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Nov-19 07:13", "status": "resolved", "created": "2009-Dec-02 12:36", "fixed_version": "2009-Dec-02 12:36", "broken_version": "v070400", "priority": "2", "subsystem": "Daemons", "assigned_to": "rrati", "derived_from": "", "creator": "rrati", "rust": "", "customer_group": "other", "visibility": "public", "notify": "zmiller@cs.wisc.edu matt@cs.wisc.edu", "due_date": ""}