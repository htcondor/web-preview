{"id": 1677, "title": "Ticket #1677: AIX doesn't build  -> collect2: library libssp_nonshared not found", "description": "<blockquote>\nWhen AIX is building in the nightlies (stable and master), this error happens:\n\n<p></p><div class=\"verbatim\">\n<pre>gcc -I. -I.. -I../.. -I../h -I../condor_includes -I../condor_c++_util\n-I../condor_daemon_client -I../condor_daemon_core.V6 -I../ccb -DHAVE_CONFIG_H\n-DPPC=PPC -DAIX=AIX   -I/scratch/externals/install/krb5-1.4.3-p0/include\n-I/scratch/externals/install/openssl-0.9.8h-p2/include -I/scratch/externals\n/install/globus-4.2.1-p5/include/vendorcc32dbg -DWANT_QUILL\n-DWANT_LEASE_MANAGER -g -DBUILDID=275155  -g  -Wall -W -Wextra -Wfloat-equal\n-Wshadow -Wendif-labels -Wpointer-arith -Wcast-qual -Wcast-align -Wvolatile-\nregister-var -fstack-protector   -DC_COMP_KIND_GCC -DC_COMP_MAJOR_GCC_4\n-DC_COMP_MINOR_GCC_4_2 -DC_COMP_PATCH_GCC_4_2_4 -DWITH_OPENSSL\n-DCOMPILE_SOAP_SSL -I/scratch/externals/install/pcre-7.6/include\n-Wnested-externs -Wstrict-prototypes -Wmissing-prototypes -o stub_gen\ny.tab.o lex.yy.o -lfl -rdynamic -fstack-protector  -lm    -Wl,-berok\n-Wl,-bstatic -lstdc++ -Wl,-bdynamic -lcfg -lodm -lcrypt -lc -static-libgcc\ngcc: unrecognized option '-rdynamic'\ncollect2: library libssp_nonshared not found\n</pre></div>\n\n\n<p>The trouble is in this context, <code>configure.ac</code> should have noticed that\n<code>-fstack-protector</code> was in fact not working, but it is marked as working\nleading to the above problem.\n\n</p><p>I've attached what I think the patch should be, however not only does it not\nwork on the AIX machine itself, but it also breaks other platforms.\n\n</p><p>I'm very confused about how this happens, since the patch changes work fine when converted to a tiny shell script and tested on the various platforms.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Sep-27 16:28:23 by jfrey:</em> <br/>\n\nNot realizing there was a ticket for this, I developed and committed a fix. I tested the change on linux and aix. Pete, what platform(s) did your patch fail on?\n\n<p>As a note, the failure happens at link time, not compile time. The test now does a compile and link, and checks the exit status of the compiler in addition to its output.\n\n</p><p></p><hr/>\n<em>2010-Sep-27 16:38:04 by psilord:</em> <br/>\n\nMy patch failed on the debian machines.\n\n<p></p><hr/>\n<em>2010-Sep-27 16:38:45 by psilord:</em> <br/>\n\nAlso, I hope that all of the flags we test can be tested all the way to link time. Seems a decent fix from my point of view though.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/225/patch.txt\">patch.txt</a>\n705 bytes added by psilord on 2010-Sep-27 16:58:16 UTC.\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Sep-27 16:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e0afa7d89ae3142ac2dec5547ea503b8576f3ab4\">[19063]</a></span>: Fix C_CXX_OPTION macro used in configure.ac. This macro tests whether the given command-line argument is supported by the compiler. This commit fixes two short-comings: 1) The test compiled, but didn't link a test file. Some of the arguments tested are at least partially link-time ones. 2) The test didn't\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Oct-01 14:35", "status": "resolved", "created": "2010-Sep-27 11:55", "fixed_version": "2010-Sep-27 11:55", "broken_version": "v070404", "priority": "1", "subsystem": "Packaging", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "psilord@cs.wisc.edu zmiller@cs.wisc.edu adesmet@cs.wisc.edu jfrey@cs.wisc.edu", "due_date": ""}