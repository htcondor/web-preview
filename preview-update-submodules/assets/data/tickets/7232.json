{"id": 7232, "title": "Ticket #7232: condor_ssh_to_job times out and fails on OSG and locally at CIT", "description": "<blockquote>\nLIGO reports that condor_ssh_to_job always fails to OSG nodes:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">condor_ssh_to_job times out for OSG jobs submitted from ldas-osg.ligo.caltech.edu:\n\n[jclark@ldas-osg] $ condor_ssh_to_job -debug 14788627.0\n08/21/19 13:12:33 SharedPortClient: sent connection request to schedd at &lt;131.215.113.204:9618&gt; for shared port id 1739892_c5c0_3\n08/21/19 13:12:33 SharedPortClient: sent connection request to local schedd for shared port id 1739892_c5c0_3\n08/21/19 13:17:33 condor_read(): timeout reading 21 bytes from local schedd.\n08/21/19 13:17:33 IO: Failed to read packet header\n08/21/19 13:17:33 Failed to get response from schedd\nFailed to get response from schedd\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\nJames adds that this fails for local CIT jobs too.\n\n<p></p><hr/>\n<em>2019-Sep-11 13:39:36 by pfc:</em> <br/>\n\nBall is in James's court to show how to reproduce.\n\n<p></p><hr/>\n<em>2019-Sep-18 13:09:59 by pfc:</em> <br/>\n\nSister issue on the LIGO side: <a class=\"external\" href=\"https://github.com/lscsoft/osg-lvc/issues/72\">https://github.com/lscsoft/osg-lvc/issues/72</a>\n\n<p></p><hr/>\n<em>2019-Oct-29 10:52:50 by pfc:</em> <br/>\n\nI think the order of operations here is:\n\n<p></p><ul>\n<li>condor releases this fix in 8.9.x\n</li><li>LIGO asks OSG to use 8.9.x for its pilots\n</li><li>james re-tests\n</li><li>we fix the next bug/s, if any\n</li></ul>\n\n<p></p><hr/>\n<em>2019-Dec-03 10:27:55 by pfc:</em> <br/>\n\nThis went out in 8.9.4, but requires the startd admin to set:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">CONDOR_SSH_TO_JOB_FAKE_PASSWD_ENTRY = True\n</pre></div>\n\n\n<p>So the ball is now in LIGO's court to ask OSG to deploy this for our pilots.\n\n</p><p></p><hr/>\n<em>2020-Mar-10 10:24:56 by pfc:</em> <br/>\n\nThe ball is now in IGWN's court to test this.  James Clark in particular will try it out, and will send Condor the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=StarterLog\" title=\"Starter Log\">StarterLog</a></span> from the glidein startd if it fails.\n\n<p></p><hr/>\n<em>2020-Mar-24 10:25:09 by pfc:</em> <br/>\n\nThe ball is back in Greg's court to test.\n\n<p></p><hr/>\n<em>2020-May-12 10:26:20 by pfc:</em> <br/>\n\nTim T. can reproduce this at CHTC, so Greg doesn't need <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=StarterLogs\" title=\"Starter Logs\">StarterLogs</a></span> from James right now.\n\n<p></p><hr/>\n<em>2020-May-26 10:30:25 by pfc:</em> <br/>\n\nGreg revealed that this is tangled up in the fact that OSG uses a user job wrapper for LIGO -- we should sort that out as part of solving this.\n\n<p></p><hr/>\n<em>2020-Dec-08 10:47:26 by pfc:</em> <br/>\n\n<a class=\"external\" href=\"https://github.com/lscsoft/osg-igwn/issues/72\">https://github.com/lscsoft/osg-igwn/issues/72</a>\n\n<p></p><hr/>\n<em>2020-Dec-15 10:26:13 by pfc:</em> <br/>\n\nThe ball is in Greg's court to examine James' latest failure logs.\n\n<p></p><hr/>\n<em>2021-Apr-13 10:53:03 by pfc:</em> <br/>\n\nGreg is setting up wrapper-less singularity in GLOW and will test to see if he can find failures.  We await his results.\n\n<p></p><hr/>\n<em>2021-May-10 20:06:41 by pfc:</em> <br/>\n\nMoved to <a class=\"external\" href=\"https://opensciencegrid.atlassian.net/browse/HTCONDOR-485\">https://opensciencegrid.atlassian.net/browse/HTCONDOR-485</a></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7260\" onclick=\"get_ticket_and_populate_wrapper('7260'); return false;\" title=\"LD_PRELOAD a fake getpwnam into sshd for condor_ssh_to_job\">#7260</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nLD_PRELOAD a fake getpwnam into sshd for condor_ssh_to_job</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2021-May-10 20:06", "status": "resolved", "created": "2019-Sep-04 14:17", "fixed_version": "2019-Sep-04 14:17", "broken_version": "v080800", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "", "due_date": ""}