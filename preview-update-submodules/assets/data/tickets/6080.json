{"id": 6080, "title": "Ticket #6080: Supporting MOUNT_UNDER_SCRATCH for Docker universe jobs", "description": "<blockquote>\nOne of the last few nags for Docker on red is the location of /tmp for jobs. The attached patch adds support for MOUNT_UNDER_SCRATCH to Docker jobs.\n\n<p>With EL6, MOUNT_UNDER_SCRATCH mounted job /tmp and /var/tmp under /var/lib/condor/execute. The nodes were partitioned to provide a large amount of space for /var.\n\n</p><p>With EL7+Docker, /tmp and /var/tmp remain inside the container. Jobs writing to /tmp end up using the Docker LVM pool. The pool is fairly small on red and it Docker jobs hang when it fills up.\n\n</p><p>The attached patch takes the directories from MOUNT_UNDER_SCRATCH and converts them to \"--volume\" arguments for docker run, bind mounting them inside the job directory.</p></blockquote>", "remarks": "<blockquote>\nThanks Derek!  Reviewed and pushed into 8.6.1</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/980/docker-mount-under-scratch.patch\">docker-mount-under-scratch.patch</a>\n2034 bytes added by dweitzel on 2017-Jan-05 20:43:09 UTC.\n<br/>\nPatched for Docker Mount under scratch<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-28 11:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2ea6f0b083a23f102a213cdb75c04945fd4f2c23\">[50227]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6080\" onclick=\"get_ticket_and_populate_wrapper('6080'); return false;\" title=\"Supporting MOUNT_UNDER_SCRATCH for Docker universe jobs\">#6080</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-09 16:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1b49bcb432e4dec99fc218eb74cfb7062462abf2\">[49957]</a></span>: In Docker Universe volume mnount MOUNT_UNDER_SCRATCH'ed directories <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6080\" onclick=\"get_ticket_and_populate_wrapper('6080'); return false;\" title=\"Supporting MOUNT_UNDER_SCRATCH for Docker universe jobs\">#6080</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Feb-28 11:49", "status": "resolved", "created": "2017-Jan-05 14:42", "fixed_version": "2017-Jan-05 14:42", "broken_version": "", "priority": "3", "subsystem": "DaemonsExecNode", "assigned_to": "gthain", "derived_from": "", "creator": "dweitzel", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "dweitzel@cse.unl.edu,bbockelm@cse.unl.edu,jthiltges@unl.edu", "due_date": ""}