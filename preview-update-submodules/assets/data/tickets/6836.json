{"id": 6836, "title": "Ticket #6836: event log reader code does not correct strip formatting information", "description": "<blockquote>\nThe event log reader code does not correctly always strip whitespace and other formatting characters that it wrote out when it reads the event log.  This results in situations like the <code>UserNotes</code> field of the submit event changing from \"data\" to \"\\tdata\" when it is written and then read back.\n\n<p>Several events are effected.  The problem is mostly leading whitespace, but there are other problems.  The <code>RemoteError</code> event doesn't remove a trailing : that it adds, and doesn't handle internal whitespace in the name field correctly.\n\n</p><p>This mostly effects the python bindings, since the other clients of the event log reader code don't care that some of the fields are read back incorrectly.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Dec-04 16:42:13 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>(For <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/28924ac57ca2143acfb809d560d6d1326acf485c\">[55823]</a></span>, since the other commit is testing-only.)\n\n</p><p>It looks like the computation at line 1991 should be 'sizeof(daemon_name) + sizeof(execute_host) + 4 + 1', not '2 * sizeof(daemon_name)'.  A better/easier/less-fragile change might be to copy the whole string (e.g., use line.length()) and truncate in the individual places where we still have fixed-length buffers (so that it'll be easier to change them when we need to).\n\n</p><p>Otherwise, looks good.  Thanks for the fix.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-19 12:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/89dc415deff167c99d9227d2ff58c20c1f7f12dc\">[55897]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6816\" onclick=\"get_ticket_and_populate_wrapper('6816'); return false;\" title=\"condor_event reader code does not put mem usage in terminate event ad\">#6816</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6836\" onclick=\"get_ticket_and_populate_wrapper('6836'); return false;\" title=\"event log reader code does not correct strip formatting information\">#6836</a></span>. minor code change from review of <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6836\" onclick=\"get_ticket_and_populate_wrapper('6836'); return false;\" title=\"event log reader code does not correct strip formatting information\">#6836</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-04 13:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3b66e654b530cf67778073c92adbb6cea4842f45\">[55830]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6829\" onclick=\"get_ticket_and_populate_wrapper('6829'); return false;\" title=\"Test (Python) JobEvent class\">#6829</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6836\" onclick=\"get_ticket_and_populate_wrapper('6836'); return false;\" title=\"event log reader code does not correct strip formatting information\">#6836</a></span>) Now that the event reader handles Remote Error correctly, update the job event log test to match.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-03 10:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/28924ac57ca2143acfb809d560d6d1326acf485c\">[55823]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6836\" onclick=\"get_ticket_and_populate_wrapper('6836'); return false;\" title=\"event log reader code does not correct strip formatting information\">#6836</a></span>, event log reader doesn't always strip formatting characters when reading the event log. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2018-Dec-19 13:42", "status": "resolved", "created": "2018-Dec-03 10:10", "fixed_version": "2018-Dec-03 10:10", "broken_version": "v080800", "priority": "3", "subsystem": "Libs", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}