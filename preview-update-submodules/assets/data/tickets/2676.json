{"id": 2676, "title": "Ticket #2676: Using PublicClaimId causes schedd to crash", "description": "<blockquote>\nIn testing my code for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2673\" onclick=\"get_ticket_and_populate_wrapper('2673'); return false;\" title='DAGman should use the \"hold claim\" functionality'>#2673</a></span>, I tried the following submit file:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">executable = /bin/echo\nuniverse = vanilla\narguments = $$([ifThenElse(isUndefined(PublicClaimId),,PublicClaimId)]) $$([ifThenElse(isUndefined(KeepClaimIdle),\\\"KeepClaimIdle undefined\\\",KeepClaimIdle)])\noutput = $(cluster).out\nerror = $(cluster).err\nlog = $(cluster).log\nqueue\n</pre></div>\n\n\n<p>This submit file causes the schedd to crash.\n\n</p><p>The crash dump follows:\n</p><div class=\"code\">\n<pre class=\"code\">Stack dump for process 26349 at timestamp 1322756567 (22 frames)\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(dprintf_dump_stack+0x100)[0x2b780\nc6f1578]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so[0x2b780c67a698]\n/lib64/libpthread.so.0[0x3d0640eb10]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(_ZNK9__gnu_cxx9hashtableISt4pairI\nKSsPN7classad8ExprTreeEESsNS3_17StringCaseIgnHashESt10_Select1stIS6_ENS3_12CaseIgnEqStrESaIS5_EE14_M\n_bkt_num_keyERS2_m+0x2a)[0x2b780c73ccd0]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(_ZNK9__gnu_cxx9hashtableISt4pairI\nKSsPN7classad8ExprTreeEESsNS3_17StringCaseIgnHashESt10_Select1stIS6_ENS3_12CaseIgnEqStrESaIS5_EE14_M\n_bkt_num_keyERS2_+0x2d)[0x2b780c73cd07]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libclassad.so.2(_ZNK9__gnu_cxx9hashtableISt4pairIKSs\nPN7classad8ExprTreeEESsNS3_17StringCaseIgnHashESt10_Select1stIS6_ENS3_12CaseIgnEqStrESaIS5_EE4findER\nS2_+0x1d)[0x2b780cc49801]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libclassad.so.2(_ZNK9__gnu_cxx8hash_mapISsPN7classad\n8ExprTreeENS1_17StringCaseIgnHashENS1_12CaseIgnEqStrESaIS3_EE4findERKSs+0x1d)[0x2b780cc498bf]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libclassad.so.2(_ZNK7classad7ClassAd6LookupERKSs+0x2\na)[0x2b780cc404b8]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libclassad.so.2(_ZNK7classad7ClassAd13LookupInScopeE\nRKSsRPNS_8ExprTreeERNS_9EvalStateE+0x53)[0x2b780cc408e5]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libclassad.so.2(_ZNK7classad7ClassAd12EvaluateAttrER\nKSsRNS_5ValueE+0x40)[0x2b780cc40d28]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libclassad.so.2(_ZNK7classad7ClassAd18EvaluateAttrSt\nringERKSsRSs+0x2f)[0x2b780cc40fa7]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(_ZNK14compat_classad7ClassAd12Loo\nkupStringEPKcPPc+0x49)[0x2b780c7350a1]\ncondor_schedd(_Z18dollarDollarExpandiiPN14compat_classad7ClassAdES1_b+0x16ca)[0x486178]\ncondor_schedd(_Z8GetJobAdiibb+0x12b)[0x486851]\ncondor_schedd(_ZN9Scheduler13contactStartdEP17ContactStartdArgs+0x15c)[0x4bf0c8]\ncondor_schedd(_ZN9Scheduler17checkContactQueueEv+0x61)[0x4bf563]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(_ZN12TimerManager7TimeoutEPiPd+0x\n274)[0x2b780c8183a6]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(_ZN10DaemonCore6DriverEv+0x962)[0\nx2b780c821f20]\n/scratch/nwp/CONDOR_SRC/release_dir/sbin/../lib/libcondor_utils.so(_Z7dc_mainiPPc+0x1e26)[0x2b780c81\n2376]\ncondor_schedd(main+0x56)[0x496f04]\n/lib64/libc.so.6(__libc_start_main+0xf4)[0x3d0581d994]\ncondor_schedd(_ZN10CronJobMgr9JobExitedERK7CronJob+0xc1)[0x45efe9]\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2011-Dec-01 13:46:33 by nwp:</em> <br/>\n\nschedd only crashes in a personal condor, as far as I can see. Otherwise, my job just gets put on hold.\n\n<p></p><hr/>\n<em>2012-Feb-07 16:40:13 by nwp:</em> <br/>\n\nI cannot reproduce this with current master.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2013-Jul-07 13:51", "status": "abandoned", "created": "2011-Dec-01 10:39", "fixed_version": "2011-Dec-01 10:39", "broken_version": "v070704", "priority": "5", "subsystem": "Daemons", "assigned_to": "PitS", "derived_from": "", "creator": "nwp", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}