{"id": 6914, "title": "Ticket #6914: Terminate event can have data transfer numbers reversed", "description": "<blockquote>\nIf the shadow crashes after sending its final update for a completed job to the schedd, the schedd will restart it to ensure that final tasks like writing the terminate event are performed. In this recovery code path, the shadow will reverse the bytes sent and bytes received numbers in the terminate event.\n\n<p>The shadow has a separate code path for writing the terminate event in recovery mode, as many of the data structures it would normally use aren't available. It pulls the relevant numbers from the job ad, instead. The recovery code path was confused about whether the transfer numbers in the job ad are relative to the job or the shadow.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Mar-26 16:40:53 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> : looks good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-15 11:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/51d9e5ba896e5bca035601f77ab5a8da7a67e139\">[56199]</a></span>: Docs for flip of transfer values in job terminate event. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6914\" onclick=\"get_ticket_and_populate_wrapper('6914'); return false;\" title=\"Terminate event can have data transfer numbers reversed\">#6914</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-15 11:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/adb3addb8a2df21b91cf8d845de4ae9c89375103\">[56198]</a></span>: Retried terminate event in shadow had transfer numbers reversed. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6914\" onclick=\"get_ticket_and_populate_wrapper('6914'); return false;\" title=\"Terminate event can have data transfer numbers reversed\">#6914</a></span> When the shadow is restarted to handle final cleanup after job termination, its renewed attempt to write the terminate event reverses the bytes sent and received numbers that it pulls from the job ad.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Mar-26 16:41", "status": "resolved", "created": "2019-Feb-13 16:04", "fixed_version": "2019-Feb-13 16:04", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}