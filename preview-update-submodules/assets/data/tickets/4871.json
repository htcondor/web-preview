{"id": 4871, "title": "Ticket #4871: Allow -notify_user to be set in condor_submit_dag", "description": "<blockquote>\nTom Downes just pointed out that -notify_user is not available on the condor_submit_dag command line.  I'm also wondering whether we should have config macros specific to DAGMan for -notification and -notify_user.</blockquote>", "remarks": "<blockquote>\n<em>2015-Sep-22 13:28:12 by tpdownes:</em> <br/>\n\nI've setup Condor 8.2.6 according to the most recent suggestions from the\nCondor team and have notifications working again. I am curious about the\nbehavior under DAGs, which is not obvious to me from the manual.\n\n<p>Let's say a user submits a DAG with jobs each of which have this in its\nsubmit file:\n\n</p><p>notification = Complete\nnotify_user = thomas.downes@ligo.org\n\n</p><p>Further suppose that DAGMAN_SUPPRESS_NOTIFICATION is not set globally or\nlocally and reverts to its default value of True. The entry in the manual\nfor this variable states \"Defaults to True, implementing behavior in which\nthe user receives one notification email when the condor_dagman job\ncompletes, rather than thousands of notifications from each of the jobs\nsubmitted by condor_dagman.\" This is suggestive that the DAG-handled\nsubmission of a job with notifications enabled will create a notification at\nthe end of the DAG run irrespective of the settings used in\ncondor_submit_dag or in the file.dag.condor.sub file created by\ncondor_submit_dag.\n\n</p><p># RESPONSE FROM KENT\n#Hmm -- the language in the DAGMAN_SUPPRESS_NOTIFICATION documentation\n#is incorrect.  The DAGMAN_SUPPRESS_NOTIFICATION setting doesn't have any effect\n#on whether you get a notification email for the DAGMan job itself, and that defaults to #never.\n\n</p><p>However, empirically, I don't believe that a notification is generated\nunless . I do see the ability to manually set \"-notification\" to\ncondor_submit_dag but I don't see a corresponding \"-notify_user\" setting.\nHow is one supposed to set these values for the DAG?\n\n</p><p>Is this the recommended path to generate a post-DAG notification to a\nuser-specified e-mail address?\n\n</p><p>1. condor_submit_dag -no_submit file.dag\n2. Add 2 lines noted above to job <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> in \"file.dag.condor.sub\"\n3. condor_submit file.dag.condor.sub\n\n</p><p>That works as it ought to, but it seems like there are 2 too many steps.\n\n</p><p># RESPONSE FROM KENT\n#Yes, you're right.  There are two or three problems here:\n#\n<span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=1\" onclick=\"get_ticket_and_populate_wrapper('1'); return false;\" title=\"Another Test\">#1</a></span>) The language in the DAGMAN_SUPPRESS_NOTIFICATION section is misleading.\n<span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=2\" onclick=\"get_ticket_and_populate_wrapper('2'); return false;\" title=\"Get Dan Forrests Std Univ stuff into the code\">#2</a></span>) There should be a way to set notify_user in condor_submit_dag. Probably just adding a -notify_user argument is the way to go.\n<span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=3\" onclick=\"get_ticket_and_populate_wrapper('3'); return false;\" title=\"Customize GitTrac\">#3</a></span>) I wonder if -notification should default to always for DAGs.  Or maybe there should be config macros for -notification and -notify_user?\n\n</p><p></p><hr/>\n<em>2015-Sep-22 13:38:53 by tpdownes:</em> <br/>\n\nIn-person conversation with Kent suggest following actions:\n\n<p></p><ol>\n<li>-notify_user argument to condor_submit_dag\n</li><li>DAGMAN_NOTIFICATION DAG config entry\n</li><li>DAGMAN_NOTIFY_USER DAG config entry\n</li></ol>\n\n<p>Open questions:\n\n</p><p></p><ol>\n<li>Should notification-related DAG config entries actually be keywords in .dag file so that they are more \"user facing\"?\n</li><li>Should condor_dagman \"inherit\" the notification settings of its jobs following some rules? For example, if any job sets notification != Never, to inherit that value for the condor_dagman job?</li></ol>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2015-Sep-22 13:38", "status": "defer", "created": "2015-Feb-06 08:57", "fixed_version": "2015-Feb-06 08:57", "broken_version": "v080303", "priority": "5", "subsystem": "Dag", "assigned_to": "", "derived_from": "", "creator": "wenger", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "wenger@cs.wisc.edu, zmiller@cs.wisc.edu, tpdownes@gravity.phys.uwm.edu,pcouvare@caltech.edu", "due_date": ""}