{"id": 2124, "title": "Ticket #2124: Re-add --blocking-factor to tarball creation code?", "description": "<blockquote>\nPrior to the move to cmake, when using tar to create the tar.gz packages, we used the --blocking-factor option to set a larger blocking factor.  This was found to provide a major speed boost; psilord reports it cut the tar step's time in half.\n\n<p>Modern tests suggest that this may not longer be true.  (Possibly because we do the gzip compression using GNU tar instead of a separate gzip pass?  Perhaps the built in gzip drowns out the tarring?  Perhaps compression provides larger blocking as an unexpected side-effect?)\n\n</p><p></p><ol>\n<li>Do some tests to see if a larger --blocking-factor provides useful benefit.  I believe the old version used a --blocking-factor somewhere between 512 and 2048, versus the default of 20.\n</li><li>If yes, modify the packaging to include a larger --blocking-factor.  This will probably be done in <a class=\"file\" href=\"rlog?f=build/cmake/macros/TarGz.cmake\">/build/cmake/macros/TarGz.cmake</a>, looking for a line something like:\n<div class=\"code\">\n<pre class=\"code\">        COMMAND tar ARGS czf ${CPACK_PACKAGE_FILE_NAME}.tar.gz --owner=0 --group=0 --numeric-owner ${CPACK_PACKAGE_FILE_NAME}\n</pre></div>\n\n</li><li>Check that the larger --blocking-factor works on AIX.  When this was tried earlier, one of the two AIX machines could not untar the resulting tarballs, or emitted lots of complaints (I'm fuzzy on the details now).  We may need to special-case AIX builds to not use --blocking-factor depending on the results.\n</li></ol>\n\n<p>(This ticket forked off of <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1863\" onclick=\"get_ticket_and_populate_wrapper('1863'); return false;\" title=\"tar.gz problems in CMake/CPack\">#1863</a></span>)</p></blockquote>", "remarks": "<blockquote>\nWhat's going on with this?  Seems to have drop'd off the radar?\n\n<p></p><hr/>\n<em>2011-May-24 14:53:58 by adesmet:</em> <br/>\n\nI did a few tests back when I was hacking on <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1863\" onclick=\"get_ticket_and_populate_wrapper('1863'); return false;\" title=\"tar.gz problems in CMake/CPack\">#1863</a></span> and I wasn't seeing significant speed improvements.  However, my very quick-and-dirty tests were limited to just my desktop Linux box.  Thus, step 1 is determine if there is a useful benefit.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2020-Jul-31 14:38", "status": "abandoned", "created": "2011-May-04 15:14", "fixed_version": "2011-May-04 15:14", "broken_version": "v070506", "priority": "4", "subsystem": "Packaging", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}