{"id": 489, "title": "Ticket #489: Hard limit resource restriction", "description": "<blockquote>\nProvide the ability to strictly restrict a job's resource usage</blockquote>", "remarks": "<blockquote>\n<em>2009-Jun-09 11:59:10 by matt:</em> <br/>\n\nAssigned the ticket over to Zach for code review</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/55/resource_restriction.patch\">resource_restriction.patch</a>\n33085 bytes added by rrati on 2009-May-15 19:32:42 UTC.\n<br/>\nThis patch will make the machine ad available to the stater, and both job and machine cans can be made available to the running job.  It is the responsibility of the job or the job wrapper to use the information in the ads to perform the desired limits.  A sample wrapper to do resource limiting is provided in condor_examples.\n\n<p>Additionally, a job can set wants_ads in the submit file and the machine and job ads will be made available by the starter<br/>\n</p></li><li><a href=\"../files/63/resource_restriction.patch\">resource_restriction.patch</a>\n20551 bytes added by rrati on 2009-Jul-02 17:48:59 UTC.\n<br/>\nChanges after review: 1) Removed <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobWantsAds\" title=\"Job Wants Ads\">JobWantsAds</a></span> and other limit restriction attributes.  Job and Machine Ads are always written in the execute directory now. 2) The Machine Ad is no longer passed via a file on the system, but is instead passed to the Starter via the update socket.\n<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7dfebca1ae898b58982d54e0f4114f73799931c1\">[15075]</a></span>: Copy the condor_limits_wrapper.sh to libexec ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=489\" onclick=\"get_ticket_and_populate_wrapper('489'); return false;\" title=\"Hard limit resource restriction\">#489</a></span> (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/089e2956f3380e41cff25b57191042a2ac712f86\">[15074]</a></span>: Code cleanup ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=489\" onclick=\"get_ticket_and_populate_wrapper('489'); return false;\" title=\"Hard limit resource restriction\">#489</a></span> (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8754cf7f2479d114a287f589b2466bdcbfd8fb7f\">[15073]</a></span>: Changes after review: - Removed <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobWantsAds\" title=\"Job Wants Ads\">JobWantsAds</a></span> and other limit restriction attributes. Job and Machine Ads are always written in the execute directory now. - The Machine Ad is no longer passed via a file on the system, but is instead passed to the Starter via the update socket. (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=489\" onclick=\"get_ticket_and_populate_wrapper('489'); return false;\" title=\"Hard limit resource restriction\">#489</a></span>) (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7cb10691b1dc7b241b7b944fc0e943ec01472975\">[15072]</a></span>: Removed commented out code ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=489\" onclick=\"get_ticket_and_populate_wrapper('489'); return false;\" title=\"Hard limit resource restriction\">#489</a></span> (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4bcfc282d902cdeb037f06647d53d5af96b6cb86\">[15071]</a></span>: - The machine ad the starter received will be printed to the log file if D_FULLDEBUG is enabled - If the job wrapper creates the .job_wrapper_error file then when the job/wrapper exits the starter will treat it as if there was an error executing the job. This file can optionally be filled with text denoting\u00a0[...]\n (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3955a30859824bf66fb36a54895e17533702f7c3\">[15070]</a></span>: - Added wants_ads to condor_submit that allows a job to specify if it wants the job and machine ads available - Added configuration parameter ENFORCE_JOB_LIMITS to enable the administrator to set limits. Limits should be implemented in a job wrapper. \u00a0[...]\n (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Jul-14 08:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c86cced0e0b54aaa64e8725436e1488ecec566ff\">[15069]</a></span>: The machine ad is now passed to the starter in all cases except for BOINC and standard starters. The startd will create a unique file in /tmp for the starter to read, and will remove the file when the claim expires. (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=489\" onclick=\"get_ticket_and_populate_wrapper('489'); return false;\" title=\"Hard limit resource restriction\">#489</a></span>)  (By Robert Rati )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Jan-08 08:11", "status": "resolved", "created": "2009-May-15 14:28", "fixed_version": "2009-May-15 14:28", "broken_version": "", "priority": "2", "subsystem": "Daemons", "assigned_to": "rrati", "derived_from": "", "creator": "rrati", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu,gthain@cs.wisc.edu", "due_date": ""}