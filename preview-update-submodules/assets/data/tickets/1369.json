{"id": 1369, "title": "Ticket #1369: New ClassAd function: switch", "description": "<blockquote>\nLets say you're writing a report similar to the default condor_q report, but with tweaks for your own needs.  condor_q's -format option can get you there, but sometimes the expressions you end up writing are a mess.  For example, to generate the \"ST\" (Job Status) field, you use something like this:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">-format '%-2s ' 'ifThenElse(JobStatus==0,\"U\",ifThenElse(JobStatus==1,\"I\",ifThenElse(JobStatus==2,\"R\",ifThenElse(JobStatus==3,\"X\",ifThenElse(JobStatus==4,\"C\",ifThenElse(JobStatus==5,\"H\",ifThenElse(JobStatus==6,\"E\",string(JobStatus))))))))'\n</pre></div>\n\n\n<p>That's a pain in the ass to write or read.  Essentially I'm doing a lookup, or something similar to a switch statement, and a briefer form would be nice.  For example, it might look like this:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">-format '%-2s ' 'switch(JobStatus,string(JobStatus),0,\"U\",1,\"I\",2,\"R\",3,\"X\",4,\"C\",5,\"H\",6,\"E\")'\n</pre></div>\n\n\n<p>The arguments above would be:\n\n</p><p>switch( <em>value to switch on</em>, <em>default</em>, <em>value 1</em>, <em>result 1</em>, <em>value 2</em>, <em>result 2</em>, ...)\n\n</p><p>Or perhaps something more verbose, but also more flexible:\n</p><div class=\"code\">\n<pre class=\"code\">-format '%-2s ' 'switch(string(JobStatus),JobStatus==0,\"U\", JobStatus==1,\"I\", JobStatus==2,\"R\", JobStatus==3,\"X\", JobStatus==4,\"C\", JobStatus==5,\"H\", JobStatus==6,\"E\")'\n</pre></div>\n\n\n<p>With the tests evaluated in order, the first one to return true being the answer.  If none are true, the first argument is returned at the default.  This more verbose form allows simple testing of ranges or regular expressions.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Apr-22 20:45:42 by matt:</em> <br/>\n\nFor <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStatus\" title=\"Job Status\">JobStatus</a></span> I've always been a fan of substr(\"UIRXCHE\", <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobStatus\" title=\"Job Status\">JobStatus</a></span>, 1)\n<hr/>\n<em>2010-Oct-20 16:03:30 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:46:04 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 16:08:44 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2011-Feb-01 16:08", "status": "new", "created": "2010-Apr-21 16:21", "fixed_version": "2010-Apr-21 16:21", "broken_version": "v070400", "priority": "4", "subsystem": "Libs", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}