{"id": 1841, "title": "Ticket #1841: Flocking broken under certain conditions post async-schedd merge", "description": "<blockquote>\nI found a condition where flocking stops working.  It used to be the condition for decreasing the flocking level was this:\n\n<p></p><div class=\"verbatim\">\n<pre>( JobsStarted &lt; jobs || JobsRejected &gt; 0 )\n</pre></div>\n\n\n<p>This has changed to:\n\n</p><p></p><div class=\"verbatim\">\n<pre>satisfied = getNumJobsRejected() == 0\n</pre></div>\n\n\n<p>We found that there's at least one condition where getNumJobsRejected() == 0 and flocking should increase: if the negotiator has zero resources:\n\n</p><p></p><div class=\"verbatim\">\n<pre>01/06/11 20:30:52 Phase 4.1:  Negotiating with schedds ...\n01/06/11 20:30:52   Negotiating with bbockelm@glidein.unl.edu at &lt;129.93.239.145:59940&gt;\n01/06/11 20:30:52 0 seconds so far\n01/06/11 20:30:52     Reached submitter resource limit: 0.000000 ... stopping\n</pre></div>\n\n\n<p>I think the original condition should be restored.  In our case, the negotiator with 0 resources for the user is at flock level 0; so, whenever that negotiator talks to this schedd, the flock level resets to 0.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "todo", "last_change": "2011-Jan-07 10:44", "status": "resolved", "created": "2011-Jan-06 20:39", "fixed_version": "2011-Jan-06 20:39", "broken_version": "v070505", "priority": "2", "subsystem": "Daemons", "assigned_to": "danb", "derived_from": "#1069", "creator": "bbockelm", "rust": "", "customer_group": "other", "visibility": "public", "notify": "dweitzel@cse.unl.edu,bbockelm@cse.unl.edu", "due_date": ""}