{"id": 6785, "title": "Ticket #6785: Starter should assume shadow on same machine has trustable UID_DOMAIN", "description": "<blockquote>\nOn a machine that doesn't have working DNS or is configured to be a personal Condor (using interface 127.0.0.1), it's easy for UID_DOMAIN (default $(FULL_HOSTNAME)) to not match the hostname associated with the network interface used between the starter and shadow. This causes the starter to run the job as user <code>nobody</code>. If file transfer isn't enabled, this is likely to fail, as <code>nobody</code> won't have permission to access the job's files. If the starter and shadow are on the same machine, it's reasonable to assume they share the same UID namespace.\n\n<p>Add a new knob, TRUST_LOCAL_UID_DOMAIN. If it's true (the default) and the shadow's end of the TCP connection is on a local network interface, then the starter doesn't do the matching test between UID_DOMAIN and the hostname of that interface. This is the same as TRUST_UID_DOMAIN, but only for shadows on the same machine. We should still do the matching of UID_DOMAIN values between starter and shadow, as that makes testing easier.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-22 16:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/126f1f027313f84eacdbcb3b538911c79015f82f\">[55605]</a></span>: Docs for new param TRUST_LOCAL_UID_DOMAIN. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6785\" onclick=\"get_ticket_and_populate_wrapper('6785'); return false;\" title=\"Starter should assume shadow on same machine has trustable UID_DOMAIN\">#6785</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-28 16:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e70353099af79796ce4c7eb8262f0caca96331dc\">[55491]</a></span>: Starter should trust UID_DOMAIN of local shadows. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6785\" onclick=\"get_ticket_and_populate_wrapper('6785'); return false;\" title=\"Starter should assume shadow on same machine has trustable UID_DOMAIN\">#6785</a></span> Add new config knob TRUST_LOCAL_UID_DOMAIN. In default setting, the starter won't require that the shadow's UID_DOMAIN match the hostname of its interface if the two daemons are on the same machine.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2018-Oct-22 16:21", "status": "resolved", "created": "2018-Sep-28 14:27", "fixed_version": "2018-Sep-28 14:27", "broken_version": "", "priority": "3", "subsystem": "DaemonsExecNode", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}