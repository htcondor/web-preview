{"id": 5538, "title": "Ticket #5538: Bad accounting group names can kill negotiator", "description": "<blockquote>\nIf an accounting group name contains a space, the negotiator will write bad entries to the accountant log, which it cannot read back on restart. This will kill matchmaking until the accountant log file is manually corrected.\n\n<p>The negotiator uses the account group name as part of a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> log key, but keys cannot contain spaces, as space delimits the fields of a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> log entry. The negotiator needs to validate accounting group names and reject those that have invalid characters (which may extend beyond space). Condor_submit and condor_schedd should probably do the same. At a lower level, the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> log should validate its keys, and refuse to write entries that it can't read back.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Mar-02 04:17:58 by jfrey:</em> <br/>\n\nThis is similar to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5123\" onclick=\"get_ticket_and_populate_wrapper('5123'); return false;\" title=\"Malformed concurrency limits break condor_userprio\">#5123</a></span>, but with worse consequences.\n\n<p></p><hr/>\n<em>2016-Mar-02 09:16:26 by tannenba:</em> <br/>\n\nJust an idea: at the lower level of classad log object, perhaps it should escape forbidden characters in key names instead of refusing to write.\n\n<p></p><hr/>\n<em>2016-Mar-21 14:24:20 by johnkn:</em> <br/>\n\n<strong>code_review</strong> change looks good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Mar-10 13:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5168757a0b14e99c9a74f70f8eab56fb87a81ead\">[47693]</a></span>: Docs for accounting group name with spaces bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5538\" onclick=\"get_ticket_and_populate_wrapper('5538'); return false;\" title=\"Bad accounting group names can kill negotiator\">#5538</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Mar-10 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/765e3f9a4581bebc97115b0aac4fd69280a248b9\">[47692]</a></span>: Constrain and validate accounting group names. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5538\" onclick=\"get_ticket_and_populate_wrapper('5538'); return false;\" title=\"Bad accounting group names can kill negotiator\">#5538</a></span> If an accounting group name contains a space, the negotiator will write invalid entries in the accountant log and be unable to read the log back in on startup. The negotiator now ignores submitter ads with an invalid name and condor_submit fails if\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Mar-21 14:24", "status": "resolved", "created": "2016-Mar-02 04:16", "fixed_version": "2016-Mar-02 04:16", "broken_version": "v080000", "priority": "2", "subsystem": "DaemonsCM", "assigned_to": "johnkn", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "atlas", "visibility": "public", "notify": "philippo@LAL.IN2P3.FR, tannenba@cs.wisc.edu", "due_date": ""}