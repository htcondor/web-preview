{"id": 2970, "title": "Ticket #2970: CONDOR_INHERIT causes recursive glideins to misbehave", "description": "<blockquote>\nIn a test of Igor's <code>CrosOSG CE</code>, there is a glidein within a glidein.  The inner glidein failed shortly after being started, because the master was trying to send a CHILDALIVE message to the outer glidein.  This failed due to authorization errors.\n\n<p>The inner glidein should not be trying to send CHILDALIVE messages to the outer glidein.  The reason it is trying to do so is that the CONDOR_INHERIT environment variable is being passed to the job executed by the outer glidein.\n\n</p><p>Proposed fix: remove CONDOR_INHERIT from the environment as soon as it is read in <code>DaemonCore</code>.  It should never be passed to a child process of a daemon.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-May-03 14:34:45 by danb:</em> <br/>\n\nI learned more: CONDOR_INHERIT is passed to the job when JOB_INHERITS_STARTER_ENVIRONMENT is true.  Otherwise, it is not passed.  Furthermore, the value is explicitly set by the starter in <code>DaemonCore::CreateProcess()</code>.  It is not just a value left over from what the starter itself inherited.\n\n<p></p><hr/>\n<em>2012-Oct-08 14:53:03 by tannenba:</em> <br/>\n\n<strong>Code Review</strong>.  I wonder if scheduler universe has a similar issue, and seems like it would be easy to write a regression test for this. But the code patch itself looks fine, so resolving.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-May-03 15:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/34ca628b03319f197c3ed62273db89a41a044f94\">[31917]</a></span>: Do not pass CONDOR_INHERIT to the user job when JOB_INHERITS_STARTER_ENVIRONMENT is true. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2970\" onclick=\"get_ticket_and_populate_wrapper('2970'); return false;\" title=\"CONDOR_INHERIT causes recursive glideins to misbehave\">#2970</a></span>  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Oct-08 14:53", "status": "resolved", "created": "2012-May-03 12:34", "fixed_version": "2012-May-03 12:34", "broken_version": "v070600", "priority": "4", "subsystem": "", "assigned_to": "tannenba", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "isfiligoi@ucsd.edu,dan@hep.wisc.edu", "due_date": ""}