{"id": 5348, "title": "Ticket #5348: JobRouter should perform spooling as source job user", "description": "<blockquote>\nWe had a user notice that if the Owner attribute changes during routing, then spooling can fail.\n\n<p>This is because the job router sets the eUID to match the Owner of the <strong>destination job</strong> when it reads the <strong>source job</strong> input files.  In the (admittedly rare) case where the Owner attribute changes in routing, this is the wrong euid to use.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Oct-07 11:31:18 by jfrey:</em> <br/>\n\n<strong>Code review</strong>\n\n<p>This change is good.\n\n</p><p></p><hr/>\n<em>2016-Oct-07 11:43:50 by jfrey:</em> <br/>\n\nThis patch is incomplete. File transfer after job completion is also broken if the Owners are different.\n\n<p></p><hr/>\n<em>2016-Oct-11 13:11:48 by jfrey:</em> <br/>\n\nFile transfer after job completion is now handled correctly.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Oct-11 09:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a90846be4f04e673d8e6efe2d3ee09246b4ee587\">[49398]</a></span>: Fetch output sandbox as the source user in the job router. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5348\" onclick=\"get_ticket_and_populate_wrapper('5348'); return false;\" title=\"JobRouter should perform spooling as source job user\">#5348</a></span> If the source and routed jobs have different owners, then the job router needs to write job files as the source job owner, not the routed job owner.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Oct-11 09:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/42b9afc545fb396577498233453051c2458ae8b4\">[49397]</a></span>: Fix bad whitespace. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5348\" onclick=\"get_ticket_and_populate_wrapper('5348'); return false;\" title=\"JobRouter should perform spooling as source job user\">#5348</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Oct-07 11:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/664ac42623c5983577ed4521e1266d05270bb49c\">[49378]</a></span>: Docs for job router different Owner file transfer bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5348\" onclick=\"get_ticket_and_populate_wrapper('5348'); return false;\" title=\"JobRouter should perform spooling as source job user\">#5348</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Oct-07 11:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e47f4c7c9c1cbb1acb4f29fa8cf38312b1b24048\">[49377]</a></span>: Turn EXCEPT into dprintf and failure return. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5348\" onclick=\"get_ticket_and_populate_wrapper('5348'); return false;\" title=\"JobRouter should perform spooling as source job user\">#5348</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Oct-30 15:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/62a0e956312c794533bed35d4c217295f62fea11\">[46179]</a></span>: Perform spooling as source user. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5348\" onclick=\"get_ticket_and_populate_wrapper('5348'); return false;\" title=\"JobRouter should perform spooling as source job user\">#5348</a></span>  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "incident", "last_change": "2016-Oct-11 13:12", "status": "resolved", "created": "2015-Oct-27 21:29", "fixed_version": "2015-Oct-27 21:29", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "jfrey", "derived_from": "#4490", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}