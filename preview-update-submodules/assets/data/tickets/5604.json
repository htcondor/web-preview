{"id": 5604, "title": "Ticket #5604: Multiple startds behind shared port broken w/ match password", "description": "<blockquote>\nThe startd advertises its claimId using only &lt;ip:port&gt; and not the fully decorated sinful that specifies shared port information.  As such creating a non-negotiated session using \"match password\" fails because all startds appear to have the same address, which is &lt;ip:9618&gt;.  The fix appears to be to use the fully decorated sinful as part of the claimId.</blockquote>", "remarks": "<blockquote>\n<em>2018-Oct-19 11:35:32 by jfrey:</em> <br/>\n\nThe full sinful string of the startd will have '#' in it if using CCB. It appears that the only things that care about this are ClaimIdParser::startdSinfulAddr(), which nobody calls, and getAddrFromClaimId(). The latter is used by COD and by the schedd when reading a <strong>really</strong> old job queue log.\n\n<p>We can update these functions to look for '&gt;' instead of '#' to find the end of the sinful string in a claim id.\n\n</p><p></p><hr/>\n<em>2018-Oct-19 19:53:25 by zmiller:</em> <br/>\n\nAssigning ticket to Jaime since he has recent knowledge of the problem and what seems like a straightforward fix.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6810\" onclick=\"get_ticket_and_populate_wrapper('6810'); return false;\" title=\"Tolerate full sinful string in claim ids\">#6810</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nTolerate full sinful string in claim ids</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7391\" onclick=\"get_ticket_and_populate_wrapper('7391'); return false;\" title=\"Multiple startds behind shared port in 8.8\">#7391</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nMultiple startds behind shared port in 8.8</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-08 11:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/38c44fcdc5482392556991472f6c30cf66529394\">[56149]</a></span>: Docs for multiple startds between shared port auth fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5604\" onclick=\"get_ticket_and_populate_wrapper('5604'); return false;\" title=\"Multiple startds behind shared port broken w/ match password\">#5604</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-30 15:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b65fe0cad2f9cea1004450a86d13e625353f17a4\">[55665]</a></span>: Remove redundant function getAddrFromClaimId(). <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5604\" onclick=\"get_ticket_and_populate_wrapper('5604'); return false;\" title=\"Multiple startds behind shared port broken w/ match password\">#5604</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-30 14:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/45bc286f023f2fe1678e82d1892a7ae4c47dd156\">[55664]</a></span>: Put full startd sinful string in claim ids. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5604\" onclick=\"get_ticket_and_populate_wrapper('5604'); return false;\" title=\"Multiple startds behind shared port broken w/ match password\">#5604</a></span> Currently, the sinful string in the claim id is just an ip address and port. COD uses the sinful string in the claim id to contact the startd. That will fail when shared port or CCB is enabled. For match password session, the sinful string forms part\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Feb-08 11:25", "status": "resolved", "created": "2016-Apr-06 13:56", "fixed_version": "2016-Apr-06 13:56", "broken_version": "v080400", "priority": "2", "subsystem": "DaemonsExecNode", "assigned_to": "jfrey", "derived_from": "", "creator": "zmiller", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "zmiller@cs.wisc.edu, tlmiller@cs.wisc.edu", "due_date": ""}