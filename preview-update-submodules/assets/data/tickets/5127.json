{"id": 5127, "title": "Ticket #5127: make condor_userprio -long output easier to process", "description": "<blockquote>\nThe userprio ad that is returned from the negotiator is very hard to work with because it's one big ad that is logically multiple ads where attributes that end in a common integer refer to the same group/user information.\n\n<p>For instance, if there a two users, the ad might look like this\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">  Name1 = \"foo\"\n  Priority1 = 10\n  Name2 = \"bar\"\n  Priority2 = 12\n</pre></div>\n\n\n<p>And would be processed by condor_userprio as if it were really this\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">  Id = 1\n  Name = \"foo\"\n  Priority = 10\n\n  Id = 2\n  Name = \"bar\"\n  Priority = 12\n</pre></div>\n\n\n<p>We should change the negotiator to return the second form rather than the first, but in the mean time (and for backward compatibility).  The usefulness of <code>condor_userprio -long</code> could be enhanced by having it convert from the first form to the second on the fly.  This would allow the addition of -af and -constraint arguments in condor_userprio.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Jul-02 09:36:43 by johnkn:</em> <br/>\n\nThis commit adds arguments -legacy and -modular as modifiers to -long.  also -autoformat (-af) which implies -modular.\n\n<p>-legacy forces the old form of -long, which is one ad for all userprio information with attribute names having an integer appended to indicate which record.   -modular is the improved form, where there is one ad per record.  -af operates on, (and therefore forces) the modular form.\n\n</p><p>in the modular form, the first ad contains only 2 attributes:\n\n</p><p></p><pre>    NumSubmittors = 23\n    LastUpdate = 1435304615\n</pre>\n\n<p><code>NumSubmittors</code> indicates how many subsequent ads there will be, these\nads will be either group records or submittor records.  In the current implementation, the group records will be first, followed by the submittor records with the &lt;none&gt; group being the first group. Groups have these attributes.\n\n</p><p></p><pre>    SubmittorId = 2\n    IsAccountingGroup = true\n    Name = \"alice\"\n    SurplusPolicy = \"regroup\"\n    GroupSortKey = 0.0\n    EffectiveQuota = 1.8084\n    ConfigQuota = 0.0548\n    SubtreeQuota = 1.8084\n    Requested = 0.0\n    AccountingGroup = \"&lt;none&gt;\"\n    Priority = 50000.0\n    PriorityFactor = 100000.0\n    BeginUsageTime = 0\n    ResourcesUsed = 0\n    LastUsageTime = 0\n    AccumulatedUsage = 0.0\n    WeightedAccumulatedUsage = 0.0\n    WeightedResourcesUsed = 0.0\n</pre>\n\n<p>And submittors have these attributes, this is the same as the above except for the 6 attributes listed above after Name and before <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AccountingGroup\" title=\"Accounting Group\">AccountingGroup</a></span>.\n\n</p><p></p><pre>    SubmittorId = 17\n    IsAccountingGroup = false\n    Name = \"bob@submit-3.chtc.wisc.edu\"\n    AccountingGroup = \"&lt;none&gt;\"\n    Priority = 50000.0\n    PriorityFactor = 100000.0\n    BeginUsageTime = 0\n    ResourcesUsed = 0\n    LastUsageTime = 0\n    AccumulatedUsage = 0.0\n    WeightedResourcesUsed = 0.0\n    WeightedAccumulatedUsage = 0.0</pre>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-26 15:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4dee33ba94a99eb5e40d618507893cabf66cfc38\">[45703]</a></span>: edit and complete documentation of new options to condor_userprio <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5127\" onclick=\"get_ticket_and_populate_wrapper('5127'); return false;\" title=\"make condor_userprio -long output easier to process\">#5127</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-25 14:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cdaaa015644432f0cef1b6aea371d1924e713238\">[45669]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5159\" onclick=\"get_ticket_and_populate_wrapper('5159'); return false;\" title=\"condor_submit should allow an empty file transfer list.\">#5159</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5210\" onclick=\"get_ticket_and_populate_wrapper('5210'); return false;\" title=\"condor_kbdd should not report transient mouse movement as 'activity'\">#5210</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5127\" onclick=\"get_ticket_and_populate_wrapper('5127'); return false;\" title=\"make condor_userprio -long output easier to process\">#5127</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5155\" onclick=\"get_ticket_and_populate_wrapper('5155'); return false;\" title=\"condor_q -better -reverse output confusing when expr uses CurrentTime\">#5155</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4836\" onclick=\"get_ticket_and_populate_wrapper('4836'); return false;\" title=\"Enable python bindings in windows\">#4836</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5132\" onclick=\"get_ticket_and_populate_wrapper('5132'); return false;\" title=\"fix problems with SLOT_TYPE_n_* params\">#5132</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5171\" onclick=\"get_ticket_and_populate_wrapper('5171'); return false;\" title=\"DetectedCpus and DetectedMemory is stuffed into ALL ads\">#5171</a></span> <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=5172\" onclick=\"get_ticket_and_populate_wrapper('5172'); return false;\" title=\"condor_q tries to parse usernames starting with digits as job ids\">#5172</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5188\" onclick=\"get_ticket_and_populate_wrapper('5188'); return false;\" title=\"$REAL() macro substitution doesn't evaluate\">#5188</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5189\" onclick=\"get_ticket_and_populate_wrapper('5189'); return false;\" title=\"$CHOICE() macro should allow empty items\">#5189</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jul-01 17:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8cb05da7440e92fe767273dd822f7bf4b2d1b60d\">[45196]</a></span>: make condor_userprio -long output easier to work with. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5127\" onclick=\"get_ticket_and_populate_wrapper('5127'); return false;\" title=\"make condor_userprio -long output easier to process\">#5127</a></span> This commit also moves the generic function parse_autoformat_args from history.cpp into condor_utils so that it can be called from condor_userprio. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Sep-18 08:42", "status": "resolved", "created": "2015-Jul-01 15:33", "fixed_version": "2015-Jul-01 15:33", "broken_version": "", "priority": "3", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}