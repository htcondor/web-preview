{"id": 2585, "title": "Ticket #2585: Local universe job leaves sandbox directory behind", "description": "<blockquote>\nI have two local universe jobs, and they appear to be leaving behind a sandbox directory.  I found my Condor schedd crashed when the execute directory hit 32k sandboxes.\n\n<p>This setup has GLEXEC=true, but the jobs were submitted prior to enabling glexec, so they don't have a proxy.  In the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=StarterLog\" title=\"Starter Log\">StarterLog</a></span>, I see:\n\n</p><p></p><div class=\"verbatim\">\n<pre>10/25/11 20:06:17 (24912.0)  Starter running a job under a schedd listening at &lt;129.93.239.174:46811&gt;\n10/25/11 20:06:17 (24912.0)  Starter running a local job with no shadow\n10/25/11 20:06:17 (24912.0)  Reading job ClassAd from \"STDIN\"\n10/25/11 20:06:17 (24912.0)  Found ClassAd data in \"STDIN\"\n10/25/11 20:06:17 (24912.0)  setting the orig job name in starter\n10/25/11 20:06:17 (24912.0)  setting the orig job iwd in starter\n10/25/11 20:06:17 (24912.0)  Done setting resource limits\n10/25/11 20:06:17 (24912.0)  ERROR \"configuration specifies use of glexec, but job has no proxy\" at line 1501 in file /home/cse496/bbockelm/rpmbuild/BUILD/condor-7.7.3/src/condor_starter.V6.1/baseStarter.cpp\n</pre></div>\n\n\n<p>I think that, when this error is encountered, the job should be put on HOLD.\n\n</p><p>I wasn't able to disentangle the two job's output in the schedd.  The log is copy/pasted below.\n\n</p><p></p><div class=\"verbatim\">\n<pre>10/25/11 20:01:48 -------- Begin starting jobs --------\n10/25/11 20:01:48 4920980 kbytes available for \"/var/lib/condor/spool/local_univ_execute\"\n10/25/11 20:01:48 Found idle local universe job 24912.0\n10/25/11 20:01:48 Queueing job 24912.0 in runnable job queue\n10/25/11 20:01:48 start next job after 0 sec, JobsThisBurst 0\n10/25/11 20:01:48 4920976 kbytes available for \"/var/lib/condor/spool/local_univ_execute\"\n10/25/11 20:01:48 Found idle local universe job 24911.0\n10/25/11 20:01:48 Queueing job 24911.0 in runnable job queue\n10/25/11 20:01:48 -------- Done starting jobs --------\n10/25/11 20:01:48 Job prep for 24912.0 will not block, calling aboutToSpawnJobHandler() directly\n10/25/11 20:01:48 aboutToSpawnJobHandler() completed for job 24912.0, attempting to spawn job handler\n10/25/11 20:01:48 Starting local universe job 24912.0\n10/25/11 20:01:48 About to spawn /usr/sbin/condor_starter condor_starter -f -job-cluster 24912 -job-proc 0 -header (24912.0)' ' -job-input-ad - -schedd-addr &lt;129.93.239.174:46811&gt;\n10/25/11 20:01:48 Cleared dirty attributes for job 24912.0\n10/25/11 20:01:48 Starting add_shadow_birthdate(24912.0)\n10/25/11 20:01:48 Create_Process: using fast clone() to create child process.\n10/25/11 20:01:48 SharedPortEndpoint: Inside destructor.\n10/25/11 20:01:48 Added shadow record for PID 18714, job (24912.0)\n10/25/11 20:01:48 Spawned local starter (pid 18714) for job 24912.0\n10/25/11 20:01:48 start next job after 0 sec, JobsThisBurst 0\n10/25/11 20:01:48 Job prep for 24911.0 will not block, calling aboutToSpawnJobHandler() directly\n10/25/11 20:01:48 aboutToSpawnJobHandler() completed for job 24911.0, attempting to spawn job handler\n10/25/11 20:01:48 Starting local universe job 24911.0\n10/25/11 20:01:48 About to spawn /usr/sbin/condor_starter condor_starter -f -job-cluster 24911 -job-proc 0 -header (24911.0)' ' -job-input-ad - -schedd-addr &lt;129.93.239.174:46811&gt;\n10/25/11 20:01:48 Cleared dirty attributes for job 24911.0\n10/25/11 20:01:48 Starting add_shadow_birthdate(24911.0)\n10/25/11 20:01:48 Create_Process: using fast clone() to create child process.\n10/25/11 20:01:48 SharedPortEndpoint: Inside destructor.\n10/25/11 20:01:48 Added shadow record for PID 18715, job (24911.0)\n10/25/11 20:01:48 Spawned local starter (pid 18715) for job 24911.0\n10/25/11 20:01:48 Expedited call to StartJobs()\n10/25/11 20:01:48 DaemonCore: No more children processes to reap.\n10/25/11 20:01:48 Local starter pid 18715 for job 24911.0 exited with status 4\n10/25/11 20:01:48 Cleared dirty attributes for job 24911.0\n10/25/11 20:01:48 ERROR: Local Starter exited with job exception code!\n10/25/11 20:01:48 Deleting shadow rec for PID 18715, job (24911.0)\n10/25/11 20:01:48 Entered check_zombie( 18715, 0x0x112f9194, st=2 )\n10/25/11 20:01:48 Marked job 24911.0 as IDLE\n10/25/11 20:01:48 Exited check_zombie( 18715, 0x0x112f9194 )\n10/25/11 20:01:48 Exited delete_shadow_rec( 18715 )\n10/25/11 20:01:48 DaemonCore: No more children processes to reap.\n10/25/11 20:01:48 Local starter pid 18714 for job 24912.0 exited with status 4\n10/25/11 20:01:48 Cleared dirty attributes for job 24912.0\n10/25/11 20:01:48 ERROR: Local Starter exited with job exception code!\n10/25/11 20:01:48 Deleting shadow rec for PID 18714, job (24912.0)\n10/25/11 20:01:48 Entered check_zombie( 18714, 0x0x11298714, st=2 )\n10/25/11 20:01:48 Marked job 24912.0 as IDLE\n10/25/11 20:01:48 Exited check_zombie( 18714, 0x0x11298714 )\n10/25/11 20:01:48 Exited delete_shadow_rec( 18714 )\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "todo", "last_change": "2012-Jan-30 14:56", "status": "new", "created": "2011-Oct-25 20:08", "fixed_version": "2011-Oct-25 20:08", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "#2753", "creator": "bbockelm", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}