{"id": 6106, "title": "Ticket #6106: bosco installation doesn't support slurm", "description": "<blockquote>\nHi,\n\n<p>Installing the latest bosco version 1.2.6 from\n\n</p><p><a class=\"external\" href=\"ftp://ftp.cs.wisc.edu/condor/bosco/1.2.6/\">ftp://ftp.cs.wisc.edu/condor/bosco/1.2.6/</a>\n\n</p><p>doesn't work with a remote slurm site. If I follow the instructions on\n\n</p><p><a class=\"external\" href=\"http://www.t2.ucsd.edu/twiki2/bin/view/UCSDTier2/BoscoSDSC\">http://www.t2.ucsd.edu/twiki2/bin/view/UCSDTier2/BoscoSDSC</a>\n\n</p><p>it doesn't accept slurm as a valid choice for remote batch system. If I try to use the bosco_quickstart install method, it accepts slurm but maps it automatically to pbs.\n\n</p><p>Install method from the BoscoSDSC twiki actually works if I change\n\n</p><p>bin/bosco_cluster\n\n</p><p>slightly and add slurm to the list of allowed options (line 793). Installation works and the following\n\n</p><p>bosco_cluster --add hufnagel@cori.nersc.gov slurm\n\n</p><p>also works. A subsequent\n\n</p><p>bosco_cluster --test hufnagel@cori.nersc.gov slurm\n\n</p><p>does not work though. It doesn't like the slurm line in the configuration, even though a factory with the same setup can submit just fine to the same remote slurm batch system using the new installation.\n\n</p><p>Cheers\n\n</p><p>Dirk</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Jan-24 14:09:44 by jfrey:</em> <br/>\n\nCan you be more specific about what's failing after you modify bosco_cluster?\n\n<p>I am able to configure a slurm cluster and run jobs there after tweaking bosco_cluster.\n\n</p><p></p><hr/>\n<em>2017-Jan-25 17:53:27 by hufnagel:</em> <br/>\n\n<div class=\"verbatim\">\n<pre>bash-4.1$ source ~/bosco/bosco_setenv\nbash-4.1$ bosco_start\nBOSCO Started\nbash-4.1$ bosco_cluster --test hufnagel@cori.nersc.gov\n&lt;bunch of output from the ssh session&gt;\nPassed!\nTesting bosco submission...Failed\nERROR: Parse error in expression: grid_resource = batch slurm hufnagel@cori.nersc.gov Error in config file SUBMIT_ATTRS or SUBMIT_EXPRS value. Aborting submit.\n</pre></div>\n\n\n<p></p><hr/>\n<em>2017-Feb-07 15:49:07 by jfrey:</em> <br/>\n\nThe bug here is that BOSCO's trick to make the grid_resource attribute optional in the submit file stopped working in HTCondor 8.4.7 (due to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5694\" onclick=\"get_ticket_and_populate_wrapper('5694'); return false;\" title=\"SUBMIT_ATTRS can't set JobLeaseDuration to an expression\">#5694</a></span>). It's unrelated to slurm. To work around this failure, you need to remove the SUBMIT_EXPRS line in ~/bosco/local.bosco/config/condor_config.bosco_routing.\n\n<p>I'll change bosco_cluster to not set this config parameter.\n\n</p><p></p><hr/>\n<em>2017-Feb-27 16:41:28 by tim:</em> <br/>\n\n<strong>CODE REVIEW:</strong> Looks good</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-28 11:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cc01acf659304f86f9633d59fc9db5bb9c9d9dd0\">[50223]</a></span>: Docs for Bosco SLURM support. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6106\" onclick=\"get_ticket_and_populate_wrapper('6106'); return false;\" title=\"bosco installation doesn't support slurm\">#6106</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-07 15:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1a60cefc3f7c1130f010e7e46535cc3a6441d882\">[50117]</a></span>: Disable Bosco's attempt to set a default grid_resource attribute. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6106\" onclick=\"get_ticket_and_populate_wrapper('6106'); return false;\" title=\"bosco installation doesn't support slurm\">#6106</a></span> Using SUBMIT_EXPRS to set a default grid_resource attibute no longer works, and will cause condor_submit to fail.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-24 13:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7dbe1ae2d20e6b0077effbef8fe74d3208b2f93e\">[50054]</a></span>: Support slurm clusters in bosco_cluster. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6106\" onclick=\"get_ticket_and_populate_wrapper('6106'); return false;\" title=\"bosco installation doesn't support slurm\">#6106</a></span>  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Feb-28 11:26", "status": "resolved", "created": "2017-Jan-24 00:19", "fixed_version": "2017-Jan-24 00:19", "broken_version": "v080507", "priority": "4", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "hufnagel", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}