{"id": 5570, "title": "Ticket #5570: Add PreCmdEnvironment and PostCmdEnvironment support", "description": "<blockquote>\nFrom the rust ticket:\n\n<p>It would be nice to set additional or replacement environment variables\nfor the <span class=\"quote\">PreCmd</span> and <span class=\"quote\">PostCmd</span>.\n\n</p><p>MATLAB uses a wrapper shell script to set up the correct LD_LIBRARY_PATH\nfor tools compiled with \"mcc,\" and thus using compiled MATLAB as a <span class=\"quote\">PreCmd</span>\nor <span class=\"quote\">PostCmd</span> requires transferring both the wrapper and the binary and then\nexecuting the wrapper. This environment may not be suitable for the job\nitself, however, so setting these elements in the submit description's\nenvironment is not the best approach. In some cases I've had to work\naround, the MATLAB environment for very old releases actually prevented\nHTCondor commands from running due to antiquated MATLAB-supplied\nlibraries.\n\n</p><p>If we had a (Pre|Post)CmdEnvironment attribute, it could set environment\nvariables specific to the <span class=\"quote\">PreCmd</span> and <span class=\"quote\">PostCmd</span>, such as the required MATLAB\nCompiler Runtime variables, eliminating the need for the wrapper script\nwhile avoiding interference with the job's environment.\n\n</p><p>Default behavior would continue as currently exists, with the job's\nenvironment being applied to the <span class=\"quote\">PreCmd</span> and <span class=\"quote\">PostCmd</span>, but if the Pre or\n<span class=\"quote\">PostCmdEnvironment</span> is defined, it would set the variables specified and\noverride matching variables in the job environment, then return to the\noriginal environment when the command is finished.</p></blockquote>", "remarks": "<blockquote>\nWhen I went to go implement this, it turned out that it already existed in the code.  As such, I just updated the manual and am resolving the ticket.  Docs will appear in the 8.4.6 and 8.5.4 manual.\n\n<p>For reference, just put this this in the submit file:\n</p><div class=\"code\">\n<pre class=\"code\">+PreEnv = \"one=1;two=2\"\n+PostEnv = \"three=3\"\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Mar-23 20:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7aa7ef08a4b5545b0cadba4628b299054b3aba57\">[48099]</a></span>: Add documentation for already-existing feature. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5570\" onclick=\"get_ticket_and_populate_wrapper('5570'); return false;\" title=\"Add PreCmdEnvironment and PostCmdEnvironment support\">#5570</a></span>  (By zmiller )</td></tr>\n</tbody></table>", "type": "doc", "last_change": "2016-Mar-23 21:09", "status": "resolved", "created": "2016-Mar-22 11:35", "fixed_version": "2016-Mar-22 11:35", "broken_version": "", "priority": "2", "subsystem": "DaemonsExecNode", "assigned_to": "zmiller", "derived_from": "", "creator": "zmiller", "rust": "s8665", "customer_group": "support", "visibility": "public", "notify": "zmiller@cs.wisc.edu, Michael.V.Pelletier@raytheon.com", "due_date": ""}