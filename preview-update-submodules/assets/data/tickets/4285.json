{"id": 4285, "title": "Ticket #4285: Master should should down checkpoint server last", "description": "<blockquote>\nAnd old friend of ours has reared its ugly head again. In particular, there is a race condition during a graceful shutdown between the ckpt server and starters, e.g., from the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MasterLog\" title=\"Master Log\">MasterLog</a></span>,\n\n<p></p><div class=\"code\">\n<pre class=\"code\">03/27/14 17:14:31 Got SIGQUIT.  Performing fast shutdown.\n03/27/14 17:14:31 Sent SIGQUIT to CKPT_SERVER (pid 38340)\n03/27/14 17:14:31 Sent SIGQUIT to STARTD (pid 38720)\n03/27/14 17:14:31 AllReaper unexpectedly called on pid 38340, status 0.\n03/27/14 17:14:31 The CKPT_SERVER (pid 38340) exited with status 0\n03/27/14 17:14:32 AllReaper unexpectedly called on pid 38720, status 0.\n03/27/14 17:14:32 The STARTD (pid 38720) exited with status 0\n03/27/14 17:14:32 All daemons are gone.  Exiting.\n03/27/14 17:14:32 **** condor_master (condor_MASTER) pid 33093 EXITING WITH STATUS 0\n</pre></div>\n\n\n<p>Would it be possible for a graceful shutdown to have the ckpt server shutdown only after the starters are all shutdown so local checkpoint images can be written first?</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Apr-15 14:31:43 by gthain:</em> <br/>\n\nNote that the master is killed in this case with kill -TERM &lt;masterpid&gt;\n\n<p></p><hr/>\n<em>2019-Apr-10 14:59:32 by pfc:</em> <br/>\n\nDeferring since to my knowledge this is no longer an issue for us in practice. It might be an issue in the future if/when Condor provides a checkpoint server for vanilla-universe checkpoints.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2019-Apr-10 14:59", "status": "defer", "created": "2014-Mar-28 10:28", "fixed_version": "2014-Mar-28 10:28", "broken_version": "v080000", "priority": "5", "subsystem": "DaemonMaster", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "pfcouvar@syr.edu, anderson@ligo.caltech.edu, tannenba@cs.wisc.edu,,pcouvare@caltech.edu", "due_date": ""}