{"id": 3457, "title": "Ticket #3457: reduce the size of classad exprtree nodes", "description": "<blockquote>\nThe classad <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ExprTree\" title=\"Expr Tree\">ExprTree</a></span> nodes have fields in them (such as nodeKind) that can be removed to achieve a size reduction in all in-memory classads.</blockquote>", "remarks": "<blockquote>\n<em>2013-Jan-24 14:04:33 by johnkn:</em> <br/>\n\npatch <span class=\"chng\"><a href=\"/404.html\">[34742]</a></span>  achieves a 5.4% size reduction in the collector relative to 7.9.3 on x64.  Testing was done on x64_64_RedHat6 with 3300 STARTD ads harvested from CHTC pool and pushed into the test collector using condor_advertise.\n\n<p></p><div class=\"verbatim\">\n<pre>              BeforeAdvertise   AfterAdvertise    Increase\n7.9.3 VmData          3468 kb         89004 Kb    85536 Kb\nnew   VmData          2220 kB         83136 kB    80916 Kb\n</pre></div>\n\n<hr/>\n<em>2013-Mar-05 10:58:27 by johnkn:</em> <br/>\n\nBulk change of target version from v070904 to v070905 using ./ticket-target-mover.\n<hr/>\n<em>2013-Apr-22 11:40:52 by johnkn:</em> <br/>\n\nBulk change of target version from v070905 to v070906 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Mar-22 09:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7ba36b1ca3635ee2d0b3cee087ba9a5e3d737643\">[35262]</a></span>: Remove data members from classad Operation class, and create subclasses by arity <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3457\" onclick=\"get_ticket_and_populate_wrapper('3457'); return false;\" title=\"reduce the size of classad exprtree nodes\">#3457</a></span> parent ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2541\" onclick=\"get_ticket_and_populate_wrapper('2541'); return false;\" title=\"Memory utilization of classads (revised)\">#2541</a></span> each subclass of Operation class will have only the necessary data members, so we don't waste space for 2nd &amp; 3rd <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ExprTree\" title=\"Expr Tree\">ExprTree</a></span> pointers in nodes that have no need of them. ===VersionHistory:Pending===\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Mar-22 09:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/92e696c90d116a81099a1ffd12b041bcca607560\">[35261]</a></span>: Remove nodeKind member from <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ExprTree\" title=\"Expr Tree\">ExprTree</a></span>, and replace it with a pure virtual method <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3457\" onclick=\"get_ticket_and_populate_wrapper('3457'); return false;\" title=\"reduce the size of classad exprtree nodes\">#3457</a></span> that all of the derived classes must implement. parent ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2541\" onclick=\"get_ticket_and_populate_wrapper('2541'); return false;\" title=\"Memory utilization of classads (revised)\">#2541</a></span>  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2018-May-18 10:09", "status": "resolved", "created": "2013-Jan-24 13:49", "fixed_version": "2013-Jan-24 13:49", "broken_version": "v070900", "priority": "3", "subsystem": "", "assigned_to": "johnkn", "derived_from": "#2541", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}