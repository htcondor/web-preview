{"id": 1285, "title": "Ticket #1285: param to enable fsync's (namely dagman)", "description": "<blockquote>\nThis ticket is meant to track configurable fsync work, as there is a broad interest in testing the possible performance improvements.\n\n<p>The open ended question is whether it should be disabled by default.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Jun-09 09:20:48 by matt:</em> <br/>\n\nTodd, it has been a few months, will you attach your patch?\n\n<p></p><hr/>\n<em>2010-Jun-09 10:32:13 by tannenba:</em> <br/>\n\nThanks for the bump, patch is now attached.  Mmmm, <em>git format-patch</em> makes this darn painless :).  Note, the attached patch is against V7_4-branch head.\n\n<p></p><hr/>\n<em>2011-May-24 13:09:26 by tstclair:</em> <br/>\n\nwhat ever happened w/this?  seems to have fallen off the grid.\n\n<p></p><hr/>\n<em>2011-Aug-12 15:45:25 by ziliang:</em> <br/>\n\nUpdated patch that actually conditionalizes calls to fsync through condor_fsync.\n\n<p></p><hr/>\n<em>2011-Aug-17 13:29:35 by danb:</em> <br/>\n\nZ,\n\n<p>Thanks for the patch!  It looks good to me.  A couple minor recommendations:\n\n</p><p>Call the global variable <code>condor_fsync_on</code>.\n\n</p><p>If fsync is turned off, I'd recommend a <code>dprintf(D_FULLDEBUG)</code> at config time that notes this fact.\n\n</p><p>In the function definition of condor_fsync(), comment out the parameter name for the unused argument.  This will avoid compiler warnings about the variable being unused.\n\n</p><p></p><hr/>\n<em>2011-Aug-18 11:34:28 by matt:</em> <br/>\n\nHow do I read the patch for this? There's a patch from Todd that includes everything. Then there's another patch attached and some files attached. Is the second patch and the included files intended to be the patch for this ticket?\n\n<p></p><hr/>\n<em>2011-Aug-18 11:36:12 by matt:</em> <br/>\n\nThis the ticket aiming to provide a \"job specific param\"? The patch doesn't seem to go that way. If it is, we should discuss if a job (a user) should not have such power.\n\n<p></p><hr/>\n<em>2011-Aug-18 14:15:38 by ziliang:</em> <br/>\n\nThe ticket was badly named by whoever first created it so after talking to Dan I changed the ticket name.  The intent behind the ticket is to conditionalize whether fsync is done or not.  Dan has reviewed the patch/files (the ones I attached) and I've committed them to master.  Doc is still pending.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/185/fsync.patch\">fsync.patch</a>\n8793 bytes added by tannenba on 2010-Jun-09 15:31:14 UTC.\n<br/>\nPatch to have many relevant fsync calls go through a condor_fsync() library call, which in this patch is a no-op, but could be changed to conditionally fsync.<br/>\n</li><li><a href=\"../files/438/fsync.patch\">fsync.patch</a>\n4472 bytes added by ziliang on 2011-Aug-12 20:42:45 UTC.\n<br/>\nUpdated patch against master.<br/>\n</li><li><a href=\"../files/439/condor_fsync.cpp\">condor_fsync.cpp</a>\n181 bytes added by ziliang on 2011-Aug-12 20:43:13 UTC.\n<br/>\ncondor_fsync source file<br/>\n</li><li><a href=\"../files/440/condor_fsync.h\">condor_fsync.h</a>\n1117 bytes added by ziliang on 2011-Aug-12 20:43:32 UTC.\n<br/>\ncondor_fsync header file<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-21 16:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f3b2b28df724658b21c4314a0399e3aa8947355f\">[27320]</a></span>: Documentation for Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1285\" onclick=\"get_ticket_and_populate_wrapper('1285'); return false;\" title=\"param to enable fsync's (namely dagman)\">#1285</a></span>.  (By Ziliang Guo )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-18 14:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0ab78fdd1a843d7c38490f853ef866603ddea88e\">[26868]</a></span>: Supress unused variable warning in condor_fsync. Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1285\" onclick=\"get_ticket_and_populate_wrapper('1285'); return false;\" title=\"param to enable fsync's (namely dagman)\">#1285</a></span>.  (By Ziliang Guo )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-18 13:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e7d0a5a2d5f655540629b51eae4711a04def33be\">[26857]</a></span>: Conditionalize fsync based on a config knob when writing user logs. Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1285\" onclick=\"get_ticket_and_populate_wrapper('1285'); return false;\" title=\"param to enable fsync's (namely dagman)\">#1285</a></span>. ===VersionHistory:Pending===  (By Ziliang Guo )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Sep-21 16:52", "status": "resolved", "created": "2010-Mar-17 10:34", "fixed_version": "2010-Mar-17 10:34", "broken_version": "v070500", "priority": "4", "subsystem": "Daemons", "assigned_to": "ziliang", "derived_from": "#1284", "creator": "tstclair", "rust": "", "customer_group": "users", "visibility": "public", "notify": "matt@cs.wisc.edu, dan@hep.wisc.edu, tstclair@redhat.com, tannenba@cs.wisc.edu, ziliang@cs.wisc.edu", "due_date": ""}