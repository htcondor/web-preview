{"id": 6011, "title": "Ticket #6011: Control bind mounts for Singularity", "description": "<blockquote>\nOne oversight in testing the initial Singularity support -\n\n<p>HTCondor automatically enables \"container mode\" for singularity, which applies additional isolation protections.\n\n</p><p>In this mode, the admin-specified automatic bind mounts (such as <code>/cvmfs</code>) are ignored.  Hence, we should add a configuration knob that allows HTCondor to add arbitrary bind mounts.\n\n</p><p>Marking as relatively important as various OSG VOs heavily utilize CVMFS and wouldn't be able to switch from glexec to singularity without it.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Dec-09 14:12:07 by wenger:</em> <br/>\n\nSINGULARITY_BIND_EXPR was documented in a commit for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5828\" onclick=\"get_ticket_and_populate_wrapper('5828'); return false;\" title=\"Initial Singularity support\">#5828</a></span>, so I'm going to resolve this ticket.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Dec-21 13:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/837faf5b37ca3d8ccf2119c303760b22ea03c5bc\">[49857]</a></span>: reduce singluarity detection chattyness, and time out the my_popen <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6011\" onclick=\"get_ticket_and_populate_wrapper('6011'); return false;\" title=\"Control bind mounts for Singularity\">#6011</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-13 20:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/181d77ff35e7d069e95dc9538818a0f798e6b12e\">[49584]</a></span>: Add singularity bind mount support. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6011\" onclick=\"get_ticket_and_populate_wrapper('6011'); return false;\" title=\"Control bind mounts for Singularity\">#6011</a></span> This introduces a new parameter, SINGULARITY_BIND_EXPR, into the configuration file for the starter. When set, it is evaluated as a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> expression with the TARGET set to the job ad and MY set to the machine ad.\u00a0[...]\n (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-11 20:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a65767893311d2c9574b0efdfbdf3f38babb208c\">[49580]</a></span>: Add singularity bind mount support. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6011\" onclick=\"get_ticket_and_populate_wrapper('6011'); return false;\" title=\"Control bind mounts for Singularity\">#6011</a></span> This introduces a new parameter, SINGULARITY_BIND_EXPR, into the configuration file for the starter. When set, it is evaluated as a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> expression with the TARGET set to the job ad and MY set to the machine ad.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Dec-09 14:12", "status": "resolved", "created": "2016-Nov-11 16:03", "fixed_version": "2016-Nov-11 16:03", "broken_version": "v080508", "priority": "2", "subsystem": "", "assigned_to": "wenger", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "bbockelm@cse.unl.edu", "due_date": ""}