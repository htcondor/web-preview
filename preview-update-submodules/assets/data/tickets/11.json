{"id": 11, "title": "Ticket #11: condor_q -run -format produces broken output", "description": "<blockquote>\n\"condor_status -run -format ...\" works as you might expect, it prints out your special format for all machines with running jobs. Great.\n\n<p>\"condor_q -run -format ...\" prints out a mixture of \"condor_q -run\" output and \"condor_q -constraint 'JobStatus==2' -format ...\" output. Not great.\n\n</p><p>Is this intended, or should it be fixed? There is a clear workaround, use \"condor_q -constraint 'JobStatus==2' -format ...\", but that's onerous. This also happens with -hold, -goodput, and -io.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Apr-23 16:46:29 by adesmet:</em> <br/>\n\nSee also <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=399\" onclick=\"get_ticket_and_populate_wrapper('399'); return false;\" title=\"condor_q -run and -format interact strangely.\">#399</a></span> which may be a dupe.\n<hr/>\n<em>2010-Oct-20 15:59:08 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:21:33 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2011-Nov-04 12:41:42 by adesmet:</em> <br/>\n\nContent of <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=399\" onclick=\"get_ticket_and_populate_wrapper('399'); return false;\" title=\"condor_q -run and -format interact strangely.\">#399</a></span>, which is basically a dupe:\n\n<p>condor_q -run -format produces odd output.\n\n</p><p>condor_q -run works as expected:\n</p><div class=\"code\">\n<pre class=\"code\">% condor_q -run | head\n\n-- Submitter: ribera.cs.wisc.edu : &lt;128.105.166.16:34160&gt; : ribera.cs.wisc.edu\n ID      OWNER            SUBMITTED     RUN_TIME HOST(S)\n1507.2   pdudnik         4/10 09:31   9+00:22:36 slot1@s1-23.cs.wisc.edu\n1507.6   pdudnik         4/10 09:31   9+00:22:57 slot2@s1-23.cs.wisc.edu\n1508.2   pdudnik         4/10 09:31   9+00:22:52 slot2@s1-28.cs.wisc.edu\n1510.2   pdudnik         4/10 09:32   6+11:58:41 slot1@s1-27.cs.wisc.edu\n1510.5   pdudnik         4/10 09:32   8+18:52:57 slot3@clover-17.cs.wisc.edu\n1510.6   pdudnik         4/10 09:32   6+12:18:38 slot2@s1-29.cs.wisc.edu\n</pre></div>\n\n\n<p>condor_q -format works as expected:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">% condor_q -format '%s ' RemoteHost -format '%s\\n' ImageSize -const 'JobStatus==2' | head\nslot2@s0-06.cs.wisc.edu 1100000\nslot2@s0-11.cs.wisc.edu 1000000\nslot1@clover-29.cs.wisc.edu 1100000\nslot3@clover-29.cs.wisc.edu 1100000\nslot2@s1-14.cs.wisc.edu 1100000\nslot1@s0-26.cs.wisc.edu 1100000\nslot1@clover-22.cs.wisc.edu 1100000\nslot3@clover-18.cs.wisc.edu 1200000\nslot2@clover-22.cs.wisc.edu 1100000\nslot1@clover-12.cs.wisc.edu 1200000\n</pre></div>\n\n\n<p>Both together partially works, but adds lines of [????]:\n</p><div class=\"code\">\n<pre class=\"code\">% condor_q -run -format '%s ' RemoteHost -format '%s\\n' ImageSize | head\nslot2@s0-06.cs.wisc.edu 1100000\n[????????????]  [????????????] [??????????] [????????????????]\nslot3@clover-29.cs.wisc.edu 1100000\n[????????????]  [????????????] [??????????] [????????????????]\nslot2@s1-14.cs.wisc.edu 1100000\n[????????????]  [????????????] [??????????] [????????????????]\nslot3@clover-18.cs.wisc.edu 1200000\n[????????????]  [????????????] [??????????] [????????????????]\nslot2@clover-22.cs.wisc.edu 1100000\n[????????????]  [????????????] [??????????] [????????????????]\n</pre></div>\n\n\n<p>Expected behavior: No lines full of brackets and question marks; essentially the same output if I replace \"-run\" with \"-const JobStatus==2\".\n\n</p><p></p><hr/>\n<em>2011-Nov-04 12:43:59 by adesmet:</em> <br/>\n\nZaniness also happens with -hold.\n\n<p></p><div class=\"code\">\n<pre class=\"code\">[root@submit squid]# condor_q -hold qpei -format '%s\\n' LastMatchName0\nglidein_27626@c3615.local\n[????????????]  [????????????] glidein_9804@c3113.local\n[????????????]  [????????????] glidein_24359@c1734.local\n[????????????]  [????????????]\n0 jobs; 0 idle, 0 running, 0 held\n[root@submit squid]# condor_q -format '%s\\n' LastMatchName0 -hold qpei\nglidein_27626@c3615.local\n[????????????]  11/4  12:41 The job attribute OnExitHold expression 'Ex\nglidein_9804@c3113.local\n[????????????]  11/4  12:42 The job attribute OnExitHold expression 'Ex\nglidein_24359@c1734.local\n[????????????]  11/4  12:41 The job attribute OnExitHold expression 'Ex\n\n0 jobs; 0 idle, 0 running, 0 held\n[root@submit squid]# condor_q -format '%s\\n' LastMatchName0 -const 'JobStatus==5' qpei\nglidein_27626@c3615.local\nglidein_9804@c3113.local\nglidein_24359@c1734.local\n</pre></div>\n\n\n<p>Expected behavior: all three of the above would return identical answers, with the last one being correct.\n\n</p><p></p><hr/>\n<em>2011-Nov-04 12:46:08 by adesmet:</em> <br/>\n\nGeneral proposal: -run, -hold, and -globus do two things:\n\n<p></p><ol>\n<li>Select a subset of jobs (-run means JobStatus==2. -hold means JobStatus==5)\n</li><li>Produce a special report.\n</li></ol>\n\n<p>If one of these options is present, and a -format option is present, we keep the subsetting, but discard the special report in favor of the -format.\n\n</p><p>The general logic needs an overhaul to remove the problem where order of seemingly unrelated arguments matters.\n\n</p><p></p><hr/>\n<em>2016-Jan-28 15:18:17 by johnkn:</em> <br/>\n\nas of 8.5.2,  condor_q has been substantially re-written so that <code>-run</code> and <code>-hold</code> will now only constrain the query when used with one of the other formatting options.  so\n\n<p></p><pre>    condor_q -run -af clusterid\n</pre>\n\n<p>will return only running cluster id's of running jobs, etc.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-May-16 11:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/59071d425dd8b3dbbbf8ee94c9302be6647f152a\">[50651]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a21caa8d51947f9228bfc4a524d3b2d1a65b2e97\">[50650]</a></span>, Fix minor typos in condor_analyze man page. Github pull request <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=11\" onclick=\"get_ticket_and_populate_wrapper('11'); return false;\" title=\"condor_q -run -format produces broken output\">#11</a></span> from Alain Roy  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-28 15:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6e93dbf671c306bd1252be1a93d8cf4855fd819a\">[47514]</a></span>: add -allusers and -progress to condor_q usage for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5271\" onclick=\"get_ticket_and_populate_wrapper('5271'); return false;\" title=\"condor_q should show only current owner's jobs by default\">#5271</a></span>. add version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=11\" onclick=\"get_ticket_and_populate_wrapper('11'); return false;\" title=\"condor_q -run -format produces broken output\">#11</a></span> (not a typo)  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-10 10:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d16516fed8b1a58a5e8d66aa2cc8f8c6a919bba4\">[46537]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/19569556771a1ccb618743a63cd4ff81ddd13689\">[46525]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/27bd329b6112db32b329d549567a2f250c07147a\">[46530]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eaea6a7a7c36a0d37b04310a58c33354a7929ff0\">[46531]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/01368697956c400efde410e74a1f4bd591e485e1\">[46532]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fe1359ecf1bad368d248ef6b1e68a028c5644103\">[46533]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d4426de42422c6f4fbbc3b73bae75aaed2887264\">[46534]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cdf32b7e9bb9d75f76ffdbfaae3b1b2f946b8f74\">[46535]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/61502ad201081ee53d08708c1f68b7e9449cf2bb\">[46536]</a></span>, Merge pull request <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=11\" onclick=\"get_ticket_and_populate_wrapper('11'); return false;\" title=\"condor_q -run -format produces broken output\">#11</a></span> from zhangzhehust/network_namespaces Make Bandwidth Monitoring work with file transfer  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Jan-29 14:21", "status": "resolved", "created": "2009-Jan-13 20:01", "fixed_version": "2009-Jan-13 20:01", "broken_version": "v070000", "priority": "5", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "#4976", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}