{"id": 6790, "title": "Ticket #6790: Submit object in python bindings needs a spool flag", "description": "<blockquote>\nThe Submit object in the python bindings has no support for spooling job files to the schedd. The old submit() function in the Schedd object does have a spool flag. The Schedd object already has spool() and retrieve() methods for doing the transfers of the job input and output sandboxes.\n\n<p>You can make spooling of job files work with the the Submit object today by manually setting several attributes in the job ads. Here's an example:\n</p><div class=\"code\">\n<pre class=\"code\">#!/usr/bin/python\n\nimport htcondor\nimport sys, os\n\nos.environ['X509_USER_PROXY'] = '/home/dcameron/dev/aCT/proxies/proxiesid2'\ncoll = htcondor.Collector('ce513.cern.ch:9619')\nsch = coll.locate(htcondor.DaemonTypes.Schedd)\nschedd = htcondor.Schedd(sch)\n\n# Including paths in Output or Error requires some extra changes\ncad = {\"Cmd\": \"/bin/ls\",\n      \"Output\": \"job.$(ClusterId).$(ProcId).out\",\n      \"Error\": \"job.$(ClusterId).$(ProcId).err\",\n      \"Iwd\": \"/tmp/output\",\n      \"+JobStatus\": \"5\",\n      \"+HoldReason\": \"\\\"Spooling input data files\\\"\",\n      \"+HoldReasonCode\": \"16\",\n      \"+LeaveJobInQueue\": \"JobStatus == 4 &amp;&amp; (CompletionDate =?= undefined || CompletionDate == 0 || ((time() - CompletionDate) &lt; 864000))\",\n      \"UserLog\": \"/tmp/output/job.$(ClusterId).$(ProcId).log\"}\n\nsub = htcondor.Submit(cad)\nad_list = []\n\nwith schedd.transaction() as txn:\n   jobid = sub.queue(txn, ad_results=ad_list)\n\nfor ad in ad_list:\n   ad[\"ClusterId\"]=jobid\n\nschedd.spool(ad_list)\n\nprint (jobid)\n</pre></div>\n\n\n<p>Note: If you want the output and error filenames to contain any path information, then you also need to set <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TransferOutputRemaps\" title=\"Transfer Output Remaps\">TransferOutputRemaps</a></span>.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=7771\" onclick=\"get_ticket_and_populate_wrapper('7771'); return false;\" title=\"Support spooled submits with the Submit object\">#7771</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nSupport spooled submits with the Submit object</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2018-Oct-17 13:53", "status": "new", "created": "2018-Oct-08 14:43", "fixed_version": "2018-Oct-08 14:43", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "atlas", "visibility": "public", "notify": "", "due_date": ""}