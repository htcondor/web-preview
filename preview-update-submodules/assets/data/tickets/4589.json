{"id": 4589, "title": "Ticket #4589: MAX_JOBS_RUNNING without scheduler universe jobs", "description": "<blockquote>\nMAX_JOBS_RUNNING should exclude scheduler universe jobs.  There's already a knob to manage scheduler universe jobs.\n\n<p>Right now, if you hit MAX_JOBS_RUNNING, the schedd starts/stops the scheduler universe jobs as quickly as possible.  The \"stop\" logic is aware of MAX_JOBS_RUNNING but the start logic is oblivious to it.</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Sep-16 12:28:39 by tannenba:</em> <br/>\n\nMaybe related to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4554\" onclick=\"get_ticket_and_populate_wrapper('4554'); return false;\" title=\"Exceeds MAX_JOBS_RUNNING\">#4554</a></span>?\n\n<p></p><hr/>\n<em>2014-Sep-18 13:40:11 by jfrey:</em> <br/>\n\nOne thing to note about changing MAX_JOBS_RUNNING: If you change START_LOCAL_UNIVERSE and/or START_SCHEDULER_UNIVERSE to reduce the number of local or scheduler universe jobs that can run at a time, the schedd won't (and can't) kill currently-running jobs to come down to the new limit. You could run condor_vacate_job to manually select some jobs to kill to get under the new limit.\n\n<p></p><hr/>\n<em>2014-Sep-18 13:42:33 by jfrey:</em> <br/>\n\nCurrently, when the schedd detects that it's over the current MAX_JOBS_RUNNING limit, it will immediately preempt enough jobs to get under the limit. It probably should throttle the preemptions to respect JOB_STOP_COUNT and JOB_STOP_DELAY.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-24 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/445c191ef20090772caad17f338c31db2d1d4c7f\">[41468]</a></span>: version history item edit, and unrelated spelling correction. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4589\" onclick=\"get_ticket_and_populate_wrapper('4589'); return false;\" title=\"MAX_JOBS_RUNNING without scheduler universe jobs\">#4589</a></span> Committer: Todd L Miller  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-24 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5b13ed449f65de6226854c669a82c32ebdbcded4\">[41464]</a></span>: Docs for MAX_JOBS_RUNNING change to only apply to shadows. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4589\" onclick=\"get_ticket_and_populate_wrapper('4589'); return false;\" title=\"MAX_JOBS_RUNNING without scheduler universe jobs\">#4589</a></span> Committer: Todd L Miller  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-24 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/75c88492246f104552eeb1ae627061333c5efc5d\">[41455]</a></span>: MAX_JOBS_RUNNING should exclude scheduler/local universe jobs. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4589\" onclick=\"get_ticket_and_populate_wrapper('4589'); return false;\" title=\"MAX_JOBS_RUNNING without scheduler universe jobs\">#4589</a></span> We are changing MAX_JOBS_RUNNING to throttle just shadow processes. We have parameters to limit the number of running scheduler and local universe jobs, which were previously also limited by MAX_JOBS_RUNNING.\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-09 13:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/aa50392bcf98e085a61a5f25ea26da263fb170f3\">[41363]</a></span>: version history item edit, and unrelated spelling correction. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4589\" onclick=\"get_ticket_and_populate_wrapper('4589'); return false;\" title=\"MAX_JOBS_RUNNING without scheduler universe jobs\">#4589</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-09 10:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2587d9234f7c0f68d8aa9ec727e79fb971055d3e\">[41357]</a></span>: Docs for MAX_JOBS_RUNNING change to only apply to shadows. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4589\" onclick=\"get_ticket_and_populate_wrapper('4589'); return false;\" title=\"MAX_JOBS_RUNNING without scheduler universe jobs\">#4589</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-08 16:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/149006262304ed6fc0934e9f3056d728078bf9a9\">[41345]</a></span>: MAX_JOBS_RUNNING should exclude scheduler/local universe jobs. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4589\" onclick=\"get_ticket_and_populate_wrapper('4589'); return false;\" title=\"MAX_JOBS_RUNNING without scheduler universe jobs\">#4589</a></span> We are changing MAX_JOBS_RUNNING to throttle just shadow processes. We have parameters to limit the number of running scheduler and local universe jobs, which were previously also limited by MAX_JOBS_RUNNING.\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Dec-22 09:45", "status": "resolved", "created": "2014-Sep-16 08:38", "fixed_version": "2014-Sep-16 08:38", "broken_version": "v080200", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "jfrey", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "bbockelm@cse.unl.edu, johnkn@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}