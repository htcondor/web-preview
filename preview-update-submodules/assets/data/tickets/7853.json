{"id": 7853, "title": "Ticket #7853: python submit method on schedd object should take a Submit object", "description": "<blockquote>\nAs a part of fixing <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=7655\" onclick=\"get_ticket_and_populate_wrapper('7655'); return false;\" title=\"Python bindings transaction behavior is confusing and undocumented\">#7655</a></span>, and transitioning to a stable and usable python submit API.  We plan to change the arguments of the <code>schedd.submit</code> method,\ndeprecating some, and replacing them with others.\n\n<p>Currently, <code>schedd.submit</code> takes a classad as it's first argument, that will be deprecated but still allowed, and the new argument type will be <code>htcondor.Submit</code>\n\n</p><p>In all cases, <code>count</code> and <code>spool</code> will be unchanged. But other arguments will depend on what is passed as the first argument.\n\n</p><p>If the first argument it a classad, a deprecation warning will fire, but the existing submission mechanism will still work, the submitted job ad(s) will optionally be returned in the <code>result_ads</code> list, and the return value will be the <code>ClusterId</code> as an integer.\n\n</p><p>If The first argument is not a classad\n\n</p><p></p><ul>\n<li>it must be a <code>htcondor.Submit</code> object.\n</li><li>The return value will be a <code>htcondor.SubmitResult</code> object instead of an integer.\n</li><li><code>count</code> and the new <code>itemdata</code> arguments will behave as they do with <code>Submit.queue</code> method\n</li><li>the <code>spool</code> argument will cause jobs to be submitted on spooling hold and the passed in <code>htcondor.Submit</code> object will be changed so that the jobs needed to spool can be accessed via the <code>htcondor.Submit.jobs</code> iterator method.\n</li></ul>\n\n<p>A new method on the schedd object: <code>Schedd.insert_jobs</code> will be added as a non-deprecated way to submit raw job classads to the schedd.  This will replace both <code>Schedd.submit</code> and <code>Schedd.submitMany</code> and it will do the absolute minimum amount of mutation of the classads (<code>ClusterId</code>, and <code>ProcId</code> will be set to agree with the newly allocated cluster / proc. nothing else will change.  In the future we may allow <code>ProcId</code> to pass through unmodified if is set in the incoming job classad.\n\n</p><p>In keeping with the way condor_submit works, the jobs passed to  <code>Schedd.insert_jobs</code>, will undergo attribute de-duplication so that there is a cluster classad, and a sequence of proc classads that contain only the differences.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Nov-10 10:29:42 by johnkn:</em> <br/>\n\nimported to jira as HTCONDOR-70</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Nov-17 14:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5831e2d8d874debc8e50a099c8c4c796b097d813\">[61684]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7853\" onclick=\"get_ticket_and_populate_wrapper('7853'); return false;\" title=\"python submit method on schedd object should take a Submit object\">#7853</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7693\" onclick=\"get_ticket_and_populate_wrapper('7693'); return false;\" title=\"Support oauth tokens and krb/kerberos credentials in local universe\">#7693</a></span> and HTCONDOR-67  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Sep-14 11:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cbcec94667587ab551d712cd45697b4280864a39\">[61287]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7853\" onclick=\"get_ticket_and_populate_wrapper('7853'); return false;\" title=\"python submit method on schedd object should take a Submit object\">#7853</a></span>. python bindings schedd.submit() method now accepts a htcondor.Submit object as the first argument. This is now the preferred method to submit jobs. It also now accepts itemdata in the same format as Submit.queue() when the first argument is a Submit object, and the return value is a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitResult\" title=\"Submit Result\">SubmitResult</a></span>\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Nov-17 15:06", "status": "resolved", "created": "2020-Sep-10 12:14", "fixed_version": "2020-Sep-10 12:14", "broken_version": "", "priority": "4", "subsystem": "PythonBinding", "assigned_to": "johnkn", "derived_from": "#7655", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}