{"id": 6937, "title": "Ticket #6937: Successful Application-Level Checkpointing Misidentified as Failure", "description": "<blockquote>\nDuncan Brown reports:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">I've encountered the following error:\n\n6070226.0   dbrown          2/27 17:41 Error from\nslot1@CRUSH-SUGWG-OSG-10-5-228-85: Job did not exit as promised when sent\nits checkpoint signal.  Promised exit was with exit code 255, actual exit\nstatus was with exit code 255.\n</pre></div>\n\n\n<p></p><div class=\"code\">\n<pre class=\"code\">More information: I did straces which suggests that condor_pid_ns_init and\ncondor_exec.exe are both exiting with status 255, as they are supposed to.\nThe problem also happens when I try and use a signal for checkpointing,\nrather than an exit code:\n\n+CheckpointExitBySignal = True\n+CheckpointExitSignal = 10\n\n6070287.0   dbrown          2/28 10:42 Error from\nslot1@CRUSH-SUGWG-OSG-10-5-228-85: Job did not exit as promised when sent\nits checkpoint signal.  Promised exit was on signal 10, actual exit status\nwas on signal 10.\n</pre></div>\n\n\n<p></p><div class=\"code\">\n<pre class=\"code\">It's a bug in the starter. The code to figure out what a successful checkpoint\nis...  inconsistent with the docs on the wiki page and the code ... that\ngenerates the error.\n\nThe former wants\n\n+SuccessCheckpointExitBySignal = True\n+SuccessCheckpointExitSignal = 10\n\nto see if the checkpoint was successful and the latter looks for\n\n+CheckpointExitBySignal = True\n+CheckpointExitSignal = 10\n\n(as per the docs on the wiki) to construct the hold error message. Adding\nboth sets of class ads to the submit file works around the problem.\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2019-Feb-28 14:29:50 by tlmiller:</em> <br/>\n\nProposed fix: change the code for the error message and the Wiki documentation to match the check that's actually being done, as that's more consistent with other cases where the user needs to specify what \"success\" means for the starter.\n\n<p></p><hr/>\n<em>2019-Feb-28 14:34:30 by tlmiller:</em> <br/>\n\nBuilding proposed fix on a branch until we've heard back from the user.  Wiki edit queued.\n\n<p></p><hr/>\n<em>2019-Mar-04 16:44:42 by tlmiller:</em> <br/>\n\nUser is okay with proposed changes.\n\n<p></p><hr/>\n<em>2019-Mar-04 16:47:37 by tlmiller:</em> <br/>\n\nDocumentation for this experimental feature was updated on the Wiki, which is the only documentation.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-28 14:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f528c198a6a4124829a40b5f7e37f333427617cc\">[56259]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6937\" onclick=\"get_ticket_and_populate_wrapper('6937'); return false;\" title=\"Successful Application-Level Checkpointing Misidentified as Failure\">#6937</a></span>) Change the #defines for the attributes the error message reports on to match the check the error message is trigger by.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Mar-29 11:10", "status": "resolved", "created": "2019-Feb-28 13:05", "fixed_version": "2019-Feb-28 13:05", "broken_version": "v080703", "priority": "2", "subsystem": "DaemonsExecNode", "assigned_to": "johnkn", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, dabrown@syr.edu", "due_date": ""}