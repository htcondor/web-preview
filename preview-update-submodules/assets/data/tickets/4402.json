{"id": 4402, "title": "Ticket #4402: Improve directory execute permission check in access_euid()", "description": "<blockquote>\nThe Condor utility library provides access_euid() (and helper access_euid_dir()), which acts like access(), but uses the current effective uid of the process, rather than the real uid. To test execute permission on a directory, we check whether the current euid or egid matches the owner or group of the directory and whether the corresponding execute bit is set. This doesn't take into account supplemental groups or POSIX ACLs, which can make Condor conclude the euid doesn't have permission when, in fact, it does.\n\n<p>Instead of manually examining the ownership and permissions of the directory, we could just try an operation that requires the permission that we want to check. That's what we do for read and write permissions on a directory. If we can chdir() to the directory, then we have the necessary execute permission.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jul-15 15:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/07f57141389c0aa2070f5d91b0f654a6149a16e8\">[40661]</a></span>: Docs for improved directory access check. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4402\" onclick=\"get_ticket_and_populate_wrapper('4402'); return false;\" title=\"Improve directory execute permission check in access_euid()\">#4402</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-17 13:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0ad7d678d088e2ac1701633afb351deb05530bd4\">[40452]</a></span>: Fix some warnings caused by changes in access_euid(). <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4402\" onclick=\"get_ticket_and_populate_wrapper('4402'); return false;\" title=\"Improve directory execute permission check in access_euid()\">#4402</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-17 12:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d270b9f26b5076aeb46b181b545b17984627eefc\">[40451]</a></span>: Lean on OS for access() with euid when possible. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4402\" onclick=\"get_ticket_and_populate_wrapper('4402'); return false;\" title=\"Improve directory execute permission check in access_euid()\">#4402</a></span> access() does file permission checks using the process's real uid. We want to do checks with the effective uid, so we wrote our own access_euid(). Recent versions of linux now provide euidaccess(), which does what we want and should do it better\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-17 12:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d5340197428a53e717e24cacd0fc6b41651e6302\">[40450]</a></span>: Improve directory execute permission check in access_euid(). <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4402\" onclick=\"get_ticket_and_populate_wrapper('4402'); return false;\" title=\"Improve directory execute permission check in access_euid()\">#4402</a></span> When checking whether the current euid has execute permission on a directory, attempt the operation instead of manually examining bits in the inode. We do this for read and write permissions, and it takes into account all ways in which\u00a0[...]\n (By David Champion )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Jul-15 15:51", "status": "resolved", "created": "2014-Jun-13 16:02", "fixed_version": "2014-Jun-13 16:02", "broken_version": "v080000", "priority": "3", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "atlas", "visibility": "public", "notify": "dgc@uchicago.edu", "due_date": ""}