{"id": 206, "title": "Ticket #206: timeslice timers delay scheduling of local/scheduler universe jobs", "description": "<blockquote>\nThe schedd uses a timeslice timer to aid in scheduling of Scheduler::timeout(), the main house-keeping function of the schedd, responsible for many things including scanning the job queue and counting idle jobs.  The timeslice timer is used for scalability reasons.  For very large queues, scanning the queue is expensive, so we schedule it less frequently.  The result is that we maintain high throughput when dealing with large queues of reasonably long-running jobs.\n\n<p>However, when our task is to run jobs with minimal delay after they enter the queue, the delays introduced by the timeslice timer tend to reduce response-time.  This has been observed for scheduler/local universe jobs on highly loaded submit machines.  Setting SCHEDD_INTERVAL_TIMESLICE close to 1.0 can be done to increase responsiveness, but this may sacrifice scalability quite a bit.  The question is whether we can be more efficient about scanning for new jobs to run without all the expense that is currently implied by Scheduler::timeout().\n\n</p><p>A related worry is that occasional load spikes may cause the timeslice timer to overreact and introduce undesirable delays.  I will make the timeslice calculation use an exponential moving average in its estimate of the expected runtime for the task, rather than just using the most recent runtime.  This will smooth out temporary spikes.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Feb-10 11:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/56f44fff5f09e88dcd5755ec80869e7ebe6ed14b\">[13795]</a></span>: Added moving average to timeslice delay calculation. This is intended to smooth out fluctuations in the delay between firings of a timeslice timer. (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=206\" onclick=\"get_ticket_and_populate_wrapper('206'); return false;\" title=\"timeslice timers delay scheduling of local/scheduler universe jobs\">#206</a></span>)  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Sep-21 11:27", "status": "defer", "created": "2009-Feb-10 11:26", "fixed_version": "2009-Feb-10 11:26", "broken_version": "v070200", "priority": "5", "subsystem": "Daemons", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "danb@cs.wisc.edu,psilord@cs.wisc.edu,pcouvare@caltech.edu", "due_date": ""}