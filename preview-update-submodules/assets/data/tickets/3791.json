{"id": 3791, "title": "Ticket #3791: condor_submit -spool fails on Windows", "description": "<blockquote>\n<code>condor_submit -spool</code> always fails on Windows because the SCHEDD is making an invalid check for read access for the executable in the spool directory, even though the file isn't even there yet.\n\n<p>This failure is showing up as failure of the condor-c test in the batlab. see <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=3776\" onclick=\"get_ticket_and_populate_wrapper('3776'); return false;\" title=\"windows condorc_ab issues\">#3776</a></span> for more details.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Jul-18 16:34:15 by johnkn:</em> <br/>\n\nat line 418 of file_transfer.cpp, there is a windows specific test for read access to the executable that always fails on Windows when this code is executed by the SCHEDD as a result of condor_submit -spool.\n\n<p></p><div class=\"code\">\n<pre class=\"code\">#ifdef WIN32\nif ( perm_obj &amp;&amp; (perm_obj-&gt;read_access(buf) != 1) ) {\n   // we do _not_ have permission to read this file!!\n   dprintf(D_ALWAYS,\"FileTrans: permission denied reading %s\\n\",buf);\n   return 0;\n}\n#endif\n</pre></div>\n\n\n<p>When the SCHEDD executes this code, buf is a relative path to the executable, and the current working directory of the SCHEDD is $(LOG), so this test always fails.   TJ &amp; Jaime think this test is entirely bogus for the SCHEDD so the fix is to disable the test when simple_init is true.\n\n</p><p></p><hr/>\n<em>2013-Aug-13 10:28:32 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>This change looks good.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Aug-19 09:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c17ba16942140d3bbe4150d6c458e230443025b2\">[37266]</a></span>: minor 8.0.2 version history item edit ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3791\" onclick=\"get_ticket_and_populate_wrapper('3791'); return false;\" title=\"condor_submit -spool fails on Windows\">#3791</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Aug-13 15:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/da8170b9cf4e54f6f94751a9a4acaa305194b7e0\">[37197]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3791\" onclick=\"get_ticket_and_populate_wrapper('3791'); return false;\" title=\"condor_submit -spool fails on Windows\">#3791</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jul-18 16:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/896712eaa03f4600dc3b6d06260d60b4934f949e\">[36957]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3791\" onclick=\"get_ticket_and_populate_wrapper('3791'); return false;\" title=\"condor_submit -spool fails on Windows\">#3791</a></span>) disable bogus windows-specific read_access test in the file transfer object that is preventing condor_submit -spool and condor-c from working on Windows. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Aug-13 15:44", "status": "resolved", "created": "2013-Jul-18 16:14", "fixed_version": "2013-Jul-18 16:14", "broken_version": "v080000", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}