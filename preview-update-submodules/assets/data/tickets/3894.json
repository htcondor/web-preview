{"id": 3894, "title": "Ticket #3894: condor_config_val -dump should work remotely", "description": "<blockquote>\nAdd to daemon core the ability to query the names of all configuration knobs, and add to condor_config_val the ability to use that to provide the functionality of\n\n<p></p><pre>    condor_config_val -&lt;daemon&gt; [-dump|-verbose]\n</pre>\n\n<p>where &lt;daemon&gt; is master, startd, etc.\n\n</p><p>Current daemons already support the <code>DC_CONFIG_VAL</code> function, but only <code>condor_who</code> uses it - <code>condor_config_val</code> does not.  This gives us the oppotunity to extend the behavior of DC_CONFIG_VAL so support more complex queries by using characters not allowed in param names.  And to return more than a single string result back.\n\n</p><p>The <code>DC_CONFIG_VAL</code> command will be extended to look for <code>?</code> in the first character position of the input argument.  If it exists, what follows will be a command rather than a parameter name.  Initially, the supported commands will be\n\n</p><p></p><ul>\n<li><code>?names[:&lt;regex&gt;]</code> - return all of the param names. Optionally return all of the names that match the given regex.\n</li></ul>\n\n<p>Additionally, the normal <code>DC_CONFIG_VAL</code> query, which passes a single param name, will now return multiple strings in the following order.  HTCondor daemons prior to 8.1.2 will return only the first line, so clients of the <code>DC_CONFIG_VAL</code> command must be prepared to deal with getting back either 1 string or an arbitrary number of strings - future versions of daemon core may return more additional strings after <code>&lt;default-value&gt;</code>\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">&lt;expanded-value&gt;\n&lt;name&gt; = &lt;raw-value&gt; (like the line would appear in the config file)\n&lt;source&gt;[, line &lt;lineno&gt;]\n&lt;default-value&gt;\n</pre></div>\n\n\n<p>where &lt;source&gt; can be a filename, or &lt;Detected&gt;, &lt;Default&gt;, &lt;Environment&gt;, &lt;Over&gt;, or &lt;Internal&gt;.\n\n</p><p><code>condor_config_val</code> will be enhanced to make use of the expanded return values of <code>DC_CONFIG_VAL</code> and of the new <code>?names</code> query to add support for -dump and and -verbose modes for remote queries.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-21 15:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3d6787abccedf858c94f772f9323b5ecffc57e49\">[40203]</a></span>: extended 8.1.6 version history item to identify all the new configuration file changes <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3820\" onclick=\"get_ticket_and_populate_wrapper('3820'); return false;\" title=\"Param system improvements for v8.1 series\">#3820</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4325\" onclick=\"get_ticket_and_populate_wrapper('4325'); return false;\" title=\"Strip default condor_config file down to the bare essentials.\">#4325</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4319\" onclick=\"get_ticket_and_populate_wrapper('4319'); return false;\" title=\"add #include like mechanism to config file parser\">#4319</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4211\" onclick=\"get_ticket_and_populate_wrapper('4211'); return false;\" title=\"Add #ifdef-like mechanism to config file parser\">#4211</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-18 17:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c28dda7cc126b2768ee6ce69ec8f07f6b29d7774\">[38750]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> print out contributing config files from remote condor_config_val -dump ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-31 14:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/aa580f15e183de53bb6e8e53783fdbb5c3781fcb\">[38056]</a></span>: quick edits of 8.1.2 version history items for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3897\" onclick=\"get_ticket_and_populate_wrapper('3897'); return false;\" title=\"Remotely queryable history\">#3897</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-31 13:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fe9bc9c1e26dbb48fb17a378c0559ee7a2b56bf3\">[38052]</a></span>: Version histrory for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-31 13:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1787911e2afea5b3f29ad10ec9b849a2a9ed351e\">[38054]</a></span>: Version histrory for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-22 10:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8a5223b7c3236dd7f963a9e90d29418b12b20d65\">[37948]</a></span>: document new -writeconfig option for condor_config_val <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-16 13:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/460f0e27f657ee6deddb35f11414b1f1c221adc5\">[37890]</a></span>: fix bug in DC_CONFIG_VAL where query can cause a NULL deref. for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:None=== bug never shipped.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-14 12:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8b41d982bac3c5a1020bc057e704cc8c7ac676c3\">[37833]</a></span>: fix typo that caused param_get_info to never return default value. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-10 11:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d1a74a620e65924c38c111be5c582c80a2e88d59\">[37810]</a></span>: add -writeconfig option to condor_config_val <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-10 10:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fa9991bda2ecc87ea5a9738d3a2cd7260c4ce157\">[37809]</a></span>: complete the rewrite of the condor_config_val manual page <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-09 17:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/91f278ddc9cb51b73f7c9f9728a0f3c6f1d346c6\">[37807]</a></span>: not yet finished: complete rewrite of condor_config_val man page <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-08 19:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/36bb864751d26dc202fae7f2b4e583f056f6177d\">[37804]</a></span>: fix fedora warning, bad memcpy size in HASHITER assignment and remove more obsolete code for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-08 12:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eb6d773bd23d8b3e1912fc275514f14651ebb88f\">[37801]</a></span>: prune code made obsolete by previous <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> changes. fix typos and clarify condor_config_val useage ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-07 17:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1d9b48a616aaeb4eccea3ab7b76147431aef4c4a\">[37794]</a></span>: ifdef out the param namespace references when compiling as C. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-07 14:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/07e45a1f73b548ecc011e75a119d6f868d3dbe85\">[37790]</a></span>: Better support for verbose for condor_config_val -dump of default <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-04 11:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/be2a51114303fa9af2e87874debc2fd3b62fadbe\">[37772]</a></span>: comment out function arg name to make fedora happy. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-04 11:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fb71bca247583c0c1a90ba8d45d46b66cd8a11f9\">[37771]</a></span>: add support for quering default params for remote condor_config_val -dump <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> this commit changes the low-level storage of params to a sorted array. default params longer copied into the config table when referenced, and param param use/size statistics can now be reported, both locally and remotely.\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-18 13:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/05fcad2e808e647edabe346107300512f5864909\">[37647]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>, add use and reference counts to param table, and optionally return that information with condor_config_dump. works for local and daemon queries. ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-13 10:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4000314a79b180c02c63b3a715024f79af1fb9cb\">[37590]</a></span>: quiet covertity warning for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> by removing unnecessary NULL check. ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-12 18:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d820619ecb03f8e4a18058179cd4f360a170a060\">[37587]</a></span>: Make condor_config_val -dump work remotely <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span>. this commit also adds support for -verbose and -raw for remote and pattern matching for -dump. ===VersiionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Oct-22 10:36", "status": "resolved", "created": "2013-Sep-05 13:10", "fixed_version": "2013-Sep-05 13:10", "broken_version": "v080000", "priority": "4", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "#3820", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}