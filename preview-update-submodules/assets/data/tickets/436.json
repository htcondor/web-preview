{"id": 436, "title": "Ticket #436: x_trapsig in test suite busy loops consuming a lot of CPU", "description": "<blockquote>\nIn running the test suite by hand on my laptop, I noticed a lot of CPU time is going to x_trapsig.exe.  The reason for this is in x_trapsig.c, we busy loop with\n\n<p></p><pre>   while(1);\n</pre>\n\n<p>when waiting to receive a signal.\n\n</p><p>Seems like this could be easily improved by replacing the while loop with a call to <code>sigwait()</code>.  This should be semantically identical, and yet drastically reduce the CPU requirements of the test suite.</p></blockquote>", "remarks": "<blockquote>\nFixed by converting it to use sigwait. Pushed to master.\n\n<p></p><hr/>\n<em>2009-May-06 12:18:29 by tannenba:</em> <br/>\n\nLooks like using sigwait() fails on Solaris because apparently sigwait() takes a single argument on Solaris instead of two arguments everywhere else.\n\n<p>Seems like either a configure rule is needed, or perhaps it'd be more simple to use pause() instead of sigwait().\n\n</p><p></p><hr/>\n<em>2010-Jan-15 14:25:23 by bt:</em> <br/>\n\n1/15/10 Looks like we fixed this in may.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-May-06 08:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/36f3ddd46bc3b5114f86fb0dfd40982a4246bff5\">[14648]</a></span>: Turn off second test using sigwait with 2 args on solaris <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=436\" onclick=\"get_ticket_and_populate_wrapper('436'); return false;\" title=\"x_trapsig in test suite busy loops consuming a lot of CPU\">#436</a></span> (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-May-05 16:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/83f1ed15506562f254c7b54ab7bc8277c9909133\">[14642]</a></span>: Test turned off on solaris because of sigwait differences there. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=436\" onclick=\"get_ticket_and_populate_wrapper('436'); return false;\" title=\"x_trapsig in test suite busy loops consuming a lot of CPU\">#436</a></span> (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-May-01 13:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5fdb0824ed987dcfc5d2d5b6e7456e5e9d79e7a5\">[14625]</a></span>: Replaced busy loop with sigwait <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=436\" onclick=\"get_ticket_and_populate_wrapper('436'); return false;\" title=\"x_trapsig in test suite busy loops consuming a lot of CPU\">#436</a></span>  (By Bill Taylor )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Jan-15 14:25", "status": "resolved", "created": "2009-Apr-30 12:07", "fixed_version": "2009-Apr-30 12:07", "broken_version": "v070300", "priority": "3", "subsystem": "Tests", "assigned_to": "bt", "derived_from": "", "creator": "tannenba", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}