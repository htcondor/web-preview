{"id": 2588, "title": "Ticket #2588: User log gives unhelpful exception reason for permissions problems", "description": "<blockquote>\n1. On Linux...\n2. Create an executable that creates a new file with unusual permissions. (The unusual permissions part is probably optional)\n3. Submit the executable as a job using file transfer.  The submit directory should be on a Samba mount with permissions mashed to 777.\n4. Observe that the job encounters a stream of shadow exceptions and eventually fails.\n5. Observe that the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowLog\" title=\"Shadow Log\">ShadowLog</a></span> contains a pretty clear error: (anonymized)\n<div class=\"code\">\n<pre class=\"code\">10/26/11 11:18:43 (3198015.0) (1306): ReliSock::get_file_with_permissions(): Failed to chmod file '/mnt/smb/outfile': Operation not permitted (errno: 1)\n10/26/11 11:18:43 (3198015.0) (1306): DoDownload: SHADOW at XXX.XXX.XXX.XXX failed to receive file /mnt/smb/outfile\n10/26/11 11:18:43 (3198015.0) (1306): Can no longer talk to condor_starter &lt;XXX.XXX.XXX.XXX:33379&gt;\n</pre></div>\n\n\n<p>Expected behavior: the job log gives an error something like \"ReliSock::get_file_with_permissions(): Failed to chmod file '/mnt/smb/outfile': Operation not permitted (errno: 1)\"\n\n</p><p>Actual behavior:\n</p><div class=\"code\">\n<pre class=\"code\">022 (3198056.000.000) 10/26 11:04:11 Job disconnected, attempting to reconnect\n    Socket between submit and execute hosts closed unexpectedly\n    Trying to reconnect to slot5@example.com &lt;XXX.XXX.XXX.XXX:33695&gt;\n</pre></div>\n\n\n<p>Reporting an unexpected disconnect is not helpful to the user and fails to identify the real problem (an inability to chmod a file).  It's downright misleading, as the connection was not unexpectedly closed, we closed it with intent.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2011-Oct-26 11:33", "status": "new", "created": "2011-Oct-26 11:33", "fixed_version": "2011-Oct-26 11:33", "broken_version": "v070702", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}