{"id": 4782, "title": "Ticket #4782: Recognize My in native ClassAds", "description": "<blockquote>\nIn the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> compatibility class, we add and remove a <code>My</code> attribute every time we do an evaluation or reference tracking. The native <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> library already has a special <code>self</code> attribute that refers to the current ad (which we use to implement <code>My</code>). If we had the library recognize <code>My</code> the same as <code>self</code>, then we eliminate lots of temporary modifications of the ad in the compatibility class and callers could use the native <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> evaluation methods.\n\n<p>We could make the recognition of <code>My</code> contingent on <code>_useOldClassAdSemantics</code> being set to true, so users of <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> other than HTCondor wouldn't see it.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Jan-27 16:21:19 by jfrey:</em> <br/>\n\nNo user-visible changes, so no version history.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-07 15:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/90253e1190bb48a073b47342e90759bcd40fe548\">[42128]</a></span>: None of the Eval methods of the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> compat layer can be const. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4782\" onclick=\"get_ticket_and_populate_wrapper('4782'); return false;\" title=\"Recognize My in native ClassAds\">#4782</a></span> Use of the optional target <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> means this ad will be modified.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-07 15:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/52f96b36eb585caf84ba822e5c1ebef4f65468d7\">[42127]</a></span>: ClassAd::EvalAttr() can't be const, like the other Eval methods can. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4782\" onclick=\"get_ticket_and_populate_wrapper('4782'); return false;\" title=\"Recognize My in native ClassAds\">#4782</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-07 14:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/43f1b8dd93337a2ebd751d82002e26e3b689566c\">[42125]</a></span>: Add const to evaluation methods on <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CalssAd\" title=\"Calss Ad\">CalssAd</a></span> compatibility layer. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4782\" onclick=\"get_ticket_and_populate_wrapper('4782'); return false;\" title=\"Recognize My in native ClassAds\">#4782</a></span> Now that we don't have to insert a My attribute, the evaluation methods can be const.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-18 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1fcdb6a68b61c142cd19d9f83a0f43d67b98cfbd\">[41968]</a></span>: Use ClassAd's recognition of My in Condor's compatibility layer. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4782\" onclick=\"get_ticket_and_populate_wrapper('4782'); return false;\" title=\"Recognize My in native ClassAds\">#4782</a></span> The compat layer no longer needs to insert and remove a My attribute on every evaluation. Adjust the unit tests to account for whole <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> no longer being inlined.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-18 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c0bf69e2aec83cc20d456173ef69a0fff07b7996\">[41967]</a></span>: Add special attribute My in new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>, similar to self. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4782\" onclick=\"get_ticket_and_populate_wrapper('4782'); return false;\" title=\"Recognize My in native ClassAds\">#4782</a></span> In the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> compatibility layer, we add and remove a My attribute every time we do an evaluation or track references. The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> library already has a special 'self' attribute that refers to the current ad (which we use to implement\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Jan-27 16:21", "status": "resolved", "created": "2014-Dec-16 15:40", "fixed_version": "2014-Dec-16 15:40", "broken_version": "v080200", "priority": "3", "subsystem": "ClassAd", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}