{"id": 3136, "title": "Ticket #3136: Incorporate a full unit-testing strategy for condor.", "description": "<blockquote>\nIn the classad-caching work I front loaded the pipeline to enable boost across condor's supported platforms.  This work is intended to extend that effort and hook into boosts unit_testing_framework.\n\n<p><a class=\"external\" href=\"http://www.boost.org/doc/libs/1_50_0/libs/test/doc/html/index.html\">http://www.boost.org/doc/libs/1_50_0/libs/test/doc/html/index.html</a>\n\n</p><p><strong>Milestones</strong>\n</p><ul>\n<li>Create build infrastructure to support inline tests run as part of the build. <strong>[Done]</strong>\n<ul>\n<li>CTest is integrated w/boost::test under a condor_unit_test macro which allows you to run 'make test' and it will kick all the unit tests. I will probably rename the old tests target to condor_tests or equiv. <strong>[Done]</strong>\n</li></ul>\n</li><li>Push DC-exe's into stub (main entry points) and lib (everything else), so the lib can be bound into a testrunner executable.\n<ul>\n<li>Start with the collector as an example which will be used as a frontloaded example. <strong>[Done]</strong>\n</li></ul>\n</li></ul>\n\n<p>changes are in tracking branch under master-test</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Jul-18 15:35:57 by tstclair:</em> <br/>\n\nSo the question had been raised a number of times about whether CTest would be a good substitute for batch_test.pl, and after walking through the whole chain the answer is definitively <strong>NO</strong>, and here is why.\n\n<p>CTest is structured to kick-off against elements in a build tree but can not be leveraged outside of that structure.  Which makes it great for unit testing, which is what I have set it up to do, but I would advise against it for any level of integration testing.\n\n</p><p>Arguably many of the tests that are under condor_tests can and should now be shifted to unit_tests and leave some of the other tests for a different harness which is not so tightly wound into the src tree.\n\n</p><p></p><hr/>\n<em>2012-Jul-20 15:33:47 by tstclair:</em> <br/>\n\nboost is <strong>only</strong> enabled and bound when BUILD_TESTING is enabled (ON By Default), and is only bound to the test executables which are not shipped.\n\n<p></p><hr/>\n<em>2012-Jul-24 16:34:21 by tstclair:</em> <br/>\n\nMerge is pending on modifications to nmi's windows VM, that should honestly take no more then a couple of hours, but I'm estimating 3 weeks.\n<hr/>\n<em>2012-Oct-22 14:59:14 by zmiller:</em> <br/>\n\nBulk change of target version from v070901 to v070902 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2013-Jan-18 11:54:35 by tannenba:</em> <br/>\n\nChanged from Resolved to design review, as I do not see any documentation in any form of how to use this, how/why boost+ctest and how it all fits together.  Also this ticket lived in code review status, and yet no evidence anything was reviewed.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-12 10:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8b645d77a2aa07758b3d1557f06b430f00487ac1\">[34902]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update windows macro to create new folder(unit_tests) and setup link deps in macro for unit tests which are created prior to external link_directories() statement in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorConfigure\" title=\"Condor Configure\">CondorConfigure</a></span>  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-20 10:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0d12a9f7f1373db9235086d46bcb2ddd68386a24\">[33113]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Cleanup windows build issues around testing  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-15 14:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/53ccaf148dd599edb4aa5e957a34bbf9c095a834\">[33079]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> - Update for old versions of boost re:PROPER rhel5  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/64f7114edcfd0b295389b2607874a283ce73d533\">[33000]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update to segregate the collector for testing. Now onto windows.  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/77d9751425fd1c000967031a1552d98094018772\">[33001]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Incorporate testing mods into windows.  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/765274f2ce685c259a45e48306e6e4f65360bf84\">[33002]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Fixes for non-proper building  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/389efb368db33c90f78874ef055cb1a201739353\">[33003]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> fix copy past issue on dependencies  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/671ec432c4ee7688d8f78ab85eb61715f2e71009\">[33004]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update glue to try VS2010  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8f459eccd9a6bc8722c3558f7362aa4e32498bf2\">[33005]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update other glue and scripts to prefer VS2010 over 2008  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e10241c02a424c714c9fb5e210e37a9ba4ddad6b\">[33006]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> More glue hacking for vs2010 support  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6e328d4f9f48e00415090c8a2cfeca7ef342dfd3\">[33007]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update both build script and glue to prefer 2010  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7450de3c4866e23fad7dfd42c4170e60531cc401\">[33008]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> reset glue mods to just support vs2008 by default let upstream handle the delta once nmi is ready for 2010  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-08 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c3e99cbae9a49828d38fcc2b8f07e8e72e314664\">[32999]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> CTest ++ macros to kick boost::test along with cmake cruft cleanup.  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-07 13:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/705e9e12c436df0b2d69562f336f2c11b461c1d6\">[32992]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> reset glue mods to just support vs2008 by default let upstream handle the delta once nmi is ready for 2010  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-24 15:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/09f41a6f8e7e8ad18089c872054d76f97631c895\">[32903]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update both build script and glue to prefer 2010  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-24 13:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fbd0e819edc8e3be8168fa53ee17692e29d99e59\">[32902]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> More glue hacking for vs2010 support  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-23 16:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6ff2f14f3fef247675fef13e67c72af9a2ade351\">[32891]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update other glue and scripts to prefer VS2010 over 2008  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-23 15:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f27cb56b80d82c5e7187af11f0545980826e965a\">[32889]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update glue to try VS2010  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-23 11:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bae65851d70fb666d0dda349c2c46c2fa9220e3c\">[32888]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> fix copy past issue on dependencies  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-20 15:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2b2fc94f3eb35f70b8e2244379fd69304de6b8d1\">[32879]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Fixes for non-proper building  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-20 11:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/34592b28494a3e11b39a3749d7863f6cf24e0c5e\">[32869]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Incorporate testing mods into windows.  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-19 10:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/90218ed30ff8d268f60bf0c2426a425a01d378b2\">[32857]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> Update to segregate the collector for testing. Now onto windows.  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-18 14:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ce8a252fce79f41bb83a391816b00deb7a8f7410\">[32850]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3136\" onclick=\"get_ticket_and_populate_wrapper('3136'); return false;\" title=\"Incorporate a full unit-testing strategy for condor.\">#3136</a></span> CTest ++ macros to kick boost::test along with cmake cruft cleanup.  (By Timothy St. Clair )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Sep-22 10:52", "status": "resolved", "created": "2012-Jul-18 13:03", "fixed_version": "2012-Jul-18 13:03", "broken_version": "v070901", "priority": "5", "subsystem": "Libs", "assigned_to": "johnkn", "derived_from": "#3154", "creator": "tstclair", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com matt@cs.wisc.edu eje@cs.wisc.edu kronenfe@cs.wisc.edu tannenba@cs.wisc.edu", "due_date": ""}