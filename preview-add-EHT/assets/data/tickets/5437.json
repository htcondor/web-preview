{"id": 5437, "title": "Ticket #5437: starter induced holds cause output sandbox xfer", "description": "<blockquote>\nWhen the starter initiates a job hold, like with a cgroup OOM event, output files are transfered back to the submit machine.  When a user runs condor_hold, the output sandbox is not brought back.  These should be consistent.</blockquote>", "remarks": "<blockquote>\n<em>2016-Jun-18 14:58:31 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>Starter-&gt;Hold() primarily sends the job the hold signal.\n\n</p><p>Starter-&gt;allJobsDone() calls CStarter::TransferOutput() if JIC::allJobsDone() returned true (which it usually will for vanilla universe); this function will in turn call JIC::TransferOutput(), which will do file transfer.\n\n</p><p>Starter-&gt;shutdownFast() kills a bunch of processes.  It will also call Starter-&gt;allJobsDone() if all the jobs were already done (or were killed immediately as a result of shutting down fast).\n\n</p><p>So the second two removals appear to be necessary.  The call to Starter-&gt;Hold() may have been superfluous, but I'm not sure about the implications, one way or the other, for someone using ssh-to-job (as far as I know, the only way to get a second Proc object in a single job).  It seems like somebody who's logged in shouldn't be kicked out (in case they want to do a post-mortem, which this patch makes harder to do because they won't get intermediate files back).  This may be another ticket.\n\n</p><p>The other concern would then be what this does to the starter log (we already have too many cases where the normal course of action is the abnormal termination of the starter), but that's probably another ticket as well.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Dec-16 14:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b6044a931d6bd85e7c2b801abaee738fe213e925\">[46601]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5437\" onclick=\"get_ticket_and_populate_wrapper('5437'); return false;\" title=\"starter induced holds cause output sandbox xfer\">#5437</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Dec-11 10:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d6d166bd162b60cb275aa05364a970610b232af2\">[46576]</a></span>: Don't xfer sandbox when starter holds jobs <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5437\" onclick=\"get_ticket_and_populate_wrapper('5437'); return false;\" title=\"starter induced holds cause output sandbox xfer\">#5437</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Aug-15 11:39", "status": "resolved", "created": "2015-Dec-11 10:32", "fixed_version": "2015-Dec-11 10:32", "broken_version": "v080400", "priority": "2", "subsystem": "", "assigned_to": "tlmiller", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "lmichael@wisc.edu", "due_date": ""}