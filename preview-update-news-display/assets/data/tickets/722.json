{"id": 722, "title": "Ticket #722: Remove Insert() and Append() variants in our List class", "description": "<blockquote>\nOur List class has two variants for its Insert() and Append() methods. One takes a pointer to the item to be added and the other takes a reference. The reference variant just takes the address of the item and calls the pointer variant. The code comments say that the reference variant is useful for adding items on the stack or in global data space. Since the List always stores a pointer to the item, adding stack variables is dangerous, as the List then can't leave the local scope.\n\n<p>I've found a couple places in the code that use the reference variant and assume the items are copied, rather than a pointer taken. One function inserts a local variable and returns the List to the caller. Another inserts the same variable multiple times, assigning different values in between calls.\n\n</p><p>The reference variants of these two methods are only used in four source files. To avoid misuse, we should remove them and convert the few callsites to the pointer variant. We should also fix the existing faulty code.</p></blockquote>", "remarks": "<blockquote>\nCommitted changes for 7.4.0.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-10 11:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/036df2499f6efd94eddc4b822c4ab2adacb22955\">[15649]</a></span>: Remove bad calls to List Append() in Windows-only code (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=722\" onclick=\"get_ticket_and_populate_wrapper('722'); return false;\" title=\"Remove Insert() and Append() variants in our List class\">#722</a></span>) The faulty code was never called, so I removed it.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-09 13:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7791fb1e59c503626c2c6f3f5403aa90d92e4308\">[15639]</a></span>: Add Insert method to <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SimpleList\" title=\"Simple List\">SimpleList</a></span> (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=722\" onclick=\"get_ticket_and_populate_wrapper('722'); return false;\" title=\"Remove Insert() and Append() variants in our List class\">#722</a></span>)  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-09 13:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fccfd1f5da2c8f74a38b403fe4ddfdf8d0c7f501\">[15640]</a></span>: Fix bad usage of List Insert() and Append() methods (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=722\" onclick=\"get_ticket_and_populate_wrapper('722'); return false;\" title=\"Remove Insert() and Append() variants in our List class\">#722</a></span>) Remove error-prone variants of Insert() and Append() in our List class. Fix buggy usage of these methods.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Jan-31 13:41", "status": "resolved", "created": "2009-Sep-09 11:24", "fixed_version": "2009-Sep-09 11:24", "broken_version": "v070302", "priority": "3", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}