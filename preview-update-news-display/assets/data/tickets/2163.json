{"id": 2163, "title": "Ticket #2163: EvalFloat doesn't promote a boolean result to a float", "description": "<blockquote>\nThe startd uses Classad::EvalFloat to evaluate RANK expressions, amoung other things.  In old classads, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=EvalFloat\" title=\"Eval Float\">EvalFloat</a></span> would promote a boolean to a float (0 for false, 1 for true).  In the new classad wrappers, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=EvalFloat\" title=\"Eval Float\">EvalFloat</a></span> does not.  This breaks configs like the following:\n\n<p>RANK = (Owner == \"coltrane\")\n\n</p><p>Which is disturbingly close to examples we recommend in the manual.  Note that internally within the expression, bool's get promoted to float:\n\n</p><p>RANK = (Owner == \"coltrane\") + 0\n\n</p><p>works.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-May-17 13:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ffca0c47986af624673075f3c30afc3ae5f1cc32\">[21878]</a></span>: Allow <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=EvalFloat\" title=\"Eval Float\">EvalFloat</a></span> to promote booleans to float. This is useful for startd RANK. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2163\" onclick=\"get_ticket_and_populate_wrapper('2163'); return false;\" title=\"EvalFloat doesn't promote a boolean result to a float\">#2163</a></span> ===VersionHistory=== Fixed bug throughout classads where expressions expecting a floating point value returned an error if the expression actually evaluated to a boolean. This is most common in startd RANK expressions.\u00a0[...]\n (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-May-17 13:54", "status": "resolved", "created": "2011-May-17 13:40", "fixed_version": "2011-May-17 13:40", "broken_version": "v070600", "priority": "2", "subsystem": "", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}