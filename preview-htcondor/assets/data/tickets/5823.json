{"id": 5823, "title": "Ticket #5823: Test for condor_transform_ads tool", "description": "<blockquote>\nNeeds to have a test for condor_transform_ads tool.\n\n<p>Notes:\n\n</p><p>1) COPY /&lt;regex&gt;/ &lt;newattr&gt; and RENAME /&lt;regex&gt;/ &lt;newattr&gt; does not recognize &lt;newattr&gt;, and output an error message\n\n</p><p>2) No matter what the command is, there's always a Segmentation fault (core dumped), but the tool seems to function correctly.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Aug-10 09:53:20 by johnkn:</em> <br/>\n\nHere is a transform script that converts a set of STARTD ads from a single machine, into multiple startd ads, each with a different architecture and operating system.\n\n<p></p><div class=\"snip\">\n<pre class=\"sniplabel\">to_multi_platform.xfm </pre>\n<pre class=\"snip\"># Transform a each STARTD ad into multiple ads, each with a differnt OS and Arch\n# invoker can change behavior of this transform by setting\n#   DOMAIN=x.y.z           # set the default domain for machine names\n#   SharedFileSystem=true  # have machines pretend to have a shared filesystem domain\n\nNAME Simulate multiple STARTD platforms\nREQUIREMENTS MyType == \"Machine\"\n\n# extract slotname from the ad name and manufacture a machine index\nEVALMACRO SLOT = splitslotname(Name)[0]\nINDEX = $(ROW)+1\n\n# rewrite the machine name and domain\n#\nSET UidDomain = \"$(DOMAIN:cs.wisc.edu)\"\nSET Machine = \"exec$INT(INDEX,%02d).$(MY.UidDomain)\"\nif defined SLOT\n  SET  Name = \"$(SLOT)@$(My.Machine)\"\nelse\n  COPY Machine Name\nendif\nCOPY Machine PrivateNetworkName\n\nif $(SharedFileSystem)\n  COPY UidDomain FileSystemDomain\nelse\n  COPY Machine FileSystemDomain\nendif\n\nSET Arch           = \"$(ARCH)\"\nSET OpSys          = \"$(OS)\"\nSET OpSysAndVer    = \"$(OSAndVer)\"\nSET OpSysVer       = \"$(OSVer)\"\nSET OpSysName      = \"$(OSName)\"\nSET OpSysMajorVer  = \"$(OSMajor)\"\nSET OpSysShortName = \"$(OSShort)\"\nSET OpSysLegacy    = \"$(OSLegacy)\"\n\n\nTRANSFORM Arch,OS,OSAndVer,OSVer,OSName,OSMajor,OSShort,OSLegacy from (\n  X86_64 LINUX   Debian7      700 Debian       7 Debian  LINUX\n  X86_64 LINUX   Debian8      800 Debian       8 Debian  LINUX\n  X86_64 LINUX   SL6          602 SL           6 SL      LINUX\n  X86_64 LINUX   SL7          702 SL           7 SL      LINUX\n  X86_64 LINUX   RedHat6      607 RedHat       6 RedHat  LINUX\n  X86_64 LINUX   RedHat6      607 RedHat       6 RedHat  LINUX\n  INTEL  LINUX   RedHat6      607 RedHat       6 RedHat  LINUX\n  X86_64 LINUX   RedHat7      702 RedHat       7 RedHat  LINUX\n  X86_64 WINDOWS WINDOWS601   601 Windows7   601 Win7    WINNT61\n  X86_64 WINDOWS WINDOWS602   602 Windows8   602 Win8    WINNT62\n  X86_64 WINDOWS WINDOWS1000 1000 Windows10 1000 Win10   WINNT100\n  X86_64 OSX     MacOSX7      705 Lion         7 MacOSX  OSX\n  X86_64 OSX     MacOSX8      805 MountainLion 8 MacOSX  OSX\n  X86_64 OSX     MacOSX10    1001 ElCapitan   10 MacOSX  OSX\n  X86_64 OSX     MacOSX10    1005 ElCapitan   10 MacOSX  OSX\n  X86_64 LINUX   Ubuntu12    1204 Ubuntu      12 Ubuntu  LINUX\n  X86_64 LINUX   Ubuntu14    1404 Ubuntu      14 Ubuntu  LINUX\n  X86_64 LINUX   Fedora23    2300 Fedora      23 Fedora  LINUX\n  X86_64 LINUX   Fedora24    2200 Fedora      22 Fedora  LINUX\n  X86_64 FREEBSD FreeBSD10   1003 FreeBSD     10 FreeBSD FREEBSD\n)\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-17 12:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1b8ab1674c9ff74a4bf896b15819cf09bb4142cf\">[50179]</a></span>: Fixed error casued by spacing difference in V8_6, ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5823\" onclick=\"get_ticket_and_populate_wrapper('5823'); return false;\" title=\"Test for condor_transform_ads tool\">#5823</a></span>  (By shuyang )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Aug-10 10:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/68fcc7243f69e83c54fd85b350011a1b25c66c88\">[48978]</a></span>: A test for condor_transform_ads. Still having some problems with regex on all platforms and transfrom from a file on non-Windows platforms <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5823\" onclick=\"get_ticket_and_populate_wrapper('5823'); return false;\" title=\"Test for condor_transform_ads tool\">#5823</a></span>  (By shuyang )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Sep-14 16:20", "status": "resolved", "created": "2016-Aug-02 17:10", "fixed_version": "2016-Aug-02 17:10", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "shuyang", "derived_from": "#5247", "creator": "shuyang", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}