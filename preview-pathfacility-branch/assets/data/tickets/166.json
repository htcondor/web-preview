{"id": 166, "title": "Ticket #166: Create regression test of evironment for DAGMan jobs with getenv=true", "description": "<blockquote>\nIn commit 7a6474199f35eed50bcc2598752641f656603c11, I added the ability for condor_submit_dag to import the environment from it's process, and pass this to the environment passed to condor_submit, so that DAGMan jobs which specify getenv=true will get the parent process's environment as expected.\nWe need a regression test to verify this functionality.</blockquote>", "remarks": "<blockquote>\n<em>2009-Feb-10 16:26:39 by psilord:</em> <br/>\n\nSo, if dag A sets _CONDOR_DAGMAN_LOG=XXX and has an external subdag B which sets _CONDOR_DAGMAN_LOG = YYY, then will the subdag B's environment be corrupted to only contain _CONDOR_DAGMAN_LOG=XXX instead of the expected YYY.\n\n<p>I think so, because I see this exact case in the test suite right now on the trunk.\n\n</p><p>Kent happens to have a test which will show it, and he's going to modify job_dagman_subdag-A to ensure that the three dagman.out files associated with that test appear correctly. At this time there is only ONE dagman.out file because of the environment corruption.\n\n</p><p>I've seen X509_CERT_DIR be fought over as for how dagman processes it in relation to the environment of the children it executes. Our transmission or rejection of X509_CERT_DIR is always too general and screws up other environment variables that we want to exhibit the opposite behavior that we want for X509_CERT_DIR.\n\n</p><p><em>2009-Nov-17 12:08:13 by wenger:</em> <br/>\n\nDowngrading priority as per discussion in staff meeting.\n\n</p><p></p><hr/>\n<em>2012-Feb-09 23:04:55 by pfc:</em> <br/>\n\nThis may have originated as the indirect result of a LIGO ticket (<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=29\" onclick=\"get_ticket_and_populate_wrapper('29'); return false;\" title=\"DAGMan overwrites X509_CERT_DIR and friends\">#29</a></span>), but it's not something LIGO is asking for, so I'm removing us as the customer group.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nDagman.out files broken for external subdags</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Feb-10 18:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8d5800f20717e09c6a38a40f34ec0e7b93b07965\">[13902]</a></span>: job_dagman_subdag-A.run now checks for proper dagman.out files (see gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span> and <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=166\" onclick=\"get_ticket_and_populate_wrapper('166'); return false;\" title=\"Create regression test of evironment for DAGMan jobs with getenv=true\">#166</a></span>).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Feb-10 18:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0b5f8e4e88d9b304c799c7d192095d8305f985ab\">[13901]</a></span>: job_dagman_subdag-A.run now checks for proper dagman.out files (see gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span> and <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=166\" onclick=\"get_ticket_and_populate_wrapper('166'); return false;\" title=\"Create regression test of evironment for DAGMan jobs with getenv=true\">#166</a></span>).  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2012-Feb-09 23:05", "status": "new", "created": "2009-Jan-30 09:39", "fixed_version": "2009-Jan-30 09:39", "broken_version": "v070300", "priority": "3", "subsystem": "Dag", "assigned_to": "", "derived_from": "#29", "creator": "nleroy", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}