{"id": 3407, "title": "Ticket #3407: HTCondor Python Bindings", "description": "<blockquote>\nPython bindings to libclassad.so and libcondor_utils.so can be beneficial to our end-users and system integrators (see <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3380\" onclick=\"get_ticket_and_populate_wrapper('3380'); return false;\" title=\"Foolproof mechanism for JobRouter routes\">#3380</a></span>).\n\n<p>I propose adding the code in:\n\n</p><p><a class=\"external\" href=\"https://github.com/bbockelm/python-condor\">https://github.com/bbockelm/python-condor</a> and\n<a class=\"external\" href=\"https://github.com/bbockelm/python-classad\">https://github.com/bbockelm/python-classad</a>\n\n</p><p>to the default Condor builds for platforms where python is available.\n\n</p><p>See attached design document.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Jan-02 04:01:01 by tosky:</em> <br/>\n\n&gt; to the default Condor builds for platforms where python is available.\n\n<p>What is the minimum supported version? Apart from python 2.6+, are also older but supported platforms (like, for example, rhel5/python 2.4) on the radar?\n\n</p><p></p><hr/>\n<em>2013-Jan-02 07:22:29 by bbockelm:</em> <br/>\n\nI just tried compiling with RHEL5/python2.4.  Looks like there are some small compilation issues, but nothing fundamental missing from that version of boost.\n\n<p>So, RHEL5/python 2.4 support ought to be less than half a day's work.  I was planning on adding the support anyway as glideinWMS would require it.\n\n</p><p></p><hr/>\n<em>2013-Jan-02 07:44:23 by bbockelm:</em> <br/>\n\nActually, RHEL5/python2.4 support is much less than half-day.  I just pushed the code necessary for support.\n\n<p></p><hr/>\n<em>2013-Jan-03 19:24:41 by bbockelm:</em> <br/>\n\nJust posted a sample git branch to:\n\n<p><a class=\"external\" href=\"https://github.com/bbockelm/htcondor/tree/python\">https://github.com/bbockelm/htcondor/tree/python</a>\n\n</p><p></p><hr/>\n<em>2013-Jan-16 12:44:12 by nwp:</em> <br/>\n\nI got stuck with reviewing this.\n\n<p></p><hr/>\n<em>2013-Jan-16 12:45:18 by nwp:</em> <br/>\n\nWhat is the appropriate place for this in the HTCondor tree?\n\n<p></p><hr/>\n<em>2013-Jan-16 12:47:04 by nwp:</em> <br/>\n\nWho is going to maintain this when Boost changes their interface in the next ten minutes?\n\n<p></p><hr/>\n<em>2013-Jan-16 13:17:31 by tstclair:</em> <br/>\n\nPython Bindings have been fairly consistent for ~5+ years.  Not all api's gyrate and we have cmake to detect versions changes.\n\n<p></p><hr/>\n<em>2013-Jan-16 13:19:09 by bbockelm:</em> <br/>\n\nHi Nathan,\n\n<p>I think the current location in condor_contrib is appropriate.\n\n</p><p>In terms of maintenance, I will happily continue to support it.  I've been trying to stick to a subset of the API in order to keep RHEL5 support.  The interface appears to be fairly stable over a number of years, but cmake can support interface changes.\n\n</p><p>Brian\n\n</p><p></p><hr/>\n<em>2013-Jan-16 22:24:41 by nwp:</em> <br/>\n\npushed onto V7_9-python_bindings-branch.  Needs to be integrated into the normal builds, but I will not be able to work on that until Tuesday (22 Jan 2013).\n\n<p></p><hr/>\n<em>2013-Jan-22 20:24:59 by nwp:</em> <br/>\n\nCould not build this from scratch:\n<div class=\"code\">\n<pre class=\"code\">$ configure_uw -DWITH_PYTHON_BINDINGS:BOOL=ON\n...\n$ make externals\n...\n$ make\n&lt;snipped&gt;\nmake[2]: *** No rule to make target `bld_external/boost_1_49_0-p2/install/lib/libboost_thread.a', needed by `src/cream_gahp/cream_gahp'.\nmake[2]: Target `src/cream_gahp/CMakeFiles/cream_gahp.dir/build' not remade because of errors.\nmake[1]: *** [src/cream_gahp/CMakeFiles/cream_gahp.dir/all] Error 2\n&lt;snipped&gt;\nLinking CXX shared library libpyclassad.so\n/usr/bin/ld: /afs/cs.wisc.edu/u/n/w/nwp/CONDOR_SRC/bld_external/boost_1_49_0-p2/install/lib/libboost_python.a(long.o): relocation R_X86_64_32 against `__dso_handle' can not be used when making a shared object; recompile with -fPIC\n/afs/cs.wisc.edu/u/n/w/nwp/CONDOR_SRC/bld_external/boost_1_49_0-p2/install/lib/libboost_python.a: could not read symbols: Bad value\ncollect2: ld returned 1 exit status\nmake[2]: *** [src/condor_contrib/python-bindings/libpyclassad.so] Error 1\nmake[2]: Target `src/condor_contrib/python-bindings/CMakeFiles/pyclassad.dir/build' not remade because of errors.\nmake[1]: *** [src/condor_contrib/python-bindings/CMakeFiles/pyclassad.dir/all] Error 2\n&lt;snipped&gt;\nLinking CXX executable _collector_tester\n/usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../lib64/crt1.o: In function `_start':\n(.text+0x20): undefined reference to `main'\ncollect2: ld returned 1 exit status\nmake[2]: *** [src/condor_collector.V6/tests/_collector_tester] Error 1\nmake[2]: Target `src/condor_collector.V6/tests/CMakeFiles/_collector_tester.dir/build' not remade because of errors.\nmake[1]: *** [src/condor_collector.V6/tests/CMakeFiles/_collector_tester.dir/all] Error 2\n&lt;snipped&gt;\n</pre></div>\n\n\n<p></p><hr/>\n<em>2013-Jan-23 12:44:09 by nwp:</em> <br/>\n\nSee <a class=\"external\" href=\"http://submit-2.batlab.org/results/run-details.php?runid=96087\">NMI run 96087</a> for results from setting <code>WITH_PYTHON_BINDINGS</code> to <code>ON</code>.\n\n<p></p><hr/>\n<em>2013-Jan-23 18:33:10 by bbockelm:</em> <br/>\n\nHi nwp,\n\n<p>Are you familiar with the cmake voodoo for UW builds?  That's precisely the issue I was looking for help on.\n\n</p><p>Thanks,\n\n</p><p>Brian\n\n</p><p></p><hr/>\n<em>2013-Jan-23 19:02:09 by tstclair:</em> <br/>\n\nI'll take a gander either tonight or in the am.\n\n<p></p><hr/>\n<em>2013-Jan-23 19:58:26 by tstclair:</em> <br/>\n\nI'm pretty sure I see what's wrong..\n\n<p>Brian - if this is contrib do you ever want it to be built in non-proper?  Or is this stuff going mainline condor?\n\n</p><p></p><hr/>\n<em>2013-Jan-23 20:16:01 by bbockelm:</em> <br/>\n\nThe idea is to get this into the UW build for Condor, but keep it clearly delineated out in contrib in the codebase.\n\n<p></p><hr/>\n<em>2013-Jan-23 20:23:27 by tstclair:</em> <br/>\n\nUW Build &amp;&amp; contrib are mutually exclusive.  If you go UW Build you need to support NON_PROPER and all that comes with it, which is why Nathan is seeing wonkyness.\n\n<p>Jamie is the best person to rectify.\n\n</p><p></p><hr/>\n<em>2013-Jan-25 19:28:22 by bbockelm:</em> <br/>\n\nOk,\n\n<p>I just pushed a commit that should fix the UW build issues and runs the python unit tests.\n\n</p><p>Where in the install should this go?  How do I trigger a UW RPM build?\n\n</p><p></p><hr/>\n<em>2013-Jan-25 20:42:41 by bbockelm:</em> <br/>\n\nFigured out the UW RPM build.  Bindings should now be properly packaged for RPM builds in this branch.\n\n<p></p><hr/>\n<em>2013-Jan-25 20:56:53 by nwp:</em> <br/>\n\nStarted an nmi build at <a class=\"external\" href=\"http://submit-2.batlab.org/nmi/results/details?runID=96739\">Build for 6923e4a</a>. <span class=\"chng\"><a href=\"/404.html\">[34758]</a></span>\n\n<p></p><hr/>\n<em>2013-Jan-26 12:42:44 by bbockelm:</em> <br/>\n\nOk, another few build fixes went through.  Feel free to fire off another NMI build.\n\n<p></p><hr/>\n<em>2013-Jan-26 16:58:43 by bbockelm:</em> <br/>\n\nOk, tracked down a bizarre linker error causing the unit tests to fail in a subtle way.  Fire off another!\n\n<p></p><hr/>\n<em>2013-Jan-26 18:20:23 by nwp:</em> <br/>\n\nLooks like success! <a class=\"external\" href=\"http://submit-2.batlab.org/results/run-details.php?runid=96901\">Batlab build 96901</a> <span class=\"chng\"><a href=\"/404.html\">[34767]</a></span>\n\n<p></p><hr/>\n<em>2013-Jan-26 19:04:04 by bbockelm:</em> <br/>\n\nWell, a few successes (Ubuntu 10, Fedora 16).  The failed platforms had verbose mode off for the failed unit tests so I cannot see why they failed.\n\n<p>Do you have access to the nodes?  Can you re-run \"VERBOSE=1 make test\"?\n\n</p><p></p><hr/>\n<em>2013-Jan-26 20:04:05 by bbockelm:</em> <br/>\n\nAlright, verbose output on Debian6 works, so I could see the unit test failure.  It was another linking issue with loading libcondor_utils at runtime (coredumper symbols are used but not linked in).\n\n<p>Pushed a few more commits and should be ready for another shot.  Feel free to cancel any prior tasks still running.\n\n</p><p></p><hr/>\n<em>2013-Jan-26 23:01:47 by nwp:</em> <br/>\n\n<a class=\"external\" href=\"http://submit-2.batlab.org/nmi/results/details?runID=96907\">build for</a> <span class=\"chng\"><a href=\"/404.html\">[34769]</a></span>\n\n<p></p><hr/>\n<em>2013-Jan-27 09:14:18 by bbockelm:</em> <br/>\n\nDo you know of any way to re-run job_core_coredump_std-1 on RHEL6?  Seems to be the only failed unit test.\n\n<p>Just pushed a commit that should fix F16.  With that, I think all the platforms will build.\n\n</p><p>I don't know what's up with OS X or Solaris - is it possible the branch is based on a bad point in time on master?\n\n</p><p></p><hr/>\n<em>2013-Jan-28 12:33:47 by nwp:</em> <br/>\n\n<strong>CODE REVIEW</strong> Done. No issues.\n\n<p>Rebased and pushed onto master\n\n</p><p></p><hr/>\n<em>2013-Jan-28 13:52:42 by bbockelm:</em> <br/>\n\nDocumentation is being handled in a sub-ticket (<span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=3466\" onclick=\"get_ticket_and_populate_wrapper('3466'); return false;\" title=\"Add user documentation for python bindings\">#3466</a></span>).  I will move this into the docpending state.\n\n<p></p><hr/>\n<em>2013-Jan-28 13:56:01 by bbockelm:</em> <br/>\n\nWhoops, nwp and I had conflicting updates.  Documentation work will be done here, not in <span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=3466\" onclick=\"get_ticket_and_populate_wrapper('3466'); return false;\" title=\"Add user documentation for python bindings\">#3466</a></span> (which has been deleted).\n\n<p></p><hr/>\n<em>2013-Feb-18 13:10:09 by bbockelm:</em> <br/>\n\nDocumentation is done for 7.9.4.\n\n<p>Any further code improvements should go into <span class=\"ticket\"><a class=\"docpending\" href=\"/wiki-archive/tickets/?ticket=3494\" onclick=\"get_ticket_and_populate_wrapper('3494'); return false;\" title=\"Improve python bindings for 7.9.5\">#3494</a></span>.\n\n</p><p>Closing out ticket.  Thanks to all who contributed!</p></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=3466\" onclick=\"get_ticket_and_populate_wrapper('3466'); return false;\" title=\"Add user documentation for python bindings\">#3466</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd user documentation for python bindings</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3482\" onclick=\"get_ticket_and_populate_wrapper('3482'); return false;\" title=\"Python bindings are not resilient against version changes\">#3482</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nPython bindings are not resilient against version changes</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/665/HTCondor+Python+Bindings.docx\">HTCondor Python Bindings.docx</a>\n148319 bytes added by bbockelm on 2012-Dec-29 18:02:07 UTC.\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-18 12:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eec19c51efcd68d666d03828a2cc53c5045778ea\">[34950]</a></span>: final documentation edits for Python bindings contrib module ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-13 15:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9fb4bf42863445a154d991a0e6cdf9a2a81ee2a3\">[34919]</a></span>: version history item and little corrections for Python bindings documentation ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-12 16:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d8e0cffa262424643504cef44b864cdcbc79b18e\">[34912]</a></span>: addition of sample python code and the last of the module info for the Python bindings ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-12 13:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8437a9466b6f47613426c3e5c6743abd9ac14d72\">[34903]</a></span>: Python bindings documentation: add descriptions of schedd class methods. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-11 15:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d42af59b4d74686d9305b314d5d8402b1325fb7b\">[34894]</a></span>: Python bindings documentation: put info into tables to standardize the format. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-05 14:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a0b457e61121507244e4a12bf09b4dba87d15499\">[34858]</a></span>: add more details about the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> module for Python bindings ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-04 17:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7d7622b3334480ac2ccc07d17e30ace9f46646c4\">[34848]</a></span>: Missed a unittest change in the condor-&gt;htcondor rename. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-04 17:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3948a7a1613b595c0e58f02eed989221e2d2f260\">[34847]</a></span>: Rename condor-&gt;htcondor for all the applicable targets. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-04 17:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2f69e0a3794dd131d137e8b0b22abdbb76433e49\">[34843]</a></span>: new file added which will contain documentation of (for now, contrib module) Python bindings ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-28 10:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/21e51a914218958b328b4bfc5655693a6c1e5290\">[34775]</a></span>: Python bindings for classad and condor <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span> Fix boost build issues. Add python unittests to ctest. Package python bindings in the generated RPM. Suppress warnings-as-errors to fix builds on Fedora. The python headers themselves cause the warnings, so there's not much we can do to fix this.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-28 10:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f7174a5f9f248e7d68f72eea76f341d86ad4d5b6\">[34774]</a></span>: Fix unit tests. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3407\" onclick=\"get_ticket_and_populate_wrapper('3407'); return false;\" title=\"HTCondor Python Bindings\">#3407</a></span> Failures were due to the fact libcondor_utils internals were using the glibc copy of dprintf when loaded from python.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Feb-18 13:10", "status": "resolved", "created": "2012-Dec-29 12:01", "fixed_version": "2012-Dec-29 12:01", "broken_version": "", "priority": "3", "subsystem": "Tools", "assigned_to": "bbockelm", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "jfrey@cs.wisc.edu, bbockelm@cse.unl.edu, burt@fnal.gov, tstclair@redhat.com", "due_date": ""}