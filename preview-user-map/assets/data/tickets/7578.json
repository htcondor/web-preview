{"id": 7578, "title": "Ticket #7578: Fix Kerberos krb5_free_addresses issue", "description": "<blockquote>\n<strong>THIS BUG WAS FIXED BEFORE IT MADE IT INTO A RELEASE</strong>\n\n<p>While fixing up a coverity-found potential issue, a new bug was introduced where we passed a pointer to something that was supposed to be a NULL-terminated array but had no terminator, and furthermore also tried to <code>free()</code> memory that was on the stack.\n\n</p><p>Interestingly, the code before this bug was introduced was not correct to begin with.  It is supposed to be passing in a NULL-terminated array to <code>krb5_free_addresses()</code> and most definitely was not.  Perhaps by luck neighboring memory had a zero, or perhaps <code>malloc()</code> allocated a larger block of memory than needed and conveniently filled it with zeros, or something.  Even more surprisingly, that function <code>free()</code> 's the addresses passed in the array <strong>AND THEN ALSO FREE()S THE ARRAY ITSELF</strong>.  So the NULL-terminated array can't be on the stack either and must be explicitly <code>malloc()</code> 'ed.</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2020-Apr-10 07:46:37 by tim:</em> <br/>\n\nBulk change of target version from v080906 to v080907 using ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-02 17:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/23f7281189db84ec49e55d9373b1e7a730d36f89\">[59234]</a></span>: Fix call to slightly oddball interface of krb5_free_addresses() <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=6992\" onclick=\"get_ticket_and_populate_wrapper('6992'); return false;\" title=\"Fix coverity-found problems in 8.9\">#6992</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7578\" onclick=\"get_ticket_and_populate_wrapper('7578'); return false;\" title=\"Fix Kerberos krb5_free_addresses issue\">#7578</a></span>  (By zmiller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Apr-10 07:47", "status": "resolved", "created": "2020-Apr-02 17:35", "fixed_version": "2020-Apr-02 17:35", "broken_version": "v080906", "priority": "2", "subsystem": "Security", "assigned_to": "zmiller", "derived_from": "#6992", "creator": "zmiller", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "zmiller@cs.wisc.edu, gthain@cs.wisc.edu", "due_date": "20200410"}