{"id": 3165, "title": "Ticket #3165: check for syscall failure", "description": "<blockquote>\nFrom Florian Weimer -\n\n<p>my_popenv_impl and my_spawnv in src/condor_utils/my_popen.cpp does not check return value of setuid and similar function calls:\n\n</p><p></p><div class=\"verbatim\">\n<pre>\t\teuid = geteuid();\n\t\tegid = getegid();\n\t\tseteuid( 0 );\n\t\tsetgroups( 1, &amp;egid );\n\t\tsetgid( egid );\n\t\tsetuid( euid );\n</pre></div>\n\n\n<p>As a result, the subprocess could be created with root privileges instead of those of the intended user.\n\n</p><p>I have not checked if this vulnerability is exploitable, but I suspect it is.\n\n</p><p>-\n\n</p><p>Please add checks for all set*id calls.  Their error behavior depends on the kernel security module, so it is somewhat unpredictable.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-17 19:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/94e84ce4ff93ea071ca17bcf823918432749c868\">[33403]</a></span>: Check setuid return value (7.6 version), <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3165\" onclick=\"get_ticket_and_populate_wrapper('3165'); return false;\" title=\"check for syscall failure\">#3165</a></span> Signed-off-by: Timothy St. Clair &lt;tstclair@redhat.com&gt;  (By Matthew Farrellee )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 12:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9cfab11143853929d7822f18c4a130a78a49123e\">[33372]</a></span>: Check setuid return value, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=3165\" onclick=\"get_ticket_and_populate_wrapper('3165'); return false;\" title=\"check for syscall failure\">#3165</a></span> Committer: Matthew Farrellee  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Dec-17 12:52", "status": "resolved", "created": "2012-Jul-30 14:44", "fixed_version": "2012-Jul-30 14:44", "broken_version": "v070600", "priority": "2", "subsystem": "Daemons", "assigned_to": "zmiller", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}