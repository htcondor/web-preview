{"id": 1830, "title": "Ticket #1830: autoclustering ignores attributes in the proc ad", "description": "<blockquote>\nAttributes in the proc ad (i.e. not the cluster ad) that are referenced without explicit MY scope are ignored by autoclustering.  The problem likely dates to 7.5.2, but it became more visible after commit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2cf88badb5d692b53eea231286c13a23bf1cc2a1\">[19048]</a></span> in pre-releases of 7.5.5 which made custom attributes go into the proc ad instead of the cluster ad as they used to.\n\n<p>The problem is that <code>ClassAd::GetInternalReferences()</code> contains the following:\n\n</p><p></p><div class=\"verbatim\">\n<pre>    state.curAd = tree-&gt;GetParentScope();\n    if(!state.curAd) state.curAd = this;\n</pre></div>\n\n\n<p>So for job ads, all lookups are done in the scope of the cluster ad.  Similar code exists in <code>ClassAd::GetExternalReferences()</code>.  This behavior seems wrong in both cases.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jan-03 18:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3028636fb75788a5c50ed59a4bbaa03ab7d2125f\">[19839]</a></span>: Fix autoclustering of attributes in proc ad. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1830\" onclick=\"get_ticket_and_populate_wrapper('1830'); return false;\" title=\"autoclustering ignores attributes in the proc ad\">#1830</a></span> When using new classads, autoclustering ignored attributes in the proc ad (i.e. attributes not in the cluster ad) unless those attributes were explicitly referenced with MY scope.  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Jan-03 18:28", "status": "resolved", "created": "2011-Jan-03 18:16", "fixed_version": "2011-Jan-03 18:16", "broken_version": "v070502", "priority": "4", "subsystem": "", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "sfiligoi@fnal.gov", "due_date": ""}