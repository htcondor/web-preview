{"id": 3742, "title": "Ticket #3742: Jobs creating Unix domain sockets too long in scratch", "description": "<blockquote>\nUnix domain sockets can be up to 108 characters long.  They also need to be real filenames.  It's common to put them in $TMP/$TEMP/$TMPDIR.  Typically $TMP will be \"pretty short\", so it succeeds assuming the filename appended is \"pretty short\".\n\n<p>HTCondor sets $TMP to the execute directory $_CONDOR_SCRATCH_DIR to ensure we can clean up temporary files.  Unfortunately it's entirely possible for the execute directory to be moderately long to start.  That, plus the filename the job adds, might break the 108 character limit.\n\n</p><p>There is good news!  If USE_FS_NAMESPACES=TRUE and the system supports it /tmp will be remapped to $_CONDOR_SCRATCH_DIR (See <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2015\" onclick=\"get_ticket_and_populate_wrapper('2015'); return false;\" title=\"Take advantage of filesystem namespaces\">#2015</a></span>).  This solves the problem for any jobs that (erroneously) assume /tmp is a good place for temporary files  However, I think we still set $TMP to $_CONDOR_SCRATCH_DIR, so well behaved programs don't get the benefit.  (This also bites condor_ssh_to_job, see <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3739\" onclick=\"get_ticket_and_populate_wrapper('3739'); return false;\" title=\"ssh to job fails when execute directory is more than 40 chars long\">#3739</a></span>.  Note that this will improve <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3739\" onclick=\"get_ticket_and_populate_wrapper('3739'); return false;\" title=\"ssh to job fails when execute directory is more than 40 chars long\">#3739</a></span> even if <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3739\" onclick=\"get_ticket_and_populate_wrapper('3739'); return false;\" title=\"ssh to job fails when execute directory is more than 40 chars long\">#3739</a></span> is already \"resolved.\")\n\n</p><p>Proposed:\n\n</p><p>If USE_FS_NAMESPACES=TRUE, then set $TMP/$TEMP/$TMPDIR to /tmp instead of $_CONDOR_SCRATCH_DIR</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Dec-29 13:15:51 by tlmiller:</em> <br/>\n\nSee <span class=\"ticket\"><a class=\"abandoned\" href=\"/tickets?ticket=3736\" onclick=\"get_ticket_and_populate_wrapper('3736'); return false;\" title=\"ssh-to-job test must conserve path length\">#3736</a></span> and <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3739\" onclick=\"get_ticket_and_populate_wrapper('3739'); return false;\" title=\"ssh to job fails when execute directory is more than 40 chars long\">#3739</a></span>.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2014-Dec-29 13:15", "status": "new", "created": "2013-Jul-08 17:50", "fixed_version": "2013-Jul-08 17:50", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}