{"id": 2128, "title": "Ticket #2128: Job preemption triggered by ssh_to_job leads to Starter segfault", "description": "<blockquote>\nIf PREEMPT becomes true because of condor_ssh_to_job, I observed a Starter crash with the following stack dump (this happened in the CS pool):\n\n<p></p><div class=\"verbatim\">\n<pre>05/05/11 13:26:02 IWD: /scratch/condor/execute/dir_13662\n05/05/11 13:26:02 Error file: /scratch/condor/execute/dir_13662/.condor_ssh_to_job_1/s\nshd.log\n05/05/11 13:26:02 Renice expr \"5\" evaluated to 5\n05/05/11 13:26:02 Using wrapper /unsup/condor/etc/cs_cluster_job_wrapper to exec /usr/\nsbin/sshd -i -e -f /scratch/condor/execute/dir_13662/.condor_ssh_to_job_1/sshd_config\n05/05/11 13:26:02 Create_Process succeeded, pid=16094\n05/05/11 13:26:02 Process exited, pid=16083, status=0\n05/05/11 13:26:02 unhandled job exit: pid=16083, status=0\n05/05/11 13:26:07 Got SIGTERM. Performing graceful shutdown.\n05/05/11 13:26:07 ShutdownGraceful all jobs.\nStack dump for process 13662 at timestamp 1304619967 (18 frames)\ncondor_starter(dprintf_dump_stack+0x4a)[0x81dec2a]\ncondor_starter[0x81f6f16]\n[0xbd8420]\ncondor_starter(_ZNK7classad7ClassAd6LookupERKSs+0x79)[0x81973b9]\ncondor_starter(_ZNK7classad7ClassAd13LookupInScopeERKSsRPNS_8ExprTreeERNS_9EvalStateE+\n0x47)[0x8197457]\ncondor_starter(_ZNK7classad7ClassAd12EvaluateAttrERKSsRNS_5ValueE+0x46)[0x8197576]\ncondor_starter(_ZNK7classad7ClassAd15EvaluateAttrIntERKSsRi+0x29)[0x81979d9]\ncondor_starter(_ZNK14compat_classad7ClassAd13LookupIntegerEPKcRi+0x67)[0x821c957]\ncondor_starter(_ZN11VanillaProc20startEscalationTimerEv+0x81)[0x810f381]\ncondor_starter(_ZN11VanillaProc16ShutdownGracefulEv+0x39)[0x810f599]\ncondor_starter(_ZN8CStarter16ShutdownGracefulEv+0x56)[0x81052d6]\ncondor_starter(_ZN8CStarter22RemoteShutdownGracefulEi+0x24)[0x8103ec4]\ncondor_starter(_Z22main_shutdown_gracefulv+0x1b)[0x810baeb]\ncondor_starter(_Z17handle_dc_sigtermP7Servicei+0x88)[0x812cf18]\ncondor_starter(_ZN10DaemonCore6DriverEv+0x23f)[0x813ad4f]\ncondor_starter(main+0x116f)[0x81301bf]\n/lib/libc.so.6(__libc_start_main+0xdc)[0x42ee9c]\ncondor_starter(realloc+0xa1)[0x80f9e71]\n</pre></div>\n\n\n<p>This does not actually break anything per se, but I think the Starter should exit a bit more gracefully than that.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2011-May-05 13:57", "status": "new", "created": "2011-May-05 13:55", "fixed_version": "2011-May-05 13:55", "broken_version": "v070600", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "cweiss", "rust": "", "customer_group": "other", "visibility": "public", "notify": "cweiss@cs.wisc.edu", "due_date": ""}