{"id": 3306, "title": "Ticket #3306: NETWORK_INTERFACE ignored on some outbound connections.", "description": "<blockquote>\nIn _condor_local_bind(), in condor_utils/internet.cpp, the outgoing port is unconditionally bound to all interfaces.  This is called by do_connect_with_timeout(), which is called by do_connect() (both in do_connect.unix.cpp), which is called by part_send_job() (in the shadow), the source of the error message reported in condor-admin #24349.\n\n<p>The error message report in condor-admin #23824 is from the starter, probably in open_file_stream() (condor_syscall_lib/file_stream.c), called from get_file (in condor_syscall_lib/xfer_file.c).  open_file_stream() calls open_tcp_stream(), which calls _condor_local_bind().\n\n</p><p>In either case, it appears that it's possible for the OS to pick the wrong interface to send from, causing packets to be dropped.  The solution would appear to be to fix _condor_local_bind() to respect NETWORK_INTERFACE, but it's presently unclear if (a) the starter/standard universe binary know about it and (b) if the checkpoint server, which also uses this code, knows about it.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Aug-01 16:14:30 by tlmiller:</em> <br/>\n\n[Transcribing undated notes]\n\n<p>(1) remove condor_utils/internet.cpp's global bindWithin().\n(2) replace condor_local_bin with Sock::bind\n\n</p><p></p><hr/>\nreplace do_connect with ReliSock::connect()\n\n<p></p><hr/>\nreplace call to do_connect in shadow with <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ReliSock\" title=\"Reli Sock\">ReliSock</a></span> (will respect CCB? and shared port, which will break things...)</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2013-Aug-01 16:14", "status": "new", "created": "2012-Nov-05 11:00", "fixed_version": "2012-Nov-05 11:00", "broken_version": "v070901", "priority": "3", "subsystem": "Std", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "a23824 a24349", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}