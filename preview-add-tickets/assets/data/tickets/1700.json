{"id": 1700, "title": "Ticket #1700: Gridmanager should retry failed purge command for Cream jobs", "description": "<blockquote>\nWhen the gridmanager needs to cancel a Cream job, it issues a cancel command, followed by a purge command. If these commands are too closely spaced, the purge can fail because the Cream server hasn't finished processing the cancel. The server will return the error \"job status does not match\".\n\n<p>The gridmanager can do two things to cope with this:\n* Introduce a small delay between the two commands.\n* Retry a purge command that fails with the error given above, after a small delay.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-Oct-08 10:22:51 by jfrey:</em> <br/>\n\nWe already have a delay of 5 seconds between CANCEL and PURGE commands. Maybe it should be increased.\n\n<p></p><hr/>\n<em>2010-Oct-08 12:54:32 by jfrey:</em> <br/>\n\nPushed a commit to V7_4-branch for 7.4.4. A failed purge command will be retried up to two additional times.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Oct-13 11:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=25727\">[25727]</a></span>: Add version history for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1699\" title=\"Gridmanager should react to Cream job state CANCELLED\">#1699</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1700\" title=\"Gridmanager should retry failed purge command for Cream jobs\">#1700</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1701\" title=\"Soap code calls realpath() incorrectly\">#1701</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Oct-08 10:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=19141\">[19141]</a></span>: Retry purge of cancelled cream jobs in gridmanager. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1700\" title=\"Gridmanager should retry failed purge command for Cream jobs\">#1700</a></span> When the gridmanager needs to cancel a Cream job, it issues a cancel command, followed by a purge command. If these commands are too closely spaced, the purge can fail because the Cream server hasn't finished processing the cancel. The server\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Oct-19 12:02", "status": "resolved", "created": "2010-Oct-07 13:29", "fixed_version": "2010-Oct-07 13:29", "broken_version": "v070400", "priority": "4", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}