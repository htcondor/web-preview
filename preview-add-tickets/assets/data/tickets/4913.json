{"id": 4913, "title": "Ticket #4913: submit files should support if/else and include like config files", "description": "<blockquote>\nThe submit file parser should support the same improved syntax as config files got in the v8.2 series.  if/else and include syntax.\n\n<p>We will get the improved behavior by having condor_submit use the config file parser to read in submit files.  The config parser will have to be enhanced to support this.   In particular it will need to handle the <code>Queue</code> statement, which right now is a syntax error to the config parser. The fix will be that lines that have no '=' or multiple words before the '=' will be handed to a callback supplied by condor_submit for parsing.  this callback will parse queue statements and return -1 for all others, which will then be treated as errors.\n\n</p><p>The other thing that the config parser cannot currently parse is\n\n</p><p></p><pre>   +Attribute=value\n   -Attribute=value\n</pre>\n\n<p>These will be re-written in the config parser to and then parsed as\n\n</p><p></p><pre>   MY.Attribute=value\n   MY.Attribute=\n</pre>\n\n<p>Then condor_submit will iterate the submit hashtable at Queue time and shove all attributes that begin with \"MY.\" into the job ad.  One advantage of this design is that these attributes will now also be available for substitution in $(MY.Attribute).\n\n</p><p>One other advantage to having condor_submit use the config file parser is that it opens up the possibility of having a param table and metaknobs in submit files.  The work to fully enable these two features will not be done until a use case for them is found.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-24 14:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44727\">[44727]</a></span>: improve documentation of 'if version. . .' <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-24 13:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44725\">[44725]</a></span>: replace the manual's example of using 'include' in the submit description file with a better example <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-22 14:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44698\">[44698]</a></span>: document new if/else statement now available in submit file by having one file describe the syntax and including this file in both the user and administrator manuals (for submit and for configuration). Also include one example of using if/else when doing job submission. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-16 10:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44642\">[44642]</a></span>: minor edit and LaTeX fix for new 8.3.5 version history items <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4983\" title=\"condor_submit should allow setting of attribs BEFORE submit is parsed\">#4983</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-16 10:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44641\">[44641]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4983\" title=\"condor_submit should allow setting of attribs BEFORE submit is parsed\">#4983</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-15 16:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44627\">[44627]</a></span>: New features for queuing jobs are grouped together in the 8.3.5 version history, and a <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4944\" title=\"New $macro expansion functions for submit\">#4944</a></span> version history item is added <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4819\" title='\"queue\" for multiple files'>#4819</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-02 11:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44503\">[44503]</a></span>: Document include feature within submit files <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Feb-27 09:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=43470\">[43470]</a></span>: Use config file parser to parse submit files so they get if/endif and include syntax <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4913\" title=\"submit files should support if/else and include like config files\">#4913</a></span> As part of this patch. the config system'd getline function changed to getline_trim, since that's what it actually does, and it now returns the actual number of lines read instead of using a global variable to\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Apr-13 14:51", "status": "resolved", "created": "2015-Feb-25 14:38", "fixed_version": "2015-Feb-25 14:38", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "#4899", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}