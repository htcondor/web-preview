{"id": 3599, "title": "Ticket #3599: Concurrency Limits Regression Test", "description": "<blockquote>\n<strong class=\"three\">HTCondor Concurrency Limits Regression Tests</strong>\n<strong>job_concurrency_limits.run</strong>\n\n<p>The concurrency test uses the SimpleJob::RunCheck. To do this it was extended to allow on abort function over-ride, allow a way to specify queue size and fix passing duration of zero(for a test job which runs forever).\n\n</p><p>Concurrency tests have an expected number of jobs running and at least one job expected to be idle.\n\n</p><p>We desired a way to delay for a bit when handling the last expected call back for a job running. In this case we wanted to wait a couple negotiation cycles.\nSo we created third test in Check/CondorLog.pm{RunCheckMultiple}.\n\n</p><p>This searches logs related to daemons and we can specify either the number of patterns seen(which it waits for with a timeout) or the number of new patterns we want to wait for(with a timeout).\n\n</p><p>So while we delay a couple negotiation cycles, if we then see an idle job start to run, we fail the test as the concurrency controlled jobs are run forever so the idle jobs should not start if the concurrency limits are working.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-28 11:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37994\">[37994]</a></span>: Race condition on remove with expected run number. If you have a callback and remove jobs you allow a restricted job to run before you get back from on_execute callback. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jul-30 09:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37039\">[37039]</a></span>: Missing some reinitialization back to zero now that updates within callbacks work. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jun-13 09:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36564\">[36564]</a></span>: Don't bitch if you have enough slots <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jun-13 09:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36561\">[36561]</a></span>: We verify we have enough slots and can wait a bit for what we need <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jun-10 08:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36517\">[36517]</a></span>: Got rid of the condor_rm -forcex calls and added timeout to all the simplejob calls. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jun-04 10:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36502\">[36502]</a></span>: Deducing that this test wais forever based on to few slots, so we are ensuring more slots then we use within the test. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jun-03 14:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36500\">[36500]</a></span>: Add some removes to clean the queue between checks. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-06 13:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35602\">[35602]</a></span>: New concurrency testing test. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-06 13:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35600\">[35600]</a></span>: Added another log searcch interface for the Check perl modules. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-06 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35599\">[35599]</a></span>: Log search extension check and SimpleJob::RunCheck fixes and extensions. Abort override, queue sz specification, duration of zero for a run forever job. Also the basic concurrency test itself. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3599\" title=\"Concurrency Limits Regression Test\">#3599</a></span>  (By Bill Taylor )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Aug-06 12:42", "status": "resolved", "created": "2013-Apr-29 09:55", "fixed_version": "2013-Apr-29 09:55", "broken_version": "", "priority": "4", "subsystem": "Tests", "assigned_to": "bt", "derived_from": "#3594", "creator": "bt", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}