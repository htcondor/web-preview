{"id": 3917, "title": "Ticket #3917: startd cron problems", "description": "<blockquote>\nWe had a use-case where it was desired to register a startd cron job per slot.  Several problems came to light.\n\n<p><span class=\"subsection\"></span></p><h3>Problem 1</h3>\n\n<p>The startd dies with an exception if more than 100 cron jobs are defined:\n\n</p><p></p><pre>    ERROR \"# of reaper handlers exceeded specified maximum\" at line 2337 in file /Users/danb/condor/CONDOR_SRC/src/condor_daemon_core.V6/daemon_core.cpp\n</pre>\n\n<p><span class=\"subsection\"></span></p><h3>Problem 2</h3>\n\n<p>When there are greater than 50 but fewer than 100 cron jobs registered, reconfig can fail.  This happens when changing the name of the cron jobs.  The startd hits an exception while registering the new cron jobs:\n\n</p><p></p><pre>    Unable to register reaper with description: Cron_Reaper\n    ERROR \"# of reaper handlers exceeded specified maximum\" at line 2337 in file /Users/danb/condor/CONDOR_SRC/src/condor_daemon_core.V6/daemon_core.cpp\n</pre>\n\n<p>On restart, the startd succeeds to register the cron jobs.\n\n</p><p><span class=\"subsection\"></span></p><h3>Problem 3</h3>\n\n<p>I don't yet know how to reproduce this one.  After a successful reconfig (with a sufficiently small number of cron jobs so that it can succeed), we sometimes see the following problem:\n\n</p><p></p><pre>    Create_Process: invalid reaper_id\n    CronJob: Error running job 'jobname'</pre>\n</blockquote>", "remarks": "<blockquote>\n<em>2013-Sep-16 07:47:17 by bbockelm:</em> <br/>\n\nThe fixed size of various <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DaemonCore\" title=\"Daemon Core\">DaemonCore</a></span> internals has always bugged the heck out of me - but for other reasons.  The reaper table is always 100 entries and the reaper entry is 64 bytes (32 bytes for 32-bit).\n\n<p>That's 4KB right there!  The command entries also take up about 20KB (data structure misalignment makes this worse).  When we're under tight memory constraints (think condor_shadow), that's a lot of slop!</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2013-Sep-16 07:47", "status": "new", "created": "2013-Sep-13 17:30", "fixed_version": "2013-Sep-13 17:30", "broken_version": "v080000", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "isfiligoi@ucsd.edu,dan@hep.wisc.edu", "due_date": ""}