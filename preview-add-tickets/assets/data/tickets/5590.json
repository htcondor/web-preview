{"id": 5590, "title": "Ticket #5590: Add a way for the master to run a script on shutdown via config alone", "description": "<blockquote>\nCurrently there is no way to specify that the master run a script upon exit other than via the <code>condor_set_shutdown</code> command-line tool.  This made recipes like <span class=\"wiki\"><a href=\"wiki?p=HowToShutdownAnIdleMachine\" title=\"How To Shutdown An Idle Machine\">HowToShutdownAnIdleMachine</a></span> very clumsy.\n\n<p>Propose a patch to add a new condor_master knob, <code>DEFAULT_MASTER_SHUTDOWN_SCRIPT</code>, which can specify a default program to exec as root upon condor_master exit.  This default will be overridden if the admin does run <code>condor_set_shutdown</code> successfully.  Also, do not run any shutdown script if the master never actually started, i.e. if it is just exiting after printing out usage information.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-May-02 14:09:10 by tim:</em> <br/>\n\nAdding this ticket to 8.5.5 to complete the documentation.\n\n<p></p><hr/>\n<em>2016-Jun-01 10:12:26 by tim:</em> <br/>\n\nDEFAULT_MASTER_SHUTDOWN_SCRIPT should be added to the param table.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-02 16:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48476\">[48476]</a></span>: Added DEFAULT_MASTER_SHUTDOWN_SCRIPT knob to param table. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5590\" title=\"Add a way for the master to run a script on shutdown via config alone\">#5590</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-02 16:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48475\">[48475]</a></span>: Documentation for knob DEFAULT_MASTER_SHUTDOWN_SCRIPT. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5590\" title=\"Add a way for the master to run a script on shutdown via config alone\">#5590</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-26 20:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48310\">[48310]</a></span>: fix previous commit to <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5590\" title=\"Add a way for the master to run a script on shutdown via config alone\">#5590</a></span> so that it doesn't try to pass a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span> to %s. Committer: Tim Theisen  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-26 20:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48309\">[48309]</a></span>: Implement config knob DEFAULT_MASTER_SHUTDOWN_SCRIPT. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5590\" title=\"Add a way for the master to run a script on shutdown via config alone\">#5590</a></span> Added a new condor_master knob, DEFAULT_MASTER_SHUTDOWN_SCRIPT, which can specify a default program to exec as root upon condor_master exit. This default will be overridden if the admin does run condor_set_shutdown successfully. Also, do not\u00a0[...]\n (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Mar-31 09:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48140\">[48140]</a></span>: fix previous commit to <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5590\" title=\"Add a way for the master to run a script on shutdown via config alone\">#5590</a></span> so that it doesn't try to pass a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span> to %s.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Mar-30 15:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48136\">[48136]</a></span>: Implement config knob DEFAULT_MASTER_SHUTDOWN_SCRIPT. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5590\" title=\"Add a way for the master to run a script on shutdown via config alone\">#5590</a></span> Added a new condor_master knob, DEFAULT_MASTER_SHUTDOWN_SCRIPT, which can specify a default program to exec as root upon condor_master exit. This default will be overridden if the admin does run condor_set_shutdown successfully. Also, do not\u00a0[...]\n (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Jun-02 17:00", "status": "resolved", "created": "2016-Mar-30 15:32", "fixed_version": "2016-Mar-30 15:32", "broken_version": "", "priority": "3", "subsystem": "DaemonMaster", "assigned_to": "tannenba", "derived_from": "", "creator": "tannenba", "rust": "", "customer_group": "atlas", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}