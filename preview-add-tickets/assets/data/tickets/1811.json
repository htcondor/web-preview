{"id": 1811, "title": "Ticket #1811: should_transfer=IF_NEEDED incorrectly handles paths to stdout/stderr", "description": "<blockquote>\nWhen should_transfer_files=IF_NEEDED, and output or error are set to something other than a simple basename, condor_submit sets the filename to _condor_stdout/_condor_stderr and uses transfer_output_remaps to specify the actual path.  However, if no file transfer is used (because the submit and execute <code>FileSystemDomain</code> values match), then the remaps are not applied, and the output gets written to _condor_stdout/_condor_stderr rather than the paths specified by the user.\n\n<p>A related problem to this one is that scheduler universe jobs which try to turn on file transfer have similar problems with _condor_stdout/_condor_stderr if the output files contain paths.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Aug-29 12:04:39 by tannenba:</em> <br/>\n\nIn addition, IF_NEEDED is borked when submitting to local and scheduler universes.\n\n<p>In ticket <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2273\" title=\"provide defaults for should_transfer_files &amp; when_to_transfer_output\">#2273</a></span> the default was changed to IF_NEEDED. However, this ticket really needs to be resolved before that change can happen. Commit <span class=\"chng\"><a href=\"chngview?cn=27009\">[27009]</a></span> sets the default in condor_submit back to how they were since the dawn of time. Once the problems are associated with this ticket are fixed, <span class=\"chng\"><a href=\"chngview?cn=27009\">[27009]</a></span> should be reverted and <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2273\" title=\"provide defaults for should_transfer_files &amp; when_to_transfer_output\">#2273</a></span> resolved.\n\n</p><p></p><hr/>\n<em>2012-Jan-13 15:33:06 by eje:</em> <br/>\n\nThis introduced a regression where -dump now fails, because <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MySchedd\" title=\"My Schedd\">MySchedd</a></span> is NULL in that case:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">\tCondorVersionInfo cvi(MySchedd-&gt;version());\n\tif ( (!cvi.built_since_version(7, 7, 2) &amp;&amp; should_transfer != STF_NO &amp;&amp;\n\t\t  JobUniverse != CONDOR_UNIVERSE_GRID &amp;&amp;\n\t\t  JobUniverse != CONDOR_UNIVERSE_STANDARD) ||\n\t\t Remote ) {\n</pre></div>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3208\" title=\"File transfer with older starters can put stdout/err in wrong location\">#3208</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nFile transfer with older starters can put stdout/err in wrong location</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3409\" title=\"stdout/stderr names are modified in execute sandbox\">#3409</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nstdout/stderr names are modified in execute sandbox</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jan-13 17:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=29117\">[29117]</a></span>: Fixed regression in -dump caused by null <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MySchedd\" title=\"My Schedd\">MySchedd</a></span> ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1811\" title=\"should_transfer=IF_NEEDED incorrectly handles paths to stdout/stderr\">#1811</a></span>  (By Erik Erlandson )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-19 13:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27286\">[27286]</a></span>: Fix version check in shadow for transfer IF_NEEDED bugfix. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1811\" title=\"should_transfer=IF_NEEDED incorrectly handles paths to stdout/stderr\">#1811</a></span> If the shadow is talking to an old starter and file transfer may be used, it needs to rewrite the job ad it sends to the starter so that stdout/err get written to the correct location.\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-16 14:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27255\">[27255]</a></span>: Revert \"Undo changes to condor_submit related to should_transfer_files and\" This reverts commit 7767dff536fdbd3aa020c791397a0f44f3e7bb19. Now that setting should_transfer_files=IF_NEEDED works correctly in all cases (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1811\" title=\"should_transfer=IF_NEEDED incorrectly handles paths to stdout/stderr\">#1811</a></span>), we can allow that to be the default.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-15 17:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27239\">[27239]</a></span>: Fix handling of stdout/err containing paths when not using file transfer. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1811\" title=\"should_transfer=IF_NEEDED incorrectly handles paths to stdout/stderr\">#1811</a></span> When should_transfer_files is set to YES or IF_NEEDED and stdout/err contain any path information, condor_submit renames them to _condor_stdout/err and uses transfer_output_remaps to specify the actual names. However, if\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Jan-13 15:33", "status": "resolved", "created": "2010-Dec-15 14:32", "fixed_version": "2010-Dec-15 14:32", "broken_version": "v070000", "priority": "2", "subsystem": "", "assigned_to": "jfrey", "derived_from": "#2273", "creator": "danb", "rust": "a15447", "customer_group": "other", "visibility": "public", "notify": "dan@hep.wisc.edu matt@cs.wisc.edu, tstclair@redhat.com, eje@cs.wisc.edu", "due_date": "20110916"}