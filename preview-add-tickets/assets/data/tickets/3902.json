{"id": 3902, "title": "Ticket #3902: condor_submit - no longer means read from stdin", "description": "<blockquote>\ncondor_submit - no longer ends up meaning read config file from stdin.  this ends up breaking condor_qsub which depends on this behavior.\n\n<p>The following patch will fix condor_qsub. It would be fantastic if this was incorporated in the next release.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">--- /usr/bin/condor_qsub\t2013-07-24 12:45:27.000000000 +0200\n+++ /home/raid3/gorgolewski/bin/condor_qsub\t2013-09-09 11:06:12.865587821 +0200\n@@ -1100,7 +1100,7 @@\n \tif [ -n \"$job_deps\" ]; then\n \tsentinel_file=\"$(mktemp --tmpdir cluster${cluster_id}_sentinel.XXXXXXXXXXXXX)\"\n \tcreate_dep_sentinel $sentinel_file \"$job_deps\" \"$cluster_id\"\n-\tcondor_submit - &lt; $sentinel_file.submit &gt; /dev/null\n+\tcondor_submit &lt; $sentinel_file.submit &gt; /dev/null\n \t[ $condor_keep_files -eq 0 ] &amp;&amp; rm $sentinel_file.submit || true\n \tfi\n else\n\n\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2013-Sep-10 14:19:04 by johnkn:</em> <br/>\n\nAfter looking at the code.  it seems that there was never explicit support for - as an argument to <code>condor_submit</code>.  What has happening is that before <code>condor_submit -interactive</code> was added,  <code>condor submit -</code> was being parsed as <code>condor_submit -verbose</code>.  Then the lack of a submit filename was causing it to read from stdin. When <code>-interactive</code> was added, it was added before <code>-verbose</code> and <code>condor_submit -</code> now means <code>condor_submit -interactive</code>.\n\n<p>I'm going to patch this for stable by moving the parsing of <code>-interactive</code> until after <code>-verbose</code>.  That will restore the original behavior.  In devel we should also fix it so that there is an explicit check for - to mean read from stdin.  We should also change it so that multiple submit files can be supplied, with - interpreted as a special case for filename.\n\n</p><p></p><hr/>\n<em>2013-Sep-13 11:33:36 by tannenba:</em> <br/>\n\n<strong>CODE REVIEW</strong>  TimT reviewed, all good.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-12 11:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37570\">[37570]</a></span>: add version history item, this time to V8_0-branch for 8.0.3, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3902\" onclick=\"get_ticket_and_populate_wrapper('3902'); return false;\" title=\"condor_submit - no longer means read from stdin\">#3902</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-12 11:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37568\">[37568]</a></span>: add version history item for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3902\" onclick=\"get_ticket_and_populate_wrapper('3902'); return false;\" title=\"condor_submit - no longer means read from stdin\">#3902</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-11 16:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37551\">[37551]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3902\" onclick=\"get_ticket_and_populate_wrapper('3902'); return false;\" title=\"condor_submit - no longer means read from stdin\">#3902</a></span>, make condor_submit - (to read from stdin) parsing explicit. add -terse option so that the implicit -verbose behavior of - isn't required. clean up usage text. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-10 19:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37545\">[37545]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3902\" onclick=\"get_ticket_and_populate_wrapper('3902'); return false;\" title=\"condor_submit - no longer means read from stdin\">#3902</a></span> change condor_qsub to use a method for getting the submit file from stdin that works on all versions of HTCondor ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-10 19:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37543\">[37543]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3902\" onclick=\"get_ticket_and_populate_wrapper('3902'); return false;\" title=\"condor_submit - no longer means read from stdin\">#3902</a></span> change condor_qsub to use a method for getting the submit file from stdin that works on all versions of HTCondor ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-10 15:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37538\">[37538]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3902\" onclick=\"get_ticket_and_populate_wrapper('3902'); return false;\" title=\"condor_submit - no longer means read from stdin\">#3902</a></span>, condor_submit - doesn't read submit from stdin. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Sep-13 11:33", "status": "resolved", "created": "2013-Sep-10 10:42", "fixed_version": "2013-Sep-10 10:42", "broken_version": "", "priority": "4", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "tim", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}