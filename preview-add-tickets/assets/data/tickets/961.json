{"id": 961, "title": "Ticket #961: STARTD_CRON function disagrees with documentation: PERIOD", "description": "<blockquote>\n<a class=\"external\" href=\"http://www.cs.wisc.edu/condor/manual/v7.4/3_3Configuration.html#18521\">http://www.cs.wisc.edu/condor/manual/v7.4/3_3Configuration.html#18521</a>\n\n<p>The documentation says the _PERIOD defaults to seconds if no unit is provided, the code does something else:\n\n</p><p></p><div class=\"verbatim\">\n<pre>$ _CONDOR_STARTD_CRON_JOBLIST=TEST _CONDOR_STARTD_CRON_TEST_EXECUTABLE=someprogram _CONDOR_STARTD_CRON_TEST_PERIOD=5 condor_startd -t -f\n...\n11/17 11:35:35 CronMgr: Constructing 'startd'\n11/17 11:35:35 CronMgr: Setting name to 'startd'\n11/17 11:35:35 CronMgr: Setting parameter base to 'startd'\n11/17 11:35:35 CronMgr: Invalid period modifier '\ufffd' for job TEST (5)\n11/17 11:35:35 Cron: Can't create job for 'TEST'\n11/17 11:35:35 CronMgr: Done processing job 'TEST'\n11/17 11:35:35 CronMgr: Doing config (initial)\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2010-Jul-20 15:34:02 by slauson:</em> <br/>\n\nThe problem was that modifier was undefined when no unit was provided. Here's my simple fix:\n\n<p></p><div class=\"verbatim\">\n<pre>diff --git a/src/condor_c++_util/cronmgr.cpp b/src/condor_c++_util/cronmgr.cpp\nindex eb5224c..3ae21d4 100644\n--- a/src/condor_c++_util/cronmgr.cpp\n+++ b/src/condor_c++_util/cronmgr.cpp\n@@ -561,7 +561,7 @@ CronMgrBase::ParseJobList( const char *jobListString )\n                                         jobName );\n                        jobOk = false;\n                } else {\n-                       char    modifier;\n+                       char    modifier = 'S';\n                        int             num = sscanf( paramPeriod.Value(), \"%d%c\",\n                                                                  &amp;jobPeriod, &amp;modifier );\n                        if ( num &lt; 1 ) {\n@@ -573,7 +573,7 @@ CronMgrBase::ParseJobList( const char *jobListString )\n                        } else {\n                                // Check the modifier\n                                modifier = toupper( modifier );\n-                               if ( ( 0 == modifier ) || ( 'S' == modifier ) ) {       // Seconds\n+                               if ( ( 'S' == modifier ) ) {    // Seconds\n                                        // Do nothing\n                                } else if ( 'M' == modifier ) {\n                                        jobPeriod *= 60;\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-29 14:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=18653\">[18653]</a></span>: Fixed STARTD_CRON function to use seconds as a default to agree with documentation. (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=961\" onclick=\"get_ticket_and_populate_wrapper('961'); return false;\" title=\"STARTD_CRON function disagrees with documentation: PERIOD\">#961</a></span>).  (By Josh Slauson )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Aug-02 12:16", "status": "resolved", "created": "2009-Nov-17 10:41", "fixed_version": "2009-Nov-17 10:41", "broken_version": "v070000", "priority": "2", "subsystem": "Daemons", "assigned_to": "slauson", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu slauson@cs.wisc.edu tannenba@cs.wisc.edu", "due_date": ""}