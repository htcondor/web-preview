{"id": 5785, "title": "Ticket #5785: Disable negotiator cross-slot user priority advertising by default", "description": "<blockquote>\nMuch to the surprise of the entire condor team, the negotiator, when preemption is enabled, injects into the machine ad not only the current <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RemoteUser\" title=\"Remote User\">RemoteUser</a></span>, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RemoteGroup\" title=\"Remote Group\">RemoteGroup</a></span>, and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RemoteUserPrio\" title=\"Remote User Prio\">RemoteUserPrio</a></span> for the current slot, but also for all other slots in that ad.  This gets to be very expensive for startds with a lot of slots.  In an unrelated test of a personal condor with 10,000 slots, the negotiation was taking over two minutes just to insert all these attributes.  We have no known users of this feature, so this ticket will add a knob, false by default to enable this behaviour.  The knob will be called NEGOTIATOR_CROSS_SLOT_PRIOS</blockquote>", "remarks": "<blockquote>\n<em>2016-Nov-15 10:07:25 by tannenba:</em> <br/>\n\nAt first blush, this patch <span class=\"chng\"><a href=\"chngview?cn=48785\">[48785]</a></span> as shipped in v8.5.7 looks very broken to me; seems like this patch would result in attrs like <code>RemoteUserPrio</code>, <code>RemoteGroup</code>, etc, from ever being inserted.  Thus PREEMPTION_REQUIREMENTS for most users would always end up being undefined.\n\n<p>Fixing this issue for v8.5.8 in <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6014\" title=\"Fix preemption_requirements and preemption_rank regression from 8.5.7\">#6014</a></span>.\n\n</p><p>Meanwhile, the work-around for people running v8.5.7 who desire priority preemption is add the following to condor_config:\n\n</p><p></p><pre>   NEGOTIATOR_CROSS_SLOT_PRIOS=True</pre>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6014\" title=\"Fix preemption_requirements and preemption_rank regression from 8.5.7\">#6014</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nFix preemption_requirements and preemption_rank regression from 8.5.7</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jul-14 11:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48788\">[48788]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5785\" title=\"Disable negotiator cross-slot user priority advertising by default\">#5785</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jul-14 11:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48785\">[48785]</a></span>: Don't advertise cross-slot user prios by default <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5785\" title=\"Disable negotiator cross-slot user priority advertising by default\">#5785</a></span> This greatly speeds up the negotiatior when there are a lot of slots per machine, and the use case for this kind of policy seems rare, at best. Can be re-eneabled by setting NEGOTIATOR_CROSS_SLOT_PRIOS = true  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Nov-15 14:40", "status": "resolved", "created": "2016-Jul-14 09:56", "fixed_version": "2016-Jul-14 09:56", "broken_version": "v080500", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}