{"id": 5155, "title": "Ticket #5155: condor_q -better -reverse output confusing when expr uses CurrentTime", "description": "<blockquote>\na startd start expression that refers to attribute in its own ad seem to be undefined when running -better -reverse. use the attached ads to see the problem. (you may need to adjust the values of <code>GLIDEIN_ToRetire</code> and <code>GLIDEIN_ToDie</code>)</blockquote>", "remarks": "<blockquote>\n<em>2015-Jul-20 09:42:40 by johnkn:</em> <br/>\n\nAnalysis of these two ads is correct, but misleading.  The analyze code is seeing comparision with <code>CurrentTime</code>, noticing that it's a constant expression that doesn't need to refer to <code>TARGET</code> to resolve, and deciding that that expression is not important to display.\n\n<p>So when it shows fields that the expression reduced to, it never shows sub expressions that compare time to a constant, because it thinks the result of evaluating (for instance)\n\n</p><p></p><pre>    CurrentTime &lt; GLIDEIN_ToRetire\n</pre>\n\n<p>will never change.\n\n</p><p>Also there is no clear currently to ask it analyze to show all expressions, you can invoke some of the debugging code by running\n\n</p><p></p><pre>    condor_q -bet:reverse,64\n</pre>\n\n<p>The mask bit 64 will enable debugging display of pruned expressions.\n\n</p><p>But the real fix would be to detect is to treat expressions containing <code>CurrentTime</code> and never prune them.</p></blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/880/jobad\">jobad</a>\n9803 bytes added by gthain on 2015-Jul-15 22:09:07 UTC.\n</li><li><a href=\"attach_get/881/machad\">machad</a>\n25674 bytes added by gthain on 2015-Jul-15 22:09:17 UTC.\n</li></ul>\n</blockquote>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-27 11:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45728\">[45728]</a></span>: minor 8.3.8 version history item edit <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5155\" onclick=\"get_ticket_and_populate_wrapper('5155'); return false;\" title=\"condor_q -better -reverse output confusing when expr uses CurrentTime\">#5155</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-25 14:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45669\">[45669]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5159\" onclick=\"get_ticket_and_populate_wrapper('5159'); return false;\" title=\"condor_submit should allow an empty file transfer list.\">#5159</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5210\" onclick=\"get_ticket_and_populate_wrapper('5210'); return false;\" title=\"condor_kbdd should not report transient mouse movement as 'activity'\">#5210</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5127\" onclick=\"get_ticket_and_populate_wrapper('5127'); return false;\" title=\"make condor_userprio -long output easier to process\">#5127</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5155\" onclick=\"get_ticket_and_populate_wrapper('5155'); return false;\" title=\"condor_q -better -reverse output confusing when expr uses CurrentTime\">#5155</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4836\" onclick=\"get_ticket_and_populate_wrapper('4836'); return false;\" title=\"Enable python bindings in windows\">#4836</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5132\" onclick=\"get_ticket_and_populate_wrapper('5132'); return false;\" title=\"fix problems with SLOT_TYPE_n_* params\">#5132</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5171\" onclick=\"get_ticket_and_populate_wrapper('5171'); return false;\" title=\"DetectedCpus and DetectedMemory is stuffed into ALL ads\">#5171</a></span> <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=5172\" onclick=\"get_ticket_and_populate_wrapper('5172'); return false;\" title=\"condor_q tries to parse usernames starting with digits as job ids\">#5172</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5188\" onclick=\"get_ticket_and_populate_wrapper('5188'); return false;\" title=\"$REAL() macro substitution doesn't evaluate\">#5188</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5189\" onclick=\"get_ticket_and_populate_wrapper('5189'); return false;\" title=\"$CHOICE() macro should allow empty items\">#5189</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jul-21 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45382\">[45382]</a></span>: For <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5155\" onclick=\"get_ticket_and_populate_wrapper('5155'); return false;\" title=\"condor_q -better -reverse output confusing when expr uses CurrentTime\">#5155</a></span>, improve condor_q -better-analyze reporting when the expression refers to <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurrentTime\" title=\"Current Time\">CurrentTime</a></span> or time(). This change also moves the better-analyze code into it's own module and makes the interface to that module more formal. It also introduces two new modifiers to -better-analyze.\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Sep-18 08:41", "status": "resolved", "created": "2015-Jul-15 17:08", "fixed_version": "2015-Jul-15 17:08", "broken_version": "", "priority": "3", "subsystem": "", "assigned_to": "johnkn", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}