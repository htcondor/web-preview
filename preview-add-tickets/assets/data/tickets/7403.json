{"id": 7403, "title": "Ticket #7403: Knob DAGMan illegal character checking", "description": "<blockquote>\nIn <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5966\" title=\"Prohibit '.' and '+' in node names\">#5966</a></span> we prohibited the use of certain characters ('.', '+') in DAGMan node names because they created problems with the parser in splices. As it turned out, many people were using these characters in their workflows and this changed caused a lot of headache. Let's knob this behavior so that people can use illegal characters when they want, but prohibit them when necessary.</blockquote>", "remarks": "<blockquote>\n<em>2019-Dec-04 13:15:25 by coatsworth:</em> <br/>\n\nAll done. The new knob is called DAGMAN_ALLOW_ANY_NODE_NAME_CHARACTERS and is set to false by default. Additionally we removed the period character (.) from the list of illegal characters.\n\n<p></p><hr/>\n<em>2019-Dec-04 14:51:06 by coatsworth:</em> <br/>\n\nAlso, I've figured out why we decided to disallow periods in the first place.\n\n<p>It has to do with submitting multiple dags at once and mungeing node names. If we were to submit multiple dags as follows:\n\n</p><p><code>condor_submit_dag mydag1.dag mydag2.dag</code>\n\n</p><p>Then the parser prepends the dag number before the node names. So in <code>mydag1.dag</code>, a job called <code>FirstJob</code> gets munged to <code>0.FirstJob</code>, <code>SecondJob</code> gets munged to <code>0.SecondJob</code>. In <code>mydag2.dag</code>, <code>FirstJob</code> gets munged to <code>1.FirstJob</code> and <code>SecondJob</code> gets munged to <code>1.SecondJob</code>. This is described in more detail at <a class=\"external\" href=\"https://htcondor.readthedocs.io/en/latest/users-manual/dagman-applications.html#single-submission-of-multiple-independent-dags\">https://htcondor.readthedocs.io/en/latest/users-manual/dagman-applications.html#single-submission-of-multiple-independent-dags</a>.\n\n</p><p>So re-allowing the period opens up the possibility of name collisions. I think this is still safe. Not only are collisions very rare, but there are multiple workarounds: 1) don't submit multiple DAGs at once, 2) set the <code>DAGMAN_MUNGE_NODE_NAMES</code> macro to <code>False</code>, 3) if you must submit multiple DAGs at once, make sure they have unique node names.\n\n</p><p></p><hr/>\n<em>2019-Dec-13 14:14:29 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> change looks ok. although a param_call is kind of expensive to be doing for each node name check.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Dec-16 15:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=58666\">[58666]</a></span>: Added documentation + version history (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=7403\" title=\"Knob DAGMan illegal character checking\">#7403</a></span>)  (By Mark Coatsworth )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Dec-04 13:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=58590\">[58590]</a></span>: Added knob for DAGMan illegal characters, period character (.) now legal (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=7403\" title=\"Knob DAGMan illegal character checking\">#7403</a></span>)  (By Mark Coatsworth )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Dec-16 15:34", "status": "resolved", "created": "2019-Nov-26 14:17", "fixed_version": "2019-Nov-26 14:17", "broken_version": "v080702", "priority": "2", "subsystem": "Dag", "assigned_to": "coatsworth", "derived_from": "#5966", "creator": "coatsworth", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}