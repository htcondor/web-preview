{"id": 6175, "title": "Ticket #6175: Create an azure_gahp", "description": "<blockquote>\nCreate an Azure GAHP to allow creation and management of VMs.</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 13:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55613\">[55613]</a></span>: Allow use of default CLI credentials in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> If the credential file field of a gahp command is 'NULL', then the gahp will attempt to load the default CLI credentials via the given API.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 13:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55615\">[55615]</a></span>: Fix some formatting issues in the azure gahp's output. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Whitespace was off in a couple places. Buffering of output must be disabled.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Apr-24 15:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=54795\">[54795]</a></span>: Convert azure gahp script from windows to unix line endings. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Apr-13 16:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=54719\">[54719]</a></span>: Add azure gahp to srpm spec file. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Apr-13 13:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=54711\">[54711]</a></span>: Add azure gahp server to the release. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Apr-13 11:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=54709\">[54709]</a></span>: Merge azure gahp code into single python script. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Apr-13 10:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=54708\">[54708]</a></span>: Fix COMMANDS syntax in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-06 15:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52271\">[52271]</a></span>: Minor updates to azure gahp proctocol document. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-05 16:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52266\">[52266]</a></span>: Improve error messages and refactor code in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Provided by Rakesh Patil on September 1, 2017. Committer: Jaime Frey  (By Rakesh Patil )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-05 16:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52265\">[52265]</a></span>: Refactor code of azure gahp and some bug fixes. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Provided by Sachin on August 17, 2017. Committer: Jaime Frey  (By Sachin )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-05 16:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52264\">[52264]</a></span>: Revamp granting of key vault access to VMs in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Previous code added each VMSS to key vault's access list, leaving cleanup issue. Now, access is granted via an Active Directory group, and each VMSS's membership in the group is cleaned up automatically when the VMSS is deleted. The key\u00a0[...]\n (By Pradeep )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-05 15:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52263\">[52263]</a></span>: Update to key vault secret download code in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Eliminate sending of credentials in VMSS's custom data and installation/use of Azure CLI within the VMs.\u00a0[...]\n (By Sachin )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-05 15:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52262\">[52262]</a></span>: The key vault setup script to be run on VMs. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> This is the script to be run in VMs to download a secret (say an HTCondor pool password) from an Azure key vault. It was retrieved from the following URL: <a class=\"external\" href=\"https://raw.githubusercontent.com/azmigproject/HTCondor/master/Setup.sh\">https://raw.githubusercontent.com/azmigproject/HTCondor/master/Setup.sh</a>\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-13 15:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51877\">[51877]</a></span>: Remove extra messages printed to stdout in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51876\">[51876]</a></span>: Update Azure gahp protocol to reflect current GAHP code. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51875\">[51875]</a></span>: Make azure deletion jobs more configurable. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Also initial code for key vault improvements. Provided by Pradeep on July 10, 2017. Committer: Jaime Frey  (By Pradeep )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51874\">[51874]</a></span>: Clean up old deletion jobs in azure. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Also minor changes in key vault code. Provided by Pradeep on July 6, 2017. Committer: Jaime Frey  (By Pradeep )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51873\">[51873]</a></span>: <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=PowerShell\" title=\"Power Shell\">PowerShell</a></span> script for azure deletion job. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Provided by Sachin on June 23, 2017. Committer: Jaime Frey  (By Sachin )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51872\">[51872]</a></span>: Fix bug in creating deletion job for azure scale set. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Provided by Sachin on June 23, 2017. Committer: Jaime Frey  (By Sachin )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51871\">[51871]</a></span>: Create deletion job before scale set in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Provided by Sachin on June 22, 2017. Committer: Jaime Frey  (By Sachin )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51870\">[51870]</a></span>: Add options to azure scale set creation for annex. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Highlights: * Support using existing vnet subnet. * Add option to insert a key vault secret into scale set vms. * Add option to delete a scale set at a set time. Provided by Sachin on June 20, 2017. Committer: Jaime Frey  (By Sachin )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51869\">[51869]</a></span>: Add scale set commands to azure gahp, and other improvements. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Highlights: * Add logging/debugging options. * Add scale set commands. * Support Python 2. * Use managed disks. * vmID and public IP address in submit results. Provided by Rangarajan Srirangam on May 25, 2017. Committer: Jaime Frey  (By Rangarajan Srirangam )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51868\">[51868]</a></span>: Support creating an azure vm from a custom image. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Also fix whitespace and escaping in gahp protocol. Provided by Rakesh Patil on April 18, 2017. Committer: Jaime Frey  (By Rakesh Patil )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51867\">[51867]</a></span>: Finish support for dataDisks option to submit in azure gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Also, fix use of whitespace in gahp protocol. Provided by Rangarajan Srirangam on April 13, 2017. Committer: Jaime Frey  (By Rangarajan Srirangam )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 14:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51866\">[51866]</a></span>: Add optional parameters to azure submit and list commands. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Highlights: * Add code for submit command options: publicIpAddress, osType, tag, customData, dataDisks. * Add code for tag option to list command. Provided by Rakesh Patil on April 11, 2017. Committer: Jaime Frey  (By Rakesh Patil )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 09:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51865\">[51865]</a></span>: Initial azure gahp implementation snapshot. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span> Azure GAHP server written in Python, which uses the Azure Python SDK. Implements the required commands in the GAHP protocol document. AppSettings.txt is a sample credential/settings file.\u00a0[...]\n (By Rangarajan Srirangam )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-31 13:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50382\">[50382]</a></span>: Add gahp commands AZURE_ACCOUNT_INFO and AZURE_VM_INFO to protocol. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-10 16:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50302\">[50302]</a></span>: Initial draft of Azure GAHP protocol specification. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6175\" onclick=\"get_ticket_and_populate_wrapper('6175'); return false;\" title=\"Create an azure_gahp\">#6175</a></span>  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2018-Oct-24 15:44", "status": "resolved", "created": "2017-Mar-07 11:12", "fixed_version": "2017-Mar-07 11:12", "broken_version": "", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "#6174", "creator": "jfrey", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}