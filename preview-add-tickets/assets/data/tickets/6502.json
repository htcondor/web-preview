{"id": 6502, "title": "Ticket #6502: Missing 'MyType' from ad returned by Collector.locate()", "description": "<blockquote>\nWhen using Collector().locate() with the optional name argument, we get a smaller version of the targeted daemon's classad:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">    [\n        AddressV1 = \"{[ p=\\\"primary\\\"; a=\\\"131.225.155.96\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034180_dda6_3\\\"; noUDP=true; ], [ p=\\\"IPv4\\\"; a=\\\"131.225.155.96\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034180_dda6_3\\\"; noUDP=true; ], [ p=\\\"IPv6\\\"; a=\\\"::1\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034180_dda6_3\\\"; noUDP=true; ]}\";\n        CondorPlatform = \"$CondorPlatform: X86_64-CentOS_7.4 $\";\n        CondorVersion = \"$CondorVersion: 8.6.8 Oct 31 2017 $\";\n        Machine = \"fermicloud360.fnal.gov\";\n        MyAddress = \"&lt;131.225.155.96:9619?addrs=131.225.155.96-9619+[--1]-9619&amp;noUDP&amp;sock=1034180_dda6_3&gt;\";\n        Name = \"fermicloud360.fnal.gov\";\n        MyType = \"Scheduler\"\n    ]\n</pre></div>\n\n\n<p>However, when using 8.7.5, the 'MyType' attribute appears to be missing:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">    [\n        AddressV1 = \"{[ p=\\\"primary\\\"; a=\\\"131.225.155.96\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034961_911d_3\\\"; noUDP=true; ], [ p=\\\"IPv4\\\"; a=\\\"131.225.155.96\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034961_911d_3\\\"; noUDP=true; ]}\";\n        CondorPlatform = \"$CondorPlatform: X86_64-CentOS_7.4 $\";\n        CondorVersion = \"$CondorVersion: 8.7.5 Oct 31 2017 $\";\n        Machine = \"fermicloud360.fnal.gov\";\n        MyAddress = \"&lt;131.225.155.96:9619?addrs=131.225.155.96-9619&amp;noUDP&amp;sock=1034961_911d_3&gt;\";\n        Name = \"fermicloud360.fnal.gov\"\n    ]\n</pre></div>\n\n\n<p>Unrelated strange thing I noticed: after updating the RPM from 8.6.8 to 8.7.5, the ad is missing the 'MyType' attribute but shows the old condor version. After restarting the condor service, the version gets updated as seen above.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">    [\n        AddressV1 = \"{[ p=\\\"primary\\\"; a=\\\"131.225.155.96\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034180_dda6_3\\\"; noUDP=true; ], [ p=\\\"IPv4\\\"; a=\\\"131.225.155.96\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034180_dda6_3\\\"; noUDP=true; ], [ p=\\\"IPv6\\\"; a=\\\"::1\\\"; port=9619; n=\\\"Internet\\\"; spid=\\\"1034180_dda6_3\\\"; noUDP=true; ]}\";\n        CondorPlatform = \"$CondorPlatform: X86_64-CentOS_7.4 $\";\n        CondorVersion = \"$CondorVersion: 8.6.8 Oct 31 2017 $\";\n        Machine = \"fermicloud360.fnal.gov\";\n        MyAddress = \"&lt;131.225.155.96:9619?addrs=131.225.155.96-9619+[--1]-9619&amp;noUDP&amp;sock=1034180_dda6_3&gt;\";\n        Name = \"fermicloud360.fnal.gov\"\n    ]\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2017-Dec-13 14:01:42 by blin:</em> <br/>\n\nThis ticket can be closed \"Won't Fix\" but I am curious about the incorrect version in the ad\n\n<p></p><hr/>\n<em>2017-Dec-13 17:54:15 by tannenba:</em> <br/>\n\nRe why the old version after updating the RPM:\n\n<p>Uninstalling the RPM shuts down any running HTCondor instance. However, <em>updating</em> the RPM does not attempt to shutdown any existing HTCondor instance. So when you update the RPM, the new files are laid down onto the filesystem, but the service will not be restarted until the condor_master notices the binaries have changed and restarts all the daemons.  The default value for config knob <code>MASTER_CHECK_NEW_EXEC_INTERVAL</code> is 300, so by default the condor_master may take up to 5 minutes to notice you updated the binaries.  So for 5 minutes after updating the RPM, you may still be running the old version.</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2017-Dec-13 17:54", "status": "abandoned", "created": "2017-Dec-08 10:27", "fixed_version": "2017-Dec-08 10:27", "broken_version": "v080705", "priority": "2", "subsystem": "PythonBinding", "assigned_to": "tannenba", "derived_from": "#4882", "creator": "blin", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "blin@cs.wisc.edu bbocklem@cse.unl.edu", "due_date": ""}