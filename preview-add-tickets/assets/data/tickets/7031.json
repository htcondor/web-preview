{"id": 7031, "title": "Ticket #7031: Make CheckpointExitCode a first-class submit command.", "description": "<blockquote>\nIf we're claiming that support for self-checkpointing jobs in vanilla universe is no longer experimental, we should add it to the submit language as a first-class command.  TJ proposes, and I concur, that the job ad attribute <code>WantFTOnCheckpoint</code> is effectively redundant with having <code>+SuccessCheckpointExitCode</code> set, and that the latter would be better without the 'Success' prefix.  Thus:\n\n<p></p><div class=\"file\">\n<pre class=\"filelabel\">self-checkpointing.submit</pre>\n<pre class=\"file\">checkpoint_exit_code = 17\n</pre></div>\n\n\n<p>would:\n\n</p><p></p><ul>\n<li>set the job ad attribute <code>WantFTOnCheckpoint</code> to <code>TRUE</code>.\n</li><li>set the job ad attribute <code>SuccessCheckpointExitCode</code> to <code>17</code>.\n</li></ul>\n\n<p>(It turns out that <code>when_to_transfer_output</code> does <em>not</em> need to be set to\n<code>ON_EXIT_OR_EVICT</code>.  This also means that checkpoint updates do <em>not</em> need to be atomic, which simplifies things for our users.)\n\n</p><p>The document at <span class=\"wiki\"><a href=\"wiki?p=HowToRunSelfCheckpointingJobs\" title=\"How To Run Self Checkpointing Jobs\">HowToRunSelfCheckpointingJobs</a></span> should updated to reflect the new syntax and that ON_EXIT_OR_EVICT is optional.\n\n</p><p>This ticket renders <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7014\" onclick=\"get_ticket_and_populate_wrapper('7014'); return false;\" title=\"Vanila universe checkpoint on eviction by default\">#7014</a></span> obsolete.\n\n</p><p>This ticket renders <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7022\" onclick=\"get_ticket_and_populate_wrapper('7022'); return false;\" title=\"Document checkpointing in the vanilla universe\">#7022</a></span> obsolete.\n\n</p><p>This ticket renders <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=7003\" onclick=\"get_ticket_and_populate_wrapper('7003'); return false;\" title=\"Improve UX when testing self-checkpointing\">#7003</a></span> part 1 obsolete.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Jun-11 18:35:27 by tlmiller:</em> <br/>\n\n... did this <em>ever</em> need ON_EXIT_OR_EVICT set?  The <a href=\"ExperimentalSupportForPeriodicCheckpointingInVanillaUniverse\">old documentation</a> doesn't think so.  The code certainly supports the assertion that it's not presently necessary.  Have I just been being confused?\n\n<p></p><hr/>\n<em>2019-Jun-14 17:12:25 by tlmiller:</em> <br/>\n\nPart 1, from <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=7013\" onclick=\"get_ticket_and_populate_wrapper('7013'); return false;\" title=\"Make the main branch of HTCondor FIPS compliant\">#7013</a></span>:\n\n<p>Write (after the doc freeze thaws) a new page/section in the manual about self-checkpointing (in the vanilla universe, where it matters).  Introduce/reinforce the ON_EXIT_OR_EVICT idea, best practices about atomic updates to checkpoint files, and the general sequence and tools used to test self-checkpointing.  This does not necessarily need to mention <span class=\"wiki\"><a href=\"wiki?p=ExperimentalSupportForPeriodicCheckpointingInVanillaUniverse\" title=\"Experimental Support For Periodic Checkpointing In Vanilla Universe\">ExperimentalSupportForPeriodicCheckpointingInVanillaUniverse</a></span>, but it could.  The use of chirp might also be discussed, if only to explain why its limitations.  To be more specific, the condor_vacate_job / condor_transfer_data pairing pairing should be mentioned, not just in the self-checkpointing section, but also in their respective man pages.\n\n</p><p></p><hr/>\n<em>2019-Jun-14 19:51:40 by tlmiller:</em> <br/>\n\nUpdated <span class=\"wiki\"><a href=\"wiki?p=HowToRunSelfCheckpointingJobs\" title=\"How To Run Self Checkpointing Jobs\">HowToRunSelfCheckpointingJobs</a></span>; needs a polishing pass.\n\n<p></p><hr/>\n<em>2019-Jun-20 11:56:46 by tlmiller:</em> <br/>\n\nReviewed in-person.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7112\" onclick=\"get_ticket_and_populate_wrapper('7112'); return false;\" title=\"Advertise HasSelfCheckpointTransfers in 8.8\">#7112</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdvertise <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HasSelfCheckpointTransfers\" title=\"Has Self Checkpoint Transfers\">HasSelfCheckpointTransfers</a></span> in 8.8</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-20 11:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57199\">[57199]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7031\" onclick=\"get_ticket_and_populate_wrapper('7031'); return false;\" title=\"Make CheckpointExitCode a first-class submit command.\">#7031</a></span>) Remove spurious flag.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-18 16:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57168\">[57168]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7031\" onclick=\"get_ticket_and_populate_wrapper('7031'); return false;\" title=\"Make CheckpointExitCode a first-class submit command.\">#7031</a></span>) Revert to std::english until more of our readers support opt::gibberish.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-18 16:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57167\">[57167]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7031\" onclick=\"get_ticket_and_populate_wrapper('7031'); return false;\" title=\"Make CheckpointExitCode a first-class submit command.\">#7031</a></span>) Documentation.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-14 17:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57157\">[57157]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7031\" onclick=\"get_ticket_and_populate_wrapper('7031'); return false;\" title=\"Make CheckpointExitCode a first-class submit command.\">#7031</a></span>) Implement checkpoint_exit_code submit command.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Jun-20 11:57", "status": "resolved", "created": "2019-May-02 15:42", "fixed_version": "2019-May-02 15:42", "broken_version": "", "priority": "2", "subsystem": "Libs", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, johnkn@cs.wisc.edu", "due_date": ""}