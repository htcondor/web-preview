{"id": 2858, "title": "Ticket #2858: Unwriteable global event log prevents writing to \"normal\" job logs", "description": "<blockquote>\nIf you have the global event log enabled (EVENT_LOG is set in your config) and that file is not writeable, the schedd doesn't write any events to the \"regular\" user log specified in a job's submit file.  This obviously breaks DAGMan...</blockquote>", "remarks": "<blockquote>\n<em>2012-Mar-01 15:27:35 by wenger:</em> <br/>\n\nI guess we should make an actual 'bad_event_log' test for this that does chmod 0 on the event log file (once the tests are set up to run with a global event log).\n\n<p></p><hr/>\n<em>2012-Mar-02 13:54:06 by wenger:</em> <br/>\n\nAs per discussion with Todd T, the fix for this will go into the 7.6 branch (but the test will go into 7.7/master).\n\n<p></p><hr/>\n<em>2012-Mar-02 14:17:47 by wenger:</em> <br/>\n\nOh, yeah -- Todd and I decided that if WriteUserLog::writeEvent() fails to write to the \"normal\" log file, it should return a value indicating an error; but if it just fails to write to the <strong>global</strong> event log, it should still return success (but should print an error or warning message).\n\n<p></p><hr/>\n<em>2012-Mar-05 11:44:00 by wenger:</em> <br/>\n\nI've split the test part of this ticket out in to <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2861\" title=\"Add global event log-related tests\">#2861</a></span>, because the tests should go into 7.7, but the actual fix should go into 7.6.\n\n<p></p><hr/>\n<em>2012-Mar-06 10:04:04 by wenger:</em> <br/>\n\nOkay, some partial changes for this are committed on the V7_6-gittrac_2858-branch.\n\n<p>Also, I started adding \"ERROR:\" to the error messages in write_user_log.cpp, because a lot of the existing error messages are not very clear, and I think it's useful to be able to easily find the things that are errors when looking at the logs, amidst all of the messages that are <strong>not</strong> errors.\n\n</p><p></p><hr/>\n<em>2012-Mar-07 09:03:20 by nwp:</em> <br/>\n\nTest runs in batlab succeeded, so I am merging this into 7.6, then master.  The tests in <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2861\" title=\"Add global event log-related tests\">#2861</a></span> still need to be implemented, but I am resolving this ticket.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2861\" title=\"Add global event log-related tests\">#2861</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd global event log-related tests</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-02 10:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=31055\">[31055]</a></span>: edit of version history item ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2858\" title='Unwriteable global event log prevents writing to \"normal\" job logs'>#2858</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-07 09:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=30847\">[30847]</a></span>: Merged <span class=\"chng\"><a href=\"chngview?cn=30846\">[30846]</a></span>, Merge branch 'V7_6-branch' This is for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2858\" title='Unwriteable global event log prevents writing to \"normal\" job logs'>#2858</a></span>  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-07 09:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=30846\">[30846]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2858\" title='Unwriteable global event log prevents writing to \"normal\" job logs'>#2858</a></span>  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-07 08:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=30845\">[30845]</a></span>: Merged <span class=\"chng\"><a href=\"chngview?cn=30820\">[30820]</a></span>, Merge branch 'V7_6-branch' Pull in fix for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2858\" title='Unwriteable global event log prevents writing to \"normal\" job logs'>#2858</a></span>  (By Nathan W. Panike )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-06 09:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=30820\">[30820]</a></span>: Partially implemented fix to gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2858\" title='Unwriteable global event log prevents writing to \"normal\" job logs'>#2858</a></span> (Unwriteable global event log prevents writing to \"normal\" job logs) -- I'm committing my changes on a branch to transfer them over to Nathan.  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Mar-07 09:38", "status": "resolved", "created": "2012-Mar-01 15:02", "fixed_version": "2012-Mar-01 15:02", "broken_version": "v070705", "priority": "1", "subsystem": "Libs", "assigned_to": "nwp", "derived_from": "", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}