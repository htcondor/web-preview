{"id": 2513, "title": "Ticket #2513: NETWORK_INTERFACE does not work as expected", "description": "<blockquote>\nAs of 7.7.0, the following configuration does not cause the daemons to bind only to 127.0.0.1:\n\n<p></p><pre>   BIND_ALL_INTERFACES = FALSE\n   NETWORK_INTERFACE = 127.0.0.1\n</pre>\n\n<p>It does not even cause the daemon to advertise 127.0.0.1 as its public address.\n\n</p><p>I have verified that in 7.6.2, the above configuration does have the expected effect.\n\n</p><p>Here's what appears to be causing this problem:\n\n</p><p>Checkin <span class=\"chng\"><a href=\"chngview?cn=22136\">[22136]</a></span> attempted to fix problems in the new 7.7.0 IPv6 init_local_hostname().  However, this code caches the result of my_sin_addr(), among other things.  The problem with caching the result is that if my_sin_addr() is called before the configuration has been fully initialized, NETWORK_INTERFACE is not taken into account.  init_local_hostname() is called early during configuration in order to fill in config macros such as HOSTNAME.  From then on, the cached value is used, so NETWORK_INTERFACE is effectively ignored.\n\n</p><p>Note that all cached values in my_hostname.cpp are cleared and re-initialized by the config system after the configuration has been loaded.  Something similar needs to be done for the new IPv6 code, or it just needs to avoid caching.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-30 12:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27551\">[27551]</a></span>: Documented fix for NETWORK_INTERFACE. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2513\" title=\"NETWORK_INTERFACE does not work as expected\">#2513</a></span> ===VersionHistory:Complete===  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-30 12:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27550\">[27550]</a></span>: NETWORK_INTERFACE was broken since 7.7.0. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2513\" title=\"NETWORK_INTERFACE does not work as expected\">#2513</a></span>  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Oct-17 18:59", "status": "resolved", "created": "2011-Sep-30 11:12", "fixed_version": "2011-Sep-30 11:12", "broken_version": "v070700", "priority": "2", "subsystem": "", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "users", "visibility": "public", "notify": "", "due_date": ""}