{"id": 3269, "title": "Ticket #3269: Grid-type batch doesn't work on systems with glite installed", "description": "<blockquote>\nWhen Condor uses the blahp to submit jobs to other batch systems, it needs to set GLITE_LOCATION in the environment for the blahp to find its components. If the system has a root-installed glite, then the standard login scripts will set GLITE_LOCATION to point at that installation. The is a problem for the XXXX_submit.sh scripts in Condor's blahp, which invoke bash with the -l argument. This causes the script to source the login scripts, overwriting our GLITE_LOCATION setting. Consequently, job submissions fail.\n\n<p>It appears we can just remove the <code>-l</code> from the first line of the XXXX_submit.sh scripts. Settings in the user-specific login scripts shouldn't affect the job's environment or the script's ability to submit into the batch system.\n\n</p><p>If sourcing the login scripts ends up being necessary, it could be done explicitly in the submit scripts while taking care to maintain the existing value of GLITE_LOCATION.\n\n</p><p>The following code will duplicate the sourcing of login scripts at startup triggered by <code>-l</code>:\n</p><div class=\"code\">\n<pre class=\"code\">if -r /etc/profile; then\n  . /etc/profile\nfi\nif -r ~/.bash_profile; then\n  . ~/.bash_profile\nelif -r ~/.bash_login; then\n  . ~/.bash_login\nelif -r ~/.profile; then\n  . ~/.profile\nfi\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Dec-06 10:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=34308\">[34308]</a></span>: Version history for blahp jobs and root-installed glite. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3269\" title=\"Grid-type batch doesn't work on systems with glite installed\">#3269</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-16 15:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33681\">[33681]</a></span>: Make grid-type batch work on systems with glite installed. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=3269\" title=\"Grid-type batch doesn't work on systems with glite installed\">#3269</a></span> The gridmanager sets GLITE_LOCATION in the environment so that the blahp we distribute can find its files. If a system has glite installed, the login scripts will set GLITE_LOCATION to that location. The blahp's submit scripts run bash\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Dec-06 10:13", "status": "resolved", "created": "2012-Oct-16 11:18", "fixed_version": "2012-Oct-16 11:18", "broken_version": "v070800", "priority": "4", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}