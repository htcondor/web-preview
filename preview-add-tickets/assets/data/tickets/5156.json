{"id": 5156, "title": "Ticket #5156: Implement MAX_TIME_PER_SCHEDD for negotiator", "description": "<blockquote>\nIn CMS, we're observing that a single schedd has the ability to completely ruin an entire negotiation cycle.\n\n<p>Some of our schedds have 400 submitter ads; when they get overloaded, the negotiator hits a 10s timeout for each submitter.  Since we're on a glidein-based infrastructure, we must keep a limit on our total negotiation cycle time (preferably, no more than 15 minutes) - meaning a single bad schedd can basically stop all negotiation activity.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Jul-28 14:16:40 by bbockelm:</em> <br/>\n\nTesting this out in CMS-land, it appears to work fine.  Certainly the log lines are much appreciated.\n\n<p>Only complaint is that integers are too coarse-grained for this (lots of negotiation interactions take ~0.4s, which are then rounded down to 0).  This complaint is true for all the MAX_TIME_PER_* knobs so I think we can merge without addressing that if you'd like.\n\n</p><p></p><hr/>\n<em>2015-Jul-28 16:12:50 by jfrey:</em> <br/>\n\nSome of the time, the interaction should cross a second boundary and be rounded up to 1 second. Across many interactions, I would expect it to even out statistically.\n\n<p>But as you say, that can be treated as a separate issue that affects all of the timing measurements in the negotiator.\n\n</p><p></p><hr/>\n<em>2015-Aug-04 21:16:30 by bbockelm:</em> <br/>\n\nHi Jaime,\n\n<p>Is this OK to merge to master?  Its been working well for CMS for about a week.\n\n</p><p>Brian</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-11 12:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45565\">[45565]</a></span>: minor edit of new knob in 8.3.8 <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5156\" title=\"Implement MAX_TIME_PER_SCHEDD for negotiator\">#5156</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-07 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45529\">[45529]</a></span>: Docs for new config parameter NEGOTIATOR_MAX_TIME_PER_SCHEDD. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5156\" title=\"Implement MAX_TIME_PER_SCHEDD for negotiator\">#5156</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jul-20 16:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45360\">[45360]</a></span>: New config knob NEGOTIATOR_MAX_TIME_PER_SCHEDD. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5156\" title=\"Implement MAX_TIME_PER_SCHEDD for negotiator\">#5156</a></span> This new config knob can limit the time the negotiator will spend talking to each schedd during a negotiation cycle. Thus, the impact of an overloaded schedd on the rest of the pool can be limited. The default is one year, like the other negotiator\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Aug-07 13:37", "status": "resolved", "created": "2015-Jul-16 11:12", "fixed_version": "2015-Jul-16 11:12", "broken_version": "", "priority": "2", "subsystem": "DaemonsCM", "assigned_to": "jfrey", "derived_from": "#5162", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "tannenba@cs.wisc.edu, bbockelm@cse.unl.edu", "due_date": ""}