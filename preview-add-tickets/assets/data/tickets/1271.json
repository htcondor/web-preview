{"id": 1271, "title": "Ticket #1271: Add Deltacloud support to grid universe", "description": "<blockquote>\nDeltacloud is an API abstraction for cloud computing client interfaces. It provides a simple REST interface that can be used to interact with many different cloud services. We want to support Deltacloud in the grid universe, similar to how we support Amazon EC2.\n\n<p>Deltacould is being developed by Red Hat. You can find more information about it at <a class=\"external\" href=\"http://deltacloud.org\">http://deltacloud.org</a>.\n\n</p><p>Red Hat will write a GAHP for Deltacloud, while Flightworthy will modify the gridmanager and any other Condor code.\n\n</p><p><span class=\"section\"></span></p><h2>Milestones </h2>\n<ul>\n<li>Handle systems where VMs begin in <code>stopped</code> state\n</li><li>Handle systems where VMs need to be destroyed after shutdown</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2010-Mar-17 12:11:22 by jfrey:</em> <br/>\n\nWork accomplished so far:\n<ul>\n<li>Defined gahp protocol.\n</li><li>Created branch V7_5-dcloud-branch for development work.\n</li><li>Received and committed initial code for dcloud_gahp from Chris Lalancette.\n</li><li>Committed initial changes to gridmanager.\n</li></ul>\n\n<p></p><hr/>\n<em>2010-Jun-18 13:11:38 by matt:</em> <br/>\n\nAny updates on this?\n<hr/>\n<em>2010-Oct-20 16:03:30 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:46:04 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 16:01:00 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1907\" onclick=\"get_ticket_and_populate_wrapper('1907'); return false;\" title=\"Create a test for deltacloud\">#1907</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nCreate a test for deltacloud</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Nov-15 14:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=19405\">[19405]</a></span>: Re-enable use of destroy command to deltacloud gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> Chris Lalancette says this methods works now.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-29 15:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17932\">[17932]</a></span>: Exempt dcloud_gahp from safe-open check. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-28 17:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17929\">[17929]</a></span>: Remove periodic job polling in DCloudJob object. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> The DCloudResource object does a periodic poll of all jobs, so polls by individual job objects is redundant.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-28 17:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17928\">[17928]</a></span>: Disable dcloud destroy operation for now. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> The destroy operation is not supported by the dcloudapi client library. So don't try to invoke it until that's fixed.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-28 17:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17927\">[17927]</a></span>: Fix <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GridJobId\" title=\"Grid Job Id\">GridJobId</a></span> parsing for dcloud jobs. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-22 15:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17902\">[17902]</a></span>: Fix locking of stdout in dclou_gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> Locking of stdout was too fine before. Parts of lines could be interleaved. Now, the lock is held through entire replies to client requests.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-22 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17901\">[17901]</a></span>: Change DCLOUD_VM_FIND result when instance not found. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> Now, when the named instance isn't found, the command returns success and an id of NULL.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-22 15:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17900\">[17900]</a></span>: Several bugfixes in the gridmanager for dcloud. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-22 12:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17899\">[17899]</a></span>: Fix up dcloud code in the gridmanager. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> * Initialize gahp properly. * Handle instances that begin in the 'stopped' state. * Handle instances that need to be explicitly destroyed. * Extract instance state from gahp command results. * Set job status to running when appropriate.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-22 12:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17898\">[17898]</a></span>: Include vm state in dcloud_gahp instance info. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-22 12:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17897\">[17897]</a></span>: Improve dcloud_gahp's reading of stdin. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> * Commands that weren't read in one syscall were lost. * Gahp didn't exit when stdin was closed.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-21 14:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17895\">[17895]</a></span>: For dcloud, start VMs that are born in the 'stopped' state. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> With some backends to deltacloud, newly-created VM instances begin life in the 'stopped' state and need an explicit 'start' command to begin executing.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-06 17:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17795\">[17795]</a></span>: Add some includes to the dcloud_gahp source files. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Apr-06 17:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17794\">[17794]</a></span>: Add a couple casts to DCloudResource in the gridmanager. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Mar-12 16:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17454\">[17454]</a></span>: Remove all Condor code from dcloud gahp. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> The Dcloud gahp doesn't need any code from the rest of Condor. This makes the program simpler and smaller.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Mar-12 11:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17453\">[17453]</a></span>: Initial implementation of Deltacloud GAHP. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> A GAHP for interacting with Deltacloud, to be used by the gridmanager. Committer: Jaime Frey  (By Chris Lalancette )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Mar-11 11:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17436\">[17436]</a></span>: Add initial Deltacloud support in grid universe. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1271\" onclick=\"get_ticket_and_populate_wrapper('1271'); return false;\" title=\"Add Deltacloud support to grid universe\">#1271</a></span> Deltacloud is a API abstraction for cloud computing client interfaces. It provides a simple REST interface that can be used to interact with many different cloud services.\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Feb-08 15:33", "status": "resolved", "created": "2010-Mar-11 11:39", "fixed_version": "2010-Mar-11 11:39", "broken_version": "v070500", "priority": "2", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu, tstclair@redhat.com", "due_date": ""}