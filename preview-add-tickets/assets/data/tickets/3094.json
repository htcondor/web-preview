{"id": 3094, "title": "Ticket #3094: DMTCP doesn't work in 7.8; SIGINT ignored", "description": "<blockquote>\nReport from Gene Cooperman, made by phone:\n\n<p>DMTCP/condor_dmtcp works in 7.2.  It no longer worked in 7.8(?).  Investigation suggests that SIGINT is being ignored, and SIGINT is what shim_dmtcp is using to detect a request to checkpoint and exit.  This has been identified by both condor_ssh_to_job and \"kill -2 PID\" as well as looking in /proc/$PID/status at <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SigIgn\" title=\"Sig Ign\">SigIgn</a></span>.  (Easy expansion of <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SigIgn\" title=\"Sig Ign\">SigIgn</a></span>: echo 0000000000384004 | xxd -r -p | xxd -b\n\n</p><p>Doing initial triage. - adesmet 2012-06-28</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Jun-28 15:08:24 by adesmet:</em> <br/>\n\nCannot reproduce. Only PIPE is blocked.  Tested on Red Hat 5.8/Condor 7.8.1 and Red Hat 5.7/Condor 7.7.6.  New hypothesis: init scripts on remote site are setting ignore INT?\n\n<p></p><hr/>\n<em>2012-Jun-28 15:09:01 by adesmet:</em> <br/>\n\nBecause I couldn't find a tool to easily list the ignored signals, I quick wrote one.  it's attached as \"describe signals\".\n\n<p></p><hr/>\n<em>2012-Jun-28 17:20:16 by adesmet:</em> <br/>\n\nReported to work fine on Debian Squeeze/6.0 stable.\n\n<p></p><hr/>\n<em>2012-Jun-29 17:23:40 by adesmet:</em> <br/>\n\nCurrent status: it looks like the job is just inheriting the ignoring of SIGINT from Condor.  Why is Condor ignoring it?  Not sure, but I suspect that it was set that way by the process that itself started Condor.\n\n<p>On the problematic machines, when Condor is started by init on boot, all is well.  When stopped and restarted using the init script tool, all is well.  But sometimes, none-the-less, it ends up blocked.  They're looking into what's going on.\n\n</p><p></p><hr/>\n<em>2012-Jul-02 14:36:01 by gene:</em> <br/>\n\nThis has now been diagnosed as a Debian bug (present in Debian 6.0/squeeze).\nThe Debian bug report is at <a class=\"external\" href=\"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679630\">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=679630</a>\nThe short story is that if Debian squeeze uses the dependency-based booting, then some of the early daemons in the boot process will block SIGINT.  If you suspect this on your machine, test it with:\n\n<p></p><pre>  cat /proc/*/status | grep \"\\(SigIgn\\|Name\\)\" |egrep -B1 \"[0-9a-f][0-9a-f]+2$\"\n</pre>\n\n<p>and look to see if many daemons (especially condor) have <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SigIgn\" title=\"Sig Ign\">SigIgn</a></span> ending in 2.\nThe workaround is to kill condor and restart it again as root:\n\n</p><p></p><pre>  /etc/init.d/condor restart\n</pre>\n\n<p>For additional bugs in Condor/DMTCP integration, please also send a bug report to <a class=\"external\" href=\"http://dmtcp.sourceforge.net\">http://dmtcp.sourceforge.net</a> to reach the DMTCP developers.  Thank you.  -- the DMTCP developers.\n\n</p><p></p><hr/>\n<em>2012-Jul-03 17:24:27 by adesmet:</em> <br/>\n\nResolved as Debian specific bug.  The idea that Condor should reset signal handling as a workaround for this and potentially other bugs is <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=3107\" title=\"Should Condor reset signal handling to defaults?\">#3107</a></span>: Should Condor reset signal handling to defaults?</blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/586/describe-signals\">describe-signals</a>\n562 bytes added by adesmet on 2012-Jun-28 20:09:57 UTC.\n<br/>\nLists by name the signals being ignored by the PID(s) on the command line<br/>\n</li></ul>\n</blockquote>", "check_ins": "", "type": "incident", "last_change": "2012-Jul-03 17:25", "status": "resolved", "created": "2012-Jun-28 14:01", "fixed_version": "2012-Jun-28 14:01", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "adesmet", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}