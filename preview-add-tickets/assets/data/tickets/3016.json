{"id": 3016, "title": "Ticket #3016: blahp canceling of completed job causes a failure", "description": "<blockquote>\nI managed to screwup a proxy, which caused the gridmanager to attempt to cancel the job after a failed renewal.\n\n<p>The job had already completed before the cancellation was attempted.  In such a case, qdel has the following output:\n\n</p><p>Request invalid for state of job MSG=invalid state for job - COMPLETE 19.brian-test.unl.edu\n\n</p><p>This causes the job to go on hold; see below.  I propose the gridmanager should either screen-scrape this particular error message or check the status after a failed cancel.\n\n</p><p></p><div class=\"verbatim\">\n<pre>[bbockelm@brian-test ~]$ condor_q -held\n\n\n-- Submitter: brian-test.unl.edu : &lt;129.93.239.174:45320&gt; : brian-test.unl.edu\n ID       OWNER          HELD_SINCE  HOLD_REASON\n[... removing other jobs ...]\n25246.0   bbockelm        5/29 09:02 qdel: Request invalid for state of job MSG=invalid state for job - COMPLETE 19.brian-test.unl.edu\n\n5 jobs; 0 completed, 0 removed, 0 idle, 0 running, 5 held, 0 suspended\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2012-Jun-28 16:51:43 by jfrey:</em> <br/>\n\nAnother possibility is to have the blahp's pbs_cancel.sh script detect the error message and report a successful removal.\n\n<p></p><hr/>\n<em>2012-Jul-03 15:25:06 by tannenba:</em> <br/>\n\nAlso important for Bosco work.</blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/587/pbs_qdel.patch\">pbs_qdel.patch</a>\n808 bytes added by jfrey on 2012-Jun-28 22:02:44 UTC.\n<br/>\nPatch to blahp's pbs_cancel.sh that treats qdel errors about completed and non-existent jobs as successes.<br/>\n</li></ul>\n</blockquote>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-07 14:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32993\">[32993]</a></span>: blahp version history. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3133\" onclick=\"get_ticket_and_populate_wrapper('3133'); return false;\" title=\"Blahp depends on condor_history -f\">#3133</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3016\" onclick=\"get_ticket_and_populate_wrapper('3016'); return false;\" title=\"blahp canceling of completed job causes a failure\">#3016</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3057\" onclick=\"get_ticket_and_populate_wrapper('3057'); return false;\" title=\"Blahp needs improved escaping of job arguments\">#3057</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3067\" onclick=\"get_ticket_and_populate_wrapper('3067'); return false;\" title=\"SGE BLAHP bug fix\">#3067</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3157\" onclick=\"get_ticket_and_populate_wrapper('3157'); return false;\" title=\"Blahp fails to handle some pbs job statuses\">#3157</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3181\" onclick=\"get_ticket_and_populate_wrapper('3181'); return false;\" title=\"Fix SGE job monitoring in the blahp\">#3181</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-03 18:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32593\">[32593]</a></span>: Blahp treats pbs qdel failures as success in some cases. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3016\" onclick=\"get_ticket_and_populate_wrapper('3016'); return false;\" title=\"blahp canceling of completed job causes a failure\">#3016</a></span> PBS's qdel will return failure if the desired job isn't in the queue or is in the queue in complete status. These failures should be treated as a success.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Aug-07 14:34", "status": "resolved", "created": "2012-May-29 19:22", "fixed_version": "2012-May-29 19:22", "broken_version": "", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "#1376", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "bbockelm@cse.unl.edu", "due_date": ""}