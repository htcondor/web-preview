{"id": 4703, "title": "Ticket #4703: Invalid COLLECTOR_HOST should cause condor_master ASSERT(0)", "description": "<blockquote>\nIf COLLECTOR_HOST is invalid, say because\n<div class=\"code\">\n<pre class=\"code\">CONDOR_HOST=\nCOLLECTOR_HOST=$(CONDOR_HOST):0\n</pre></div>\n\nthe central manager's condor_master will complain\n<div class=\"code\">\n<pre class=\"code\">11/05/14 17:05:06 Warning: Configuration file sets 'COLLECTOR_HOST=:0'.  This does not look like a valid host name with optional port.\n11/05/14 17:05:06 Invalid address: :0\n...\n11/05/14 17:05:06 Collector port not defined, will use default: 9618\n</pre></div>\n\nand merrily launch the condor_collector on 9618. This can cause a lot of grief.  Things seem like they're working, but aren't really.  Tests might pass until two tests happen to run simultaneously and collide on 9618 when they're supposed to be using a dynamic port.  This case is, sadly, not hypothetical.\n\n<p>Proposed: If a node is the central manager (DAEMON_LIST includes condor_collector) and COLLECTOR_HOST is invalid, then things are Seriously Messed Up and drastic measures should be taken.  Either the condor_master should just ASSERT(0), or it the condor_master should disable the collector.\n\n</p><p>The error is detected in getCmHostFromConfig in <a class=\"file\" href=\"rlog?f=src/condor_daemon_client/daemon.cpp\">/src/condor_daemon_client/daemon.cpp</a> around line 2256, but it's not obvious that that is where it should be fixed.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "enhance", "last_change": "2014-Nov-05 17:10", "status": "new", "created": "2014-Nov-05 17:10", "fixed_version": "2014-Nov-05 17:10", "broken_version": "v080200", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}