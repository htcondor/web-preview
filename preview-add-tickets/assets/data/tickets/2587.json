{"id": 2587, "title": "Ticket #2587: Make vbscript in MSI easier to work with and less brittle", "description": "<blockquote>\nThe vbscript used to modify the configuration file in the MSI installer is extremely brittle, mainly due to how it is trying to find where to change configuration values.  Also, because it is embedded inside of the WiX xsl file, developing it directly in the xsl file results in the loss of tooling support from an IDE.\n\n<p>Goals:\n\n</p><p></p><ul>\n<li>Separate main body of the vbscript as a separate file that is loaded by the installer at runtime.\n</li><li>Use vbscript regular expressions instead of the current pattern matching.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Oct-26 16:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=28000\">[28000]</a></span>: Use regular expressions to find lines in config file to replace in the MSI installer script. Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2587\" onclick=\"get_ticket_and_populate_wrapper('2587'); return false;\" title=\"Make vbscript in MSI easier to work with and less brittle\">#2587</a></span>.  (By Ziliang Guo )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Oct-26 11:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27994\">[27994]</a></span>: Add separated configuration vbscript for use by installer. Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2587\" onclick=\"get_ticket_and_populate_wrapper('2587'); return false;\" title=\"Make vbscript in MSI easier to work with and less brittle\">#2587</a></span>.  (By Ziliang Guo )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Oct-25 11:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27976\">[27976]</a></span>: Change dprintf_config in contrib code to match new convention. Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2477\" onclick=\"get_ticket_and_populate_wrapper('2477'); return false;\" title=\"Break hard circular dependency between dprintf and config\">#2477</a></span>.  (By Ziliang Guo )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Oct-26 16:45", "status": "resolved", "created": "2011-Oct-26 11:11", "fixed_version": "2011-Oct-26 11:11", "broken_version": "v070700", "priority": "3", "subsystem": "Win32", "assigned_to": "ziliang", "derived_from": "", "creator": "ziliang", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}