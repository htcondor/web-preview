{"id": 1156, "title": "Ticket #1156: -constraint inconsistent between tools", "description": "<blockquote>\nThe various client tools should handle \"-constraint\" (and implied constraints, like a username) consistently.\n\n<p></p><ul>\n<li>Multiple -constraints\n<ul>\n<li>condor_status will take multiple -constraints and require that a classad pass all of them.\n</li><li>condor_qedit will handle the first -constraint and erroneously interpret the rest as attribute names. (Surprised a user <a class=\"external\" href=\"https://lists.cs.wisc.edu/archive/condor-users/2010-January/msg00240.shtml\">documented here</a>)\n</li></ul>\n</li><li>-constraint and a username\n<ul>\n<li>condor_q jdoe -constraint JobStatus==1 will show all jobs that are idle <em>and</em> owned by jdoe\n</li><li>condor_rm jdoe -constraint JobStatus==1 is an error. (Used to remove all jobs that are idle jobs <em>or</em> owned by jdoe, changed in <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=485\" title=\"condor_rm/q argument inconsistency\">#485</a></span>)\n</li></ul>\n</li></ul>\n\n<p>These cases should all work identically.\n\n</p><p>See also: <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=485\" title=\"condor_rm/q argument inconsistency\">#485</a></span></p></blockquote>", "remarks": "<blockquote>\n<em>2012-Jul-23 14:35:58 by santos-g:</em> <br/>\n\nChanged condor_qedit and condor_rm so that they can behave like condor_q does.\n\n<p>Now, all of them handle multiple constraints properly, and can have username/cluster specified along with constraints at the same time. The only difference between condor_qedit/condor_rm and condor_q is that the latter accepts job_ids and constraints at the same time, whereas the first ones will simply ignore the constraints (and warn the user that it did so).\n</p><hr/>\n<hr/>\n<em>2013-May-29 13:51:56 by tannenba:</em> <br/>\n\nThis work, along w/ commits to the child ticket(s), are living on branch origin/V7_9-multiple_constraint-branch.  These commits should be code reviewed and merged to master.  Looks like code is in pretty good shape, but branch was never merged because the new regression tests written to test the new changes failed in NMI (even though supposedly the regression worked when run locally!).  Likely just some small issue with how the tests were added into cmake or some such.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1319\" title=\"Bad -constraint to condor_status returns unhelpful error\">#1319</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nBad -constraint to condor_status returns unhelpful error</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jul-24 10:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36980\">[36980]</a></span>: minor edit of version history item ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jul-09 09:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36808\">[36808]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jun-05 13:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35995\">[35995]</a></span>: Multiple constraints handled well by various tools. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span> condor_q, condor_qedit, condor_rm now handle multiple -constraint options They all can accept username or cluster and -constraints at the same time. Conflicts: src/condor_rm.V6/rm.cpp src/condor_tools/qedit.cpp Committer: John (TJ) Knoeller  (By Guilherme Baptista )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-28 16:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33552\">[33552]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>) Commented out references to new tests at CMakeLists.txt Did so because even though they work locally just fine, I couldn't make them work in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=BatLab\" title=\"Bat Lab\">BatLab</a></span>. They all fail there. Will have them not run until it is fixed.  (By Guilherme Baptista )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-26 12:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33502\">[33502]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>) condor_rm output fix. This tool was outputing \"condor_rm: \" without nothing else in the case where no job owned by given username and matching given constraints existed. To be consistent with the case where no jobs exist for a given username, now it simply doesn't output anything in that case.\u00a0[...]\n (By Guilherme Baptista )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-07 18:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32998\">[32998]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>) Experimenting with Test framework Tests supposedly run on NMI after I added their entries. None of them passed, though. Yet, locally, they succeed. Comparing my tests with previous ones I notice there are some steps that I didn't add on.\u00a0[...]\n (By Guilherme Baptista )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-07 16:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32997\">[32997]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>) Adding entries for new tests in CMakeLists file It is a necessary step so that these tests are run at NMI. Entries for each new test were added.  (By Guilherme Baptista )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-31 17:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32931\">[32931]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>) Adding Perl tests for Condor Tools use -constraint Specifically the tools addressed by ticket (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>): condor_q, condor_qedit and condor_rm (condor_status does not have the referred inconsistency problems)\u00a0[...]\n (By Guilherme Baptista )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-20 15:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32878\">[32878]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>) Fixing bug in condor_qedit and minor issues condor_qedit was segfaulting if no attributes were actually specified - it was trying to access a value in the arguments using an index which was out of bounds, no matter what. Now it simply returns a usage message. \u00a0[...]\n (By Guilherme Baptista )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jul-09 10:06", "status": "resolved", "created": "2010-Jan-28 17:20", "fixed_version": "2010-Jan-28 17:20", "broken_version": "v070000", "priority": "3", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": "20130630"}