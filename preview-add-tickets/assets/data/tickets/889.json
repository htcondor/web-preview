{"id": 889, "title": "Ticket #889: Split up the WriteUserLog class", "description": "<blockquote>\n<span class=\"section\"><h2>Synopsis </h2></span>\nCurrently, the <span class=\"quote\">WriteUserLog</span> class has several issues:\n\n<p></p><ol>\n<li>There's a lot of duplicate logic to accommodate the addition of the event log\n</li><li>For the schedd, which likely has a lot of <span class=\"quote\">WriteUserLog</span> objects, there are man open file handles to the event log file.\n</li><li>This intertwining of these functions has increased the complexity of the code, making it increasingly more difficult to maintain.\n</li></ol>\n\n<p><span class=\"section\"></span></p><h2>Fixes </h2>\nTo fix this, I propose:\n<ol>\n<li>Split up <span class=\"quote\">WriteUserLog</span> into a base class, and two thin derived classes\n<ol>\n<li><span class=\"quote\">WriteUserLogBase</span> would be the class with logic shared between the \"normal\" user log and event log\n</li><li><span class=\"quote\">WriteUserLog</span> would be very small, containing only logic specific to the user log.\n<ul>\n<li>Included in this would be a static pointer to a singleton <span class=\"quote\">WriteEventLog</span> object\n</li></ul>\n</li><li><span class=\"quote\">WriteEventLog</span> would contain all of the event log specific logic'\n<ul>\n<li>As noted above, there would be only a single instance of this object, with pointers to it shared by all of the <span class=\"quote\">WriteUserLog</span> objects\n</li></ul>\n</li><li>The pointer to the <span class=\"quote\">WriteEventLog</span> singleton would be available to the application through a static accessor method in the <span class=\"quote\">WriteUserLog</span> class\n</li></ol>\n</li><li>The schedd would thus be able to directly interact with the <span class=\"quote\">WriteEventLog</span> object\n<ol>\n<li>In particular, it would disable reconfigure events from being propagated through the <span class=\"quote\">WriteUserLog</span> objects to the <span class=\"quote\">WriteEventLog</span> object, and would instead directly reconfigure the <span class=\"quote\">WriteEventLog</span> object.</li></ol>\n</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2020-May-26 20:05:17 by jfrey:</em> <br/>\n\nSubsequent changes to the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=WriteUserLog\" title=\"Write User Log\">WriteUserLog</a></span> code make this ticket obsolete.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "enhance", "last_change": "2020-May-26 20:05", "status": "abandoned", "created": "2009-Oct-29 10:38", "fixed_version": "2009-Oct-29 10:38", "broken_version": "", "priority": "4", "subsystem": "Libs", "assigned_to": "nleroy", "derived_from": "", "creator": "nleroy", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}