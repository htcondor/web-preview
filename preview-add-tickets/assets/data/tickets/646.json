{"id": 646, "title": "Ticket #646: Not all daemons register with collector", "description": "<blockquote>\nNot all daemons register with the collector, meaning it's not possible to use condor_* tools with them.  Job_Router and HAD are two of these daemons, but there are likely more.</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/71/register_missing_ads.patch\">register_missing_ads.patch</a>\n24831 bytes added by rrati on 2009-Aug-10 21:11:54 UTC.\n<br/>\nRegisters the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobRouter\" title=\"Job Router\">JobRouter</a></span> and Replication daemons with the collector using generic Ads, fixes the condor tools to work with the HAD subsystem, HAD and Negotiator daemons invalidate their ads with the collector upon shutdown<br/>\n</li><li><a href=\"attach_get/75/register_missing_daemons.patch\">register_missing_daemons.patch</a>\n24692 bytes added by rrati on 2009-Aug-13 20:00:35 UTC.\n<br/>\nChanges after review.  Namely, changed Inserts to Assigns or <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AssignExprs\" title=\"Assign Exprs\">AssignExprs</a></span>.<br/>\n</li></ul>\n</blockquote>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 16:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15334\">[15334]</a></span>: Fixed merge issue in daemon.cpp with generic ad changes (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=646\" onclick=\"get_ticket_and_populate_wrapper('646'); return false;\" title=\"Not all daemons register with collector\">#646</a></span>)  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 15:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15330\">[15330]</a></span>: Changed Inserts to Assigns or <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AssignExprs\" title=\"Assign Exprs\">AssignExprs</a></span> when sending ads to the collector for the Replicator, HAD, and Job Router (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=646\" onclick=\"get_ticket_and_populate_wrapper('646'); return false;\" title=\"Not all daemons register with collector\">#646</a></span>) (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 15:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15329\">[15329]</a></span>: Fix the negotiator so it will invalidate its daemon ad with the collector upon a fast shutdown (like when the HAD terminates it) (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=646\" onclick=\"get_ticket_and_populate_wrapper('646'); return false;\" title=\"Not all daemons register with collector\">#646</a></span>)  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 15:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15328\">[15328]</a></span>: Fixed HAD deregistration when the daemon is stopped. Previous code was causing the HAD daemon to except upon startup (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=646\" onclick=\"get_ticket_and_populate_wrapper('646'); return false;\" title=\"Not all daemons register with collector\">#646</a></span>).  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15327\">[15327]</a></span>: The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobRouter\" title=\"Job Router\">JobRouter</a></span> and Replication daemons properly invalidate their ads with the collector (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=646\" onclick=\"get_ticket_and_populate_wrapper('646'); return false;\" title=\"Not all daemons register with collector\">#646</a></span>)  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15326\">[15326]</a></span>: The replication and Job Router daemons now use a name specific to themselves when registering with the collector (ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=646\" onclick=\"get_ticket_and_populate_wrapper('646'); return false;\" title=\"Not all daemons register with collector\">#646</a></span>)  (By Robert Rati )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Aug-13 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15325\">[15325]</a></span>: - Removed <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DaemonCore\" title=\"Daemon Core\">DaemonCore</a></span> registration from the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobLogMirror\" title=\"Job Log Mirror\">JobLogMirror</a></span>. Daemons that use the service should be registering themselves instead - The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobRouter\" title=\"Job Router\">JobRouter</a></span> now registers with the Collector using Generic Ads - The the condor tools wouldn't work correctly with the HAD daemon. It is now possible to act upon the HAD\u00a0[...]\n (By Robert Rati )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2009-Dec-26 20:14", "status": "resolved", "created": "2009-Jul-30 14:44", "fixed_version": "2009-Jul-30 14:44", "broken_version": "v070202", "priority": "2", "subsystem": "Daemons", "assigned_to": "rrati", "derived_from": "", "creator": "rrati", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}