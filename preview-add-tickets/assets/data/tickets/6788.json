{"id": 6788, "title": "Ticket #6788: Add process family security session", "description": "<blockquote>\nThere should be a pre-made security session shared between all daemons in a process tree (e.g. amongst a master and all of its descendants). It would work like the existing session between parent and child daemons, but apply to all daemons in the same family. A daemon whose real uid is different its parent's would not inherit this family session.\n\n<p>When a daemon attempts to connect to another daemon, it first checks whether it has a security session specific to that peer. If it does, then it uses that session, as it does today. Otherwise, it would attempt to use the family security session if both are using the same shared port daemon or, if shared port is disabled, if both are on the same machine. If the family session is rejected, the daemon would fall back to negotiating a new security session.\n\n</p><p>This would simplify making Condor secure out of the box. No security settings would needed to be set for a single-node Condor setup to be secure, without interfering with admins configuring the security settings themselves.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-08 13:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56155\">[56155]</a></span>: Docs for SEC_USE_FAMILY_SESSION. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-07 15:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55867\">[55867]</a></span>: Fix compiler warning. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-07 09:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55865\">[55865]</a></span>: Consider shared port when detecting if a peer is in our family. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span> When deciding whether to use the family security session, if shared port is enabled, don't use family session if peer has a different command port (and hence isn't using the same shared port server as us).  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-07 09:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55864\">[55864]</a></span>: The c-gahp and dagman should not create a family session. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-07 09:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55863\">[55863]</a></span>: Improve logging when family security session is rejected. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-20 11:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55862\">[55862]</a></span>: Revert \"Revert \"Punch hole for CLIENT permission for parent/child and family sessions <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>\"\" This reverts commit 3e9f97b1c77bcf4f3f36addb3a47b0aa79ab683b.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-20 11:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55861\">[55861]</a></span>: Revert \"Revert \"Change extra info in invalidate message to a classad. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>\"\" This reverts commit afa2ff70a955af5ff7de2408a6fb832bed2f185d.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-20 11:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55860\">[55860]</a></span>: Revert \"Revert \"Add automatic security session for a family of daemons. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>\"\" This reverts commit 85a65b9e31baeddfe1498bd4a219804bc245f610.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-15 16:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55743\">[55743]</a></span>: Revert \"Add automatic security session for a family of daemons. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>\" Moving this code to 8.9.0. This reverts commit b73f18b492bc2dc9d17ca009b6d38b9b19247081.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-15 16:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55742\">[55742]</a></span>: Revert \"Change extra info in invalidate message to a classad. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>\" Moving this code to 8.9.0. This reverts commit 264dc64b104de53ce55b640a117684d89b5c9097.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-15 16:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55741\">[55741]</a></span>: Revert \"Punch hole for CLIENT permission for parent/child and family sessions <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span>\" Moving this code to 8.9.0. This reverts commit 8bf9e2312d13c945e0890f2224f49c616160d5c4.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-14 14:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55733\">[55733]</a></span>: Punch hole for CLIENT permission for parent/child and family sessions <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span> If the admin sets the CLIENT permission list to something other than *, these daemon-family sessions need to continue to work.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-13 08:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55716\">[55716]</a></span>: Change extra info in invalidate message to a classad. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span> This simplifies adding more information in the future in a backwards compatible manner.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-06 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55687\">[55687]</a></span>: Add automatic security session for a family of daemons. <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=6788\" onclick=\"get_ticket_and_populate_wrapper('6788'); return false;\" title=\"Add process family security session\">#6788</a></span> This security session works like the existing parent-child security session, but is a single session shared by an entire process tree of daemons. Each daemon passes the session to its children (if creating a command port for them and their\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Feb-18 13:56", "status": "review", "created": "2018-Oct-02 15:23", "fixed_version": "2018-Oct-02 15:23", "broken_version": "", "priority": "3", "subsystem": "Security", "assigned_to": "zmiller", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}