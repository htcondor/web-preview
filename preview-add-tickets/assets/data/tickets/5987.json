{"id": 5987, "title": "Ticket #5987: Have option to run DAGMan in local universe?", "description": "<blockquote>\nWe're interested in the option of running condor_dagman under the local universe instead of scheduler universe, so it can have Kerberos credentials (the starter sets that up).\n\n<p>I just tried this manually on a simple DAG (just hand-editing the .condor.sub file), and it worked.  However, I'm pretty sure there's going to be some stuff that doesn't work right (like condor_hold'ing the DAG).\n\n</p><p>I have a build/test going to see what all fails.\n\n</p><p>Assuming we go ahead with this, one question is whether to specify the universe on the command line, with a config knob, or both...</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Nov-01 16:39:56 by wenger:</em> <br/>\n\nThe following tests seem to fail pretty consistently with DAGMan running under local universe:\n\n<p></p><pre>  cmd_q_shows_dag\n  cmd_status_compact\n  job_dagman_acct_grp\n  job_dagman_batch_name\n  job_dagman_condor_restart\n  job_dagman_default_log\n  job_dagman_jobstate_log\n  job_dagman_large_dag\n  job_dagman_submit_glob-B\n  job_dagman_node_status_rm\n  job_dagman_noop_node\n  job_dagman_recovery_event_check\n  job_dagman_recovery_preskip\n  job_dagman_rescue_recov\n  job_dagman_retry_recovery\n  job_dagman_rm\n  job_dagman_script_defer\n  job_dagman_set_attr\n  job_negotiator_restart (not sure how this is related)\n</pre>\n\n<p></p><hr/>\n<em>2016-Nov-01 17:12:57 by wenger:</em> <br/>\n\nOkay, one thing that's not working (which I think is the problem with a lot of the failing tests) is condor_hold'ing a condor_dagman job -- when condor_dagman is running under local universe, a condor_hold sends SIGUSR1 instead of SIGTERM.\n\n<p>Also, condor_q doesn't properly display DAGs.\n\n</p><p></p><hr/>\n<em>2016-Nov-02 09:23:42 by wenger:</em> <br/>\n\nCreated V8_5-gittrac_5987-branch for this.\n\n<p></p><hr/>\n<em>2016-Nov-02 11:49:59 by wenger:</em> <br/>\n\nToddT says he doesn't actually want this implemented right now -- so I'm just committing code changes to do the basic testing and then I'm going to leave it alone...</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-02 12:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=49518\">[49518]</a></span>: Gittrac <span class=\"ticket\"><a class=\"defer\" href=\"tktview?tn=5987\" title=\"Have option to run DAGMan in local universe?\">#5987</a></span>: Added DAGMAN_RUN_AS_LOCAL_UNIV config knob.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-02 09:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=49513\">[49513]</a></span>: Gittrac <span class=\"ticket\"><a class=\"defer\" href=\"tktview?tn=5987\" title=\"Have option to run DAGMan in local universe?\">#5987</a></span>: Created test version of condor_submit_dag that runs DAGMan under local universe instead of scheduler (basic DAGs work, but condor_hold of DAGMan doesn't work, and condor_q doesn't display DAGs correctly).  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Nov-06 21:34", "status": "defer", "created": "2016-Nov-01 15:51", "fixed_version": "2016-Nov-01 15:51", "broken_version": "v080508", "priority": "4", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "", "creator": "wenger", "rust": "", "customer_group": "cern", "visibility": "public", "notify": "wenger@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}