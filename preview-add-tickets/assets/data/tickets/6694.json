{"id": 6694, "title": "Ticket #6694: Extend condor_reassign_slot to accept multiple victims", "description": "<blockquote>\nWe should be able, when specifying a victim job, to instead specify multiple victim jobs (at the same startd) whose resources will be coalesced to run the beneficiary job.\n\n<p>To quote <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6659\" onclick=\"get_ticket_and_populate_wrapper('6659'); return false;\" title=\"High Priority Jobs\">#6659</a></span>:\n\n</p><p><em>There is a startd command to vacate a set of claims and return a new claim ID which corresponds to the coalescensce we can use as the basis. (Would we (need to) construct a new match record? Where in the schedd would we hang the knowledge about which job should run on the new match while the command was in nonblocking flight?)  We may need to modify the startd to accept claims rather than preempting claims.</em>\n\n</p><p></p><hr/>\nA brief of analysis of the startd reveals this command to be REQUEST_CLAIM.  It does not appear to instrinsically require preempting claims to function, but it is currently coded to assume that those are the only ones it receives.\n\n<p>After a brief discussion with ToddT, it seems plausible to move forward on the basis that whoever has the appropriate capability (knows the claim ID) should control how they're used, including whether or not to honor max retirement time.  The code change for this policy change should be as simple as identifying if the extra claim IDs are for active claims (in which case the command is being issued  on behalf of <strong>condor_reassign_slots</strong>); if they are, then don't require that their retirement time has expired, and also invalidate the preempting (and preempting preempting) claims, since the corresponding slot will shortly cease to exist.\n\n</p><p></p><hr/>\nAfter a discussion with Jaime, our conclusions were:\n\n<p>(a) our conclusions should be checked with TJ and GregT;\n\n</p><p>(b) coalescing existing claims should be its own (new) startd command.\n\n</p><p>I suggested (b) out of a concern that it would be too easy to accidentally alter the existing semantics of the REQUEST_CLAIM code when modifying it for this use case.  Jaime concurred and immediately added that separating preparing the slots to coalesce from actually coalescing them would avoid a problem in the existing implementation of REQUEST_CLAIM, where resources are reassigned from the slots being coalesced before they've been deactivated.\n\n</p><p>This implies that the schedd would deactivate each of the victim claims, and then send the coalesce command.  This approach has the additional benefit that it's a straight extension of the existing one-for-one reassignment code.  Since the schedd already waits asynchronously for deactivation, this removes complexity from the startd without much increasing it in the schedd.  (The schedd would have to check, on each deactivation notice (shadow exit), if this deactivation completed a set, rather than if it were the single victim.  This should not be difficult.)  The startd would refuse to coalesce slots that weren't claimed/idle; each dslot in the set would also have to be a child of the same pslot (because we currently don't have a mechanism to reassign resources between pslots).\n\n</p><p>The schedd could delay picking which match record was re-used by setting the 'next job' attribute on each match record in the set but ignoring it until the deactivation at hand completed the set.\n\n</p><p>It's not clear if the startd's new COALESCE command would return a new claim ID or not.  It would reduce potential confusion about stale claims if the startd invalidated all coalesced claims, which implies issuing a new claim ID for the coalesced claim.\n\n</p><p>Additionally, this approach would allow for commonality with the potential use-case where the schedd wants to make an existing pslot claim larger: it would request the pslot claim and then deactivate the other claims and coalesce them; doing so in that order should minimize the number of times a claim is deactivated unnecessarily.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Jul-19 16:35:25 by tlmiller:</em> <br/>\n\nNotes with respect to <span class=\"chng\"><a href=\"chngview?cn=55192\">[55192]</a></span>:\n\n<p></p><ul>\n<li><strong>send_matchless_vacate()</strong> needs to be tested\n</li><li>calling <strong>condor_now()</strong> a second time if the schedd failed to start the job crashes it.  Probably just need to update <strong>Scheduler::startJob()</strong> to return a failure (and check it appropriately).  (From when the match record wasn't in the right state.  Not sure what other kinds of failures there might be.)\n</li><li>We may want to special-case a COALESCE command of just one slot: all the startd really needs to do (after validation) is invalidated the current claim ID and return the new one (and the slot ad, as usual).\n</li><li>We need to handle (ignore) duplicate claim IDs in the startd.\n</li><li>The schedd needs to stop retrying the coalesce command at some point.\n</li></ul>\n\n<p></p><hr/>\n<em>2018-Aug-14 12:52:14 by tlmiller:</em> <br/>\n\n<ul>\n<li>Consider special-casing one-slot COALESCE command.  (Just invalidate the old claim ID and return the new one.)\n</li><li>Implement pccc regression tests.\n</li><li>Implement functional regression test(s).\n</li></ul>\n\n<p></p><hr/>\n<em>2018-Sep-21 11:54:04 by tlmiller:</em> <br/>\n\nTODOs as of <span class=\"chng\"><a href=\"chngview?cn=55442\">[55442]</a></span>:\n<ul>\n<li>pccc regression test\n</li><li>functional regression test\n</li></ul>\n\n<p></p><hr/>\n<em>2018-Oct-12 13:24:46 by tlmiller:</em> <br/>\n\nTODOs as of <span class=\"chng\"><a href=\"chngview?cn=55524\">[55524]</a></span>:\n<ul>\n<li>functional regression test\n</li></ul>\n\n<p></p><hr/>\n<em>2018-Oct-16 14:19:55 by tlmiller:</em> <br/>\n\nThe <span class=\"chng\"><a href=\"chngview?cn=55563\">[55563]</a></span> tests passed.  Still thinking about the best way to test failure.\n\n<p></p><hr/>\n<em>2018-Oct-31 18:05:34 by tlmiller:</em> <br/>\n\nThat should do it...\n\n<p></p><hr/>\n<em>2019-Feb-26 14:47:54 by tim:</em> <br/>\n\nThis needs some documentation</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=6777\" onclick=\"get_ticket_and_populate_wrapper('6777'); return false;\" title=\"Special-case single-slot COALESCE\">#6777</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nSpecial-case single-slot COALESCE</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7210\" onclick=\"get_ticket_and_populate_wrapper('7210'); return false;\" title=\"Query of match ads can crash schedd\">#7210</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nQuery of match ads can crash schedd</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-26 15:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56250\">[56250]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Release note, update man page.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Dec-07 15:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55868\">[55868]</a></span>: Fix CEDAR calls in startd for coalesce_slots command. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span> Also fix variable name refering to job ad.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-13 18:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55730\">[55730]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix bug in WaitUntilAllExecute() [pytest].  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-13 18:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55729\">[55729]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Don't try to stop personal condors at shutdown that we've already stopped.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Nov-13 18:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55728\">[55728]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix bug in PersonalCondor.Stop().  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-31 18:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55680\">[55680]</a></span>: Squashed commit of the following: commit 9e9738f0e0f30c555e6e892840812c409e743ee8 Merge: b729505 227846c Author: Todd L Miller &lt;tlmiller@cs.wisc.edu&gt; Date: Wed Oct 31 17:25:59 2018 -0500\u00a0[...]\n (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-31 14:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55678\">[55678]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Remove a race condition from failure subtests 1, 2, 4, and 5.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-31 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55677\">[55677]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Remove race condition in subtest failure-3 of the cmd_now tests.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 15:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55625\">[55625]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Test five failure modes for condor_now with failure injection in the startd.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 15:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55624\">[55624]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Don't try to stop personal condors at shutdown that we've already stopped.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 15:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55623\">[55623]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix bug in PersonalCondor.Stop().  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 15:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55622\">[55622]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix crashing bug discovered in testing, change a failure case from D_FULLDEBUG to D_ALWAYS (and improve message).  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-24 15:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55621\">[55621]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Remove stray dprintf()s.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-23 15:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55620\">[55620]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Missed a dprinf() that should have been D_ALWAYS.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-22 12:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55611\">[55611]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Have the schedd send match ads when (directly) queried for startd ads. Write information relevant to condor_now testing to D_TEST when it does. Switch some PCCC messages to D_ALWAYS (and reformat) to assist administrators in debugging condor_now failures.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-12 16:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55563\">[55563]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Add the expected-success tests for condor_now.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-02 18:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55524\">[55524]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Add pccc testing functions to schedd and use it from cmd_now_internals.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-02 18:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55523\">[55523]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix bug in WaitUntilAllExecute() [pytest].  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-01 13:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55522\">[55522]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Reorder pccc.cpp for clarity.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Oct-01 11:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55521\">[55521]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Move PCCC stuff to its own file to help with regression testing.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-26 10:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55468\">[55468]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Remove stray debugging statement.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-24 16:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55458\">[55458]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix build errors.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-24 15:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55456\">[55456]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Activate cmd_now_internals test.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-20 16:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55451\">[55451]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Add --flags to condor_now to drive new (optional) flags attribute in the REASSIGN_SLOT command. This field is currently only used to force a call to send_matchless_vacate(). Add the corresponding regression test.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-19 15:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55442\">[55442]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Fix capitalization in error messages. Also make wire protocol marginally more efficient.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Sep-19 14:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55439\">[55439]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) The startd now ignores duplicate claim IDs when coalescing slots.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Aug-07 12:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55262\">[55262]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-24 14:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55210\">[55210]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. Not sure why startJob() is void.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-24 14:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55209\">[55209]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. Now only twenty retries (twenty seconds).  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-19 16:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55192\">[55192]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. Protocol now pretends to work. FIXMEs remain.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-06 14:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55145\">[55145]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. More progress towards a full protocol.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-05 16:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55142\">[55142]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. Progress towards a full protocol.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-05 15:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55137\">[55137]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. Handling COALESCE time-outs better.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-05 14:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55136\">[55136]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jun-28 16:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55135\">[55135]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit. Not sure why having multiple invalid IDs in the map didn't cause problems, but it seems better just to unlink the match records and delete them by hand later.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jun-25 15:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55134\">[55134]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit: rename m_next_job to m_now_job. Maintain invariant about match records.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jun-22 18:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55133\">[55133]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Finished step 3, including all the book-keeping &amp; clean-up, except untested successful coalesce-command case. Just blew an unchanged ASSERT, however...  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jun-22 13:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55132\">[55132]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jun-21 13:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55131\">[55131]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>) Tracking commit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jun-13 11:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55047\">[55047]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6659\" onclick=\"get_ticket_and_populate_wrapper('6659'); return false;\" title=\"High Priority Jobs\">#6659</a></span>) Rename to condor_now for release. Reorder arguments because of the obviously proper extension for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6694\" onclick=\"get_ticket_and_populate_wrapper('6694'); return false;\" title=\"Extend condor_reassign_slot to accept multiple victims\">#6694</a></span>.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Feb-26 17:05", "status": "resolved", "created": "2018-Jun-04 15:13", "fixed_version": "2018-Jun-04 15:13", "broken_version": "v080709", "priority": "3", "subsystem": "DaemonsExecNode", "assigned_to": "tlmiller", "derived_from": "#6659", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu, jfrey@cs.wisc.edu", "due_date": ""}