{"id": 5067, "title": "Ticket #5067: Failure to get remote address", "description": "<blockquote>\nA user of ours was experiencing an issue with 'condor_ce_q' (with OSG's Condor 8.2.8 compiled without the NO_PHONE_HOME flag). His <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SchedLog\" title=\"Sched Log\">SchedLog</a></span> has quite a few of the following errors:\n\n<p></p><div class=\"verbatim\">\n<pre>05/25/15 19:53:21 entering FileTransfer::SimpleInit\n05/25/15 19:53:22 -------- Begin starting jobs --------\n05/25/15 19:53:22 -------- Done starting jobs --------\n05/25/15 19:53:22 condor_write(): Socket closed when trying to write 13 bytes to , fd is 20\n05/25/15 19:53:22 Buf::write(): condor_write() failed\n05/25/15 19:53:22 SharedPortEndpoint: failed to send final status (success) for SHARED_PORT_PASS_SOCK\n05/25/15 19:53:22 PERMISSION DENIED to treydock@users.opensciencegrid.org from host 0 INVALID ADDRESS FAMILY\nfor command 1112 (QMGMT_WRITE_CMD), access level WRITE: reason: WRITE authorization policy contains no matching\nALLOW entry for this request; identifiers used for this host: , hostname size = 0, original ip address = 0\nINVALID ADDRESS FAMILY\n05/25/15 19:53:22 Clearing userlog file cache\n</pre></div>\n\n\n<p>And I'm not sure if it's related but there seem to be some other issues with the file transfer:\n\n</p><p></p><div class=\"verbatim\">\n<pre>05/25/15 19:27:20 ReliSock::get_file_with_permissions(): going to set permissions 644\n05/25/15 19:27:21 get_file(): going to write to filename /fdata/spool/3004/0/cluster23004.proc0.subproc0.tmp/nagrun.sh\n05/25/15 19:27:21 get_file: Receiving 13815 bytes\n05/25/15 19:27:21 get_file: wrote 13815 bytes to file\n05/25/15 19:27:21 rename(/fdata/spool/3003/0/cluster23003.proc0.subproc0.tmp/gridjob.tgz,\n/fdata/spool/3003/0/cluster23003.proc0.subproc0/gridjob.tgz) failed with errno 2\n05/25/15 19:27:21 ERROR \"FileTransfer CommitFiles Failed -- What Now?!?!\" at line 2564 in file\n/builddir/build/BUILD/condor-8.2.8/src/condor_utils/file_transfer.cpp\n05/25/15 19:27:21 ReliSock::get_file_with_permissions(): going to set permissions 755\n05/25/15 19:27:21 Initializing Directory: curr_dir = /fdata/spool/3004/0/cluster23004.proc0.subproc0.tmp\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2015-May-26 21:35:48 by bbockelm:</em> <br/>\n\nIs there anything interesting in the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SharedPortLog\" title=\"Shared Port Log\">SharedPortLog</a></span> corresponding to the schedd failures?\n\n<p>The second (ENOENT) indicates either (from <code>man 2 rename</code>):\n</p><ol>\n<li>The link named by oldpath does not exist\n</li><li>A directory component in newpath does not exist\n</li></ol>\n\n<p>Honestly, the two look unrelated.  I'd start with the first though.  Suggestions:\n</p><ol>\n<li>Are hostnames setup appropriately?  (Includes reverse DNS).\n</li><li>Did the user try setting <code>ENABLE_IPV6=true</code> in the configuration?\n</li><li>Are there multiple hostnames being juggled?  Does the external hostname differ from the output of the <code>hostname</code> command?\n</li></ol>\n\n<p></p><hr/>\n<em>2015-May-27 09:10:07 by blin:</em> <br/>\n\nOne thing to note is that when he downgrade to OSG's 8.2.8-2 package, he did not see these errors. It was only with 8.2.8-3, which was built without the NO_PHONE_HOME flag.\n\n<p></p><hr/>\n<em>2015-May-28 17:41:11 by blin:</em> <br/>\n\nFrom the GOC ticket (<a class=\"external\" href=\"https://ticket.opensciencegrid.org/25590\">https://ticket.opensciencegrid.org/25590</a>):\n\n<p></p><ol>\n<li>Reverse DNS looks fine\n</li><li>He has 'ENABLE_IPV6=false'\n</li><li>He does not have multiple hostnames\n</li></ol>\n\n<p></p><hr/>\n<em>2015-Jun-05 13:03:45 by blin:</em> <br/>\n\nAlain, have you had a chance to look at this since we last spoke?\n\n<p></p><hr/>\n<em>2015-Sep-28 14:54:56 by blin:</em> <br/>\n\nTrey says he hasn't seen this issue in a while so we can close this for the time being.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "incident", "last_change": "2015-Oct-07 15:28", "status": "resolved", "created": "2015-May-26 16:49", "fixed_version": "2015-May-26 16:49", "broken_version": "v080208", "priority": "2", "subsystem": "DaemonsCM", "assigned_to": "blin", "derived_from": "#4555", "creator": "blin", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "blin@cs.wisc.edu treydock@tamu.edu", "due_date": ""}