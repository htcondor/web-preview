{"id": 4561, "title": "Ticket #4561: Allow file transfer plugins to run with ruid root", "description": "<blockquote>\nNormally, file transfer plugins run as \"the user\", whether that's a slot user or the user itself.  If Condor has root priv, we could invoke the plugin with root priv as well, since that would allow it to do privileged things (access credentials).  The default is of course to not give root priv (i.e. to drop privs before invoking the plugin).  However, if the condor_config sets RUN_FILETRANSFER_PLUGINS_WITH_ROOT to true, we should not drop privs.</blockquote>", "remarks": "<blockquote>\n<em>2014-Aug-27 14:03:15 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>You should add an entry to the param table for the new parameter. Other than that, this change looks good.\n\n</p><p></p><hr/>\n<em>2014-Sep-11 11:31:16 by tannenba:</em> <br/>\n\nI assume that when RUN_FILETRANSFER_PLUGINS_WITH_ROOT is True, the euid of the plugin is still the slot user, and just the ruid is root?  If so, please clarify that in the ticket description above.\n\n<p>Also please address the code review comments (i.e. add to the param table).  Then the ticket can go to docpending state.  Thanks.\n\n</p><p></p><hr/>\n<em>2014-Sep-29 11:05:54 by tannenba:</em> <br/>\n\nMoved this ticket from Resolved back to <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DocPending\" title=\"Doc Pending\">DocPending</a></span>, as the documentation is not correct or complete.  I understand this is probably a result of the ticket description not being complete...  but the bar for resolving the ticket needs to be higher than the bar to create a ticket...\n\n<p>Documentation needs to explain that if this knob is true, then the plugin is run with a real uid of root and an effective uid equal to the uid used to launch the job.  If this knob is false (default), then this knob is run with both the real and effective uid equal to the uid used to launch the job.  Also should mention what, if anything, this knob does on Windows.  Also should mention what, if anything, this knob does to group permissions.\n\n</p><p>While the above information is required for anyone to understand <em>what</em> this knob does, it would also would be nice if the documentation provided one or two sentences about <em>why</em> anybody would ever care about this knob -- ie an example scenario of why/when could it be useful.\n\n</p><p></p><hr/>\n<em>2014-Oct-01 11:25:58 by tim:</em> <br/>\n\nWe need a documentation review.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-24 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41463\">[41463]</a></span>: correction on RUN_FILETRANSFER_PLUGINS_WITH_ROOT definition <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span> Committer: Todd L Miller  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-09 10:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41356\">[41356]</a></span>: correction on RUN_FILETRANSFER_PLUGINS_WITH_ROOT definition <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-30 15:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41286\">[41286]</a></span>: extra info for new knob RUN_FILETRANSFER_PLUGINS_WITH_ROOT <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-25 00:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41243\">[41243]</a></span>: Add param table entry for RUN_FILETRANSFER_PLUGINS_WITH_ROOT. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span>  (By Zach Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-23 12:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41222\">[41222]</a></span>: document new knob in 8.2.3 <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-10 11:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41134\">[41134]</a></span>: If desired, run file transfer plugins with ruid 0. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span>  (By Zach Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Aug-27 11:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41050\">[41050]</a></span>: If desired, run file transfer plugins with ruid 0. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4561\" onclick=\"get_ticket_and_populate_wrapper('4561'); return false;\" title=\"Allow file transfer plugins to run with ruid root\">#4561</a></span>  (By Zach Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Oct-31 15:45", "status": "resolved", "created": "2014-Aug-27 11:30", "fixed_version": "2014-Aug-27 11:30", "broken_version": "", "priority": "1", "subsystem": "FileTransfer", "assigned_to": "zmiller", "derived_from": "#4572", "creator": "zmiller", "rust": "", "customer_group": "iplant", "visibility": "public", "notify": "zmiller@cs.wisc.edu, tannenba@cs.wisc.edu, smoler@cs.wisc.edu, tim@cs.wisc.edu", "due_date": "20140826"}