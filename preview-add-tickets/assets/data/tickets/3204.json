{"id": 3204, "title": "Ticket #3204: segfault in condor_status -any -pool", "description": "<blockquote>\nCrash is not 100% reproducable, I've seen about 1 time in 10.  here's the backtrace, reformatted to be a bit more readable.\n\n<p></p><div class=\"verbatim\">\n<pre>warning: no loadable sections found in added symbol-file system-supplied DSO at 0x7fff22de3000\nCore was generated by `condor_status -any -pool glidein.chtc.wisc.edu'.\nProgram terminated with signal 11, Segmentation fault.\n#0  0x00002b1440a86a0b in void std::__unguarded_linear_insert&lt;\n\t__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;,\n\tcompat_classad::ClassAdListItem*,\n\tcompat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;\n    (   __gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;,\n\tcompat_classad::ClassAdListItem*,\n\tcompat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator\n    ) ()\n   from /usr/lib64/condor/libcondor_utils_7_9_0.so\n(gdb) backtrace\n#0  0x00002b1440a86a0b\n   in void std::__unguarded_linear_insert&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) ()\n   from /usr/lib64/condor/libcondor_utils_7_9_0.so\n#1  0x00002b1440a86e99\n   in void std::__final_insertion_sort&lt;\n\t__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;,\n\tcompat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;\n   (    __gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;,\n\t__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;,\n\tcompat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator\n   ) ()\n   from /usr/lib64/condor/libcondor_utils_7_9_0.so\n#2  0x00002b1440a861d2\n   in compat_classad::ClassAdListDoesNotDeleteAds::Sort(\n\tint (*)(compat_classad::ClassAd*, compat_classad::ClassAd*, void*),\n\tvoid*) ()\n   from /usr/lib64/condor/libcondor_utils_7_9_0.so\n#3  0x0000000000409ffe\n   in main ()\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2012-Aug-20 16:46:36 by johnkn:</em> <br/>\n\nthis was not released 7.9.0.  it was\n$CondorVersion: 7.9.0 Jul 10 2012 BuildID: 51900 $\n\n<p></p><hr/>\n<em>2012-Aug-20 16:49:29 by johnkn:</em> <br/>\n\nvalgrind --tool=memcheck condor_status -any -pool glidein.chtc.wisc.edu\n\n<p>produces:\n</p><div class=\"verbatim\">\n<pre>==8885== Memcheck, a memory error detector\n==8885== Copyright (C) 2002-2009, and GNU GPL'd, by Julian Seward et al.\n==8885== Using Valgrind-3.5.0 and LibVEX; rerun with -h for copyright info\n==8885== Command: condor_status -any -pool glidein.chtc.wisc.edu\n==8885==\n==8885== Invalid read of size 8\n==8885==    at 0x4E039FB: void std::__unguarded_linear_insert&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E03E98: void std::__final_insertion_sort&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, __gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E031D1: compat_classad::ClassAdListDoesNotDeleteAds::Sort(int (*)(compat_classad::ClassAd*, compat_classad::ClassAd*, void*), void*) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x409FFD: main (in /usr/bin/condor_status)\n==8885==  Address 0x5406ab8 is 8 bytes before a block of size 65,536 alloc'd\n==8885==    at 0x4A0695E: operator new(unsigned long) (vg_replace_malloc.c:220)\n==8885==    by 0x4E0393A: std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt;::_M_insert_aux(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem* const&amp;) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E0316B: compat_classad::ClassAdListDoesNotDeleteAds::Sort(int (*)(compat_classad::ClassAd*, compat_classad::ClassAd*, void*), void*) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x409FFD: main (in /usr/bin/condor_status)\n==8885==\n==8885== Invalid read of size 8\n==8885==    at 0x4E03A0B: void std::__unguarded_linear_insert&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E03E98: void std::__final_insertion_sort&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, __gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E031D1: compat_classad::ClassAdListDoesNotDeleteAds::Sort(int (*)(compat_classad::ClassAd*, compat_classad::ClassAd*, void*), void*) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x409FFD: main (in /usr/bin/condor_status)\n==8885==  Address 0x2e32303830313136 is not stack'd, malloc'd or (recently) free'd\n==8885==\n==8885==\n==8885== Process terminating with default action of signal 11 (SIGSEGV): dumping core\n==8885==  General Protection Fault\n==8885==    at 0x4E03A0B: void std::__unguarded_linear_insert&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListItem*, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E03E98: void std::__final_insertion_sort&lt;__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator&gt;(__gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, __gnu_cxx::__normal_iterator&lt;compat_classad::ClassAdListItem**, std::vector&lt;compat_classad::ClassAdListItem*, std::allocator&lt;compat_classad::ClassAdListItem*&gt; &gt; &gt;, compat_classad::ClassAdListDoesNotDeleteAds::ClassAdComparator) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x4E031D1: compat_classad::ClassAdListDoesNotDeleteAds::Sort(int (*)(compat_classad::ClassAd*, compat_classad::ClassAd*, void*), void*) (in /usr/lib64/condor/libcondor_utils_7_9_0.so)\n==8885==    by 0x409FFD: main (in /usr/bin/condor_status)\n==8885== Invalid free() / delete / delete[]\n==8885==    at 0x4A05D21: free (vg_replace_malloc.c:325)\n==8885==    by 0x319DF0A57A: ??? (in /lib64/libc-2.5.so)\n==8885==    by 0x319DF0A171: ??? (in /lib64/libc-2.5.so)\n==8885==    by 0x48024E8: _vgnU_freeres (vg_preloaded.c:62)\n==8885==    by 0x5406B3F: ???\n==8885==  Address 0x52567d8 is not stack'd, malloc'd or (recently) free'd\n==8885==\n==8885==\n==8885== HEAP SUMMARY:\n==8885==     in use at exit: 124,781,752 bytes in 3,132,957 blocks\n==8885==   total heap usage: 10,686,028 allocs, 7,553,072 frees, 544,395,480 bytes allocated\n==8885==\n==8885== LEAK SUMMARY:\n==8885==    definitely lost: 40 bytes in 1 blocks\n==8885==    indirectly lost: 0 bytes in 0 blocks\n==8885==      possibly lost: 15,505,380 bytes in 363,084 blocks\n==8885==    still reachable: 109,276,332 bytes in 2,769,872 blocks\n==8885==         suppressed: 0 bytes in 0 blocks\n==8885== Rerun with --leak-check=full to see details of leaked memory\n==8885==\n==8885== For counts of detected and suppressed errors, rerun with: -v\n==8885== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 4 from 4)\nSegmentation fault\n</pre></div>\n\n<hr/>\n<em>2012-Oct-22 14:59:59 by zmiller:</em> <br/>\n\nBulk change of target version from v070901 to v070902 using ./ticket-target-mover.\n<hr/>\n<em>2012-Dec-11 16:38:39 by johnkn:</em> <br/>\n\nBulk change of target version from v070902 to v070903 using ./ticket-target-mover.\n<hr/>\n<em>2013-Jan-22 10:54:51 by johnkn:</em> <br/>\n\nBulk change of target version from v070903 to v070904 using ./ticket-target-mover.\n<hr/>\n<em>2013-Mar-05 10:58:27 by johnkn:</em> <br/>\n\nBulk change of target version from v070904 to v070905 using ./ticket-target-mover.\n<hr/>\n<em>2013-Apr-22 11:10:10 by johnkn:</em> <br/>\n\nBulk change of target version from v070905 to v070906 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2013-Apr-22 11:11", "status": "new", "created": "2012-Aug-20 16:00", "fixed_version": "2012-Aug-20 16:00", "broken_version": "v070900", "priority": "3", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}