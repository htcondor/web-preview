{"id": 5466, "title": "Ticket #5466: Job policy reason strings contain extra junk", "description": "<blockquote>\nChanges done in 8.3 to make job policy evaluation more efficient introduced a bug where multiple unparsed expressions are concatenated together if a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=UserPolicy\" title=\"User Policy\">UserPolicy</a></span> object is used to do multiple evaluations.\n\n<p>For example, if two jobs have PeriodicRemove=True and the schedd is performing the policy evaluations, then the remove reason for one of them will be \"The job attribute <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=PeriodicRemove\" title=\"Periodic Remove\">PeriodicRemove</a></span> expression 'truetrue' evaluated to TRUE\".</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Jan-18 13:13:04 by johnkn:</em> <br/>\n\nCODE REVIEW: change looks good.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-29 11:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=47526\">[47526]</a></span>: Minor version history edits for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5492\" onclick=\"get_ticket_and_populate_wrapper('5492'); return false;\" title=\"collector crashes while sending updates\">#5492</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5488\" onclick=\"get_ticket_and_populate_wrapper('5488'); return false;\" title=\"master blows assert if old shared port ad in address file\">#5488</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5466\" onclick=\"get_ticket_and_populate_wrapper('5466'); return false;\" title=\"Job policy reason strings contain extra junk\">#5466</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-29 10:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=47524\">[47524]</a></span>: Docs for bug fix for job policy reason strings containing extra junk <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5466\" onclick=\"get_ticket_and_populate_wrapper('5466'); return false;\" title=\"Job policy reason strings contain extra junk\">#5466</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-06 15:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=47426\">[47426]</a></span>: Job policy reason strings contain extra junk. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5466\" onclick=\"get_ticket_and_populate_wrapper('5466'); return false;\" title=\"Job policy reason strings contain extra junk\">#5466</a></span> Clear m_fire_unparsed_expr each time we start a new policy evaluation. Otherwise, the unparsed expression strings will build up each time a policy fires and multiple epxressions will show up in the reason string jammed together.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Jan-29 10:53", "status": "resolved", "created": "2016-Jan-06 15:44", "fixed_version": "2016-Jan-06 15:44", "broken_version": "v080308", "priority": "3", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "#5204", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}