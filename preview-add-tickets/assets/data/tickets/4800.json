{"id": 4800, "title": "Ticket #4800: Offload authorization to a separate process", "description": "<blockquote>\nAlong with <span class=\"ticket\"><a class=\"abandoned\" href=\"tktview?tn=189\" title=\"Allow Selector class to use epoll system call where available\">#189</a></span>, one remaining reason we need a collector hierarchy is the cost of authentication.\n\n<p>In <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=4137\" title=\"Non-blocking authentication\">#4137</a></span>, authentication (for FS and GSI) was made non-blocking, allowing multiple authentication attempts to proceed at once.  However, GSI itself is a costly operation in terms of CPU usage - in the case of a collector restart, there is simply no CPU fast enough to establish new connections for all startds in a large glidein pool.\n\n</p><p>I propose introducing a new daemon - condor_auth_server - which will receive the remote TCP socket, perform authentication only, and then send the socket back to the parent.  This will allow multiple CPUs to be utilized for GSI authentication.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-29 11:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42046\">[42046]</a></span>: Enable the auth server in the collector. <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=4800\" title=\"Offload authorization to a separate process\">#4800</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-29 11:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42045\">[42045]</a></span>: Allow DC to utilize the auth_server if enabled. <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=4800\" title=\"Offload authorization to a separate process\">#4800</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-29 11:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42044\">[42044]</a></span>: Implementation of a separate authorization server. <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=4800\" title=\"Offload authorization to a separate process\">#4800</a></span> The condor_auth_server accepts and authenticates TCP sockets from other daemons, sending the results and socket back to the original DC process.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-29 11:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42043\">[42043]</a></span>: Allow the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorError\" title=\"Condor Error\">CondorError</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=KeyInfo\" title=\"Key Info\">KeyInfo</a></span> objects to be serialized in a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span>. <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=4800\" title=\"Offload authorization to a separate process\">#4800</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-29 11:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42042\">[42042]</a></span>: CEDAR plumbing for socket passing. <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=4800\" title=\"Offload authorization to a separate process\">#4800</a></span> This includes three items: - Passing file descriptors between two CEDAR processes on the same host. - Fix const-ness of the various socket serialize methods. - Creating a pair of unix domain sockets.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-29 11:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42041\">[42041]</a></span>: Fix missing include in exprList header. <span class=\"ticket\"><a class=\"new\" href=\"tktview?tn=4800\" title=\"Offload authorization to a separate process\">#4800</a></span>  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Dec-29 11:18", "status": "new", "created": "2014-Dec-29 11:18", "fixed_version": "2014-Dec-29 11:18", "broken_version": "", "priority": "4", "subsystem": "DaemonsCM", "assigned_to": "bbockelm", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "other", "visibility": "public", "notify": "bbockelm@cse.unl.edu", "due_date": ""}