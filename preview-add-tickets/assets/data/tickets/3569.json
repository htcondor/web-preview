{"id": 3569, "title": "Ticket #3569: add a knob to disable hold-on-failure for glexec", "description": "<blockquote>\nIgor requests a knob to disable the hold-on-failure semantics of glexec.  The default should still be to hold on failure.  When the hold is disabled, the job should return to the idle state, and the claim should be broken.\n\n<p>Using SYSTEM_PERIODIC_RELEASE to get out of the hold state is not a good enough solution for CMS, because held jobs are considered failed and must be resubmitted.\n\n</p><p>We considered whether it would be acceptable to implement this as an immediate release from hold, so that the job never appears in the hold state, but the user log contains hold/release events.  Igor thinks this could potentially still cause problems.  He just wants the old shadow exception behavior.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Apr-10 12:01:02 by sfiligoi:</em> <br/>\n\nIdeally, I would want to disable the hold semantics only for glexec failures during the initial job startup attempt.<br/>\n\nIf glexec fails afterwards, holding the job seems the right thing to do.\n\n<p>The difference is the frequency; glexec failing on startup is very likely unrecoverable, and a lot of jobs will be held on this condition.\n\n</p><p>On the other hand, a glexec hold after the job startup is very rare, so having a record on the user side is useful.\n\n</p><p></p><hr/>\n<em>2013-Apr-19 17:08:37 by danb:</em> <br/>\n\nQuestion:\n\n<p>One of the reasons that the initial glexec operation may fail is that the starter's test that the proxy is valid fails.  This could happen because the proxy is expired, or because there is clock skew, or other reasons.\n\n</p><p>Should the new knob that disables hold-on-failure of glexec setup also disable hold on failure of the proxy validity test?  That happens to be the easiest thing to implement, but it would not be a major effort to untangle the two cases.\n\n</p><p></p><hr/>\n<em>2013-Apr-19 17:21:24 by sfiligoi:</em> <br/>\n\nIdeally, you would only disable \"true glexec failure\" errors.\n\n<p>Holding jobs with expired proxies is definitely a good thing.\n\n</p><p>Now, I know clock skews are a bit of an edge case scenario, but we should not mix this with \"glexec failures\".</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Apr-29 15:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35573\">[35573]</a></span>: cosmetic changes to documentation of new knob GLEXEC_HOLD_ON_INITIAL_FAILURE ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3569\" onclick=\"get_ticket_and_populate_wrapper('3569'); return false;\" title=\"add a knob to disable hold-on-failure for glexec\">#3569</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Apr-19 17:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35473\">[35473]</a></span>: GLEXEC_HOLD_ON_INITIAL_FAILURE should not prevent hold on invalid proxy. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3569\" onclick=\"get_ticket_and_populate_wrapper('3569'); return false;\" title=\"add a knob to disable hold-on-failure for glexec\">#3569</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Apr-19 17:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35472\">[35472]</a></span>: Add a knob to turn off glexec hold-on-error behavior. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3569\" onclick=\"get_ticket_and_populate_wrapper('3569'); return false;\" title=\"add a knob to disable hold-on-failure for glexec\">#3569</a></span> Also improve error propagation in case the proxy validation check fails.  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Apr-19 17:46", "status": "resolved", "created": "2013-Apr-10 10:55", "fixed_version": "2013-Apr-10 10:55", "broken_version": "v070906", "priority": "2", "subsystem": "", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "isfiligoi@ucsd.edu,dan@hep.wisc.edu,zmiller@cs.wisc.edu,tannenba@cs.wisc.edu", "due_date": ""}