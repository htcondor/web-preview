{"id": 1705, "title": "Ticket #1705: RFE: Advertise some additional performance-related negotiator stats", "description": "<blockquote>\n<div class=\"verbatim\">\n<pre>From email by Matt Farrellee:\n\n=============================================\nAll daemons should report MonitorSelf* attributes, covering uptime, cpu\nusage, memory usage, etc.\n\nI'd like to see a few more stats coming from the Collector, Negotiator,\nand Schedd. From the Collector, information about command rates, e.g.\ninvalidations or misses. The Negotiator can report information about how\nmany jobs and/or slots were involved in a negotiation cycle. For the\nSchedd, information about completion rates based on\nEnteredCurrentStatus, CompletionDate and JobFinishedHookDone. Also,\nstatistics on condor_shadow exit codes, both absolute values and rates.\nPossibly information about expensive fs operations, such as fsync.\n============================================\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2010-Oct-11 17:46:49 by eje:</em> <br/>\n\n<div class=\"verbatim\">\n<pre>Currently, new stats from candidate patch are:\n\n// ending time for neg cycle (sec since big bang)\nLastNegotiationCycleEnd0 = 1286400981\n\n// time from end of previous cycle to end of this cycle (sec)\nLastNegotiationCyclePeriod0 = 34\n\n// durations of the four phases (sec)\nLastNegotiationCyclePhase1Duration0 = 0\nLastNegotiationCyclePhase2Duration0 = 2\nLastNegotiationCyclePhase3Duration0 = 0\nLastNegotiationCyclePhase4Duration0 = 2\n\n// total slots incoming\nLastNegotiationCycleTotalSlots0 = 40\n// total slots after trimming\nLastNegotiationCycleTrimmedSlots0 = 40\n// total slots after filtering by GROUP_DYNAMIC_MACH_CONSTRAINT\nLastNegotiationCycleCandidateSlots0 = 40\n\n// number of schedulers spoken to\nLastNegotiationCycleNumSchedulers0 = 1\n// number of idle jobs (across all schedulers spoken to)\nLastNegotiationCycleNumIdleJobs0 = 120\n// number of job requests returned for consideration\nLastNegotiationCycleNumJobsConsidered0 = 21\n\n// match rate over duration of this cycle (jobs / sec)\nLastNegotiationCycleMatchRate0 = 5.000000\n\n// match rate over period (jobs / sec)\n// This is effective match rate since end of previous cycle\nLastNegotiationCycleMatchRateSustained0 = 0.588235\n</pre></div>\n\n\n<p></p><hr/>\n<em>2010-Oct-13 14:20:28 by danb:</em> <br/>\n\nHi Erik,\n\n<p>Thanks for the patch.  A couple comments:\n\n</p><p>You changed the minimum range for NEGOTIATION_CYCLE_STATS_LENGTH from 1 to 0 in the call to param_integer().  You did not change the entry in the param table (param_info.in).  The intended and documented behavior was for the special value 0 to indicate that no stats should be published.  I don't imagine that anyone will ever need to turn it off, so I'm not going to throw a fit if you ignore me, but if you do, please update the param table and the documentation.\n\n</p><p>It is customary in Condor code to always uses {}'s for if statements.  In a couple places you did not.  Although I find the use of {}'s ugly in some cases, there is an advantage to uniformity of style.\n\n</p><p>I assume you will document the new attributes that you added in the Condor manual or at least send a description of them to Karen.\n\n</p><p>Cheers,<br/>\n\n--Dan\n\n</p><p></p><hr/>\n<em>2010-Oct-14 11:45:33 by eje:</em> <br/>\n\nI posted a patch to address feedback.  Also, I'll make sure that descriptions for new stats make it into the documentation.\n<hr/>\n<em>2011-Jan-27 14:50:47 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2011-Feb-01 16:16:42 by danb:</em> <br/>\n\nErik,\n\n<p>Sorry for the long delay.  I read over the patch.  I don't spot any problems.  The patch no longer applies cleanly to the master branch.  Go ahead and rebase the patch and push it.  If you would like me to push the rebased patch, that's fine too.\n\n</p><p>--Dan\n</p><hr/>\n<em>2011-Feb-01 16:20:02 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.\n\n<p></p><hr/>\nHi Dan,  this patch has actually been subsumed by latest patch for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1393\" onclick=\"get_ticket_and_populate_wrapper('1393'); return false;\" title=\"Implement tiered groups and hierarchical fairshare\">#1393</a></span>, so I'm marking this ticket as \"abandoned.\"\n-Erik</blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/235/new_neg_stats_uw.patch\">new_neg_stats_uw.patch</a>\n20464 bytes added by eje on 2010-Oct-11 22:45:34 UTC.\n<br/>\nCandidate patch for 7.5 series, advertises several new requested statistics in negotiator ad<br/>\n</li><li><a href=\"attach_get/237/new_neg_stats_uw.patch2\">new_neg_stats_uw.patch2</a>\n20082 bytes added by eje on 2010-Oct-14 16:44:01 UTC.\n<br/>\n<div class=\"verbatim\">\n<pre>Updated patch: \n*) restores num-cycle-stats minimum to zero -- code has existing hack to prevent segfault when parameter is zero\n*) used condor-standard braces for if statements\n</pre></div>\n\n<br/>\n</li><li><a href=\"attach_get/238/new_neg_stats_doc_uw.patch\">new_neg_stats_doc_uw.patch</a>\n6690 bytes added by eje on 2010-Oct-14 19:15:05 UTC.\n<br/>\nPatch to update manual with new negotiator ad stats.<br/>\n</li></ul>\n</blockquote>", "check_ins": "", "type": "enhance", "last_change": "2011-Feb-02 09:57", "status": "abandoned", "created": "2010-Oct-11 17:44", "fixed_version": "2010-Oct-11 17:44", "broken_version": "", "priority": "2", "subsystem": "Daemons", "assigned_to": "eje", "derived_from": "", "creator": "eje", "rust": "", "customer_group": "other", "visibility": "public", "notify": "eje@redhat.com, matt@cs.wisc.edu", "due_date": ""}