{"id": 6151, "title": "Ticket #6151: Make documented flag names human-readable.", "description": "<blockquote>\nIn particular, 'odi' and 'sfr' are odious.  Flags that are specific to AWS should probably begin -aws (we can add a general version of the flag later, if it turns out be generalizable).\n\n<p></p><div class=\"verbatim\">\n<pre>        We probably have better things to do than to think about this too\nhard, but I'm proposing the following based on our discussions.  Some of the\noption names get rather long, but if we're worried about them not working\nfor Azure, we don't have a lot of choice (but see below for an idea about\nthat).  This help assumes GT# 6113 in the 'user data' section.\n\n--------------------------------------------------------------------------------\n\nusage: condor_annex -annex-name &lt;annex-name&gt; -count|-slots &lt;number&gt;\n\nFor on-demand instances:\n        [-aws-on-demand]\n        -count &lt;integer number of instances&gt;\n\nFor spot fleet instances:\n        [-aws-spot-fleet]\n        -slots &lt;integer number of weighted capacity units&gt;\n\nTo set the lease or idle durations:\n        [-duration &lt;lease duration in decimal hours&gt;]\n        [-idle &lt;idle duration in decimal hours&gt;]\n\nTo customize the annex's HTCondor configuration:\n        [-config-dir &lt;/full/path/to/config.d&gt;]\n\nTo set an instance's user data:\n        [-aws-[default-]user-data[-file] &lt;data|file&gt; ]\n\nTo customize an AWS on-demand annex:\n        [-aws-on-demand-instance-type &lt;instance-type&gt;]\n        [-aws-on-demand-ami-id &lt;AMI-ID&gt;\n        [-aws-on-demand-security-group-ids &lt;group-ID[,groupID]*&gt;\n        [-aws-on-demand-key-name &lt;key-name&gt;]\n\nTo use a customize an AWS Spot Fleet annex, specify a JSON config file:\n        [-spot-fleet-config-file &lt;path/to/config.json&gt;]\n\nTo reprint this help:\n        [-help]\n\nExpert mode (specify account and region):\n        [-aws-access-key-file &lt;path/to/access-key-file&gt;]\n        [-aws-secret-key-file &lt;path/to/secret-key-file&gt;]\n        [-aws-ec2-url https://ec2.&lt;region&gt;.amazonaws.com]\n        [-aws-events-url https://events.&lt;region&gt;.amazonaws.com]\n        [-aws-lambda-url https://lambda.&lt;region&gt;.amazonaws.com]\n        [-aws-s3-url https://s3.&lt;region&gt;.amazonaws.com]\n\nExpert mode (specify implementation details):\n        [-aws-spot-fleet-lease-function-arn &lt;sfr-lease-function-arn&gt;]\n        [-aws-on-demand-lease-function-arn &lt;odi-lease-function-arn&gt;]\n        [-aws-on-demand-instance-profile-arn &lt;instance-profile-arn&gt;]\n\n--------------------------------------------------------------------------------\n\n        I discussed this briefly with TJ, and it seems like some of the\noption names are getting rather long.  My proposal to address this, which we\nagreed seemed both reasonable and implementable, had two parts:\n\n(1) Break the -aws off the front of the options and make it its own\n    flag, which is set by default.  That way you only have to type it\n    (or -azure, if and when that happens) once.\n(2) Break the -on-demand off the new front of the options and make it its\n    own flag, which is set by default.  That way you only have to type it\n    (or -spot-fleet) once.\n\nThis has the nice implementation side-effect of allowing the AWS-,\non-demand-, and spot- specific parsing/setup to happen in different\nfunctions.\n\n        To further encourage parsimony, we thought it would make sense for\nthe -on-demand and -spot-fleet flags to become options whose argument\nspecifies the size of the annex.  We could keep -count as a general flag of\nyou don't specify an annex type; TJ and like the idea, however, of having a\ngeneral flag for the count as well, because having a single positional\nargument sometimes looks real funny.\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2017-Feb-16 13:47:44 by tlmiller:</em> <br/>\n\nFIXME: The S3 config path is not ODI-specific.\nFIXME: Change knob names to match the command-line option names; remove the <em>DEFAULT</em>, since we won't be doing nondefault setups in config for a while, if ever.\n\n<p>Ponder -- perhaps for 8.7.1 -- removing a bunch of the options and making them config-only, with the addition of being able to specify a config on the command line, whose value will default to the default output of <code>condor_config -setup</code>; see <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>.\n\n</p><p></p><hr/>\n<em>2017-Feb-20 13:53:43 by tlmiller:</em> <br/>\n\nMake doc changes in wiki once new binaries are available.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-17 16:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50185\">[50185]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6151\" onclick=\"get_ticket_and_populate_wrapper('6151'); return false;\" title=\"Make documented flag names human-readable.\">#6151</a></span>) Fix brain-damage in parser. Change flag and option names to be less awful. Add a param-table default for the (newly-configurable) idle timeout. (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6150\" onclick=\"get_ticket_and_populate_wrapper('6150'); return false;\" title=\"Improve output before annex attempt.\">#6150</a></span>) First pass.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "experimental", "last_change": "2017-Feb-23 12:33", "status": "resolved", "created": "2017-Feb-15 16:01", "fixed_version": "2017-Feb-15 16:01", "broken_version": "", "priority": "1", "subsystem": "Annex", "assigned_to": "tlmiller", "derived_from": "#6111", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}