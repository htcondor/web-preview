{"id": 1201, "title": "Ticket #1201: DAEMONLIST=VIEW_SERVER without a CONDOR_VIEW_HOST segfaults master", "description": "<blockquote>\nIf VIEW_SERVER is in the DAEMON_LIST (and points to the same binary as COLLECTOR), but CONDOR_VIEW_HOST is not set, the condor_master will try to dereference a null pointer and falls over dead.\n\n<p>Two layers could have caught and handled the error:\n\n</p><p></p><ol>\n<li>StringList::initializeFromString (string_list.cpp:66) doesn't notice it was passed in NULL.  It should instead notice the NULL pointer, then either EXCEPT or behave as though an empty string (\"\") was passed in.  EXCEPTing may help catch bugs in callers layers who are being sloppy and handing around bad data.  Treating it as an empty string almost certainly yields the desired behavior.\n\n<p></p></li><li>Daemon::getCmInfo (daemon.cpp:1330) didn't notice that getCmHostFromConfig returned NULL. If that happens, it should silently return false; the layer one up will notice and will fall back to using COLLECTOR_HOST.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Feb-10 17:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17192\">[17192]</a></span>: If you can't extract a valid hostname from the central manager list, don't try to do a strlen on the resulting null pointer. Eliminates crash when setting CONDOR_VIEW_HOST to something like \":1234\". Stumbled upon while solving <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1201\" onclick=\"get_ticket_and_populate_wrapper('1201'); return false;\" title=\"DAEMONLIST=VIEW_SERVER without a CONDOR_VIEW_HOST segfaults master\">#1201</a></span>, which is a slightly different crash bug.  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Feb-10 17:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17191\">[17191]</a></span>: When looking for a central manager, if getCmHostFromConfig returns NULL, fail immediately, as opposed to trying to use NULL as a valid list of hostnames. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1201\" onclick=\"get_ticket_and_populate_wrapper('1201'); return false;\" title=\"DAEMONLIST=VIEW_SERVER without a CONDOR_VIEW_HOST segfaults master\">#1201</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Feb-10 17:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=17190\">[17190]</a></span>: EXCEPT is StringList::initializeFromString is passed a null pointer. Replaces previous behavior of segfaulting. Chose to go with an EXCEPT to avoid hiding higher level bugs where caller doesn't realize it's handing around null as distinct from an empty string. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1201\" onclick=\"get_ticket_and_populate_wrapper('1201'); return false;\" title=\"DAEMONLIST=VIEW_SERVER without a CONDOR_VIEW_HOST segfaults master\">#1201</a></span>  (By Alan De Smet )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Feb-11 13:20", "status": "resolved", "created": "2010-Feb-10 12:02", "fixed_version": "2010-Feb-10 12:02", "broken_version": "v070401", "priority": "2", "subsystem": "Daemons", "assigned_to": "adesmet", "derived_from": "", "creator": "adesmet", "rust": "a20236", "customer_group": "other", "visibility": "public", "notify": "", "due_date": "20100210"}