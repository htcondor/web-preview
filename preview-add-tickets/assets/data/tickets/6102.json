{"id": 6102, "title": "Ticket #6102: Synchronize Job Router's polling functions", "description": "<blockquote>\nThe Job Router has different daemoncore timers for two polling functions. One function snoops on the schedd's job_queue.log and maintains an in-memory copy of the queue state. The other function looks at all routed jobs and performs any required actions on them. This includes propagating attribute changes from the routed job ad to the source job ad. These have the same interval by default, but can get out of synch by configuration or due to runtime delays.\n\n<p>I have observed frequent occasions where the Job Router will push attribute updates to the source job ad in the schedd twice, because its view of the schedd's queue isn't updated after the first push.\n\n</p><p>We should merge these polling operations under a single daemoncore timer. It would first update the in-memory mirror of the job queue, then examine all of the routed jobs. The latter uses information from the former for much of its work.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-01 14:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50245\">[50245]</a></span>: Docs for synchronizing Job Router polling functions. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6102\" onclick=\"get_ticket_and_populate_wrapper('6102'); return false;\" title=\"Synchronize Job Router's polling functions\">#6102</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-20 11:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50026\">[50026]</a></span>: Synchronize Job Router's two polling functions. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6102\" onclick=\"get_ticket_and_populate_wrapper('6102'); return false;\" title=\"Synchronize Job Router's polling functions\">#6102</a></span> Update the mirrors of the job queue logs just before iterating over the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RoutedJobs\" title=\"Routed Jobs\">RoutedJobs</a></span>. This guarantees the queue state is up-to-date. In particular, changes pushed to the schedd in a previous iteration will be reflected in the queue state for the current\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Mar-01 14:14", "status": "resolved", "created": "2017-Jan-20 11:05", "fixed_version": "2017-Jan-20 11:05", "broken_version": "v080400", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}