{"id": 5204, "title": "Ticket #5204: Make processing of periodic exprs in schedd more efficient", "description": "<blockquote>\nThe handling of Periodic expression evaluations in the SCHEDD can use a significant amount of time.  It can be 5 seconds or so each time the queue is walked to check expressions even if all most of the expressions are trivial and false and none of them fire.\n\n<p>This slowness is because the code that actually does the evaluation isn't careful about how many attributes are fetched for each job.  Because trivial <code>Expr=false</code> expressions are inserted into the job ad and thus cannot be quickly skipped, and because the system periodic expressions are repeatedly param'd and parsed.\n\n</p><p>two of these things can be easily fixed, and should help the CERN schedd deal with 100's of thousands of jobs.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Aug-26 11:38:00 by tim:</em> <br/>\n\nNo version history needed. The change is not user visible and other version history items mention the gain in efficiency.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5466\" title=\"Job policy reason strings contain extra junk\">#5466</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nJob policy reason strings contain extra junk</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-14 11:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45630\">[45630]</a></span>: fix typo in previous commit for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5204\" title=\"Make processing of periodic exprs in schedd more efficient\">#5204</a></span> that could set wrong value for hold subcode  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Aug-06 00:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=45484\">[45484]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=5204\" title=\"Make processing of periodic exprs in schedd more efficient\">#5204</a></span>) make processing of Periodic expressions in the SCHEDD more efficient. this patch speeds up the processing when expressions don't trigger and where most jobs have default expressions by 2x ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Aug-26 11:38", "status": "resolved", "created": "2015-Aug-06 00:16", "fixed_version": "2015-Aug-06 00:16", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}