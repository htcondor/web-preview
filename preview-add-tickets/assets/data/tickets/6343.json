{"id": 6343, "title": "Ticket #6343: Collector Python plugin has undefined symbols", "description": "<blockquote>\nJIRA ticket: <a class=\"external\" href=\"https://jira.opensciencegrid.org/browse/SOFTWARE-2816\">https://jira.opensciencegrid.org/browse/SOFTWARE-2816</a>\n\n<p></p><div class=\"blockquote\">\n<table width=\"95%\"><tbody><tr><td>\u00a0</td><td>\n  \nThe python plugin in condor 8.6.4 is throwing undefined symbol errirs when a python plugin imports other python modules, for example PyExc_ValueError for the time module and _Py_ZeroStruct for the collections.OrderedDict module.  This is getting in the way of the implementation of the htcondor-ce collector plugin we want to use at Fermilab for logging jobs run with singularity.   I will attach a htcondor patch that makes it work, please get it released by OSG and integrated into the upstream htcondor releases.\n</td></tr></tbody></table></div>\n\n\n<p>Relevant <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GitHub\" title=\"Git Hub\">GitHub</a></span> discussion: <a class=\"external\" href=\"https://github.com/opensciencegrid/htcondor-ce/pull/153#discussion_r123656798\">https://github.com/opensciencegrid/htcondor-ce/pull/153#discussion_r123656798</a></p></blockquote>", "remarks": "<blockquote>\n<em>2017-Jul-26 16:21:15 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>These changes look good.</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-31 16:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51971\">[51971]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6344\" onclick=\"get_ticket_and_populate_wrapper('6344'); return false;\" title=\"Cross-protocol CCB should not cause schedd or shadow to EXCEPT\">#6344</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6324\" onclick=\"get_ticket_and_populate_wrapper('6324'); return false;\" title=\"Execute directory cannot be an ImDisk ramdrive on Windows\">#6324</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6308\" onclick=\"get_ticket_and_populate_wrapper('6308'); return false;\" title=\"parallel universe doesn't support partitionable slots well\">#6308</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6343\" onclick=\"get_ticket_and_populate_wrapper('6343'); return false;\" title=\"Collector Python plugin has undefined symbols\">#6343</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-21 14:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51899\">[51899]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6343\" onclick=\"get_ticket_and_populate_wrapper('6343'); return false;\" title=\"Collector Python plugin has undefined symbols\">#6343</a></span>) Don't try to make collector_python_plugin library on MacOS  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-21 13:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51898\">[51898]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6343\" onclick=\"get_ticket_and_populate_wrapper('6343'); return false;\" title=\"Collector Python plugin has undefined symbols\">#6343</a></span>) This breaks collector plugins for OSG Revert \"Move <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CollectorPlugin\" title=\"Collector Plugin\">CollectorPlugin</a></span> constructor/destructor into header file. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6244\" onclick=\"get_ticket_and_populate_wrapper('6244'); return false;\" title=\"Build python bindings for MacOSX\">#6244</a></span>\" This reverts commit ba80c01a440f793a49c731efc541fda3d59af831.  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-21 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51897\">[51897]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6343\" onclick=\"get_ticket_and_populate_wrapper('6343'); return false;\" title=\"Collector Python plugin has undefined symbols\">#6343</a></span>) Don't enable collector plugins on MacOSX (They're broken)  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-12 13:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51860\">[51860]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6343\" onclick=\"get_ticket_and_populate_wrapper('6343'); return false;\" title=\"Collector Python plugin has undefined symbols\">#6343</a></span>) Load plugins with global scope The python plugins must be load in global scope in order to be able to load other python modules.  (By Tim Theisen )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Jul-31 15:21", "status": "resolved", "created": "2017-Jul-11 09:45", "fixed_version": "2017-Jul-11 09:45", "broken_version": "", "priority": "2", "subsystem": "DaemonsCM", "assigned_to": "tim", "derived_from": "#4555", "creator": "blin", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "blin@cs.wisc.edu bbocklem@cse.unl.edu", "due_date": ""}