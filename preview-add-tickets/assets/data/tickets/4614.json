{"id": 4614, "title": "Ticket #4614: DAGMan crash on version skew", "description": "<blockquote>\nDAGMan is segfaulting when it's restarted after HTCondor is upgraded. In main_init(), it detects a version skew and can end up calling main_shutdown_rescue() to abort. This function calls Dag::ReportMetrics(), but Dag::CreateMetrics() hasn't been called yet, so ReportMetrics() dereferences a NULL pointer. The call to Dag::CreateMetrics() is in main_init() after the version skew detection.</blockquote>", "remarks": "<blockquote>\n<em>2014-Sep-25 16:26:05 by jfrey:</em> <br/>\n\nThis caused all of the dagman instances on submit3.batlab.org to crash when the machine was upgraded from 8.0 to 8.2.\n\n<p></p><hr/>\n<em>2014-Oct-22 16:24:11 by wenger:</em> <br/>\n\nThis was fixed by the same code change that fixed <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4600\" onclick=\"get_ticket_and_populate_wrapper('4600'); return false;\" title=\"Setting DAGMAN_ALWAYS_USE_NODE_LOG to false can cause DAGMan core dump\">#4600</a></span>.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "", "type": "defect", "last_change": "2014-Oct-22 16:26", "status": "resolved", "created": "2014-Sep-25 16:25", "fixed_version": "2014-Sep-25 16:25", "broken_version": "v080202", "priority": "3", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}