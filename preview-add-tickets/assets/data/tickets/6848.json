{"id": 6848, "title": "Ticket #6848: Support in-place string substitution on ClassAds regexps() function", "description": "<blockquote>\nThe <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> function <code>regexps()</code> allows you to do a regular expression match and apply a substitution for the matched text. The resulting string is only the substitution for the matched text. It does not include any of the surrounding text. Having an option to keep the full target string with the substitution(s) applied in-place would provide useful new functionality. For example, you could replace all commas in the target string with spaces.\n\n<p>We should add two new flags to the options argument of <code>regexps()</code>:\n</p><ul>\n<li><code>f</code>: Include the full target text in the result, with substitutions applied in-place.\n</li><li><code>g</code>: Find all occurrences of the pattern in the target string and apply the substitution for each.\n</li></ul>\n\n<p>Question: Should option <code>g</code> imply <code>f</code>? Is using <code>g</code> without <code>f</code> ever useful?\n\n</p><p>Also, we should consider adding new functions <code>replace()</code> and/or <code>replaceall()</code> that imply <code>f</code> and <code>g</code>.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Jan-22 16:12:31 by tlmiller:</em> <br/>\n\nI guess this is just another reason to upgrade the BaTLab submit node, but <span class=\"chng\"><a href=\"chngview?cn=55958\">[55958]</a></span> breaks building on RHEL6 even with an up-to-date, because its libpcre is so old that PCRE_NOTEMPTY_ATSTART doesn't exist.\n\n<p></p><hr/>\n<em>2019-Jan-24 14:46:59 by tlmiller:</em> <br/>\n\nWe can revert <span class=\"chng\"><a href=\"chngview?cn=56074\">[56074]</a></span> once submit-3.batlab.org is ugpraded.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Apr-02 15:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56493\">[56493]</a></span>: Docs for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> functions replace(), replaceall(). <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6848\" title=\"Support in-place string substitution on ClassAds regexps() function\">#6848</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-24 14:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56074\">[56074]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6848\" title=\"Support in-place string substitution on ClassAds regexps() function\">#6848</a></span>) Until we upgrade submit-3.batlab.org, we need the external's libpcre to build on sl6.3.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-07 16:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55958\">[55958]</a></span>: Add new options 'f' and 'g' to <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> function regexps() <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6848\" title=\"Support in-place string substitution on ClassAds regexps() function\">#6848</a></span> Option 'f' includes the full target string in the result, with substitutions applied in-place. Option 'g' does a global search-and-replace in the target string. Option 'g' is not implemented for the POSIX regex variant.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-07 16:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55959\">[55959]</a></span>: Add <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> functions replace() and replaceall(). <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6848\" title=\"Support in-place string substitution on ClassAds regexps() function\">#6848</a></span> These are equivalent to regexps() with the new 'f' and 'g' options enabled.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-07 16:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55960\">[55960]</a></span>: Add regression tests for new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> regexps() options. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6848\" title=\"Support in-place string substitution on ClassAds regexps() function\">#6848</a></span>  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Apr-04 10:43", "status": "resolved", "created": "2019-Jan-03 16:13", "fixed_version": "2019-Jan-03 16:13", "broken_version": "", "priority": "3", "subsystem": "ClassAd", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}