{"id": 825, "title": "Ticket #825: More detailed version compat check for dagman than -AllowVersionMismat", "description": "<blockquote>\n-AllowVersionMismatch is necessary to override a simple strcmp check of the version strings between dagman and CSD. RH testing using all UW dag tests revealed good compatibility between mixes of 7.2.4 and 7.4.0 DM/CSD.\n\n<p>RH proposes a specific version check class for dagman that uses <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorVersionInfo\" title=\"Condor Version Info\">CondorVersionInfo</a></span> to analyse the presented version strings in more detail. It also will be a place holder for embedding rules for known compatibility issues as they are discovered.\n\n</p><p>It essentially will allow customers in the midst of dagman migrations to \"safely\" run mixed environments of DM/CSD components without the need for -AllowVersionMismatch.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Oct-13 11:41:55 by tstclair:</em> <br/>\n\nIt should be noted that existing dag jobs on CHTC upgrade (10/12/09) failed due to version mismatch.\n\n<p>--From Team Meeting.\n\n</p><p>2009-10-13 by wenger:\nJust committed a fix to this (1304b7e71b627eb6c1b7af4e920fefb82601bb38) for 7.4.0.  Leaving the ticket open because I haven't documented it yet.\n\n</p><p></p><hr/>\n<em>2009-Oct-15 10:59:38 by pmackinn:</em> <br/>\n\nKent, do you think we should log the fact that the CSD was less than the DM version, even if it is within tolerance (i.e., &gt;= 7.1.2)?\n\n<p>2009-10-16 by wenger:\nI just documented this, and I was going to resolve the ticket.  Just saw the remark above by pmackinn -- I thought about that a bit, and I now I think it's a good idea (but maybe not for 7.4.0 at this point).  I thought about that when I originally wrote the new check, and I didn't think it was necessary.  But thinking about it again, I think it might be a good idea, mainly in case we goof up and don't update the \"minimum acceptable version\" when we should.  That would at least give us some help in debugging the resulting problems.  And most of the time, the versions should exactly match, so the warnings shouldn't happen all that often.  So I'm deferring the ticket for now, and downgrading the priority.\n\n</p><p></p><hr/>\n<em>2010-Jul-30 12:44:42 by wenger:</em> <br/>\n\nIf the versions differ, but the difference is legal, the message could be something like this:\n\n<p></p><pre>  Note: condor_submit_dag version (7.5.2) differs from condor_dagman version\n    (7.5.3), but the difference is allowed.\n</pre>\n\n<p></p><hr/>\n<em>2010-Jul-30 15:03:08 by wenger:</em> <br/>\n\nI've now finished the code changes to print this \"permissible mismatch\" message, and documented that in the version history, so I'll close this ticket.</blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/108/0001-Added-support-if-necessary-for-more-detailed-versi.patch\">0001-Added-support-if-necessary-for-more-detailed-versi.patch</a>\n6345 bytes added by pmackinn on 2009-Oct-08 16:19:28 UTC.\n<br/>\nPatch for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DagmanVersionInfo\" title=\"Dagman Version Info\">DagmanVersionInfo</a></span> support<br/>\n</li></ul>\n</blockquote>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-30 15:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=25590\">[25590]</a></span>: Final fix for gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=825\" onclick=\"get_ticket_and_populate_wrapper('825'); return false;\" title=\"More detailed version compat check for dagman than -AllowVersionMismat\">#825</a></span>: we now print a note when the condor_submit_dag and condor_dagman versions differ, even if the difference is permissible.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jul-30 14:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=18679\">[18679]</a></span>: Final fix for gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=825\" onclick=\"get_ticket_and_populate_wrapper('825'); return false;\" title=\"More detailed version compat check for dagman than -AllowVersionMismat\">#825</a></span>: we now print a note when the condor_submit_dag and condor_dagman versions differ, even if the difference is permissible.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Oct-16 15:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=25037\">[25037]</a></span>: Documented gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=825\" onclick=\"get_ticket_and_populate_wrapper('825'); return false;\" title=\"More detailed version compat check for dagman than -AllowVersionMismat\">#825</a></span> (More detailed version compat check for dagman than -AllowVersionMismat) fix -- in version history and notes in condor_dagman and condor_submit_dag man pages.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Oct-15 13:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=16077\">[16077]</a></span>: Fixed gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=825\" onclick=\"get_ticket_and_populate_wrapper('825'); return false;\" title=\"More detailed version compat check for dagman than -AllowVersionMismat\">#825</a></span> (More detailed version compat check for dagman than -AllowVersionMismat) -- there's now a minimum compatible submit file version defined in dagman_main.h. Currently this is 7.1.2 (in that version, the -condorlog and -storklog command-line arguments to condor_dagman were eliminated).\u00a0[...]\n (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Oct-13 17:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=16046\">[16046]</a></span>: Fixed gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=825\" onclick=\"get_ticket_and_populate_wrapper('825'); return false;\" title=\"More detailed version compat check for dagman than -AllowVersionMismat\">#825</a></span> (More detailed version compat check for dagman than -AllowVersionMismat) -- there's now a minimum compatible submit file version defined in dagman_main.h. Currently this is 7.1.2 (in that version, the -condorlog and -storklog command-line arguments to condor_dagman were eliminated).\u00a0[...]\n (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jan-29 12:55", "status": "resolved", "created": "2009-Oct-08 11:18", "fixed_version": "2009-Oct-08 11:18", "broken_version": "v070400", "priority": "3", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "", "creator": "pmackinn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "pmackinn@redhat.com, matt@cs.wisc.edu", "due_date": ""}