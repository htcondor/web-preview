{"id": 173, "title": "Ticket #173: Sample Excel and MS Office Jobs", "description": "<blockquote>\nIt would be nice to have a set of sample that showed how to use Condor to use automated MS Office scripts. At a minimum, there is a clear need for Excel samples, as this one is mentioned more frequently than any of the others.</blockquote>", "remarks": "<blockquote>\n<em>2009-May-01 14:08:25 by burnett:</em> <br/>\n\nMethods are outlined <span class=\"wiki\"><a href=\"wiki?p=ExcelJobs\" title=\"Excel Jobs\">here</a></span>.  Once the document is complete, it will be added to the manual.\n\n<p></p><hr/>\n<em>2009-May-22 12:02:38 by ziliang:</em> <br/>\n\nI'm currently using the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ForceFullCalculation\" title=\"Force Full Calculation\">ForceFullCalculation</a></span> variable in order to decide whether to do a massive update.  There doesn't seem to be a way to set it using cmd argument switches in Excel, so a way to set it within the spreadsheet needs to be determined.  Or we could leave it up to the end-user to come up with their own way.\n\n<p></p><hr/>\n<em>2009-May-28 13:31:48 by burnett:</em> <br/>\n\nPlease see <a class=\"external\" href=\"http://www.decisionmodels.com/calcsecretse.htm\">this page</a> for a very simple GUI based solution.\n\n<p></p><hr/>\n<em>2009-May-28 15:39:27 by burnett:</em> <br/>\n\nA Python example can be found <a class=\"external\" href=\"http://www.dev-explorer.com/articles/excel-spreadsheets-and-python\">here</a>.\n\n<p></p><hr/>\n<em>2009-Jun-21 15:49:39 by ziliang:</em> <br/>\n\nFound the Registry value that controls the macro settings for security.  For Office 2007, the key is in HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security and is called VBAWarnings.  Set it to 1 and it will enable all VBA scripts.  Depending on what other versions we intend to support for this, I'll need to get a copy and install it.  We'll also need to make sure people can't do something malicious with this, since in theory they could put together a VBA script that screws with the system.\n\n<p></p><hr/>\n<em>2009-Jun-22 13:15:55 by ziliang:</em> <br/>\n\nKey in Office 2003 is located in HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security and is called Level.  Also appears that we need to set it to 1 to disable security.\n\n<p></p><hr/>\n<em>2009-Jun-29 12:06:50 by tannenba:</em> <br/>\n\nAnother idea for a different approach altogether: scrap all the VBScript mumbo jumbo ;) and use a gui automater like <span class=\"quote\">WinBatch</span> or its freeware alternative <a class=\"external\" href=\"http://www.autoitscript.com/autoit3/\">AutoIT</a>.\n\n<p></p><hr/>\n<em>2009-Jun-30 00:30:50 by burnett:</em> <br/>\n\nIf you're going that route, then just use the VBScript engine included with the Windows Scripting Host.  The WSH already supports a great deal of GUI automation capabilities, and it is available on a stock Windows machine.\n\n<p></p><hr/>\n<em>2009-Jun-30 09:53:39 by ziliang:</em> <br/>\n\nIsn't the WSH automation what you were doing originally, except that the settings needed rendered it unusable by anyone else?\n\n<p></p><hr/>\n<em>2009-Sep-29 11:15:16 by adesmet:</em> <br/>\n\nPossible STUDENTTASK.\n\n<p></p><hr/>\n<em>2010-Aug-16 11:38:42 by ziliang:</em> <br/>\n\nTo make this work with the embedded VBA script, we need a prejob hook that will modify a registry setting that determines whether Office allows a VBA script to run or not.  I'm not sure what the current status over distributing said hooks are so this part was never completed.\n\n<p></p><hr/>\n<em>2010-Aug-16 15:49:35 by tannenba:</em> <br/>\n\nWhat about the wisdom at <a class=\"external\" href=\"http://ben.versionzero.org/w/index.php?title=Excel_On_Windows\">http://ben.versionzero.org/w/index.php?title=Excel_On_Windows</a> ?\n\n<p></p><hr/>\n<em>2010-Aug-16 16:12:59 by ziliang:</em> <br/>\n\nAll wisdom on that page is on the wiki page <span class=\"wiki\"><a href=\"wiki?p=ExcelJobs\" title=\"Excel Jobs\">here</a></span>\n\n<p></p><hr/>\n<em>2010-Aug-17 13:23:59 by ziliang:</em> <br/>\n\nI've added the prejob hook stuff and listed this as an admin recipe.  That should be enough for our purposes.  I don't have a copy of Excel 2010 so I don't know what the registry location for its security settings got moved to, so that will have to wait.  I consider this ticket closed though since the majority of info is present and ready.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"abandoned\" href=\"/tickets?ticket=305\" onclick=\"get_ticket_and_populate_wrapper('305'); return false;\" title=\"Excel scripting examples\">#305</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nExcel scripting examples</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "", "type": "doc", "last_change": "2010-Aug-17 13:24", "status": "resolved", "created": "2009-Jan-30 14:02", "fixed_version": "2009-Jan-30 14:02", "broken_version": "v070300", "priority": "4", "subsystem": "Win32", "assigned_to": "ziliang", "derived_from": "", "creator": "burnett", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tannenba@cs.wisc.edu", "due_date": ""}