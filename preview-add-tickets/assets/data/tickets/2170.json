{"id": 2170, "title": "Ticket #2170: assertion fails in dedicated scheduler when claim request is rejected", "description": "<blockquote>\nWhen the dedicated scheduler's attempt to request a claim is rejected by the startd, an assertion fails with the following message in the logs:\n\n<p></p><div class=\"verbatim\">\n<pre>ERROR \"Assertion ERROR on (rec-&gt;cluster == -1)\" at line 3197 in file src/condor_schedd.V6/dedicated_scheduler.cpp\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2011-May-18 13:04:08 by danb:</em> <br/>\n\nThe problem was caused by the asynchronous negotiation changes.  The cluster variable in the match_rec for dedicated scheduler matches was getting set before any job was actually associated with that match by the dedicated scheduler.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-18 10:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26069\">[26069]</a></span>: added missing 7.6.1 version history item assoc. with gittrac <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2170\" onclick=\"get_ticket_and_populate_wrapper('2170'); return false;\" title=\"assertion fails in dedicated scheduler when claim request is rejected\">#2170</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jul-18 10:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26068\">[26068]</a></span>: remove version history item assoc with <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2170\" onclick=\"get_ticket_and_populate_wrapper('2170'); return false;\" title=\"assertion fails in dedicated scheduler when claim request is rejected\">#2170</a></span>; it belongs in the 7.6.1 version history  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-May-18 15:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=21894\">[21894]</a></span>: Fixed a problem in my previous patch to dedicated scheduler. <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2170\" onclick=\"get_ticket_and_populate_wrapper('2170'); return false;\" title=\"assertion fails in dedicated scheduler when claim request is rejected\">#2170</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-May-18 15:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=21893\">[21893]</a></span>: Fixed a case in which the schedd died when managing parallel jobs. ===GT=== <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2170\" onclick=\"get_ticket_and_populate_wrapper('2170'); return false;\" title=\"assertion fails in dedicated scheduler when claim request is rejected\">#2170</a></span> ===VersionHistory=== A bug introduced in 7.5.5 caused the condor_schedd to die when its attempt to claim a slot for a parallel universe job was rejected by the condor_startd.  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-May-18 12:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=21889\">[21889]</a></span>: Fixed a problem in my previous patch to dedicated scheduler. <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2170\" onclick=\"get_ticket_and_populate_wrapper('2170'); return false;\" title=\"assertion fails in dedicated scheduler when claim request is rejected\">#2170</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-May-17 21:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=21881\">[21881]</a></span>: Fixed a case in which the schedd died when managing parallel jobs. ===GT=== <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2170\" onclick=\"get_ticket_and_populate_wrapper('2170'); return false;\" title=\"assertion fails in dedicated scheduler when claim request is rejected\">#2170</a></span> ===VersionHistory=== A bug introduced in 7.5.5 caused the condor_schedd to die when its attempt to claim a slot for a parallel universe job was rejected by the condor_startd.  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-May-18 15:27", "status": "defer", "created": "2011-May-17 20:09", "fixed_version": "2011-May-17 20:09", "broken_version": "v070505", "priority": "5", "subsystem": "", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "a22161", "customer_group": "ligo", "visibility": "public", "notify": "pcouvare@caltech.edu", "due_date": ""}