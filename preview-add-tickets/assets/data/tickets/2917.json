{"id": 2917, "title": "Ticket #2917: Add the OSG Campus Factory as a condor contrib", "description": "<blockquote>\nThis ticket is meant to track the progress of adding the OSG Campus Factory (<a class=\"external\" href=\"http://sourceforge.net/projects/campusfactory/\">http://sourceforge.net/projects/campusfactory/</a>) to the condor contrib.\n\n<p>This will include several steps:\n</p><ol>\n<li>Add campus factory code to condor contrib\n</li><li>Modify build to install campus factory properly\n</li><li>Modify bosco_install in order to correctly configure bosco for the campus factory.\n</li><li>Modify bosco_cluster to send the necessary factory bits to the remote cluster.\n</li></ol>\n\n<p><span class=\"section\"></span></p><h2>Current Overview</h2>\n<span class=\"subsection\"><h3>Contrib </h3></span>\n<ul>\n<li>CMakeLists.txt is created that will install the campus factory into the release directory.  There is no build process for the campus factory (it's python)\n</li><li>The campus factory is installed in libexec/campus_factory\n</li></ul>\n\n<p><span class=\"subsection\"></span></p><h3>Install </h3>\n<ul>\n<li>bosco_install (really condor_configure) is modified to put the factory condor configuration in the LOCAL_CONFIG_DIR\n</li></ul>\n\n<p><span class=\"subsection\"></span></p><h3>Running </h3>\nIt's not clear yet how to run the campus factory.  Traditionally it's been run as a condor job.  I can change it to run as a normal condor daemon, as I believe that would fit the contrib MO better.\n\n<p><strong>EDIT:</strong> The campus factory now runs as a daemon under the <code>condor_master</code>.  Using the config:\n</p><div class=\"code\">\n<pre class=\"code\">CAMPUSFACTORY = $(SBIN)/runfactory\nCAMPUSFACTORY_ARGS = -c $(LIBEXEC)/campus_factory/etc/campus_factory.conf\nCAMPUSFACTORY_ENVIRONMENT = \"PYTHONPATH=$(LIBEXEC)/campus_factory/python-lib CAMPUSFACTORY_DIR=$(LIBEXEC)/campus_factory\"\n\n# What daemons should I run?\nDAEMON_LIST = COLLECTOR, SCHEDD, NEGOTIATOR, MASTER, CAMPUSFACTORY\n</pre></div>\n\n\n<p><span class=\"subsection\"></span></p><h3>bosco_cluster </h3>\n<ul>\n<li>Copy over the campus factory to the remote host (will just rsync the libexec/campus_factory/share/glidein_jobs directory) when adding hosts.\n</li></ul>\n\n<p><span class=\"subsection\"></span></p><h3>Questions </h3>\n<ul>\n<li>Should the campus factory be run as a job or as a condor daemon? - Answered: As condor daemon because it's easy.\n</li><li>Glidein needs binaries on the remote host.  I can create these binaries for the currently installed machine.  It is really, really hard to make binaries for different architectures (ie mac submitting to linux).</li></ul>\n</blockquote>", "remarks": "<blockquote>\nUpdating overview with how the campus factory is run.\n<hr/>\n<em>2012-Oct-22 14:59:14 by zmiller:</em> <br/>\n\nBulk change of target version from v070901 to v070902 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-May-15 13:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32644\">[32644]</a></span>: Updating campus factory to v1.0-rc5 <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-11 21:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32643\">[32643]</a></span>: Updating campus factory to commit: 0d80730 <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-11 16:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32642\">[32642]</a></span>: Updating campus factory to commit 5e03364 <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 22:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32640\">[32640]</a></span>: Update the campus factory to tag v1.0-rc4 <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 17:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32639\">[32639]</a></span>: Changing password file transfer to quite rsync <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 17:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32637\">[32637]</a></span>: Updating to latest campus factory <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 17:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32636\">[32636]</a></span>: Adding condor_utils library to those transferred to remote <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 17:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32635\">[32635]</a></span>: Adding the password file creation to the bosco_cluster <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 16:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32634\">[32634]</a></span>: bosco_start to generate sec password file for campus factory <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 16:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32633\">[32633]</a></span>: Add sending campus factory bits to the remote host <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-06 15:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32632\">[32632]</a></span>: Updating campus factory to commit 1a29de06 <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span> This update improves the logging and the configuration.  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-04 22:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32631\">[32631]</a></span>: Initial add of the campus factory source to the contrib <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span> The campus factory is a light weight glidein factory using the bosco (ssh) capabilities of the cluster.\u00a0[...]\n (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-04 22:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32630\">[32630]</a></span>: Removing obsolete cp command <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-04 20:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32629\">[32629]</a></span>: Fixing install location of campus_factory.conf <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-04 20:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32628\">[32628]</a></span>: Adding campus factory configuration to libexec/campus_factory <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-04 17:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32627\">[32627]</a></span>: Adding local config directory creation and factory config install <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-04 16:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32626\">[32626]</a></span>: Modified bosco_install and cmake lists for campus factory integration <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=2917\" title=\"Add the OSG Campus Factory as a condor contrib\">#2917</a></span>  (By Derek Weitzel )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Aug-04 15:02", "status": "resolved", "created": "2012-Apr-03 16:11", "fixed_version": "2012-Apr-03 16:11", "broken_version": "", "priority": "4", "subsystem": "Grid", "assigned_to": "dweitzel", "derived_from": "", "creator": "dweitzel", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "jfrey@cs.wisc.edu, dweitzel@cse.unl.edu", "due_date": ""}