{"id": 6712, "title": "Ticket #6712: gce_gahp ignores server errors for GCE_INSTANCE_LIST command", "description": "<blockquote>\nWhen an error occurs while executing a GCE_INSTANCE_LIST command, the gce_gahp will return a result stating there are no instances on the GCE server. This is due to a missing return statement after constructing an error result. The code continues as if the request to the server succeeded and overwrites the the error result.\n\n<p>Fermilab encountered this problem when their credentials expired. Subsequently, the gridmanager thought their instances had exited and marked the jobs as completed. When the credentials were later refreshed, the gridmanager deleted the still-active instances as part of cleanup for the \"completed\" jobs.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Jul-12 12:05:15 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>I concur with the analysis and the fix.</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-12 14:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55159\">[55159]</a></span>: Docs for GCE_INSTANCE_LIST error detection bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6712\" title=\"gce_gahp ignores server errors for GCE_INSTANCE_LIST command\">#6712</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-12 10:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55158\">[55158]</a></span>: gce_gahp wasn't reporting errors for GCE_INSTANCE_LIST command. <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=6712\" title=\"gce_gahp ignores server errors for GCE_INSTANCE_LIST command\">#6712</a></span> Add missing return statement. Otherwise, error result is overwritten by bogus success result indicating all instances have exited.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2018-Jul-12 14:19", "status": "resolved", "created": "2018-Jul-12 10:27", "fixed_version": "2018-Jul-12 10:27", "broken_version": "", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "a93221", "customer_group": "fermi", "visibility": "public", "notify": "", "due_date": ""}