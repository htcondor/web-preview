{"id": 1319, "title": "Ticket #1319: Bad -constraint to condor_status returns unhelpful error", "description": "<blockquote>\nAn invalid -constraint option to condor_status returns an unhelpful error message.\n\n<p>Current behavior:\n</p><div class=\"code\">\n<pre class=\"code\">%  condor_status  -constraint 'foo X bar'\nError: communication error\n\n</pre></div>\n\n\n<p>Expected behavior:\n</p><div class=\"code\">\n<pre class=\"code\">%  condor_status  -constraint 'foo X bar'\nError: Invalid constraint\n</pre></div>\n\n\n<p>Probably related: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1363\" title='condor_status -collector broken: \"Error: communication error\"'>#1363</a></span>: condor_status -collector broken: \"Error: communication error\"</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2010-Aug-23 17:42:37 by adesmet:</em> <br/>\n\nBulk change of target version from v070403 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2012-Jun-27 15:01:11 by adesmet:</em> <br/>\n\nMismatched parenthesis may be another useful case to test.  Both of these current (7.8.1) return \"communication error\":\n\n<p></p><div class=\"code\">\n<pre class=\"code\">condor_status -const '(foo'\ncondor_status -const 'foo)'\n</pre></div>\n\n\n<p></p><hr/>\n<em>2012-Jul-19 21:19:02 by santos-g:</em> <br/>\n\nImplemented a working solution for this one, and submitted to NMI.\nI'm afraid that's not the best way to solve the problem, though.\n\n<p></p><hr/>\n<em>2013-May-29 13:45:25 by tannenba:</em> <br/>\n\nNote the below commits are living on branch V7_9-multiple_constraint-branch. They will be code reviewed and merged along with other  patches on this branch as part of <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1156\" title=\"-constraint inconsistent between tools\">#1156</a></span>.\n\n<p></p><hr/>\n<em>2013-Jun-28 13:55:19 by adesmet:</em> <br/>\n\nRan into this problem again, with a user interpreting the error as a bug in HTCondor, when he had actually entered an invalid constraint. He specified JobId=\"14380548.0\" when he meant JobId==\"14380548.0\", an easy mistake to make.\n\n<p></p><hr/>\n<em>2013-Jul-08 16:27:13 by adesmet:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>This is only reviewing <span class=\"chng\"><a href=\"chngview?cn=35949\">[35949]</a></span> AKA f998f2cb, on the theory that the 2012-Jul-19 <span class=\"chng\"><a href=\"chngview?cn=32862\">[32862]</a></span> is a done deal.\n\n</p><p>As best I can tell, the change to <a class=\"file\" href=\"rlog?f=src/condor_daemon_client/daemon_list.cpp\">/src/condor_daemon_client/daemon_list.cpp</a> is stylistic, harmless, and unnecessary, but I'm not going to bounce it on that.\n\n</p><p>Perhaps a brief, \"Improved error messages\" in the version history?\n\n</p><p>No formal objections.  Bouncing back to TJ to make the final determination in case he wants to make changes based on this review, but I'll sign off on marking the ticket as resolved.</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jul-22 10:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36965\">[36965]</a></span>: minor 8.1.0 version history item edit ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1319\" title=\"Bad -constraint to condor_status returns unhelpful error\">#1319</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jul-09 09:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=36806\">[36806]</a></span>: Version History for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1319\" title=\"Bad -constraint to condor_status returns unhelpful error\">#1319</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-30 15:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35949\">[35949]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1319\" title=\"Bad -constraint to condor_status returns unhelpful error\">#1319</a></span>, invalid -constraint to condor_status has wrong error message fix was originally from Guilherme Baptista in a work branch, simplified and committed to mainline by tj ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-19 20:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32862\">[32862]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"tktview?tn=1319\" title=\"Bad -constraint to condor_status returns unhelpful error\">#1319</a></span>) Bad -constraint to condor_status has better error message When a invalid constraint was passed, it would return \"communication error\" but now it returns a more helpful error message indicating the real problem.  (By Guilherme Baptista )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jul-09 09:53", "status": "resolved", "created": "2010-Mar-30 17:26", "fixed_version": "2010-Mar-30 17:26", "broken_version": "v070402", "priority": "3", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "#1156", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}