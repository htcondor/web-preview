<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" type="text/css" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/cvstrac.10.css">
<link rel="stylesheet" type="text/css" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/cvstrac.tj.css">
<link rel="stylesheet" type="text/css" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/diff2html.css">
<link rel="alternate stylesheet"
      title="prosimii-screen"
      type="text/css" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/prosimii-screen.css">
<link rel="alternate stylesheet"
      title="Default Stylesheet"
      type="text/css" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/cvstrac_default.css">
<link rel="alternate" type="application/rss+xml"
   title="HTCondorWiki Timeline Feed" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/timeline.rss">
<link rel="index" title="Index" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/index">
<link rel="search" title="Search" href="https://htcondor-wiki.cs.wisc.edu/index.cgi/search">
<link rel="help" title="Help"
   href="https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=CvstracDocumentation">
<title>HTCondorWiki: Ticket #1361</title>
<script type="text/javascript">
  function setFocus() {
    var firstForm, e;
    if ( document.forms && (firstForm = document.forms[0]) ) {
      if      ( (e = firstForm.elements["u"]) && e.type == "text" ) e.focus();
      else if ( (e = firstForm.elements["t"]) && e.type == "text" ) e.focus();
      else if ( (e = firstForm.elements["s"]) && e.type == "text" ) e.focus();
    }
  }
</script>
</head>
<body onload="setFocus()">
<div id="header">
<div class="midHeader">
<div class="iconHeader">
<a href="https://www.cs.wisc.edu/condor"><img src="https://research.cs.wisc.edu/htcondor/images/HTCondor_wiki_logo_small.png" alt="HTCondor High Throughput Computing" border=0></a>
</div>
</div>
</div><div id="header">
<h1 id="title">
Ticket #1361
</h1>
<p id="identity">
<a href="honeypot"><notatag arg="meaningless"></a>
<a href="login?nxp=/index.cgi/tktview%3Ftn%3D1361" title="Log in">Not logged in</a>
</p>
<ul id="navigation">
<li><a href="dir">Browse</a></li>
<li><a href="wiki?p=CvstracTicket">Help</a></li>
<li><a href="index">Home</a></li>
<li><a href="login">Login</a></li>
<li><a href="reportlist">Reports</a></li>
<li><a href="search?t=1">Search</a></li>
<li><a href="timeline">Timeline</a></li>
<li><a href="wiki">Wiki</a></li>
</ul>
<ul id="action">
<li><a href="tkthistory?tn=1361" rel="nofollow">History</a></li>
</ul>
</div>
<div id="content">
<h2>Ticket #1361: Error reported from execute node incomplete for IWD access failure</h2>
<blockquote>
Note, this bug is also mentioned in:
<a class="external" href="http://condor-wiki.cs.wisc.edu/index.cgi/tktview?tn=1015">http://condor-wiki.cs.wisc.edu/index.cgi/tktview?tn=1015</a>

<p>Description of problem:

<p>A failure to access a job's IWD during execution reports a confusing error
message in the job's <span class="wiki"><a title="Hold Reason"
class="missing"
  href="wiki?p=HoldReason">HoldReason</a></span>.

<p>Version-Release number of selected component (if applicable):

<p>All up to and including condor 7.4.3-0.4

<p>How reproducible:

<p>100%

<p>Steps to Reproduce:
<ol>
<li>2 machine setup: 1) schedd, 2) startd
<li>mkdir /tmp/wontexist
<li>echo -e
&quot;cmd=/bin/true\niwd=/tmp/wontexist\nrequirements=Machine=!=\&quot;$HOSTNAME\&quot;\nqueue&quot;
| condor_submit
<li>let the job go to H[eld] in condor_q
<li>condor_q -l | grep ^HoldReason and observe &quot;Error from slot1@startd-machine:
Failed to execute '/bin/true': No such file or directory
<li>on startd machine look in /var/log/condor/StarterLog.slot1 and observe:
<div class="code">
<pre class="code">
 Create_Process: Cannot access specified cwd "/tmp/wontexist": errno = 2 (No
such file or directory)
 ERROR "Create_Process(/bin/true,, ...) failed: No such file or directory" at
line 530 in file os_proc.cpp
</pre></div>

</ol>

<p>Expected results:

<p>The <span class="wiki"><a title="Hold Reason"
class="missing"
  href="wiki?p=HoldReason">HoldReason</a></span> to include information about access to cwd (say iwd!) failing.</blockquote>

<table align="right" style="margin: 0 10px;" cellpadding=2 border=0>
<tr><td bgcolor="#a0b5f4" class="border1">
<table width="100%" border=0 cellpadding=4 cellspacing=0>
<tr bgcolor="#d0d9f4" class="bkgnd1">
<td valign="top" align="left">
[<a href="tktappend?tn=1361">Append remarks</a>]
</td></tr></table></td></tr></table>
<h3>Remarks:</h3>
<blockquote>
<em>2010-Apr-16 16:12:36 by adesmet:</em> <br>

There is no particular benefit to dragging std::string in; core_daemon_core.* is already using <span class="wiki"><a title="My String"
class="missing"
  href="wiki?p=MyString">MyString</a></span>.

<p>More importantly, you'll overrun the errbuf buffer if strlen(cwd) &gt; 481(ish).  MyString::sprintf will accomplish the same thing in a simpler fashion that avoids the complication of buffer sizes.

<p>In condor_Starter.V6.1/os_proc.cpp: are we guaranteed strerror() never returns anything longer than 500ish bytes?  MyString::sprintf again seems safer.  In particular, if create_process_err_msg is a <span class="wiki"><a title="My String"
class="missing"
  href="wiki?p=MyString">MyString</a></span>, you could use create_process_err_msg.sprintf_cat, eliminating the need for errbuf entirely.

<p><hr>
<em>2010-Jun-01 16:06:24 by adesmet:</em> <br>

&quot;#include &lt;string&gt;&quot; in src/condor_daemon_core.V6/condor_daemon_core.h seems unnecessary, since the code no longer uses std::string.  But otherwise, it looks fine by me.
<hr>
<em>2010-Aug-23 17:42:37 by adesmet:</em> <br>

Bulk change of target version from v070403 to v070404 using ./ticket_target_mover.
<hr>
<em>2010-Oct-27 16:39:01 by adesmet:</em> <br>

Bulk change of target version from v070404 to v070405 using ./ticket-target-mover.
<hr>
Pinging to get this in for 7.6
<hr>
<em>2011-Feb-01 16:08:44 by tannenba:</em> <br>

Bulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>
<table align="right" style="margin: 0 10px;" cellpadding=2 border=0>
<tr><td bgcolor="#a0b5f4" class="border1">
<table width="100%" border=0 cellpadding=4 cellspacing=0>
<tr bgcolor="#d0d9f4" class="bkgnd1">
<td valign="top" align="left">
[<a href="tktappend?tn=1361">Append remarks</a>]
</td></tr></table></td></tr></table>


<h3>Properties:</h3>

<blockquote>
<table>
<tr>
  <td align="right">Type:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>defect&nbsp;</b></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td align="right">Last&nbsp;Change:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>2011-Feb-08 14:57</b></td>
</tr>
<tr>
  <td align="right">Status:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>resolved</b></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td align="right">Created:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>2010-Apr-16 14:51</b></td>
</tr>
<tr>
  <td align="right">Fixed&nbsp;Version:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>v070506&nbsp;</b></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td align="right">Broken&nbsp;Version:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>v070401&nbsp;</b></td>
</tr>
<tr>
  <td align="right">Priority:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>3&nbsp;</b></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td align="right">Subsystem:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>Daemons&nbsp;</b></td>
</tr>
<tr>
  <td align="right">Assigned&nbsp;To:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>eje&nbsp;</b></td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
  <td align="right">Derived From:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>
  &nbsp;
  </b></td>
</tr>
<tr>
  <td align="right">Creator:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>adesmet&nbsp;</b></td>
<td></td>
  <td align="right">Rust:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>&nbsp;</b></td>
</tr>
<tr>
  <td align="right">Customer Group:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>other&nbsp;</b></td>
<td></td>
  <td align="right">Visibility:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>public&nbsp;</b></td>
</tr>
<tr>
  <td align="right">Notify:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>matt@cs.wisc.edu,eje@redhat.com&nbsp;</b></td>
<td></td>
  <td align="right">Due Date:</td>
  <td bgcolor="#d0d0d0" class="bkgnd3"><b>&nbsp;</b></td>
</tr>
</table>
</blockquote>
<h3>Related Check-ins:</h3>
<table cellspacing=0 border=0 cellpadding=0>
<tr><td valign="top" width=160 align="right">2011-Feb-08 14:53</td>
<td valign="top" width=30 align="center">
<span class="icon dot">&nbsp;</span></td>
<td valign="top" align="left"> 
Check-in <span class="chng"><a href="chngview?cn=20332">[20332]</a></span>: Improved <span class="wiki"><a title="Hold Reason"
class="missing"
  href="wiki?p=HoldReason">HoldReason</a></span> when job execution fails to access IWD, <span class="ticket"><a href="tktview?tn=1361" class="resolved"
title="Error reported from execute node incomplete for IWD access failure"
>#1361</a></span> Committer: Matthew Farrellee  (By Erik Erlandson )</td></tr>
</table>
<h3>Attachments:</h3>
<blockquote>
<ul>
<li><a href="attach_get/157/gt_1361.patch">gt_1361.patch</a>
4293 bytes added by eje on 2010-Apr-16 20:24:47 UTC.
<br>
Patch to obtain less ambiguous error info out of Create_Process, particularly in case of IWD access failure, although could also be used in future to also reduce ambiguity from other error returns, as the need arises.<br>
<li><a href="attach_get/159/gt_1361_MyString.patch">gt_1361_MyString.patch</a>
4218 bytes added by eje on 2010-Apr-29 03:10:24 UTC.
<br>
Fix for <span class="ticket"><a href="tktview?tn=1361" class="resolved"
title="Error reported from execute node incomplete for IWD access failure"
>#1361</a></span> using <span class="wiki"><a title="My String"
class="missing"
  href="wiki?p=MyString">MyString</a></span><br>
</ul>
</blockquote>
</div>
</div>
<div id="footer" style="text-align:right">
<p>
This work is supported by NSF under Cooperative Agreement OAC-2030508 as part of the <a href="https://path-cc.io/"> PATh Project</a>. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the NSF. Site built using <a href="about">CVSTrac</a>.
</div>
</body></html>