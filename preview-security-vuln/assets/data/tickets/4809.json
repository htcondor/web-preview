{"id": 4809, "title": "Ticket #4809: Write event to workflow log if all node job submit attempts fail", "description": "<blockquote>\n<span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4727\" onclick=\"get_ticket_and_populate_wrapper('4727'); return false;\" title=\"Submit failures + retries + final node + rescue + recov = hung DAGMan\">#4727</a></span> was caused at least partially by the fact that we don't have any record in the workflow log of all submit attempts failing for a node.  I'm wondering whether we should write a special event in that case so that the workflow log more accurately reflects what actually happened.</blockquote>", "remarks": "<blockquote>\n<em>2015-Jan-11 12:43:20 by wenger:</em> <br/>\n\nIf we do this, I think we can probably take out the code that was put in to fix <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4727\" onclick=\"get_ticket_and_populate_wrapper('4727'); return false;\" title=\"Submit failures + retries + final node + rescue + recov = hung DAGMan\">#4727</a></span>.\n\n<p></p><hr/>\n<em>2015-Jan-20 07:45:09 by wenger:</em> <br/>\n\nNote:  This also assumes that we read and process this event in recovery mode!\n\n<p></p><hr/>\n<em>2015-Jan-22 15:28:58 by wenger:</em> <br/>\n\nJust discussed <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4727\" onclick=\"get_ticket_and_populate_wrapper('4727'); return false;\" title=\"Submit failures + retries + final node + rescue + recov = hung DAGMan\">#4727</a></span> with Zach, and we agreed that implementing an \"all submit attempts failed\" event is cleaner than the solution I have at this point for <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=4727\" onclick=\"get_ticket_and_populate_wrapper('4727'); return false;\" title=\"Submit failures + retries + final node + rescue + recov = hung DAGMan\">#4727</a></span>.\n\n<p></p><hr/>\n<em>2015-Jan-22 16:59:55 by wenger:</em> <br/>\n\nCreated V8_3-gittrac_4809-branch for this.\n\n<p></p><hr/>\n<em>2015-Feb-13 12:24:58 by wenger:</em> <br/>\n\nNote:  The new event type has to be added to the \"In the Job Event Log File\" section in the manual.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-28 16:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/053432c0210f2f839b0ba96f1a9caa5c974ac3f9\">[42457]</a></span>: Gittrac <span class=\"ticket\"><a class=\"active\" href=\"/wiki-archive/tickets/?ticket=4809\" onclick=\"get_ticket_and_populate_wrapper('4809'); return false;\" title=\"Write event to workflow log if all node job submit attempts fail\">#4809</a></span>: job_dagman_gt4727 now works, but I need to make sure what I'm doing is good, and implement it in a cleaner way (the big change is to set _finalNodeRun when we see the submit event for the final node).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-23 17:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fb4fa035c1e20addcc61ac293a8438a7177ab036\">[42366]</a></span>: Gittrac <span class=\"ticket\"><a class=\"active\" href=\"/wiki-archive/tickets/?ticket=4809\" onclick=\"get_ticket_and_populate_wrapper('4809'); return false;\" title=\"Write event to workflow log if all node job submit attempts fail\">#4809</a></span>: We now write the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitsFailedEvent\" title=\"Submits Failed Event\">SubmitsFailedEvent</a></span> even, but for some reason we don't see it in recovery mode (I suspect the log file is not monitored). Lots of other cleanup still needed, too.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-23 14:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e210f004a3f2dbff0311c751c6494613b4de7a96\">[42352]</a></span>: Cleaned up the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=PreSkipEvent\" title=\"Pre Skip Event\">PreSkipEvent</a></span> class (making sure I understand how this works in preparation for making a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitsFailedEvent\" title=\"Submits Failed Event\">SubmitsFailedEvent</a></span> for gittrac <span class=\"ticket\"><a class=\"active\" href=\"/wiki-archive/tickets/?ticket=4809\" onclick=\"get_ticket_and_populate_wrapper('4809'); return false;\" title=\"Write event to workflow log if all node job submit attempts fail\">#4809</a></span>).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-23 10:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a786ad7dbe16858d8350f60ede63fec6dd37b888\">[42342]</a></span>: Fixed a ton of typos in the comments in condor_event.h (found them while creating a new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitsFailedEvent\" title=\"Submits Failed Event\">SubmitsFailedEvent</a></span> class for gittrac <span class=\"ticket\"><a class=\"active\" href=\"/wiki-archive/tickets/?ticket=4809\" onclick=\"get_ticket_and_populate_wrapper('4809'); return false;\" title=\"Write event to workflow log if all node job submit attempts fail\">#4809</a></span>).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-23 10:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/df262502d4072ec48a99654f4e795c2a296069cf\">[42341]</a></span>: Fixed a ton of typos in the comments in condor_event.h (found them while creating a new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubmitsFailedEvent\" title=\"Submits Failed Event\">SubmitsFailedEvent</a></span> class for gittrac <span class=\"ticket\"><a class=\"active\" href=\"/wiki-archive/tickets/?ticket=4809\" onclick=\"get_ticket_and_populate_wrapper('4809'); return false;\" title=\"Write event to workflow log if all node job submit attempts fail\">#4809</a></span>).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-22 16:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5e7bec5fed05a75acadc20fc0fcc1b53a6ded885\">[42331]</a></span>: Gittrac <span class=\"ticket\"><a class=\"active\" href=\"/wiki-archive/tickets/?ticket=4809\" onclick=\"get_ticket_and_populate_wrapper('4809'); return false;\" title=\"Write event to workflow log if all node job submit attempts fail\">#4809</a></span>: Copied the lastest version of the job_dagman_gt4727 test over from V8_2-gittrac_4727-branch, and added it to CMakeLists.txt so it will get run.  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Mar-21 13:53", "status": "active", "created": "2015-Jan-06 13:24", "fixed_version": "2015-Jan-06 13:24", "broken_version": "v080302", "priority": "4", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "#4727", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, zmiller@cs.wisc.edu", "due_date": ""}