{"id": 5091, "title": "Ticket #5091: condor_ping segfault", "description": "<blockquote>\ncondor_ping core dumps if provided with an address/port that does not have a listen posted.  You can easily reproduce like so:\n\n<p></p><pre>   condor_ping -addr \"&lt;www.google.com:9999&gt;\"\n</pre>\n\n<p>I think this bug may have been introduced as part of the big IPv6 merge in commit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b077a09fe63caf1bc729d1a2670d745e1b4c13b1\">[44795]</a></span> which happened for v8.3.6.\n\n</p><p>Should be easy to fix... the segfault occurs in ping.cpp:do_item() on the call to print_info() when sock is NULL :\n</p><div class=\"code\">\n<pre class=\"code\">\tsock = (ReliSock*) d-&gt;makeConnectedSocket( Stream::reli_sock, 0, 0, &amp;errstack );\n\tif (sock) {\n\n\t\tsc_success = d-&gt;startSubCommand(DC_SEC_QUERY, num, sock, 0, &amp;errstack);\n\t\tif (sc_success) {\n\n\t\t\tsock-&gt;decode();\n\t\t\tif (getClassAd(sock, authz_ad) &amp;&amp;\n\t\t\t\tsock-&gt;end_of_message()) {\n\t\t\t\tfn_success = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tprint_info(fn_success, sock-&gt;get_connect_addr(), sock, name, num, &amp;authz_ad, &amp;errstack, output_mode);\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-16 04:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/33be2f6dc266b5b8001e4ccab8fcad99b218a83b\">[45059]</a></span>: Fix segfault in condor_ping when it cannot make a connection. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5091\" onclick=\"get_ticket_and_populate_wrapper('5091'); return false;\" title=\"condor_ping segfault\">#5091</a></span> No version history needed, as this was never released.  (By Zach Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Jun-19 11:08", "status": "resolved", "created": "2015-Jun-11 14:58", "fixed_version": "2015-Jun-11 14:58", "broken_version": "v080306", "priority": "2", "subsystem": "Libs", "assigned_to": "zmiller", "derived_from": "", "creator": "tannenba", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}