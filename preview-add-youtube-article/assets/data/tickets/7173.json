{"id": 7173, "title": "Ticket #7173: Starter stalls after reconnect when streaming IO", "description": "<blockquote>\nA user reports via htcondor-admin that they have seen the Starter stalled for days after the job completes, with the Schedd still showing the job in running state.\n\n<p>The job in question is streaming stdout, and the Starter/Shadow connection experienced a brief disconnection and then reconnected 90 seconds later. (they have a wide area pool).\n\n</p><p>The last lines of stdout are repeated \"a number of times\" presumably because of the reconnect.  The rust ticket has additional logs.\n\n</p><p>They first noticed it with the 8.8.3 release, but say it may have been happening with earlier releases also.\n\n</p><p></p><div class=\"snip\">\n<pre class=\"sniplabel\">from StarterLog.slotN</pre>\n<pre class=\"snip\">07/28/19 02:31:01 (pid:3808) Lost connection to shadow, waiting 7200 secs for reconnect\n07/28/19 02:32:32 (pid:3808) Accepted request to reconnect from &lt;:0&gt;\n07/28/19 02:32:32 (pid:3808) Ignoring old shadow &lt;10.10.4.68:9618?addrs=10.10.4.68-9618&amp;noUDP&amp;sock=6072_9b36_61265&gt;\n07/28/19 02:32:32 (pid:3808) Communicating with shadow &lt;10.10.4.68:9618?addrs=10.10.4.68-9618&amp;noUDP&amp;sock=6072_9b36_61265&gt;\n07/28/19 02:32:32 (pid:3808) Recovered connection to shadow after 91 seconds\n07/28/19 02:32:32 (pid:3808) Streaming i/o handler reconnecting E:\\Jobs\\2017s6767\\2019-07-25\\JFlow9_js88_s506081567_j09a80873-aed3-11e9-9e89-7048860ddf79_out.txt to shadow\n07/28/19 02:32:32 (pid:3808) Retrying streaming write to E:\\Jobs\\2017s6767\\2019-07-25\\JFlow9_js88_s506081567_j09a80873-aed3-11e9-9e89-7048860ddf79_out.txt of 65 bytes at 3150 after reconnect\n</pre></div>\n\n\n<p>The last line above is the last line of the log, 2 days later the slot was still stalled.\n\n</p><p>The pool is a Windows pool, although that may more may not be relevant to the problem.</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2020-Apr-10 07:42:27 by tim:</em> <br/>\n\nBulk change of target version from v080808 to v080809 using ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "todo", "last_change": "2020-Oct-12 10:03", "status": "new", "created": "2019-Jul-30 11:32", "fixed_version": "2019-Jul-30 11:32", "broken_version": "v080803", "priority": "4", "subsystem": "Daemons", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "a98247", "customer_group": "support", "visibility": "public", "notify": "", "due_date": ""}