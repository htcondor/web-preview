<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="/web-preview/preview-add-youtube-article/assets/js/sitewide.js" type="text/javascript" defer></script>
    <script src="/web-preview/preview-add-youtube-article/assets/js/header.js" type="text/javascript" defer></script>
    <script src="/web-preview/preview-add-youtube-article/assets/js/bootstrap.js" type="text/javascript"></script>

    

    

        <meta name="robots" content="noindex">

    

    <link href="/web-preview/preview-add-youtube-article/assets/css/style-v1.css" media="screen, tv, projection" title="Default" rel="stylesheet">
    

    

</head>
<body class="d-flex flex-column">

<!-- For non-visual user agents: -->
<a id="skip-link" href="#main-copy">Skip to main content.</a>


<header id="header" class="">
    <div class="container-xxl">
        <nav id="mobile-header" class="py-3 d-flex d-lg-none navbar navBar navbar-expand-lg navbar-light w-100">
            <a href="/web-preview/preview-add-youtube-article/index.html"><img height="50" alt="Condor High Throughput Computing" src="/web-preview/preview-add-youtube-article/assets/images/HTCondor_red_blk.svg" style="border:0"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobile-navbar" aria-controls="mobile-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mobile-navbar">
                <ul class="navbar-nav mb-2 mb-lg-0 ms-auto mt-auto">
                    
                        




<li class="nav-item dropdown">
    
        <a class="nav-link dropdown-toggle" href="#" id="software-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            Software
        </a>
        <ul class="dropdown-menu" aria-labelledby="software-toggle">
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        HTCondor
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor/overview/">Overview</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor/download/">Download</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor/documentation/">Documentation</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor/release-highlights/">Release Highlights</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor/release-plan/">Release Schedule</a></li>
        
    </ul>
    
</li>
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        HTCondor-CE
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor-ce/overview/">Overview</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor-ce/download/">Download</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor-ce/documentation/">Documentation</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor-ce/release-highlights/">Release Highlights</a></li>
        
    </ul>
    
</li>
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        General
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/new.html">News</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/security/">Security</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/manual/">Documentation</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/downloads/">Download</a></li>
        
    </ul>
    
</li>
            
        </ul>
    
</li>
                    
                        




<li class="nav-item dropdown">
    
        <a class="nav-link dropdown-toggle" href="#" id="help-and-support-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            Help & Support
        </a>
        <ul class="dropdown-menu" aria-labelledby="help-and-support-toggle">
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        Documentation
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor/documentation/">HTCondor</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor-ce/documentation/">HTCondor-CE</a></li>
        
    </ul>
    
</li>
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        Support
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/uw-support/">HTCSS Contract Support</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/mail-lists/#user">Community Mailing List</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/htcondor-support/#external-support-options">External Support Organizations</a></li>
        
    </ul>
    
</li>
            
        </ul>
    
</li>
                    
                        




<li class="nav-item dropdown">
    
        <a class="nav-link dropdown-toggle" href="#" id="community-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            Community
        </a>
        <ul class="dropdown-menu" aria-labelledby="community-toggle">
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        Email Lists
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/mail-lists/#user">Users</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/mail-lists/#world">World</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/mail-lists/#developer">Developers</a></li>
        
    </ul>
    
</li>
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        HTCondor Week
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="https://agenda.hep.wisc.edu/event/1579/">Most Recent</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/past_condor_weeks.html">Content Archives</a></li>
        
            <li><a class="dropdown-item" href="https://youtube.com/playlist?list=PLO7gMRGDPNulf_yK_9Ue6yARxJh0gQXQI">Youtube Playlist  &#11023;</a></li>
        
    </ul>
    
</li>
            
                

<li class="dropdown">
    
    <a class="dropdown-item" href="/web-preview/preview-add-youtube-article/featured-users.html" >
        Featured Users
    </a>
    
</li>
            
        </ul>
    
</li>
                    
                        




<li class="nav-item dropdown">
    
        <a class="nav-link dropdown-toggle" href="#" id="about-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            About
        </a>
        <ul class="dropdown-menu" aria-labelledby="about-toggle">
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        HTCSS
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/description.html">What is HTCSS?</a></li>
        
            <li><a class="dropdown-item" href="/web-preview/preview-add-youtube-article/logos/">Logos</a></li>
        
    </ul>
    
</li>
            
                

<li class="dropdown">
    
    <a class="dropdown-item dropdown-toggle" href="#" id="-toggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        CHTC
    </a>
    <ul class="dropdown-menu" aria-labelledby="-toggle">
        
            <li><a class="dropdown-item" href="https://chtc.cs.wisc.edu/people">Staff &#11023;</a></li>
        
            <li><a class="dropdown-item" href="https://chtc.cs.wisc.edu/jobs">Jobs &#11023;</a></li>
        
            <li><a class="dropdown-item" href="https://chtc.cs.wisc.edu/research">Research & Publications &#11023;</a></li>
        
    </ul>
    
</li>
            
        </ul>
    
</li>
                    
                    <li class="nav-item mt-2">
                        <div style="height:40px; width: 250px;">
                            

<script async src="https://cse.google.com/cse.js?cx=1056a9a876b1d1474"></script>
<div class="gcse-searchbox-only"></div>


                        </div>
                    </li>
                </ul>
            </div>
        </nav>
        <div id="desktop-header" class="d-none d-lg-block">
            <nav class="navbar py-3 navBar navbar-expand-lg navbar-light w-100">
                <a href="/web-preview/preview-add-youtube-article/index.html"><img height="50" alt="Condor High Throughput Computing" src="/web-preview/preview-add-youtube-article/assets/images/HTCondor_red_blk.svg"></a>
                <div class="collapse navbar-collapse">
                    <ul class="navbar-nav mb-2 mb-lg-0 ms-2 mt-auto">
                        
                            



    <li class="nav-item">
        <a class="nav-link drawer-toggle dropdown-toggle" href="#" id="software-desktop-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            Software
        </a>
    </li>




                        
                            



    <li class="nav-item">
        <a class="nav-link drawer-toggle dropdown-toggle" href="#" id="help-and-support-desktop-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            Help & Support
        </a>
    </li>




                        
                            



    <li class="nav-item">
        <a class="nav-link drawer-toggle dropdown-toggle" href="#" id="community-desktop-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            Community
        </a>
    </li>




                        
                            



    <li class="nav-item">
        <a class="nav-link drawer-toggle dropdown-toggle" href="#" id="about-desktop-toggle" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
            About
        </a>
    </li>




                        
                    </ul>
                    <ul class="navbar-nav mb-2 mb-lg-0 ms-auto mt-auto">
                        <li class="nav-item ms-2">
                            <div style="height:40px; width: 250px;">
                                

<script async src="https://cse.google.com/cse.js?cx=1056a9a876b1d1474"></script>
<div class="gcse-searchbox-only"></div>


                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>
    <div id="header-drawer" class=" d-none d-lg-block" hidden>
        <div class="container-xxl">
            <div id="software-desktop-drawer" class="drawer row justify-content-center" hidden>

                





                

                
                
                

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>HTCondor</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/overview/">Overview</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/download/">Download</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/documentation/">Documentation</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/release-highlights/">Release Highlights</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/release-plan/">Release Schedule</a></td></tr>
                
            </table>
        </div>
    

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>HTCondor-CE</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-ce/overview/">Overview</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-ce/download/">Download</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-ce/documentation/">Documentation</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-ce/release-highlights/">Release Highlights</a></td></tr>
                
            </table>
        </div>
    

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>General</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/new.html">News</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/security/">Security</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/manual/">Documentation</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/downloads/">Download</a></td></tr>
                
            </table>
        </div>
    


                <div class="d-none d-lg-block col-lg-4">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column">
                            <h3><a class="text-decoration-none" href="/web-preview/preview-add-youtube-article/news/Software_Integration_Developer/">New Full-Time Position: Software Integration Developer</a></h3>
                            <div>
                                <span class="text-muted">January 28, 2022</span>
                            </div>
                            <hr/>
                            <a href="/web-preview/preview-add-youtube-article/new.html">
                                <div class="row">
                                    <div class="col-auto d-flex">
                                        <img class="my-auto" height="30" src="/web-preview/preview-add-youtube-article/assets/images/arrow-up-right-circle.svg" />
                                    </div>
                                    <div class="col">
                                        View All Software News
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

            </div>
            <div id="help-and-support-desktop-drawer" class="drawer row justify-content-center" hidden>

                
                
                

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>Documentation</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/documentation/">HTCondor</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-ce/documentation/">HTCondor-CE</a></td></tr>
                
            </table>
        </div>
    

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>Support</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/uw-support/">HTCSS Contract Support</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/mail-lists/#user">Community Mailing List</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-support/#external-support-options">External Support Organizations</a></td></tr>
                
            </table>
        </div>
    


            </div>
            <div id="community-desktop-drawer" class="drawer row justify-content-center" hidden>

                






                
                
                

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>Email Lists</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/mail-lists/#user">Users</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/mail-lists/#world">World</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/mail-lists/#developer">Developers</a></td></tr>
                
            </table>
        </div>
    

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>HTCondor Week</th></tr>
                
                    <tr><td><a href="https://agenda.hep.wisc.edu/event/1579/">Most Recent</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/past_condor_weeks.html">Content Archives</a></td></tr>
                
                    <tr><td><a href="https://youtube.com/playlist?list=PLO7gMRGDPNulf_yK_9Ue6yARxJh0gQXQI">Youtube Playlist  &#11023;</a></td></tr>
                
            </table>
        </div>
    

    


                <div class="d-none d-md-block col-lg-4 my-2">
                    <a href="/web-preview/preview-add-youtube-article/featured-users.html"><b>Featured Users</b></a>
                    
                    
                    <div class="my-2">
                        

<a class="text-decoration-none d-block hover-border rounded h-100" href="/web-preview/preview-add-youtube-article/featured-users/2022-02-22-ML-and-Image-Analyses-for-Livestock-Data.html">


    <div class="card border-0 ">
        <div class="p-2 d-flex flex-column">
            <h6 class="text-decoration-none mb-1">
                
            </h6>
            <div>
                <span class="text-muted text-decoration-none">March  2, 2022</span>
            </div>
        </div>
    </div>


</a>

                    </div>
                    
                    <div class="my-2">
                        

<a class="text-decoration-none d-block hover-border rounded h-100" href="/web-preview/preview-add-youtube-article/featured-users/2021-12-16-precision-mental-health.html">


    <div class="card border-0 ">
        <div class="p-2 d-flex flex-column">
            <h6 class="text-decoration-none mb-1">
                Harnessing HTC-enabled precision mental health to capture the complexity of smoking cessation
            </h6>
            <div>
                <span class="text-muted text-decoration-none">December 16, 2021</span>
            </div>
        </div>
    </div>


</a>

                    </div>
                    
                    <div class="my-2">
                        

<a class="text-decoration-none d-block hover-border rounded h-100" href="/web-preview/preview-add-youtube-article/featured-users/2021-11-09-usgs-invasivespecies.html">


    <div class="card border-0 ">
        <div class="p-2 d-flex flex-column">
            <h6 class="text-decoration-none mb-1">
                Protecting ecosystems with HTC
            </h6>
            <div>
                <span class="text-muted text-decoration-none">November  9, 2021</span>
            </div>
        </div>
    </div>


</a>

                    </div>
                    
                    <div class="my-2">
                        

<a class="text-decoration-none d-block hover-border rounded h-100" href="/web-preview/preview-add-youtube-article/featured-users/2021-10-26-bat-genomics.html">


    <div class="card border-0 ">
        <div class="p-2 d-flex flex-column">
            <h6 class="text-decoration-none mb-1">
                80,000 jobs, 40 billion base pairs, and 20 bats –– all in 4 weeks
            </h6>
            <div>
                <span class="text-muted text-decoration-none">October 26, 2021</span>
            </div>
        </div>
    </div>


</a>

                    </div>
                    
                </div>
                <div class="d-none d-xl-block col-xl-4 my-2">
                    <div class="card h-100">
                        <img src="https://raw.githubusercontent.com/CHTC/Articles/main/images/banq-mw.jpg" class="card-img-top" alt="Card Image">
                        <div class="card-body d-flex flex-column">
                            <h5><a class="text-decoration-none" href="/web-preview/preview-add-youtube-article/featured-users/2021-10-26-Banq.html">Centuries of newspapers are now easily searchable thanks to HTCSS</a></h5>
                            <hr/>
                            <a href="/web-preview/preview-add-youtube-article/featured-users.html">
                                <div class="row">
                                    <div class="col-auto d-flex">
                                        <img class="my-auto" height="30" src="/web-preview/preview-add-youtube-article/assets/images/arrow-up-right-circle.svg" />
                                    </div>
                                    <div class="col">
                                        View All Featured Users
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <div id="about-desktop-drawer" class="drawer row justify-content-center" hidden>



                
                
                

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>HTCSS</th></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/description.html">What is HTCSS?</a></td></tr>
                
                    <tr><td><a href="/web-preview/preview-add-youtube-article/logos/">Logos</a></td></tr>
                
            </table>
        </div>
    

    
        <div class="col-auto mx-4 my-2 z-99">
            <table>
                <tr><th>CHTC</th></tr>
                
                    <tr><td><a href="https://chtc.cs.wisc.edu/people">Staff &#11023;</a></td></tr>
                
                    <tr><td><a href="https://chtc.cs.wisc.edu/jobs">Jobs &#11023;</a></td></tr>
                
                    <tr><td><a href="https://chtc.cs.wisc.edu/research">Research & Publications &#11023;</a></td></tr>
                
            </table>
        </div>
    


                <div class="d-none d-lg-block col-lg-4">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column">
                            <h5><a class="text-decoration-none" href="/web-preview/preview-add-youtube-article/description.html">What is HTCSS?</a></h5>
                            <hr class="mb-2">
                            <div>
                                HTCondor Software Suite (HTCSS) provides an array of services for automating
                                and managing batch workloads and computing resources.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<main id="main-copy" tabindex="-1">
    <div class="container-xxl py-4">
    <h1>Excel Jobs</h1>
<div id="content">
 <span class="subsection">
  <h3>
   Introduction
  </h3>
 </span>
 <p>
  There are two approaches to running Excel in HTCondor jobs, one involving the Windows Scripting Host and the other involving embedded VBA code in the Excel workbooks.  The following are examples for either approach.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  COM Automation
 </h3>
 <p>
  HTCondor can be used to run COM automation jobs using the Windows Scripting Host (WSH).  This means, for example, HTCondor can run jobs that automate Microsoft Excel.  What follows is a step-by-step introduction to running Excel 'jobs' in HTCondor.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Configuration
 </h3>
 <p>
  First, you need to create a new administrative user that will be used to run Excel jobs under.  We assume, for convenience, that this account name is
  <strong>
   excel
  </strong>
  .
 </p>
 <p>
  To configure the Excel DCOM object, do the following:
 </p>
 <p>
 </p>
 <ol>
  <li>
   Login to the execute machine as an
   <strong>
    Administrator
   </strong>
   .
  </li>
  <li>
   Click,
   <strong>
    Start
   </strong>
   , click
   <strong>
    Run
   </strong>
   and enter
   <strong>
    dcomcnfg
   </strong>
   .
  </li>
  <li>
   This will bring up the
   <strong>
    Component Services
   </strong>
   window.
  </li>
  <li>
   Click
   <strong>
    Console Root
   </strong>
   , click
   <strong>
    Component Services
   </strong>
   , click
   <strong>
    Computers
   </strong>
   , and finally, click
   <strong>
    DCOM Config
   </strong>
   .
  </li>
  <li>
   Right click on the
   <strong>
    Microsoft Excel Application
   </strong>
   component and select
   <strong>
    Properties
   </strong>
   .
  </li>
  <li>
   In the
   <strong>
    General
   </strong>
   tab, select
   <strong>
    None
   </strong>
   in the
   <strong>
    Authentication Level
   </strong>
   drop-down list.
  </li>
  <li>
   In the
   <strong>
    Identity
   </strong>
   tab, click
   <strong>
    This user
   </strong>
   , and enter the name of the administrative account,
   <strong>
    excel
   </strong>
   , and its password.
  </li>
  <li>
   Click the
   <strong>
    OK
   </strong>
   button.
  </li>
 </ol>
 <p>
  <strong>
   NOTE:
  </strong>
  This will render Excel almost inoperable on this machine for any interactive users.  Also, this has only been tested on Vista; the requirements of any future or past versions of Windows may differ slightly.
 </p>
 <p>
  <strong>
   NOTE:
  </strong>
  If your jobs run as specific users on machines and those users are in the Administrators group the DCOM changes are unnecessary. - ichesal
 </p>
 <p>
  <span class="subsubsection">
  </span>
 </p>
 <h4>
  Windows 2008 Server
 </h4>
 <p>
  In addition to the above DCOM changes it appears that jobs that run under the non-visible desktops in Windows 2008 Server (and possibly Win7 and beyond) need some changes to the default environment their given when the desktop is created. Base on
  <a class="external" href="http://social.msdn.microsoft.com/Forums/en/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91">
   this article
  </a>
  , you need to create the following directories on your machine to get Excel jobs to function properly.
 </p>
 <p>
  <strong>
   Windows 2008 Server 64-Bit
  </strong>
 </p>
 <p>
 </p>
 <pre>   C:\Windows\SysWOW64\config\systemprofile\Desktop
</pre>
 <p>
  <strong>
   Windows 2008 Server 32-Bit
  </strong>
 </p>
 <p>
 </p>
 <pre>  C:\Windows\System32\config\systemprofile\Desktop
</pre>
 <p>
  No restart of the machine or HTCondor is required after making the appropriate directory.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Example
 </h3>
 <p>
 </p>
 <hr/>
 <ul>
  <li>
   <code>
    excel.simple.sub
   </code>
   :
  </li>
 </ul>
 <p>
 </p>
 <pre>  universe     = vanilla
  executable   = excel.simple.vbs
  log          = excel.simple.log.txt
  error        = excel.simple.err.txt
  output       = excel.simple.out.txt
  load_profile = true
  queue 1
</pre>
 <p>
 </p>
 <hr/>
 <ul>
  <li>
   <code>
    excel.simple.vbs
   </code>
   :
  </li>
 </ul>
 <p>
 </p>
 <pre>  On Error Resume Next
</pre>
 <p>
 </p>
 <pre>  WScript.Echo "Creating Excel Application Object"
</pre>
 <p>
 </p>
 <pre>  Set objExcel = CreateObject("Excel.Application")
  Set objBooks = objExcel.Workbooks
</pre>
 <p>
 </p>
 <pre>  WScript.Echo "Creating a Workbook"
</pre>
 <p>
 </p>
 <pre>  Set objWorkbook = objBooks.Add()
</pre>
 <p>
 </p>
 <pre>  WScript.Echo "Generating Data"
</pre>
 <p>
 </p>
 <pre>  For i = 1 to 10
      objExcel.Cells(i, 1).Value = i
  Next
</pre>
 <p>
 </p>
 <pre>  WScript.Echo "Document Filed"
</pre>
 <p>
 </p>
 <pre>  Set objFS = CreateObject("Scripting.FileSystemObject")
  sCurPath  = objFS.GetAbsolutePathName(".")
  sFileName = sCurPath &amp; "\" &amp; "test.xlsx"
</pre>
 <p>
 </p>
 <pre>  objWorkbook.SaveAs(sFileName)
</pre>
 <p>
 </p>
 <pre>  WScript.Echo "Document Saved"
</pre>
 <p>
 </p>
 <pre>  objWorkbook.Close()
</pre>
 <p>
 </p>
 <pre>  WScript.Echo "Document Closed"
</pre>
 <p>
 </p>
 <pre>  objExcel.Quit()
  WScript.Echo "Done"
  WScript.Exit 0
</pre>
 <p>
 </p>
 <hr/>
 <span class="subsection">
  <h3>
   Test Run
  </h3>
 </span>
 <p>
  Let's take a look at what the script returns. First, submit the job:
 </p>
 <p>
 </p>
 <pre>  C:\condor-jobs\scripts&gt;condor_submit excel.simple.sub
  Submitting job(s).
  Logging submit event(s).
  1 job(s) submitted to cluster 77.
</pre>
 <p>
  Once the job has completed, dump the output file:
 </p>
 <p>
 </p>
 <pre>  C:\condor-jobs\scripts&gt;more excel.simple.out.txt
  Microsoft (R) Windows Script Host Version 5.7
  Copyright (C) Microsoft Corporation. All rights reserved.
</pre>
 <p>
 </p>
 <pre>  Creating Excel Application Object
  Creating a Workbook
  Generating Data
  Document Filed
  Document Saved
  Document Closed
  Done
</pre>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Embedded VBA
 </h3>
 <p>
  For people who wish to dispatch an Excel workbook to another machine for calculation, saving, and then closing of Excel and the return of the workbook, a fairly straightforward solution is to use a VBA script and modifying a setting in Excel that one uses to view the workbook's contents. However, because of security features in newer versions of Office, by default Excel does not automatically execute VBA scripts. A pre-job hook must be executed before to modify a registry key setting to disable the security.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Pre-job Hook
 </h3>
 <p>
  On Vista and higher, regedit cannot be used to modify even the user's own registry tree due to regedit triggering UAC upon invocation. An alternative strategy is to create a simple application that directly writes to the registry key mentioned below.
 </p>
 <p>
  On XP, a .reg file can be run using regedit through a batch script. The following reg file is needed. Note that each version of Office has this setting in a slightly different place.
 </p>
 <p>
  office.reg:
 </p>
 <p>
 </p>
 <pre>  Windows Registry Editor Version 5.00
  ;Office 2007
  [HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security]
  "VBAWarnings"=dword:00000001
</pre>
 <p>
  This batch script would serve as the actual pre-job hook.
 </p>
 <p>
  office.bat
 </p>
 <p>
 </p>
 <pre>  C:\windows\regedit.exe /s _hookdirectory_/office.reg
</pre>
 <p>
  Please keep in mind that the bat file must have the absolute path to the .reg file due to the security setup that HTCondor jobs run in, unless the .reg file is sent alongside the job and is in the current execute directory. The full path to regedit is also specified for the same reason, but may not be absolutely necessary.
 </p>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  VBA Script
 </h3>
 <p>
  The embedded VBA is in the actual workbook so instead of calling a script to execute Excel, HTCondor directly calls it.  In this example, the script relies on two settings, Application.Calculation and ActiveWorkbook.ForceFullCalculation.  It checks to see if Calculation is set to xlCalculationAutomatic and
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/ForceFullCalculation/index.html" title="Force Full Calculation">
    ForceFullCalculation
   </a>
  </span>
  is set to True.  If both are true, then it sets
  <span class="wiki">
   <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/ForceFullCalculation/index.html" title="Force Full Calculation">
    ForceFullCalculation
   </a>
  </span>
  to False and Calculation to xlCalculationManual, refreshes and hence forces a recalculation, saves, and then exits the program.
 </p>
 <p>
  To set the script to do the calculations, follow these steps.  These instructions are for Excel 2007.
 </p>
 <p>
 </p>
 <ol>
  <li>
   Open the Excel workbook where the initial calculation needs to be done.
  </li>
  <li>
   Open up the menu by clicking on the globe on the upper left and select Excel Options on the lower right of the menu.
  </li>
  <li>
   Click on the Formulas option on the menu on the left hand side and under Calculation options, change the option to Manual.  You may also wish to uncheck Recalculate workbook before saving.
  </li>
  <li>
   Hit Alt+F11 to access the editor for the VBA script.
  </li>
  <li>
   Open up the file for
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/ThisWorkbook/index.html" title="This Workbook">
     ThisWorkbook
    </a>
   </span>
   by double clicking it in the project window on the left hand side and copy the code listed in the
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/ThisWorkbook/index.html" title="This Workbook">
     ThisWorkbook
    </a>
   </span>
   subsection below.
  </li>
  <li>
   Go to the Insert menu and click Class Module.  In the Properties window, change its name to
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/AppEventClass/index.html" title="App Event Class">
     AppEventClass
    </a>
   </span>
   .  If the Properties window is not visible, hit F4.  Open up the
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/AppEventClass/index.html" title="App Event Class">
     AppEventClass
    </a>
   </span>
   file by double clicking on it in the Project window and copy in the code in
   <span class="wiki">
    <a class="missing" href="/web-preview/preview-add-youtube-article/wiki-archive/pages/AppEventClass/index.html" title="App Event Class">
     AppEventClass
    </a>
   </span>
   subsection below.
  </li>
  <li>
   Save the workbook and close it.  You will be prompted and asked whether the next time the workbook is opened, calculation should take place.  Click Yes if that is your desire and no if you wish to make further modifications later before sending it out for calculation.  However, it should be noted that if you clicked yes, the workbook will calculate and auto-exit the next time you open it, so be certain that you are ready to send it out to HTCondor if you click Yes.
  </li>
 </ol>
 <p>
  <span class="subsection">
  </span>
 </p>
 <h3>
  Example
 </h3>
 <p>
 </p>
 <hr/>
 <ul>
  <li>
   <code>
    excel.embeddedvba.sub
   </code>
   :
  </li>
 </ul>
 <p>
 </p>
 <pre>  universe     = vanilla
  executable   = excel
  log          = excel.embeddedvba.log.txt
  error        = excel.embeddedvba.err.txt
  output       = excel.embeddedvba.out.txt
  load_profile = true
  #Silently start excel without startup screen.
  arguments    = /e filelocation
  queue 1
</pre>
 <p>
 </p>
 <hr/>
 <span class="subsubsection">
  <h4>
   ThisWorkbook
  </h4>
 </span>
 <p>
 </p>
 <pre>  Dim ApplicationClass As New AppEventClass
</pre>
 <p>
 </p>
 <pre>  Private Sub Workbook_Open()
     Set ApplicationClass.Appl = Application
  End Sub
</pre>
 <p>
  <span class="subsubsection">
  </span>
 </p>
 <h4>
  AppEventClass
 </h4>
 <p>
 </p>
 <pre>  Public WithEvents Appl As Application
</pre>
 <p>
 </p>
 <pre>  Dim calculating As Boolean
  Dim answer As VbMsgBoxResult
</pre>
 <p>
 </p>
 <pre>  Private Sub Appl_WorkbookOpen(ByVal Wb As Workbook)
</pre>
 <p>
 </p>
 <pre>      calculating = ActiveWorkbook.ForceFullCalculation
</pre>
 <p>
 </p>
 <pre>      If ActiveWorkbook.ForceFullCalculation = True Then
          ActiveWorkbook.ForceFullCalculation = False
          Application.CalculateFull
          ActiveWorkbook.Save
          Application.Quit
      End If
</pre>
 <p>
 </p>
 <pre>  End Sub
</pre>
 <p>
 </p>
 <pre>  Private Sub Appl_WorkbookBeforeClose(ByVal Wb As Workbook, Cancel As Boolean)
</pre>
 <p>
 </p>
 <pre>      If calculating = False Then
          answer = MsgBox("Calculate on next open?", vbYesNo, "Calculate")
          If answer = vbYes Then
              ActiveWorkbook.ForceFullCalculation = True
          End If
      End If
</pre>
 <p>
 </p>
 <pre>      ActiveWorkbook.Save
</pre>
 <p>
 </p>
 <pre>  End Sub</pre>
</div>

</div>
</main>
<footer id="footer" class="bg-light pt-4 mt-auto">
    <div class="container-xxl">
        <div class="row justify-content-center">
            <div class="col-auto me-4 d-none d-lg-flex">
                <img class="my-auto" height="65" alt="Condor High Throughput Computing" src="/web-preview/preview-add-youtube-article/assets/images/HTCondor_red_blk.svg" />
            </div>
            <div class="col-12 col-sm-10 col-lg-7">
                <div class="row justify-content-between my-2">
                    <div class="col-auto my-2">
                        <table>
                            <tr><th>Suite</th></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor/overview/">HTCondor</a></td></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-ce/overview/">HTCondor-CE</a></td></tr>
                        </table>
                    </div>
                    <div class="col-auto my-2">
                        <table>
                            <tr><th>Software</th></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/manual/">Documentation</a></td></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/downloads/">Download</a></td></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/security//">Security</a></td></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/license.html">License</a></td></tr>
                        </table>
                    </div>
                    <div class="col-auto my-2">
                        <table>
                            <tr><th>Community</th></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/mail-lists/">Email Lists</a></td></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/past_condor_weeks.html">HTCondor Week</a></td></tr>
                        </table>
                    </div>
                    <div class="col-auto my-2">
                        <table>
                            <tr><th>Support</th></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/uw-support/">Internal Contract</a></td></tr>
                            <tr><td><a href="/web-preview/preview-add-youtube-article/htcondor-support#external-support-options">External Organizations</a></td></tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="row my-4 justify-content-center">
            <div class="col-auto d-flex">
                <a class="d-block m-auto" href="https://ls.wisc.edu/">
                    

<div style="height:75px;">
    <picture>
        <source type="image/webp" srcset="/web-preview/preview-add-youtube-article/assets/images/UW_Madison_Logo.webp">
        <img class="h-100" src="/web-preview/preview-add-youtube-article/assets/images/UW_Madison_Logo.png" alt="UW-Madison Logo">
    </picture>
</div>

                </a>
            </div>
            <div class="col-auto d-flex">
                <a class="px-3 d-block m-auto" href="https://www.nsf.org">
                    

<div style="height:100px;">
    <picture>
        <source type="image/webp" srcset="/web-preview/preview-add-youtube-article/assets/images/NSF_Logo.webp">
        <img class="h-100" src="/web-preview/preview-add-youtube-article/assets/images/NSF_Logo.jpg" alt="NSF Logo">
    </picture>
</div>

                </a>
            </div>
            <div class="col-auto d-flex">
                <a class="d-block m-auto" href="https://morgridge.org/">
                    <img class="" height="40" src="/web-preview/preview-add-youtube-article/assets/images/Morgridge_Logo.svg" alt="Morgridge Logo" />
                </a>
            </div>
        </div>
        <hr>
        <div class="row py-3">
            <div class="col text-center">
                For comments or questions about this website, please email
                <a href="mailto:htcondor-admin@cs.wisc.edu">htcondor-admin@cs.wisc.edu</a><br />
                This work is supported by <a href="https://www.nsf.gov/div/index.jsp?div=OAC">NSF</a> under Cooperative Agreement <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">OAC-2030508</a> as part of the <a href="https://path-cc.io/">PATh Project</a>. <br />
            </div>
        </div>
        <div class="row justify-content-center pb-4">
            <div class="col-lg-8 text-center">
                <span class="text-center">
                    If you are looking for Phoenix Software International's software development and library management system for z/VSE or z/OS, you can find more information on their <a href="http://www.phoenixsoftware.com">website</a>.
                </span>
            </div>
        </div>
    </div>
</footer>



</body>
</html>
