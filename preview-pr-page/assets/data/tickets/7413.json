{"id": 7413, "title": "Ticket #7413: GPU attribute improvements", "description": "<blockquote>\n<ol>\n<li>Jettison the CUDA runtime version attribute.\n</li><li>Add better-named attribute (duplicating <code>DriverVersion</code>) for the max version of the CUDA runtime supported by the driver.\n</li><li>Add a submit command, something like but not actually <code>request_cuda_version</code>, which edits the <code>requirements</code> expression appropriately.\n</li><li>Talk to ????, our GPU-jobs-on-SLURM friends, to check our assumptions, and see if they have anything useful to say about our proposed solution.\n</li></ol>\n\n<p></p><hr/>\nMaybe <code>require_cuda_version</code>, or <code>require_at_least_cuda_version</code>?</blockquote>", "remarks": "<blockquote>\n<em>2020-Feb-18 13:37:25 by tlmiller:</em> <br/>\n\nImplemented points 1 and 2 on master.  It seems like we shouldn't release point 3 until we're sure we have a good name for it, so that I pushed off into a branch.\n\n<p></p><hr/>\n<em>2020-Feb-18 14:09:27 by tlmiller:</em> <br/>\n\nCurrently implemented as \"required_cuda_version\".  Mat suggests \"CUDAVersion\" (or CUDA_Version, really, I guess), which has the benefit of being nice and simple, as well as descriptive; I wonder if it would be more or less confusing to mention the 'RT' part of what's actually going on, especially considering how we don't want to get into providing the libraries.\n\n<p></p><hr/>\n<em>2020-Feb-19 15:47:43 by tlmiller:</em> <br/>\n\nConsensus after polling is \"cuda_version\":\n\n<p></p><ul>\n<ol>\n<li>We'd like a submit-file command to deal with CUDAMaxSupportedVersion rather than explain the conversion from the string '8.1' to the integer 8001 (or, worse, why floating-point comparison don't always work).\n</li><li>Having a submit-file command will allow us to enforce the convention that the job have attribute which is used in the requirements expression; this allows things like job transforms to be constructed much more easily.\n</li><li>If NVidia's drivers ever drop support for older version of the CUDA runtime, we can adjust the constructed requirements expression to match (rather than have the user change their jobs).  This point also argues against being specific about which comparison will be used to do match-making.\n</li><li>\"cuda_version\" is nice and short, and although it's maybe a little vague, that's sometimes helpful in these situations; it also sounds more like a description of the job rather than a description of its requirements, which I think is something we want.\n</li></ol>\n</ul>\n\n<p></p><hr/>\n<em>2020-Feb-19 15:48:04 by tlmiller:</em> <br/>\n\nAlso, <code>cuda_version</code> should accept both the x.y format and the x000y format.\n<hr/>\n<em>2020-Apr-10 07:46:37 by tim:</em> <br/>\n\nBulk change of target version from v080906 to v080907 using ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-22 13:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4ae73f4b7cfc5d4d9c7808fb91853ebec5241d51\">[59018]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Documentation.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-22 13:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eff5dc3c5f03f1ca4c268c292f716d8e80ceb575\">[59017]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Needs to be CUDAMaxSupportedVersion, not MaxSupportedCUDAVersion, sadly.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-20 15:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a2bd2176e1d55a548962ea3093401880c8efd491\">[58991]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Eliminate a pair of warnings.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-20 15:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/31c6583730448ada6272d0ef486f16bc9392a37f\">[58990]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Allow cuda_version to be: (a) &lt;major&gt;, (b) &lt;major&gt;.&lt;minor&gt;, or (c) &lt;major * 1000 + minor % 100&gt;.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-19 16:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/be82d6d145f9335ba4b2b74fac34de354351cf20\">[58989]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Use 'cuda_version' for the submit-file command, instead.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-18 13:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/95d22d6716c702f983114443517137797225b7c4\">[58974]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Add submit command provisionally named 'required_cuda_version' which accepts a string of the form 'x.y' where x and y are positive integers, and adds a requirement that this version be &lt;= the max cuda version advertised by the machine.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-18 13:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ec63099bd912bcc2bfc0af9888fe53110a4b8c36\">[58973]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7413\" onclick=\"get_ticket_and_populate_wrapper('7413'); return false;\" title=\"GPU attribute improvements\">#7413</a></span>) Remove \"<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RuntimeVersion\" title=\"Runtime Version\">RuntimeVersion</a></span>\" attribute. Duplicate \"<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DriverVersion\" title=\"Driver Version\">DriverVersion</a></span>\" attribute into \"MaxSupportedCUDAVersion\".  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Apr-10 07:46", "status": "resolved", "created": "2019-Dec-04 17:08", "fixed_version": "2019-Dec-04 17:08", "broken_version": "", "priority": "3", "subsystem": "DaemonsExecNode", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu, johnkn@cs.wisc.edu, bbockelman@morgridge.org", "due_date": ""}