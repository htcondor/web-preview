{"id": 322, "title": "Ticket #322: Allow administrators to add arbitrary attributes to submittor ads", "description": "<blockquote>\nThis is for the Archer project, but I think it may be of general interest. It would be nice if the administrators could add arbitrary attributes to the submitter ads sent to the Collector.  In turn the Collector could push them into the history files consumed by condor_stats.\n\n<p>Initially these additional fields would only be displayed in condor_stats output when the -orgformat flag is used, but could later be further integrated into the tool such that a user could actually define the fields they wanted displayed.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Mar-12 15:23:38 by burnett:</em> <br/>\n\nTwo changes are needed for this:\n\n<p>1) Add the attributes to the ad in <code>Scheduler::count_jobs()</code> (<code>condor_schedd.V6\\schedd.cpp</code>) and to the <code>OwnerData</code> struct (<code>condor_schedd.V6\\scheduler.h</code>).\n\n</p><p>2) Modify <code>ViewServer::WriteHistory()</code> (<code>condor_collector.V6\\view_server.cpp</code>) to allow more than 8 fields to be printed, but preserve the existing order, only add the extra attributes to the end.\n\n</p><p></p><hr/>\n<em>2009-Apr-09 15:48:10 by burnett:</em> <br/>\n\nAdded a list, <code>SUBMITTOR_AD_ATTRS</code>, which the schedd will use to append to the submitter ad.\n\n<p></p><hr/>\n<em>2009-Apr-09 16:32:34 by matt:</em> <br/>\n\n<code>void update_submitter_ad_attrs ( <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> &amp;ad );</code>\n\n<p>Isn't this function duplicated in a bunch of places now?\n\n</p><p><code>&lt;SUBSYS&gt;_ATTRS</code>, <code>STARTD_SLOT_ATTRS</code>, <code>SUBMIT_EXPRS</code>, <code>EVENT_LOG_JOB_AD_INFORMATION_ATTRS</code>\n\n</p><p>Could you break it out into a util?\n\n</p><p></p><hr/>\n<em>2009-Apr-09 18:06:40 by burnett:</em> <br/>\n\nIt's designed with <span class=\"quote\">CondorView</span> and <code>condor_analyze</code> in mind for very specialized use.  Sure I could generalize it, but this does what we need, and there has been no call, to my knowledge, to be able to retrive more data with <code>condor_analyze</code>.  Correct me if I'm wrong.\n\n<p></p><hr/>\n<em>2009-Apr-09 22:09:54 by matt:</em> <br/>\n\nI took a second look - weird, why do you evaluate the expressions? That seems different from all other <code>..._ATTRS</code>.\n\n<p>The <code>update_submitter_ad_attrs</code> function looks almost to have been copied from a slightly more generic <code>config_fill_ad</code> in condor_config.cpp - <code>reqdExprs</code> is a strange arg name to duplicate.\n\n</p><p></p><hr/>\n<em>2009-Apr-10 11:17:29 by burnett:</em> <br/>\n\nIt was written from scratch, it is simply made to extract specific class ad fields and populate the submittor ad with them.  If you have a better name in mind, by all means, please suggest one.\n\n<p></p><hr/>\n<em>2009-Apr-10 11:20:50 by burnett:</em> <br/>\n\nNeverminf, I think the original one in the source was a copy, as you say, but it has since been re-written, but I've probably not pushed any changes.\n\n<p></p><hr/>\n<em>2009-Oct-21 15:39:05 by psilord:</em> <br/>\n\nBen Burnett has left the Condor Project. This ticket is being unassigned.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2009-Dec-26 21:26", "status": "abandoned", "created": "2009-Mar-12 14:48", "fixed_version": "2009-Mar-12 14:48", "broken_version": "v070301", "priority": "2", "subsystem": "Daemons", "assigned_to": "", "derived_from": "", "creator": "burnett", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu,roy@cs.wisc.edu", "due_date": ""}