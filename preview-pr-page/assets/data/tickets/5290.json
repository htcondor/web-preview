{"id": 5290, "title": "Ticket #5290: output of condor_q -analyze is often misleading or wrong", "description": "<blockquote>\nThe last clause of the condor_q -analyze output (the part that sometimes has suggestions) doesn't properly analyze complex requirements expressions.  Because of that it is sometimes flat out wrong about how many matches there are.\n\n<p>It's suggestions are occasionally useful, but usually unhelpful suggestions like\nChange <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=OpSys\" title=\"Op Sys\">OpSys</a></span> to LINUX or <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=OpSysAndVer\" title=\"Op Sys And Ver\">OpSysAndVer</a></span> to RedHat7.\n\n</p><p>it's useful output is usually redundant to the clauses above it.\n\n</p><p>So it should be removed from the default output of condor_q -analyze and printed out only when reguested (perhaps condor_q -analyze:suggest?).\n\n</p><p>Also some effort should be made to fix the brokenness.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Oct-31 09:23:24 by johnkn:</em> <br/>\n\ncommit <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fc4dd859ae9671933003e7cd1c7bd6a76cf00cea\">[49351]</a></span> removes the suggestions clause from condor_q -better-analyze and moves the counts of counts matching machines to the bottom of the output, like this:\n\n<p></p><div class=\"verbatim\">\n<pre>-- Schedd: user@machine.cs.wisc.edu : &lt;128.128.128.32:6909?...\nThe Requirements expression for job 379.000 is\n\n    ( TARGET.Arch == \"X86_64\" ) &amp;&amp; ( TARGET.OpSys == \"WINDOWS\" ) &amp;&amp; ( TARGET.Disk &gt;= RequestDisk ) &amp;&amp;\n    ( TARGET.Memory &gt;= RequestMemory ) &amp;&amp; ( ( TARGET.HasFileTransfer ) ||\n      ( TARGET.FileSystemDomain == MY.FileSystemDomain ) )\n\nJob 379.000 defines the following attributes:\n\n    DiskUsage = 4\n    FileSystemDomain = \"machine.cs.wisc.edu\"\n    ImageSize = 4\n    RequestDisk = DiskUsage\n    RequestMemory = ifthenelse(MemoryUsage =!= undefined,MemoryUsage,( ImageSize + 1023 ) / 1024)\n\nThe Requirements expression for job 379.000 reduces to these conditions:\n\n         Slots\nStep    Matched  Condition\n-----  --------  ---------\n[0]           0  TARGET.Arch == \"X86_64\"\n[1]           0  TARGET.OpSys == \"WINDOWS\"\n[3]           0  TARGET.Disk &gt;= RequestDisk\n[5]           0  TARGET.Memory &gt;= RequestMemory\n[7]           0  TARGET.HasFileTransfer\n\n\n379.000:  Job is held.\n\nHold reason: submitted on hold at user's request\n\n\n379.000:  Run analysis summary ignoring user priority.  Of 0 machines,\n      0 are rejected by your job's requirements\n      0 reject your job because of their own requirements\n      0 match and are already running your jobs\n      0 match but are serving other users\n      0 are available to run your job\n\nWARNING:  Be advised:\n   No machines matched the jobs's constraints\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-23 16:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1f4ad02a93a135c2ac9515c3824cc64b6ccbe136\">[49644]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5290\" onclick=\"get_ticket_and_populate_wrapper('5290'); return false;\" title=\"output of condor_q -analyze is often misleading or wrong\">#5290</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5805\" onclick=\"get_ticket_and_populate_wrapper('5805'); return false;\" title=\"Create a tool to do generic classad transforms and pretty printing\">#5805</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6018\" onclick=\"get_ticket_and_populate_wrapper('6018'); return false;\" title=\"add join function to classads to complement split\">#6018</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5889\" onclick=\"get_ticket_and_populate_wrapper('5889'); return false;\" title=\"condor_qedit and other tools should hondor CONDOR_Q_ONLY_MY_JOBS\">#5889</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5416\" onclick=\"get_ticket_and_populate_wrapper('5416'); return false;\" title=\"master should have a command to query (and wait for) child readiness\">#5416</a></span>, and doc for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6018\" onclick=\"get_ticket_and_populate_wrapper('6018'); return false;\" title=\"add join function to classads to complement split\">#6018</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Sep-29 17:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fc4dd859ae9671933003e7cd1c7bd6a76cf00cea\">[49351]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5290\" onclick=\"get_ticket_and_populate_wrapper('5290'); return false;\" title=\"output of condor_q -analyze is often misleading or wrong\">#5290</a></span>, condor_q -analyze output is often misleading or wrong. This commit removes the suggestions clause, as that was the bit that was sometimes wrong. It moves the totals to the bottom of the output and changes the wording a bit. And it evaluates local and scheduler universe jobs using the appropriate\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Nov-23 16:14", "status": "resolved", "created": "2015-Oct-02 14:43", "fixed_version": "2015-Oct-02 14:43", "broken_version": "v080400", "priority": "3", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "#4976", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}