{"id": 4911, "title": "Ticket #4911: Schedd cannot start shadows in mixed mode.", "description": "<blockquote>\nThe schedd starts shadows without a UDP port (since it's unnecessary and our C++ wrapper is huge).  The mixed-mode code that ensures that the port number matches between protocols as a result requests a specific IPv6 TCP port and a dynamic UDP port, plus no UDP port.  This combination causes the lower-level code grief.  The interface should be fixed, but for now I'm just working to make the lower-level code not lose it when this situation comes up.</blockquote>", "remarks": "<blockquote>\n<em>2015-Mar-24 11:18:29 by adesmet:</em> <br/>\n\n<strong>Code Review:</strong> Approved.\n\n<p>There are a few small tweaks I'd like to make,but nothing essential (and nothing that should impact behavior). I'll just make them and attach to this ticket.\n\n</p><p></p><hr/>\n<em>2015-Mar-24 11:42:56 by adesmet:</em> <br/>\n\n3 small changes made. 2 just change comments. 1 slightly simplifies some code.  ToddM: could you give them a quick once over to ensure I didn't do something stupid?  If they're good, close the ticket and call it a day.\n\n<p></p><hr/>\n<em>2015-Jun-03 15:18:48 by tlmiller:</em> <br/>\n\nThe actual fix appears to have gone into 8.3.5.  On TJ's advice, retroactively changing the 8.3.5 version history on the 8.3.6 branch (and updating this ticket); do we need to mention this change in the 8.3.6 version history section, or move it to there?</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-05 11:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/841e1379320fa8465a4fc6733c49b5f68509ed3e\">[44984]</a></span>: replicate version history item in the 8.3.6 version history, since it never appeared in the 8.3.5 version history upon release of 8.3.5 <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-03 15:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/96741b40ce101c6d2eecedcd8db456eb490c177c\">[44950]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>) Version history.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-24 11:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8a4bb040a04539f7642fca0683589bbea3460d02\">[43688]</a></span>: Restore comment <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span> Explain why we disable Nagle; it was noted in the earlier, replaced version.  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-24 11:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3ebdb806f8a9b2d0f71e9bc6b03d17c619b18e1e\">[43687]</a></span>: Eliminate unnecessary variable; simplify code. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-24 11:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a85f2380fe783a7384576063bea228329a3eb546\">[43686]</a></span>: Fix comment typo. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-05 14:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3c8a2896aefbe627da4b5c22ae4ef0a02699ba96\">[43526]</a></span>: Revert on 8.3.4 branch \"(<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>) Let the schedd start shadows in mixed mode.\" This reverts commit 216287ec3f10606b9fa099b9d715b03465bb6745.  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-05 14:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4905c0aab0623118f5ec41a6d6cf327cb422fd4b\">[43525]</a></span>: Revert on 8.3.4 branch \"(<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>) Make the comments less stupid.\" This reverts commit 931d706a641a1f0a160346213a2b14f94ead04f2.  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-05 11:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/abcfec6de95366ada2902620bc84abcc52bf4059\">[43523]</a></span>: add known issue to 8.3.4 version history <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-04 14:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/93e5d3f184d48151b2bb45831541d364e87d6135\">[43511]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>) When submitting a test for 64-bit <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RedHat\" title=\"Red Hat\">RedHat</a></span> 6, also submit a mixed-mode test for that platform.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-02 14:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/931d706a641a1f0a160346213a2b14f94ead04f2\">[43485]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>) Make the comments less stupid.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-02 14:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/216287ec3f10606b9fa099b9d715b03465bb6745\">[43484]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4911\" onclick=\"get_ticket_and_populate_wrapper('4911'); return false;\" title=\"Schedd cannot start shadows in mixed mode.\">#4911</a></span>) Let the schedd start shadows in mixed mode.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Jun-03 15:19", "status": "resolved", "created": "2015-Feb-24 10:25", "fixed_version": "2015-Feb-24 10:25", "broken_version": "v080303", "priority": "1", "subsystem": "DaemonsSubmitNode", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}