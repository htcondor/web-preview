{"id": 3156, "title": "Ticket #3156: IMPOSSIBLE: status for job", "description": "<blockquote>\nStuart just reported another occurrence of the \"IMPOSSIBLE: status for job\" schedd crash at LIGO Caltech.\n\n<p>According to my email archives we have seen this a few times over the years possibly related to tickets s1652, a17748, and Juan's email on 6 June 2012 that ended up sending logs to Greg Thain.\n\n</p><p></p><div class=\"verbatim\">\n<pre>[root@ldas-pcdev4 ~]# cat /etc/redhat-release\nScientific Linux release 6.1 (Carbon)\n\n[root@ldas-pcdev4 ~]# uname -a\nLinux ldas-pcdev4 2.6.32-220.13.1.el6.x86_64 #1 SMP Tue Apr 17 15:16:22 CDT 2012 x86_64 x86_64 x86_64 GNU/Linux\n\n[root@ldas-pcdev4 ~]# condor_version\n$CondorVersion: 7.8.1 Jun 08 2012 $\n$CondorPlatform: x86_64_rhap_6.2 $\n\nThis is an automated email from the Condor system\non machine \"ldas-pcdev4.ligo.caltech.edu\".  Do not reply.\n\n\"/usr/sbin/condor_schedd\" on \"ldas-pcdev4.ligo.caltech.edu\" exited with status 4.\nCondor will automatically restart this process in 10 seconds.\n\n*** Last 20 line(s) of file /var/log/condor/SchedLog:\n07/23/12 09:34:23 (pid:27383) Return from HandleReq &lt;attempt_access_handler&gt; (handler: 0.000s, sec: 0.000s, payload: 0.000s)\n07/23/12 09:34:23 (pid:27383) Received TCP command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:43573&gt;, access level WRITE\n07/23/12 09:34:23 (pid:27383) Calling HandleReq &lt;attempt_access_handler&gt; (0) for command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:43573&gt;\n07/23/12 09:34:23 (pid:27383) Return from HandleReq &lt;attempt_access_handler&gt; (handler: 0.000s, sec: 0.000s, payload: 0.000s)\n07/23/12 09:34:23 (pid:27383) Received UDP command 421 (RESCHEDULE) from  &lt;10.14.0.39:32878&gt;, access level WRITE\n07/23/12 09:34:23 (pid:27383) Calling HandleReq &lt;reschedule_negotiator&gt; (0) for command 421 (RESCHEDULE) from unauthenticated@unmapped &lt;10.14.0.39:32878&gt;\n07/23/12 09:34:23 (pid:27383) Return from HandleReq &lt;reschedule_negotiator&gt; (handler: 0.070s, sec: 0.000s, payload: 0.000s)\n07/23/12 09:34:23 (pid:27383) Calling Handler &lt;DaemonCore::HandleReqPayloadReady&gt; (5)\n07/23/12 09:34:23 (pid:27383) Calling HandleReq &lt;handle_q&gt; (0) for command 1112 (QMGMT_WRITE_CMD) from eahuerta@ligo &lt;10.14.0.39:54988&gt;\n07/23/12 09:34:23 (pid:27383) Return from HandleReq &lt;handle_q&gt; (handler: 0.075s, sec: 0.001s, payload: 0.077s)\n07/23/12 09:34:23 (pid:27383) Return from Handler &lt;DaemonCore::HandleReqPayloadReady&gt; 0.0749s\n07/23/12 09:34:23 (pid:27383) Calling Handler &lt;DaemonCore::HandleReqPayloadReady&gt; (6)\n07/23/12 09:34:23 (pid:27383) Calling HandleReq &lt;handle_q&gt; (0) for command 1112 (QMGMT_WRITE_CMD) from eahuerta@ligo &lt;10.14.0.39:50845&gt;\n07/23/12 09:34:23 (pid:27383) Return from HandleReq &lt;handle_q&gt; (handler: 0.071s, sec: 0.001s, payload: 0.149s)\n07/23/12 09:34:23 (pid:27383) Return from Handler &lt;DaemonCore::HandleReqPayloadReady&gt; 0.0715s\n07/23/12 09:34:23 (pid:27383) TransferQueueManager stats: active up=0/10 down=0/10; waiting up=0 down=0; wait time up=0s down=0s\n07/23/12 09:34:23 (pid:27383) Sent ad to central manager for eahuerta@ligo\n07/23/12 09:34:23 (pid:27383) Sent ad to 1 collectors for eahuerta@ligo\n07/23/12 09:34:23 (pid:27383) Failed to send RESCHEDULE to negotiator virgo-pilot-server.kfki.hu:\n07/23/12 09:34:23 (pid:27383) ERROR \"IMPOSSIBLE: status for job 122703.0 is COMPLETED but we're trying to start a shadow for it!\" at line 6524 in file /slots/04/dir_14970/userdir/src/condor_schedd.V6/schedd.cpp\n*** End of file SchedLog\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2012-Jul-23 15:41:01 by pfc:</em> <br/>\n\nThis particular issue just occurred again on the same submit machine, i.e.,\n\n<p></p><div class=\"verbatim\">\n<pre>This is an automated email from the Condor system\non machine \"ldas-pcdev4.ligo.caltech.edu\".  Do not reply.\n\n\"/usr/sbin/condor_schedd\" on \"ldas-pcdev4.ligo.caltech.edu\" exited with status 4.\nCondor will automatically restart this process in 10 seconds.\n\n*** Last 20 line(s) of file /var/log/condor/SchedLog:\n07/23/12 13:12:27 (pid:29743) Received TCP command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:43278&gt;, access level WRITE\n07/23/12 13:12:27 (pid:29743) Calling HandleReq &lt;attempt_access_handler&gt; (0) for command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:43278&gt;\n07/23/12 13:12:27 (pid:29743) Return from HandleReq &lt;attempt_access_handler&gt; (handler: 0.001s, sec: 0.000s, payload: 0.000s)\n07/23/12 13:12:27 (pid:29743) Received TCP command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:46050&gt;, access level WRITE\n07/23/12 13:12:27 (pid:29743) Calling HandleReq &lt;attempt_access_handler&gt; (0) for command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:46050&gt;\n07/23/12 13:12:27 (pid:29743) Return from HandleReq &lt;attempt_access_handler&gt; (handler: 0.001s, sec: 0.000s, payload: 0.000s)\n07/23/12 13:12:27 (pid:29743) Received TCP command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:53592&gt;, access level WRITE\n07/23/12 13:12:27 (pid:29743) Calling HandleReq &lt;attempt_access_handler&gt; (0) for command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:53592&gt;\n07/23/12 13:12:27 (pid:29743) Return from HandleReq &lt;attempt_access_handler&gt; (handler: 0.000s, sec: 0.000s, payload: 0.000s)\n07/23/12 13:12:27 (pid:29743) Received TCP command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:42080&gt;, access level WRITE\n07/23/12 13:12:27 (pid:29743) Calling HandleReq &lt;attempt_access_handler&gt; (0) for command 464 (ATTEMPT_ACCESS) from unauthenticated@unmapped &lt;10.14.0.39:42080&gt;\n07/23/12 13:12:27 (pid:29743) Return from HandleReq &lt;attempt_access_handler&gt; (handler: 0.000s, sec: 0.000s, payload: 0.000s)\n07/23/12 13:12:27 (pid:29743) Received UDP command 421 (RESCHEDULE) from  &lt;10.14.0.39:38330&gt;, access level WRITE\n07/23/12 13:12:27 (pid:29743) Calling HandleReq &lt;reschedule_negotiator&gt; (0) for command 421 (RESCHEDULE) from unauthenticated@unmapped &lt;10.14.0.39:38330&gt;\n07/23/12 13:12:28 (pid:29743) Return from HandleReq &lt;reschedule_negotiator&gt; (handler: 0.053s, sec: 0.000s, payload: 0.000s)\n07/23/12 13:12:28 (pid:29743) TransferQueueManager stats: active up=0/10 down=0/10; waiting up=0 down=0; wait time up=0s down=0s\n07/23/12 13:12:28 (pid:29743) Sent ad to central manager for eahuerta@ligo\n07/23/12 13:12:28 (pid:29743) Sent ad to 1 collectors for eahuerta@ligo\n07/23/12 13:12:28 (pid:29743) Failed to send RESCHEDULE to negotiator virgo-pilot-server.kfki.hu:\n07/23/12 13:12:28 (pid:29743) ERROR \"IMPOSSIBLE: status for job 123655.0 is COMPLETED but we're trying to start a shadow for it!\" at line 6524 in file /slots/04/dir_14970/userdir/src/condor_schedd.V6/schedd.cpp\n*** End of file SchedLog\n</pre></div>\n\n\n<p></p><hr/>\n<em>2012-Oct-03 09:46:19 by gthain:</em> <br/>\n\nWould it be possible to get the logs for a recent occurrence?  We fixed one cause of IMPOSSIBLE: status for job in 7.7, so I'd like to see if this is a regression, or a different code path.\n\n<p></p><hr/>\n<em>2012-Oct-09 11:19:47 by gthain:</em> <br/>\n\nThis is caused by a race condition with NOOP jobs.  That is, jobs (usually submitted by DAGman) that set\n\n<p></p><div class=\"code\">\n<pre class=\"code\">noop_job = true\n</pre></div>\n\n\n<p>In rare cases, with a heavily loaded schedd, the code that marks these jobs complete (without running them) gets delayed, and another part of the schedd doesn't know about Noop_jobs, and tries to run them, which causes this problem.\n\n</p><p>Until the code for this lands, setting Requirements = false in these jobs should work around the problem.\n\n</p><p></p><hr/>\n<em>2012-Oct-15 14:56:04 by nwp:</em> <br/>\n\n<strong>CODE REVIEW</strong> Looks fine to me.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-09 14:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6617354c314ccc76d67d99afd0390a5b9acfcd26\">[33625]</a></span>: Removed 7.8.6 version history item for <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=3156\" onclick=\"get_ticket_and_populate_wrapper('3156'); return false;\" title=\"IMPOSSIBLE: status for job\">#3156</a></span>, as this bug fix has be placed into 7.8.5.  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-09 14:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/97b9a433d225992c2713c297fcf3ce1837e46808\">[33623]</a></span>: Rewrite of bug fix version history item that was originally committed for 7.8.6, but now in 7.8.5. ===GT=== <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=3156\" onclick=\"get_ticket_and_populate_wrapper('3156'); return false;\" title=\"IMPOSSIBLE: status for job\">#3156</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-09 12:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7f53bfc30aef343f49479a9b4d9a73e3fafad115\">[33616]</a></span>: Prevent noop job race from asserting the schedd <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=3156\" onclick=\"get_ticket_and_populate_wrapper('3156'); return false;\" title=\"IMPOSSIBLE: status for job\">#3156</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-09 11:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/54dccd479b80bb385c4daac24982d116bd4a62a8\">[33613]</a></span>: Document <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=3156\" onclick=\"get_ticket_and_populate_wrapper('3156'); return false;\" title=\"IMPOSSIBLE: status for job\">#3156</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-09 11:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/568b41b2ffea44c668b61353c404f1355ed47cdc\">[33611]</a></span>: Prevent noop job race from asserting the schedd <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=3156\" onclick=\"get_ticket_and_populate_wrapper('3156'); return false;\" title=\"IMPOSSIBLE: status for job\">#3156</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Aug-04 12:09", "status": "defer", "created": "2012-Jul-23 14:10", "fixed_version": "2012-Jul-23 14:10", "broken_version": "v070801", "priority": "5", "subsystem": "Daemons", "assigned_to": "gthain", "derived_from": "", "creator": "pfc", "rust": "a17748", "customer_group": "ligo", "visibility": "public", "notify": "pfcouvar@syr.edu, anderson@ligo.caltech.edu, tannenba@cs.wisc.edu, gthain@cs.wisc.edu, tstclair@redhat.com,pcouvare@caltech.edu", "due_date": ""}