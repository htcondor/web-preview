{"id": 2293, "title": "Ticket #2293: param system can't specify default-over-null", "description": "<blockquote>\nSome param settings must be non-null; if they are null then the code simply uses the default.  It is not possible to represent this clearly at the moment and it leads to default values being in the code multiple times, creating a possibility for drift.\n\n<p>For example, this is a summary of actual code.  It has been abridged.\n\n</p><p><strong>/src/condor_utils/param_info.in</strong>\n</p><div class=\"code\">\n<pre class=\"code\">[PRIORITY_HALFLIFE]\ndefault=86400\n</pre></div>\n\n\n<p><strong>Accountant::Initialize in /src/condor_negotiator.V6/Accountant.cpp</strong>\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">  HalfLifePeriod=86400;\n  tmp = param(\"PRIORITY_HALFLIFE\");\n  if(tmp) {\n\t  HalfLifePeriod=(float)atof(tmp);\n\t  free(tmp);\n  }\n</pre></div>\n\n\n<p>Note that 86400 appears twice and must stay in sync to behave correctly in all cases.  If you omit the logic in Accountant.cpp, if the user puts\n</p><div class=\"code\">\n<pre class=\"code\">PRIORITY_HALFLIFE=\n</pre></div>\n\nin their configuration file, the PRIORITY_HALFLIFE ends up going un-set.\n\n<p>This is a reasonably common situation, and the param system should be improved to better handle it.\n\n</p><p>Proposed: Add default_overrides_null=true as a valid setting in param_info.in.  If present and true, and if the parameter is set to empty in the configuration file, the default value is returned.  (Having an empty default and default_overrides_null=true is nonsensical and should probably be a compile error.)</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Jul-11 17:37:49 by adesmet:</em> <br/>\n\nWorth noting: param_double (and probably param_bool and param_int), will return the default value if the user explicitly sets it equal to nothing.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2011-Jul-11 17:37", "status": "new", "created": "2011-Jul-11 11:57", "fixed_version": "2011-Jul-11 11:57", "broken_version": "v070700", "priority": "4", "subsystem": "Libs", "assigned_to": "", "derived_from": "#1282", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}