{"id": 1115, "title": "Ticket #1115: Remove Target scope from EvalBool() in new ClassAds", "description": "<blockquote>\nThe free-standing function EvalBool() takes a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> and an unparsed expression string, and returns true if the parsed expression evaluates to True. One of its oddities is that it uses the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> as the target scope of the evaluation and no ad for for the local scope. Most callers use expressions with no 'Target' scope for the attribute references, which works fine in old <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>, but not new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>.\n\n<p>In the new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> compatibility layer, we will change EvalBool() to use the provided <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> as the local evaluation scope and have no target scope. For the few cases where an expression may have a 'Target' scope (older condor_q querying a newer schedd), EvalBool() will call the new RemoveExplicitTargetRefs() to strip off the 'Target' scoping.\n\n</p><p>The old <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> version of <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=EvalBool\" title=\"Eval Bool\">EvalBool</a></span> should be left alone.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jan-20 16:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/75e9a4299210ee38d858e38c7d7ae6bad1554b2a\">[16937]</a></span>: Strip 'Target.' in EvalBool() in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> compat layer. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1115\" onclick=\"get_ticket_and_populate_wrapper('1115'); return false;\" title=\"Remove Target scope from EvalBool() in new ClassAds\">#1115</a></span> In the new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> world, EvalBool() evaluates an expression in the scope of a local ad only, no target ad. So strip 'Target.' from any attributes in the expression.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2010-Jan-15 16:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/39080b002dc06441b505609638b3dfa178cd8251\">[16908]</a></span>: Use the local scope for EvalBool() in compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1115\" onclick=\"get_ticket_and_populate_wrapper('1115'); return false;\" title=\"Remove Target scope from EvalBool() in new ClassAds\">#1115</a></span> Use the provided <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> as the local scope of the expression evaluation, rather than as the target scope.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Feb-05 15:41", "status": "resolved", "created": "2010-Jan-15 15:44", "fixed_version": "2010-Jan-15 15:44", "broken_version": "v070500", "priority": "4", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "#1112", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}