{"id": 2206, "title": "Ticket #2206: CondorThreads should hand around \"arg\" as objects, not void *", "description": "<blockquote>\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorThreads\" title=\"Condor Threads\">CondorThreads</a></span> pass around a void* (\"arg\") to pass to the actual worker code.  It's a void* since different code might want different things.  The down side is that we can't validate that the arg is valid in any way.\n\n<p>Proposed:\n</p><ol>\n<li>Create class <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorThreadArg\" title=\"Condor Thread Arg\">CondorThreadArg</a></span>; it has no methods\n</li><li>Change CondorThreads::pool_add to take a CondorThreadArg* instead of a void*.  (And thus in the back-end store and pass around <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorThreadArgs\" title=\"Condor Thread Args\">CondorThreadArgs</a></span>)\n</li><li>Change the prototype for the callback function to take CondorThreadArg* instead of void*\n</li><li>Change all users to wrap their data in a class derived from <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorThreadArg\" title=\"Condor Thread Arg\">CondorThreadArg</a></span>.\n</li></ol>\n\n<p>Benefits: Instead of unsafe casts to and from void*, we can use a safe(r) dynamic_cast.  If the dynamic_cast returns NULL, we know that we were passed invalid data and can EXCEPT with a helpful error.\n\n</p><p>Further thoughts: should we go whole hog and instead of passing around a function pointer and a argument, instead pass in an object with a \"RunThreadTask()\" function?</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2011-Jun-02 13:05", "status": "new", "created": "2011-Jun-02 13:05", "fixed_version": "2011-Jun-02 13:05", "broken_version": "v070700", "priority": "4", "subsystem": "Daemons", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}