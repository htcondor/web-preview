{"id": 3598, "title": "Ticket #3598: CPU affinity test", "description": "<blockquote>\n<strong class=\"two\">CPU affinity test</strong>\n\n<p><strong>job_cpu_affinity_check.run</strong>\n\n</p><p>There is a new test worker script which access the requested file\nfrom /proc with an optional second arg which is used as a patterm\nto filter the output on.\n\n</p><p>There is now a new module in  Check called ProcInfo.pm which has a\nnew check function \"ProcInfo::RunAffinityCheck\" which is used in the test.\n\n</p><p>The first test is done in a fresh personal htcondor before turning on\ncpu affinity and creating a single partionable slot with all of the machines\nresources. We want the count of available cores. SHOULD WE HAVE ONLY ONE, WE PASS THE TEST AND BYPASS THE REST OF THE CHECKS.\n\n</p><p>We then do a request for the second variant personal htcondor. Now we do 2 more checks. We request a single core job and verify we only have access to one core.\nThen we do a 2 core job and verify we have access to two cores.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-15 12:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35734\">[35734]</a></span>: Have three personal htcondors for each cpu affinity tests each with as fresh startup. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-13 15:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35690\">[35690]</a></span>: Remove confusing dprintf <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-13 14:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35688\">[35688]</a></span>: Fix name of cpu affinity knob in test <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-08 14:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35662\">[35662]</a></span>: When evealuating if we have a suitable bit mask for cpu affinity we now print an expect message when we fail. Expected X Got Y. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-08 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35661\">[35661]</a></span>: Added <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CreateLocalConfig\" title=\"Create Local Config\">CreateLocalConfig</a></span> to place local config info into a file based on both a name and the pid requestion it. The new file name is returned. It is initially used in both <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3609\" onclick=\"get_ticket_and_populate_wrapper('3609'); return false;\" title=\"Local Resource Testing - Static  and dynamic slots\">#3609</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-May-08 14:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35658\">[35658]</a></span>: Added another hash element which can be defined with <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=StartCondorWithParams\" title=\"Start Condor With Params\">StartCondorWithParams</a></span>. \"fresh_local\" set to true, we now can pass in \"condorlocalsrc\" as a file and start with a fresh condor and not one based on the .local from the current condor. Initially user in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3609\" onclick=\"get_ticket_and_populate_wrapper('3609'); return false;\" title=\"Local Resource Testing - Static  and dynamic slots\">#3609</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Apr-29 08:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35597\">[35597]</a></span>: Tools for checking info in /proc and the new cpu affinity test <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3598\" onclick=\"get_ticket_and_populate_wrapper('3598'); return false;\" title=\"CPU affinity test\">#3598</a></span>  (By Bill Taylor )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Aug-06 12:41", "status": "resolved", "created": "2013-Apr-26 14:28", "fixed_version": "2013-Apr-26 14:28", "broken_version": "", "priority": "4", "subsystem": "Tests", "assigned_to": "bt", "derived_from": "#3594", "creator": "bt", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}