{"id": 5560, "title": "Ticket #5560: SELinux and GSI don't work together (?)", "description": "<blockquote>\nHere's a sample log showing that SELinux appears to be preventing HTCondor from reading necessary credentials:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">03/14/16 12:02:02 DC_AUTHENTICATE: required authentication of IP.IP.IP.IP failed: AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5003:Failed to authenticate.  Globus is reporting error (851968:1484).  There is probably a problem with your credentials.  (Did you run grid-proxy-init?)|AUTHENTICATE:1004:Failed to authenticate using FS|FS:1002:condor_mkstemp(/tmp/FS_XXXXXXXXX) failed: Permission denied (13)\n03/14/16 12:02:29 authenticate_self_gss: acquiring self credentials failed. Please check your Condor configuration file if this is a server process. Or the user environment variable if this is a user process.\n\nGSS Major Status: General failure\nGSS Minor Status Error Chain:\nglobus_gsi_gssapi: Error with GSI credential\nglobus_gsi_gssapi: Error with gss credential handle\nglobus_credential: Valid credentials could not be found in any of the possible locations specified by the credential search order.\nValid credentials could not be found in any of the possible locations specified by the credential search order.\nAttempt 1\nglobus_credential: Error reading host credential\nglobus_sysconfig: Error with certificate filename\nglobus_sysconfig: Error with certificate filename\nglobus_sysconfig: File has bad permissions: Could not read /etc/grid-security/hostcert.pem\nAttempt 2\nglobus_credential: Error reading proxy credential\nglobus_sysconfig: Could not find a valid proxy certificate file location\nglobus_sysconfig: Error with key filename\nglobus_sysconfig: File does not exist: /tmp/x509up_u0 is not a valid file\nAttempt 3\nglobus_credential: Error reading user credential\nglobus_sysconfig: Error with certificate filename\nglobus_sysconfig: Error with certificate filename\nglobus_sysconfig: File has bad permissions: Could not read /etc/grid-security/hostcert.pem\n\n03/14/16 12:02:29 DC_AUTHENTICATE: required authentication of IP.IP.IP.IP failed: AUTHENTICATE:1003:Failed to authenticate with any method|AUTHENTICATE:1004:Failed to authenticate using GSI|GSI:5003:Failed to authenticate.  Globus is reporting error (851968:1517).  There is probably a problem with your credentials.  (Did you run grid-proxy-init?)|AUTHENTICATE:1004:Failed to authenticate using FS|FS:1002:condor_mkstemp(/tmp/FS_XXXXXXXXX) failed: Permission denied (13)\n</pre></div>\n\n\n<p>In addition, FS auth failed, which is a bit of a surprise to me.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Mar-15 11:00:12 by tannenba:</em> <br/>\n\nAlso see <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=5449\" onclick=\"get_ticket_and_populate_wrapper('5449'); return false;\" title=\"No SELINUX rules for the shared port daemon\">#5449</a></span>\n\n<p></p><hr/>\n<em>2016-Aug-08 13:24:18 by tannenba:</em> <br/>\n\nAlso see <span class=\"ticket\"><a class=\"abandoned\" href=\"/tickets?ticket=5385\" onclick=\"get_ticket_and_populate_wrapper('5385'); return false;\" title=\"HTCondor View: simplify HTCondorViewLinked\">#5385</a></span></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Dec-12 17:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=49785\">[49785]</a></span>: Improved SELinux rules <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=5449\" onclick=\"get_ticket_and_populate_wrapper('5449'); return false;\" title=\"No SELINUX rules for the shared port daemon\">#5449</a></span>, <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=5560\" onclick=\"get_ticket_and_populate_wrapper('5560'); return false;\" title=\"SELinux and GSI don't work together (?)\">#5560</a></span>, <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=5835\" onclick=\"get_ticket_and_populate_wrapper('5835'); return false;\" title=\"No SELinux rules for the linux_kernel_tuning script\">#5835</a></span> Added SELinux type enforcement rules for common situations. Also, made condor domains permissive until we nail everything down properly.  (By Tim Theisen )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Dec-19 15:58", "status": "review", "created": "2016-Mar-14 19:12", "fixed_version": "2016-Mar-14 19:12", "broken_version": "v080404", "priority": "2", "subsystem": "Packaging", "assigned_to": "tim", "derived_from": "", "creator": "zmiller", "rust": "", "customer_group": "fermi", "visibility": "public", "notify": "zmiller@cs.wisc.edu, marcom@fnal.gov", "due_date": ""}