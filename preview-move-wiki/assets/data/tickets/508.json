{"id": 508, "title": "Ticket #508: Cannot use MyType/TargetType in constraints", "description": "<blockquote>\n<div class=\"verbatim\">\n<pre>-------- Original Message --------\nSubject: Re: [Condor-users] Querying Condor_Collector through\nwebservice.. to\tget Schedd and\tNegotiator IPs\nDate: Mon, 06 Oct 2008 08:04:01 -0500\nFrom: Matthew Farrellee &lt;matt@redhat.com&gt;\nReply-To: Condor-Users Mail List &lt;condor-users@cs.wisc.edu&gt;\nTo: Condor-Users Mail List &lt;condor-users@cs.wisc.edu&gt;\nReferences: &lt;1223294910.7155.36.camel@EDEN&gt;\n\nJohnson koil Raj wrote:\n&gt; &gt; Hi\n&gt; &gt;\n&gt; &gt;   I need to Know how many Schedd and Submitter are in the pool and I\n&gt; &gt; required their corresponding IPs and Ports.\n&gt; &gt;   while Querying Condor_Collector through web service For the Particular\n&gt; &gt; constraint is not giving any Output.In Collector Log It is saying 0\n&gt; &gt; response to the Query.\n&gt; &gt;\n&gt; &gt; CondorCollectorPortType port;\n&gt; &gt;\n&gt; &gt; port.queryAnyAds(\"MyType == \\\"Submitter\\\"\")\n&gt; &gt; port.queryAnyAds(\"MyType == \\\"Negotiator\\\"\")\n&gt; &gt; port.queryAnyAds(\"TargetType == \\\"Job\\\"\");\n&gt; &gt; port.queryScheddAds(\"MyType == \\\"Scheduler\\\"\")\n&gt; &gt;\n&gt; &gt; but the following query code is Working fine it is correctly fetching\n&gt; &gt; data from Collector (boolean related values working fine with collector)\n&gt; &gt;\n&gt; &gt; port.queryScheddAds(\"HasSOAPInterface == TRUE\")\n&gt; &gt; port.queryAnyAds(\"Start == TRUE\");\n&gt; &gt;\n&gt; &gt; I have verified with command line.\n&gt; &gt;\n&gt; &gt; CondorScheddPortType schedd;\n&gt; &gt;\n&gt; &gt; schedd.getJobAds(null,\"MyType == \\\"Job\\\"\")\n&gt; &gt;\n&gt; &gt; this query code is working fine and I am able to get all the outputs\n&gt; &gt;\n&gt; &gt; Why the collector is not giving any data for that constraints.Please\n&gt; &gt; help me out in this\n&gt; &gt;\n&gt; &gt; thanks by\n&gt; &gt; Johnson\n\nIt's an unfortunate situation. The MyType and TargetType attributes on\nan ad are treated specially and are often invisible to constraints.\n\nYou can verify the issue by using condor_status -constraint 'MyType ==\n\"Scheduler\"' etc\n\nYou can use the daemon specific query methods to get around the issue,\ne.g. queryScheddAds and condor_status -schedd -constraint\n\nBest,\n\n\nmatt\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2010-Mar-31 15:26:10 by adesmet:</em> <br/>\n\nCopied over from <span class=\"ticket\"><a class=\"abandoned\" href=\"/tickets?ticket=1320\" onclick=\"get_ticket_and_populate_wrapper('1320'); return false;\" title=\"Cannot test MyType in a -constraint in condor_status\">#1320</a></span>, which is a dupe:\n\n<p>When invoking condor_status, attempting to filter based on <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyType\" title=\"My Type\">MyType</a></span> fails.  The following should find all startd ads, but returns nothing:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">condor_status -any -const 'MyType==\"Machine\"'</pre></div>\n\n\n<p><span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyType\" title=\"My Type\">MyType</a></span> works fine in the -format option.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">condor_status -any -format '%s\\n' MyType</pre></div>\n\n\n<p>I should be able to filter my queries on <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyType\" title=\"My Type\">MyType</a></span>.\n\n</p><p></p><div class=\"restricted\"><strike>As a bonus gotcha, be sure to test the submittor/submitter type; the collector does some extra magic rebranding Scheduler ads into Submitter ads in collector.cpp in CollectorDaemon::receive_query_cedar, around line 332.</strike></div> Upon closer inspection, the magic only mangles the query, not the output.  It's backward compatibility for 7.3 and earlier era clients.\n<hr/>\n<em>2010-Aug-23 17:07:50 by adesmet:</em> <br/>\n\nBulk change of target version from v070402 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2014-Apr-17 17:28:20 by jfrey:</em> <br/>\n\nWith the switch to new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyType\" title=\"My Type\">MyType</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=TargetType\" title=\"Target Type\">TargetType</a></span> are no longer magical. They can be used in constraints like any other attribute.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2014-Apr-17 17:28", "status": "resolved", "created": "2009-May-24 14:21", "fixed_version": "2009-May-24 14:21", "broken_version": "v070000", "priority": "4", "subsystem": "", "assigned_to": "", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "users", "visibility": "public", "notify": "", "due_date": ""}