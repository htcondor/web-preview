{"id": 3571, "title": "Ticket #3571: condor_starter hangs during file transfer plugin", "description": "<blockquote>\nIt appears invoking the file transfer plugin causes the starter to block.\n\n<p>If blocked for a sufficiently long time, the startd will SIGKILL the starter.  HTCondor treats this as a job disconnect and reschedules the job.\n\n</p><p>In the latest code, I think the relevant variable is NOT_RESPONDING_TIMEOUT - which defaults to 60s.\n\n</p><p>So, transfer plugins only work if all the files are staged out in less than 60s.\n\n</p><p>This is possibly a side-effect of Dan's work with the file transfer object.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Apr-11 09:26:39 by danb:</em> <br/>\n\nMy work with the file transfer object shouldn't have changed behavior of file transfer plugins.\n\n<p>I did recently touch the NOT_RESPONDING_TIMEOUT code in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3510\" onclick=\"get_ticket_and_populate_wrapper('3510'); return false;\" title=\"synchronized CHILDALIVEs may get dropped by the master\">#3510</a></span>.  The default is certainly not intended to be 60s, and a quick reading of the code implies that it is 3600s.  I'm looking at it more carefully now.\n\n</p><p></p><hr/>\n<em>2013-Apr-11 10:15:47 by bbockelm:</em> <br/>\n\nAh - the 60s figure is apparently something I set locally; I missed that from my \"condor_config_val\".\n\n<p>Perhaps this has been around for a long time then?\n\n</p><p></p><hr/>\n<em>2013-Apr-11 10:54:13 by danb:</em> <br/>\n\nThe starter blocks on stage-out file transfers (whether non-plugin or plugin).  I don't see anything that does anything special to avoid NOT_RESPONDING_TIMEOUT from firing during the transfer.  I think it has always been like this.\n\n<p></p><hr/>\n<em>2013-Apr-12 07:08:38 by bbockelm:</em> <br/>\n\nThere's still something funky going on here - I still get a lot of disconnect errors, although the job goes on hold.\n\n<p>If a file transfer fails, it goes on hold without a hold reason:\n\n</p><p></p><div class=\"verbatim\">\n<pre>-- Submitter: hcc-briantest.unl.edu : &lt;129.93.244.208:60784&gt; : hcc-briantest.unl.edu\n ID      OWNER          HELD_SINCE  HOLD_REASON\n 711.0   bbockelm        4/11 21:58 undefined\n 712.0   bbockelm        4/11 21:54 undefined\n</pre></div>\n\n\n<p>If I look at the logs, the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowLog\" title=\"Shadow Log\">ShadowLog</a></span> indicates there is a problem sending the hold message to the Schedd.  The hold message itself is suspect as it has a newline character in it.  I just tried a commit without said newline and will report back.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Apr-22 07:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=35475\">[35475]</a></span>: Fix message on error stack to not have a newline. <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3571\" onclick=\"get_ticket_and_populate_wrapper('3571'); return false;\" title=\"condor_starter hangs during file transfer plugin\">#3571</a></span>  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Jul-28 13:03", "status": "new", "created": "2013-Apr-11 08:27", "fixed_version": "2013-Apr-11 08:27", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "zmiller", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "", "due_date": ""}