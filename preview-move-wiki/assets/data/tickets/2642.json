{"id": 2642, "title": "Ticket #2642: Condor does not correctly detect the SYSTEM account", "description": "<blockquote>\nCondor checks to see if it is running as the Local System account by comparing the username to SYSTEM.  This is not guranteed to work on all versions of Windows.   The correct way to test is to compare the SID of the current user with a well known value. S-1-5-18.\n\n<p>When condor fails to detect that it is not running as SYSTEM, then it believes that it cannot switch users, so load_profile and run_as_owner dont work. Condor will not run jobs as slot users, etc.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Nov-19 15:59:14 by cweiss:</em> <br/>\n\nThe code looks good to me and tested successfully on a French Windows version for which 7.6.4 failed to recognize the SYSTEM user.\n\n<p>The only thing I feel a little iffy about are the #pragma statements. Given that it's Windows only, it probably won't matter, but I believe to remember Greg objecting to them in general. So please talk to him before closing the ticket for good.\n\n</p><p></p><hr/>\n<em>2011-Nov-21 14:19:18 by gthain:</em> <br/>\n\nIf this is in Windows-only #ifdef'd code, them I'm Ok with it.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Nov-17 11:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a22f19bc805412e32188a778e2a87cc0cad32413\">[28293]</a></span>: detect is_root and can_switch_ids by looking at the current account SID rather than comparing the username to SYSTEM (which doesn't work on non-english Windows). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2642\" onclick=\"get_ticket_and_populate_wrapper('2642'); return false;\" title=\"Condor does not correctly detect the SYSTEM account\">#2642</a></span> ===VersionHistory:Complete===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Nov-21 14:20", "status": "resolved", "created": "2011-Nov-17 11:10", "fixed_version": "2011-Nov-17 11:10", "broken_version": "v070600", "priority": "2", "subsystem": "Win32", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "a22680", "customer_group": "support", "visibility": "public", "notify": "tstclair@redhat.com", "due_date": ""}