{"id": 7073, "title": "Ticket #7073: Automatically set the alias for the collector", "description": "<blockquote>\nWhen we construct a generic daemon name from a hostname, we set an appropriate hostname alias in the sinful string for use in SSL and GSI peer certificate verification.  This allows us to compare the hostname the user provided with the hostname(s) in the certificate.  With this information, we no longer need to rely on reverse DNS (which is considered insecure) to go from the IP address in the sinful string to the hostname.\n\n<p>Surprisingly, there are <em>two</em> sets of logic that generate a sinful from a hostname -- one is <code>Daemon::getDaemonInfo</code> and the other is <code>Daemon::findCmDaemon</code>.  The alias is <em>not</em> set in the latter, resulting in issues verifying the hostname when someone does\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">condor_status -pool foo.example.com\n</pre></div>\n\n\n<p>and the collector at <code>foo.example.com</code> itself requires hostname verification.\n\n</p><p>I'm marking this as a bug in 8.9.2 given that is the first release where SSL host verification is done by default.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Aug-02 09:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/358f7090e69462fefb9e9285017073aee969b298\">[57558]</a></span>: Version release note for alias bugfix. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7073\" onclick=\"get_ticket_and_populate_wrapper('7073'); return false;\" title=\"Automatically set the alias for the collector\">#7073</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-26 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6d15e657712d98802a2ce7a96cd2751cf6f15e9a\">[56962]</a></span>: Always set alias for the collector lookup. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7073\" onclick=\"get_ticket_and_populate_wrapper('7073'); return false;\" title=\"Automatically set the alias for the collector\">#7073</a></span> The construction of the collector's sinful string in `Daemon::findCmDaemon` does not pass along the alias. Without this, hostname verification will fail for protocols such as GSI or SSL when trying to contact the collector initially in cases such as `condor_status`.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Aug-02 10:01", "status": "resolved", "created": "2019-May-26 10:05", "fixed_version": "2019-May-26 10:05", "broken_version": "v080902", "priority": "2", "subsystem": "Security", "assigned_to": "bbockelm", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "bbockelman@morgridge.org", "due_date": ""}