{"id": 3354, "title": "Ticket #3354: condor_root_switchboard performance problem with large fdset size", "description": "<blockquote>\nBurt reports performance problems because of condor_root_switchboard closing all the FDs up to getrlimit(rlimit_NOFILE).  On the glidein factory, it is common to have ulimit -n around 50k.\n\n<p>I'm not aware of a better solution than to use an OS-specific technique such as iterating through /proc/pid/fds to avoid iterating through all 50k FDs, most of which are not open.\n\n</p><p>A workaround is for the caller of the switchboard to set a lower limit for number of open files.  Since reducing the limit does not force higher-numbered fds to be closed, one may need to be careful if there is a concern about leaving some FDs open.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Nov-30 18:02:17 by bbockelm:</em> <br/>\n\nNote that iterating through /proc/self/fd isn't async signal safe.  Thus, it can't be used after-fork-before-exec.\n\n<p>Might be OK for the switchboard, but definitely can't do it in daemon core!\n\n</p><p>Lots of other Unixes solve this nicely.  I found this page: <a class=\"external\" href=\"http://stackoverflow.com/questions/1643304/how-to-set-close-on-exec-by-default\">http://stackoverflow.com/questions/1643304/how-to-set-close-on-exec-by-default</a>\n\n</p><p></p><hr/>\n<em>2019-Feb-09 08:55:36 by bbockelm:</em> <br/>\n\nClosing this ticket as the root switchboard is no longer relevant.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2019-Feb-09 08:55", "status": "abandoned", "created": "2012-Nov-30 17:26", "fixed_version": "2012-Nov-30 17:26", "broken_version": "v070900", "priority": "3", "subsystem": "", "assigned_to": "bbockelm", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "burt@fnal.gov,dan@hep.wisc.edu", "due_date": ""}