{"id": 2948, "title": "Ticket #2948: GPU jobs report incorrect ImageSize", "description": "<blockquote>\nThis may be due to shared libs, but I'm not sure.  Our only workaround is to special-case GPU slots and use <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ResidentSetSize\" title=\"Resident Set Size\">ResidentSetSize</a></span> in our policy expressions instead.</blockquote>", "remarks": "<blockquote>\n<em>2012-Nov-27 14:35:36 by pfc:</em> <br/>\n\nGreg's good question: is this the same virtual memory size reported by \"ps\", or larger?\n\n<p></p><hr/>\n<em>2012-Nov-27 14:47:17 by gthain:</em> <br/>\n\nAs discussed on the phone today, there's two potential problems that could cause this.  One, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ImageSize\" title=\"Image Size\">ImageSize</a></span> is virtual size, so if the cpu process mmaps the whole gpu memory map, the virtual size will be huge.  If you run ps, it would be interesting to see what ps reports for these proceses.  The other problem is that condor sums the virtual sizes for all the processes within the job.  If we could figure out which of these two problems is causing the incorrect size (I'm guessing too big?), then we can address a solution.\n\n<p></p><hr/>\n<em>2012-Nov-27 16:44:31 by gthain:</em> <br/>\n\nAnother interesting question (assuming you can run this by hand) is, what does cgroup think about the memory size:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">$ sudo cgcreate -g memory:testgroup\n$ sudo cgexec -g memory:testgroup ./someAppToRunAsroot -arg1 -arg2\n\n(while the above is running)\ncat /cgroup/testgroup/memory.usage_in_bytes\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2015-Sep-21 11:35", "status": "defer", "created": "2012-Apr-20 13:33", "fixed_version": "2012-Apr-20 13:33", "broken_version": "v070606", "priority": "5", "subsystem": "Daemons", "assigned_to": "", "derived_from": "", "creator": "pfc", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "pfcouvar@syr.edu,pcouvare@caltech.edu", "due_date": ""}