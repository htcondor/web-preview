{"id": 6136, "title": "Ticket #6136: Blahp status python script must accept -w argument", "description": "<blockquote>\nWe have replacements for the blahp's status scripts for pbs and slurm, written in python. These replacement scripts don't recognize the optional -w argument. When this argument is given, the script is supposed to attempt to determine the hostname of the machine that a job is running on and include that in its response. The blahp uses this argument when attempting to forward a refreshed proxy to the running job.\n\n<p>The replacement scripts exit immediately with a non-zero status when -w is given. This causes the blahp to return failure for the relevant BLAH_JOB_REFRESH_PROXY command. If the script ignores the -w argument and doesn't include a hostname in its response, then the blahp skips the attempt to forward the proxy to the executing machine.\n\n</p><p>The replacement status scripts <code>pbs_status.py</code> and <code>slurm_status.py</code> should accept but ignore a <code>-w</code> on the command line that precedes the job id.\n\n</p><p>This bug can be worked around by setting <code>blah_disable_wn_proxy_renewal=yes</code> in the blahp config file.</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Feb-27 17:09:33 by blin:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>We really should be using the optparse library but since we have reasonable control over the way the scripts are called and which arguments we pass, this is good enough.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-28 11:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50226\">[50226]</a></span>: Docs for blahp status python script -w bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6136\" onclick=\"get_ticket_and_populate_wrapper('6136'); return false;\" title=\"Blahp status python script must accept -w argument\">#6136</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Feb-09 14:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50124\">[50124]</a></span>: blahp status python script must accept -w argument <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6136\" onclick=\"get_ticket_and_populate_wrapper('6136'); return false;\" title=\"Blahp status python script must accept -w argument\">#6136</a></span> The blahp may call the status script with a -w argument when it receives a refreshed proxy. The script needs to tolerate the argument, but can safely ignore it.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Feb-28 20:09", "status": "resolved", "created": "2017-Feb-09 14:54", "fixed_version": "2017-Feb-09 14:54", "broken_version": "v080506", "priority": "3", "subsystem": "Grid", "assigned_to": "blin", "derived_from": "#5722", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}