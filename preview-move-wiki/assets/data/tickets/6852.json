{"id": 6852, "title": "Ticket #6852: Shrink compat ClassAds API", "description": "<blockquote>\nReduce the footprint of the compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> child class. For lightly used methods, update the callers to use the underlying <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> library methods or turn the compat methods into free-standing functions.</blockquote>", "remarks": "<blockquote>\n<em>2019-Mar-13 14:01:40 by jfrey:</em> <br/>\n\nThere are no user-visible changes, so no version history.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6955\" onclick=\"get_ticket_and_populate_wrapper('6955'); return false;\" title=\"Shrink compat ClassAds API, part 2\">#6955</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nShrink compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> API, part 2</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7072\" onclick=\"get_ticket_and_populate_wrapper('7072'); return false;\" title=\"Shrink compat ClassAds API, part 3\">#7072</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nShrink compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> API, part 3</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7496\" onclick=\"get_ticket_and_populate_wrapper('7496'); return false;\" title=\"Shrink compat ClassAds API, part 4\">#7496</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nShrink compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> API, part 4</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-07 08:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56313\">[56313]</a></span>: Remove EvalBool() function that takes an int. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> All callers now use a bool.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-06 09:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56312\">[56312]</a></span>: Change LookupBool() calls to use bool in the unit tests. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-05 13:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56311\">[56311]</a></span>: Change LookupBool() calls to use bool in standard universe. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-05 11:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56310\">[56310]</a></span>: Remove LookupBool() method that takes an int. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> All callers now use a bool. Also add EvalBool() that takes a bool.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-05 10:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56309\">[56309]</a></span>: Remove windows-specific <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> Assign() method. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-04 15:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56308\">[56308]</a></span>: Eliminate extra copying in EvalString() with std::string. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-04 15:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56307\">[56307]</a></span>: Move Eval*() <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> methods into free-standing functions. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> These are the evaluation functions that take a second <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> to serve as the TARGET scope. This moves us closer to eliminating the compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> child class.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-04 14:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56306\">[56306]</a></span>: Rename free-standing EvalBool() functions to EvalExprBool(). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> This will better distinguish these functions, which take a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> and an expression, from the soon-to-be free-standing Eval*() functions that take an attribute name and source and target <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span>.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-04 11:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56305\">[56305]</a></span>: Change a few more Eval*() calls to Lookup*() when there's no target ad. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-01 20:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56304\">[56304]</a></span>: Change Eval*() calls to Lookup*() when there's no target ad in the tests. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-01 15:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56303\">[56303]</a></span>: Change more Eval*() calls to Lookup*() when there's no target ad. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-01 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56302\">[56302]</a></span>: Change Eval*() calls to Lookup*() when there's no target ad. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Mar-01 11:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56301\">[56301]</a></span>: Fix evaluation functions in compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> layer. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> Allow the underlying <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> code to do type conversions between boolean, integer, and real values when doing an expression evaluation with a specific type in mind for the result. This simplifies the compat code and makes it act more consistently\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-16 16:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56300\">[56300]</a></span>: Remove compat ClassAd::NextExpr(). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> Callers now use the underlying <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> iterator.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-16 14:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56299\">[56299]</a></span>: Remove compat ClassAd::NextNameOriginal(). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span> Callers now use the underlying <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> iterator.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-15 11:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55989\">[55989]</a></span>: Turn compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> constructor from FILE into a free-standing function <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-14 10:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55988\">[55988]</a></span>: Turn compat ClassAd::InsertFromFile() into a free-standing function <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-11 10:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55987\">[55987]</a></span>: Remove unused methods in compat <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span>. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-11 10:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55986\">[55986]</a></span>: Turn compat ClassAd::ChainCollapse() into a free-standing function <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-11 09:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55985\">[55985]</a></span>: Turn compat ClassAd::CopyAttribute() into a free-standing function <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6852\" onclick=\"get_ticket_and_populate_wrapper('6852'); return false;\" title=\"Shrink compat ClassAds API\">#6852</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-10 14:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55972\">[55972]</a></span>: Turn compat ClassAd::initFromString() into a free-standing function.  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-10 12:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=55971\">[55971]</a></span>: Remove compat ClassAd's dirty attribute tracking API. All callers now use the underlying dirty attribute API.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Mar-13 14:01", "status": "resolved", "created": "2019-Jan-10 15:38", "fixed_version": "2019-Jan-10 15:38", "broken_version": "", "priority": "3", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}