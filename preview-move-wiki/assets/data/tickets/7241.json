{"id": 7241, "title": "Ticket #7241: Add condor_q -idle to complement condor_q -run", "description": "<blockquote>\nA while ago we proposed a \"condor_q -idle\" custom print format for ligo.  They like this, and would like it to be first class:\n\n<p></p><div class=\"term\">\n<pre class=\"term\">$ condor_q -pr idle.cpf\n\n-- Schedd: submit-3.chtc.wisc.edu : &lt;128.104.100.44:9618?... @ 01/04/17 14:57:55\nOWNER                UNIVERSE  STATUS CPUS MEMORY COUNT NumShadowStarts JobIDs\namalkus              Vanilla   Idle    1    1024   69606 undefined       81629705.2394 ... 81635890.8999\namalkus              Vanilla   Idle    1    1024       3 1               81629705.2385 ... 81629705.2390\nbxie9                Vanilla   Idle    4    1844       3 1               81635364.78 ... 81635364.80\nbxie9                Vanilla   Idle    4    1844     919 undefined       81635364.81 ... 81635364.999\ndwu43                Vanilla   Idle    1    2048    9704 undefined       81519428.460 ... 81521174.923\ndwu43                Vanilla   Idle    1    2048       1 2               81519428.459\neswright             Vanilla   Idle    1    2000    1000 undefined       81627145.0 ... 81637305.0\neswright             Vanilla   Idle    1    2000       4 1               81626939.0 ... 81637189.0\nhuling               Vanilla   Idle    1    8704    3344 undefined       81630700.10156 ... 81630700.13499\njnnguyen2            Vanilla   Idle    24   8000    3428 undefined       81067305.354 ... 81067305.3781\nmmillican            Vanilla   Idle    36   131072     1 1               81635891.0\nnu_mirkarim          Vanilla   Idle    1    1024    2458 undefined       81632726.0 ... 81635274.0\nnu_mirkarim          Vanilla   Idle    1    1024      13 1               81632698.0 ... 81632721.0\ntamorrell            Vanilla   Idle    1    2048    3995 undefined       81629938.0 ... 81640219.0\ntamorrell            Vanilla   Idle    1    2048       7 1               81629928.0 ... 81629937.0\ntbechtel             Vanilla   Idle    36   10240      3 2               81373985.11 ... 81373985.13\ntoczydlowski         Vanilla   Idle    16   8000     151 undefined       81639866.9 ... 81639975.39\n</pre></div>\n\n\n<p></p><div class=\"file\">\n<pre class=\"filelabel\">idle.cpf</pre>\n<pre class=\"file\">SELECT UNIQUE NOSUMMARY\n Owner         AS OWNER      WIDTH -20\n JobUniverse   AS \"UNIVERSE \"   PRINTAS JOB_UNIVERSE\n JobStatus     AS STATUS PRINTAS JOB_STATUS_RAW\n RequestCpus   AS CPUS\n RequestMemory AS MEMORY\n JobCount      AS COUNT      PRINTF  %5d\n NumShadowStarts\n JobIDs\nWHERE\n  JobStatus==1\nGROUP BY\n  Owner\n</pre></div>\n\n\n<p>This custom print format is implicitly an -all-users query, and it does aggregation in the schedd.  Neither of these are things that we want to do by default. But if we add condor_q -idle as a new command line option, and allow the default output to be overridden by configuration in the usual way, the we can satisfy them while at the same time doing something sensible for all of our users.\n\n</p><p>So we will add a new -idle option which will be a -nobatch type query like -run is.  It's output will be like this\n\n</p><p></p><div class=\"term\">\n<pre class=\"term\">-- Schedd: johnkn@crane8.cs.wisc.edu : &lt;128.105.136.34:7107?... @ 09/27/19 11:02:59\n ID       OWNER          UNIVERSE  CPUS MEMORY STARTS LAST_HOST\n15864.0   bob            Vanilla      1     70      1 slot1@hostname.cs.edu\n15864.1   bob            Vanilla      1    900      0 undefined\n15864.2   bob            Vanilla      1     70      0 undefined\n</pre></div>\n\n\n<p>A custom print format for -idle can be configured using something like this\n</p><div class=\"snip\">\n<pre class=\"sniplabel\">config fragment</pre>\n<pre class=\"snip\">Q_DEFAULT_IDLE_PRINT_FORMAT_FILE = $(ETC)/idle.cpf\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\nRe prioritized to 2 as it is easy.\n\n<p></p><hr/>\n<em>2019-Sep-17 14:40:50 by johnkn:</em> <br/>\n\nNot as easy as you think...</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Oct-22 15:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=58235\">[58235]</a></span>: man page and version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7241\" onclick=\"get_ticket_and_populate_wrapper('7241'); return false;\" title=\"Add condor_q -idle to complement condor_q -run\">#7241</a></span>, condor_q -idle  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Sep-27 11:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57943\">[57943]</a></span>: add condor_q -idle and Q_DEFAULT_IDLE_PRINT_FORMAT_FILE knob <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7241\" onclick=\"get_ticket_and_populate_wrapper('7241'); return false;\" title=\"Add condor_q -idle to complement condor_q -run\">#7241</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Oct-22 15:13", "status": "resolved", "created": "2019-Sep-04 16:52", "fixed_version": "2019-Sep-04 16:52", "broken_version": "v080900", "priority": "2", "subsystem": "", "assigned_to": "johnkn", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "", "due_date": ""}