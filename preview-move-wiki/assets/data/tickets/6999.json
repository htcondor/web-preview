{"id": 6999, "title": "Ticket #6999: submit digest Cmd should not be full path for all Grid and VM jobs", "description": "<blockquote>\nWhen submit_utils creates a submit digest, it currently promotes the executable to a full path.  But this should only happen for types of jobs where this is actually an executable.\n\n<p>For VM universe, and for some types of Grid universe, the <code>Executable</code> keyword (<code>Cmd</code> job attribute) is really just a label for the job, and should not be treated as a filename. The code in submit_utils that sets SFR_PSEUDO_EXECUTABLE shows which types of jobs should not have the executable treated as a filename.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-May-09 01:53:17 by bbockelm:</em> <br/>\n\nThis tossed a compiler warning on Mac OS X; it looks like you used a string comparison when you meant to use assignment:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">--- a/src/condor_utils/submit_utils.cpp\n+++ b/src/condor_utils/submit_utils.cpp\n@@ -8051,7 +8051,7 @@ int SubmitHash::query_universe(MyString &amp; sub_type, bool &amp;is_docker)\n        is_docker = IsDockerJob;\n        if (JobUniverse != CONDOR_UNIVERSE_MIN) {\n                if (JobUniverse == CONDOR_UNIVERSE_GRID) { sub_type = JobGridType; }\n-               else if (JobUniverse == CONDOR_UNIVERSE_VM) { sub_type == VMType; }\n+               else if (JobUniverse == CONDOR_UNIVERSE_VM) { sub_type = VMType; }\n                return JobUniverse;\n        }\n\n</pre></div>\n\n\n<p>Don't have the means to test this; pushed a fix but please re-review.\n\n</p><p></p><hr/>\n<em>2019-May-09 14:12:44 by johnkn:</em> <br/>\n\nThanks.  It's a real bug, but moot at present because the sub_type field is only actually needed at present when the universe is grid.\n\n<p></p><hr/>\n<em>2019-May-30 10:12:51 by johnkn:</em> <br/>\n\nno version history because only late materialization is affected.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-09 01:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56822\">[56822]</a></span>: Fix apparent typo. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6999\" onclick=\"get_ticket_and_populate_wrapper('6999'); return false;\" title=\"submit digest Cmd should not be full path for all Grid and VM jobs\">#6999</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Apr-15 18:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56634\">[56634]</a></span>: Fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6999\" onclick=\"get_ticket_and_populate_wrapper('6999'); return false;\" title=\"submit digest Cmd should not be full path for all Grid and VM jobs\">#6999</a></span>. submit digest Execute keyword should not be promoted to a full path when it is not actually a filename. This bug affected late materialization of VM universe, and some types of Grid universe jobs. ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-May-30 10:13", "status": "resolved", "created": "2019-Apr-15 14:46", "fixed_version": "2019-Apr-15 14:46", "broken_version": "v080710", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "#6166", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}