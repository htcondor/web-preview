{"id": 1996, "title": "Ticket #1996: group quota not applied to groups with capital letters in name", "description": "<blockquote>\nCDF at Fermilab noticed violations of the group quota in Condor 7.4.3 for groups with capital letters in their name.  I don't know how much earlier the problem goes back.\n\n<p>A successful workaround for the problem was to change all <code>AccountingGroup</code> strings in the jobs to use only lower-case letters.\n\n</p><p>Here is the user's description of the problem:\n\n</p><p>We use group accounting and you can see in the negotiator D_FULLDEBUG\noutput below there are two lines I've inserted the word \"HERE\" in.\nWhere the first HERE is, I'm expecting it to be saying that group_MCprod\nis over quota so it's skipping it but instead it is saying that the\nusage is 0.  It goes ahead and negotiates with group_MCprod then even\nthough at the second HERE you can see it knows that it's using 3591\nslots and the quota is 520.  The condor_user_prio command at the bottom\nalso shows the slots being used.  Near the bottom of the debug output\nthere is also a line with matchmakingAlgorithm: in it again saying the\nusage is 0.\n\n</p><p>I've been fighting with this for a long time.  Occasionally one of our\ngroups will manage to suck up all our slots even though they're over\nquota.  Most of the time they appear to work.\n\n</p><p></p><div class=\"verbatim\">\n<pre>03/22 11:56:06 group group_italy dynamic quota for 11106 slots = 188.000\n03/22 11:56:06 Group Table : group group_italy quota 188.000 usage\n115.000 prio 61.17\n03/22 11:56:06 group group_japan dynamic quota for 11106 slots = 233.000\n03/22 11:56:06 Group Table : group group_japan quota 233.000 usage 0.000\nprio 0.00\n03/22 11:56:06 group group_karlsruhe dynamic quota for 11106 slots = 55.000\n03/22 11:56:06 Group Table : group group_karlsruhe quota 55.000 usage\n0.000 prio 0.00\n03/22 11:56:06 group group_mit dynamic quota for 11106 slots = 33.000\n03/22 11:56:06 Group Table : group group_mit quota 33.000 usage 0.000\nprio 0.00\n03/22 11:56:06 group group_physmon dynamic quota for 11106 slots = 11.000\n03/22 11:56:06 Group Table : group group_physmon quota 11.000 usage\n0.000 prio 0.00\n03/22 11:56:06 group group_prd dynamic quota for 11106 slots = 815.000\n03/22 11:56:06 Group Table : group group_prd quota 815.000 usage 299.000\nprio 36.69\n03/22 11:56:06 group group_sam dynamic quota for 11106 slots = 277.000\n03/22 11:56:06 Group Table : group group_sam quota 277.000 usage 0.000\nprio 0.00\n03/22 11:56:06 group group_fixedwntest dynamic quota for 11106 slots =\n55.000\n03/22 11:56:06 Group Table : group group_fixedwntest quota 55.000 usage\n0.000 prio 0.00\n03/22 11:56:06 group group_fnal dynamic quota for 11106 slots = 233.000\n03/22 11:56:06 Group Table : group group_fnal quota 233.000 usage\n173.000 prio 74.25\n03/22 11:56:06 group group_highprio dynamic quota for 11106 slots = 888.000\n03/22 11:56:06 Group Table : group group_highprio quota 888.000 usage\n147.000 prio 16.55\n03/22 11:56:06 group group_ntp dynamic quota for 11106 slots = 916.000\n03/22 11:56:06 Group Table : group group_ntp quota 916.000 usage 567.000\nprio 61.90\n03/22 11:56:06 group group_mcprod dynamic quota for 11106 slots = 520.000\nHERE --------&gt; 03/22 11:56:06 Group Table : group group_mcprod quota\n520.000 usage 0.000 prio 0.00\n03/22 11:56:06 group group_btagging dynamic quota for 11106 slots = 222.000\n03/22 11:56:06 Group Table : group group_btagging quota 222.000 usage\n0.000 prio 0.00\n03/22 11:56:06 group group_dbg dynamic quota for 11106 slots = 55.000\n03/22 11:56:06 Group Table : group group_dbg quota 55.000 usage 0.000\nprio 0.00\n03/22 11:56:06 Group group_alignment - skipping, no submitters\n03/22 11:56:06 Group group_calib - skipping, no submitters\n03/22 11:56:06 Group group_dqm - skipping, no submitters\n03/22 11:56:06 Group group_florida - skipping, no submitters\n03/22 11:56:06 Group group_japan - skipping, no submitters\n03/22 11:56:06 Group group_karlsruhe - skipping, no submitters\n03/22 11:56:06 Group group_mit - skipping, no submitters\n03/22 11:56:06 Group group_physmon - skipping, no submitters\n03/22 11:56:06 Group group_sam - skipping, no submitters\n03/22 11:56:06 Group group_fixedwntest - skipping, no submitters\n03/22 11:56:06 Group group_mcprod - negotiating\n03/22 11:56:06 Phase 3:  Sorting submitter ads by priority ...\n03/22 11:56:06 Phase 4.1:  Negotiating with schedds ...\n03/22 11:56:06     numSlots = 520\n03/22 11:56:06     slotWeightTotal = 520.000000\n03/22 11:56:06     pieLeft = 520.000\n03/22 11:56:06     NormalFactor = 1.000000\n03/22 11:56:06     MaxPrioValue = 25528.660156\n03/22 11:56:06     NumSubmitterAds = 1\n03/22 11:56:06   Negotiating with group_MCprod.vellidis@fnal.gov at\n&lt;131.225.240.215:38554&gt;\n03/22 11:56:06 0 seconds so far\n03/22 11:56:06   Calculating submitter limit with the following parameters\n03/22 11:56:06     SubmitterPrio       = 25528.660156\n03/22 11:56:06     SubmitterPrioFactor = 20.000000\n03/22 11:56:06     submitterShare      = 1.000000\n03/22 11:56:06     submitterAbsShare   = 1.000000\n03/22 11:56:06     submitterLimit    = 520.000000\nHERE ---------&gt; 03/22 11:56:06     submitterUsage    = 3591.000000\n03/22 11:56:06 Socket to group_MCprod.vellidis@fnal.gov\n(&lt;131.225.240.215:38554&gt;) already in cache, reusing\n03/22 11:56:06     Sending SEND_JOB_INFO/eom\n03/22 11:56:06     Getting reply from schedd ...\n03/22 11:56:06     Got JOB_INFO command; getting classad/eom\n03/22 11:56:06     Request 17947890.00000:\n03/22 11:56:06 matchmakingAlgorithm: limit 520.000000 used 0.000000\npieLeft 520.000000\n03/22 11:56:06 Start of sorting MatchList (len=44)\n03/22 11:56:06 Finished sorting MatchList\n03/22 11:56:06       Connecting to startd\nglidein_5068@fcdfcaf1598.fnal.gov at &lt;131.225.238.42:43337&gt;\n03/22 11:56:06       Sending PERMISSION, claim id, startdAd to schedd\n03/22 11:56:06       Matched 17947890.0 group_MCprod.vellidis@fnal.gov\n&lt;131.225.240.215:38554&gt; preempting none &lt;131.225.238.42:43337&gt;\nglidein_5068@fcdfcaf1598.fnal.gov\n\n\n[cdfcaf@fcdfhead10 /export/condor_local/spool] condor_userprio\n-getreslist group_MCprod.vellidis@fnal.gov  | tail -1\nNumber of Resources Used: 3579\n[cdfcaf@fcdfhead10 /export/condor_local/spool] condor_userprio\n-getreslist group_mcprod.vellidis@fnal.gov  | tail -1\nNumber of Resources Used: 0\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2011-Mar-23 17:33", "status": "resolved", "created": "2011-Mar-23 17:32", "fixed_version": "2011-Mar-23 17:32", "broken_version": "v070403", "priority": "4", "subsystem": "", "assigned_to": "eje", "derived_from": "#1393", "creator": "danb", "rust": "a21828", "customer_group": "fermi", "visibility": "public", "notify": "", "due_date": ""}