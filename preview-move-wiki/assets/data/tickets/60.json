{"id": 60, "title": "Ticket #60: Add timing information to classad debug() function", "description": "<blockquote>\nThe classad debug() function allows for debugging of classad expressions. The debug information about evaluation should include timing data, either on each evaluation, each function call, and/or at least on the overall debug() function.\n\n<p>Current output...\n\n</p><p></p><div class=\"restricted\"><pre>(submit file has: +expression = 1 + 1)\n\n01/21 17:26:30 Classad debug: expression --&gt; ERROR\n01/21 17:26:30 Classad debug: expression --&gt; 2\n01/21 17:26:30 Classad debug: Machine --&gt; ERROR\n01/21 17:26:30 Classad debug: Machine --&gt; robin.local\n01/21 17:26:30 Classad debug: regexp(\".*a.*\", Machine) --&gt; 1\n01/21 17:26:30 Classad debug: Arch --&gt; ERROR\n01/21 17:26:30 Classad debug: Arch --&gt; INTEL\n01/21 17:26:30 Classad debug: OpSys --&gt; ERROR\n01/21 17:26:30 Classad debug: OpSys --&gt; LINUX\n01/21 17:26:30 Classad debug: Disk --&gt; ERROR\n01/21 17:26:30 Classad debug: Disk --&gt; 2001302\n01/21 17:26:30 Classad debug: DiskUsage --&gt; ERROR\n01/21 17:26:30 Classad debug: DiskUsage --&gt; 32\n01/21 17:26:30 Classad debug: Memory --&gt; ERROR\n01/21 17:26:30 Classad debug: Memory --&gt; 1008\n01/21 17:26:30 Classad debug: ImageSize --&gt; ERROR\n01/21 17:26:30 Classad debug: ImageSize --&gt; 32\n01/21 17:26:30 Classad debug: FileSystemDomain --&gt; ERROR\n01/21 17:26:30 Classad debug: TARGET.FileSystemDomain --&gt; robin.local\n01/21 17:26:30 Classad debug: FileSystemDomain --&gt; ERROR\n01/21 17:26:30 Classad debug: MY.FileSystemDomain --&gt; robin.local\n01/21 17:26:30 Classad debug: debug(expression == 2 &amp;&amp; regexp(\".*a.*\", Machine) &amp;&amp; (Arch == \"INTEL\") &amp;&amp; (OpSys == \"LINUX\") &amp;&amp; (Disk &gt;= DiskUsage) &amp;&amp; ((Memory * 1024) &gt;= ImageSize) &amp;&amp; (TARGET.FileSystemDomain == MY.FileSystemDomain)) --&gt; 1\n</pre></div>Maybe...\n\n<p></p><div class=\"restricted\"><pre>Classad debug: [1 ms] expression --&gt; 2\n...\nClassad debug: [5 ms] regexp(\".*a.*\", Machine) --&gt; 1\n...\nClassad debug: [8 ms] debug(expression == 2 &amp;&amp; regexp(\".*a.*\", Machine) &amp;&amp; (Arch == \"INTEL\") &amp;&amp; (OpSys == \"LINUX\") &amp;&amp; (Disk &gt;= DiskUsage) &amp;&amp; ((Memory * 1024) &gt;= ImageSize) &amp;&amp; (TARGET.FileSystemDomain == MY.FileSystemDomain)) --&gt; 1\n</pre></div></blockquote>", "remarks": "<blockquote>\n<em>2010-Jul-01 11:06:13 by psilord:</em> <br/>\n\nThis should go into master.\n\n<p></p><hr/>\n<em>2010-Jul-06 14:52:47 by slauson:</em> <br/>\n\nThe classad debug() function isn't implemented in the development series of Condor yet. Jaime is working on it.\n\n<p></p><hr/>\n<em>2010-Jul-06 15:53:43 by psilord:</em> <br/>\n\nAfter speaking with Jamie, he's inclined to ignore implementing the classad debug() function until there is actual need for it. So, this ticket goes back to new and gets assigned to pits.\n\n<p></p><hr/>\n<em>2010-Jul-06 17:14:16 by matt:</em> <br/>\n\nEeek, debug() is present in 7.4. Do you intend to drop it in 7.5?\n\n<p></p><hr/>\n<em>2010-Jul-06 17:28:31 by jfrey:</em> <br/>\n\nWe'd like to implement it for 7.5, but it hasn't been a high priority yet.\n<hr/>\n<em>2010-Oct-20 15:59:08 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:21:33 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2012-Oct-30 14:20:46 by jfrey:</em> <br/>\n\nTwo comments on this change:\n\n<p></p><ul>\n<li>We should have Windows code.\n</li><li>The timing operations in <code>Evaluate()</code> should only be done if <code>state.debug</code> is true. <strong>[DONE]</strong>\n</li></ul>\n\n<p></p><hr/>\n<em>2012-Nov-07 13:35:36 by jfrey:</em> <br/>\n\nYou missed the second ExprTree::Evaluate() method when making the timing only happen when in debug().\n\n<p></p><hr/>\n<em>2012-Nov-07 14:44:52 by matt:</em> <br/>\n\nThanks. I searched for gettimeofday, they should all be covered now.\n<hr/>\n<em>2012-Dec-11 16:35:11 by johnkn:</em> <br/>\n\nBulk change of target version from v070902 to v070903 using ./ticket-target-mover.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3374\" onclick=\"get_ticket_and_populate_wrapper('3374'); return false;\" title=\"ClassAd debug timing on Windows\">#3374</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> debug timing on Windows</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-07 14:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=34042\">[34042]</a></span>: ExprTree::Evaluate - only call gettimeofday if debugging, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=60\" onclick=\"get_ticket_and_populate_wrapper('60'); return false;\" title=\"Add timing information to classad debug() function\">#60</a></span>  (By Matthew Farrellee )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-02 14:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33965\">[33965]</a></span>: ExprTree::Evaluate - only call gettimeofday if debugging, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=60\" onclick=\"get_ticket_and_populate_wrapper('60'); return false;\" title=\"Add timing information to classad debug() function\">#60</a></span>  (By Matthew Farrellee )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Oct-16 19:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33686\">[33686]</a></span>: Add ms timestamp to debug() output, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=60\" onclick=\"get_ticket_and_populate_wrapper('60'); return false;\" title=\"Add timing information to classad debug() function\">#60</a></span>  (By Matthew Farrellee )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2012-Dec-12 10:24", "status": "resolved", "created": "2009-Jan-21 17:33", "fixed_version": "2009-Jan-21 17:33", "broken_version": "", "priority": "3", "subsystem": "Libs", "assigned_to": "gthain", "derived_from": "#1488", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "slauson@cs.wisc.edu psilord@cs.wisc.edu matt@cs.wisc.edu jfrey@cs.wisc.edu", "due_date": ""}