{"id": 3635, "title": "Ticket #3635: Add \"peaceful-off\" function to condor init script", "description": "<blockquote>\nSteve Timm has enhanced his condor.init script to include a \"peaceful-off\" (previously \"drain\") function for the following reason and we would like it implemented:\n\n<p></p><div class=\"blockquote\">\n<table width=\"95%\"><tbody><tr><td>\u00a0</td><td>\n  The \"drain\" function is interesting enough because I am configuring condor\non a system where I manage the head nodes but others manage the worker\nnodes.  so it is easier to tell them to \"service condor drain\"\na worker node than it is to tell them to:\n\nexport X509_USER_PROXY=\"foo\" ; condor_off -peaceful</td></tr></tbody></table></div>\n\n\n<p>See the attached patch file.</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Jun-05 18:09:22 by bbockelm:</em> <br/>\n\nStill feels like I'm missing some context - why would X509_USER_PROXY need to be set to turn off condor?\n\n<p></p><hr/>\n<em>2013-Jun-10 15:15:23 by tannenba:</em> <br/>\n\nWhat does this mean for systemd systems - can they just receive a new verb 'drain' ?  What does this mean for deb packages?  Are we making something completely specific for RHEL5 or ?  Is that a good idea?\n\n<p></p><hr/>\n<em>2013-Jun-13 14:54:13 by blin:</em> <br/>\n\nDebian follows the <a class=\"external\" href=\"http://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/iniscrptact.html\">LSB init standard</a> (<a class=\"external\" href=\"http://wiki.debian.org/LSBInitScripts\">http://wiki.debian.org/LSBInitScripts</a>), which allows extra actions on top of the required ones. RHEL 6 hasn't moved onto systemd so this patch would also work there. Additionally, this patches the redhat-specific init script that we ship with our RPM's and not the more general SysV/LSB script condor.boot.rpm.\n\n<p>As for systemd support, <a class=\"external\" href=\"http://www.freedesktop.org/wiki/Software/systemd/Incompatibilities/\">freedesktop</a> suggests the following solution:\n\n</p><p></p><div class=\"blockquote\">\n<table width=\"95%\"><tbody><tr><td>\u00a0</td><td>\n   Additional verbs for init scripts are not supported. If your init script traditionally supported additional verbs for your init script simply move them to an auxiliary script.</td></tr></tbody></table></div>\n\n\n<p></p><hr/>\n<em>2013-Jun-13 15:18:30 by bbockelm:</em> <br/>\n\nHi -\n\n<p>Yes, on RHEL platforms, this feature will \"only\" have a lifetime of 3-6 years until the last RHEL6 box disappears.\n\n</p><p>However, it's handy and straightforward - I'm OK with it going in from a packaging perspective.\n\n</p><p>Brian</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/813/condor_peaceful_off.patch\">condor_peaceful_off.patch</a>\n819 bytes added by blin on 2013-Nov-22 21:11:55 UTC.\n<br/>\nUpdated the patch to make it bourne shell friendly.<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "", "type": "enhance", "last_change": "2015-Aug-01 21:21", "status": "resolved", "created": "2013-May-16 15:54", "fixed_version": "2013-May-16 15:54", "broken_version": "v080000", "priority": "3", "subsystem": "Packaging", "assigned_to": "tim", "derived_from": "#3638", "creator": "blin", "rust": "", "customer_group": "fermi", "visibility": "public", "notify": "", "due_date": ""}