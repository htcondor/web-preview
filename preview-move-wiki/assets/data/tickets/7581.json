{"id": 7581, "title": "Ticket #7581: Fix need to invoke and depth of recursion for MAX_REMAP_RECURSIONS", "description": "<blockquote>\nA user in a real environment has a file that lives in a directory hierarchy more than 20 levels deep.  This tripped the \"probably has a cycle\" circuit breaker for file transfer remaps, which uses a recursive function.\n\n<p>First of all, it seems like there is no purpose in walking the directory hierarchy if there are no remaps to apply.  So I propose to add a check for that at the top of the recursive function to short circuit that whole process.  This will be addressed in <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7619\" onclick=\"get_ticket_and_populate_wrapper('7619'); return false;\" title=\"don't walk directory tree if output file transfer remaps not enabled\">#7619</a></span>.\n\n</p><p>Also, there is very little performance overhead in doing the remaps when needed, as it's just in-memory processing of a directory hierarchy using a recursive function.  However, we do need to have some finite limit in case there is a cycle in the remap rules, so I propose for this ticket we change the default for <code>MAX_REMAP_RECURSIONS</code> to 128.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Apr-08 10:00:17 by tannenba:</em> <br/>\n\nAnd also please add MAX_REMAP_RECURSIONS to  1) the param table so it shows up in condor_config_val -dump etc, and 2) to the Manual!\n\n<p></p><hr/>\n<em>2020-Apr-27 08:59:34 by zmiller:</em> <br/>\n\nSplit ticket into:\n<ol>\n<li>Change default (this ticket)\n</li><li>Skip recursion all together (<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7619\" onclick=\"get_ticket_and_populate_wrapper('7619'); return false;\" title=\"don't walk directory tree if output file transfer remaps not enabled\">#7619</a></span>)\n</li><li>Documentation (<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7597\" onclick=\"get_ticket_and_populate_wrapper('7597'); return false;\" title=\"Fix docs for file transfer input/output remaps and directory support\">#7597</a></span>)</li></ol>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7597\" onclick=\"get_ticket_and_populate_wrapper('7597'); return false;\" title=\"Fix docs for file transfer input/output remaps and directory support\">#7597</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nFix docs for file transfer input/output remaps and directory support</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7619\" onclick=\"get_ticket_and_populate_wrapper('7619'); return false;\" title=\"don't walk directory tree if output file transfer remaps not enabled\">#7619</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ndon't walk directory tree if output file transfer remaps not enabled</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-27 09:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=59503\">[59503]</a></span>: Version history for MAX_REMAP_RECURSIONS change. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7581\" onclick=\"get_ticket_and_populate_wrapper('7581'); return false;\" title=\"Fix need to invoke and depth of recursion for MAX_REMAP_RECURSIONS\">#7581</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-14 16:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=59349\">[59349]</a></span>: Change default (and add to param table) MAX_REMAP_RECURSIONS. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7581\" onclick=\"get_ticket_and_populate_wrapper('7581'); return false;\" title=\"Fix need to invoke and depth of recursion for MAX_REMAP_RECURSIONS\">#7581</a></span>  (By zmiller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Apr-27 11:19", "status": "resolved", "created": "2020-Apr-06 10:57", "fixed_version": "2020-Apr-06 10:57", "broken_version": "v080800", "priority": "2", "subsystem": "FileTransfer", "assigned_to": "zmiller", "derived_from": "", "creator": "zmiller", "rust": "", "customer_group": "users", "visibility": "public", "notify": "zmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": "20200410"}