{"id": 4936, "title": "Ticket #4936: Fix time zone handling in python bindings", "description": "<blockquote>\nIn the Python bindings, when converting a python datetime object into a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AbsTime\" title=\"Abs Time\">AbsTime</a></span> value, it calculates the offset of the local time zone from UTC based on the current time. It should do the calculation based on the time of the event. Otherwise, a timestamp value won't round-trip properly if it's during standard time but the current time is DST, or vice versa.\n\n<p>This is causing one of the unit tests to fail during part of the year.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Mar-13 11:37:17 by jfrey:</em> <br/>\n\nAs a further improvement, we can preserve the time zone information when converting between Python datetime and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> absTime values. I have a patch for the Python-&gt;ClassAd conversion, but I'm struggling with the other direction.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=4941\" onclick=\"get_ticket_and_populate_wrapper('4941'); return false;\" title=\"Preserve time zone info in python bindings\">#4941</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nPreserve time zone info in python bindings</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-17 13:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/133994e786997c8c9aaf3ebf2b5355299c0b18dc\">[43609]</a></span>: Docs for DST bug fixes with <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> timestamps. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4936\" onclick=\"get_ticket_and_populate_wrapper('4936'); return false;\" title=\"Fix time zone handling in python bindings\">#4936</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4937\" onclick=\"get_ticket_and_populate_wrapper('4937'); return false;\" title=\"Fix time zone handling in ClassAds\">#4937</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-16 10:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c1c735713cefe536dc4b051982f1f44a8b6d9cb5\">[43586]</a></span>: Fix time zone handling in python bindings for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AbsTime\" title=\"Abs Time\">AbsTime</a></span>. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4936\" onclick=\"get_ticket_and_populate_wrapper('4936'); return false;\" title=\"Fix time zone handling in python bindings\">#4936</a></span> When converting a Python datetime value to a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AbsTime\" title=\"Abs Time\">AbsTime</a></span> value, the bindings should calculate the local time zone offset from UTC based on the time of the value, not the current time. Otherwise, a timestamp value won't round-trip\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-13 10:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1d0f68d5af4b8154f7501862bdc1df91e685fb54\">[43576]</a></span>: Fix time zone handling in python bindings for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AbsTime\" title=\"Abs Time\">AbsTime</a></span>. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4936\" onclick=\"get_ticket_and_populate_wrapper('4936'); return false;\" title=\"Fix time zone handling in python bindings\">#4936</a></span> When converting a Python datetime value to a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=AbsTime\" title=\"Abs Time\">AbsTime</a></span> value, the bindings should calculate the local time zone offset from UTC based on the time of the value, not the current time. Otherwise, a timestamp value won't round-trip\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Mar-17 13:33", "status": "resolved", "created": "2015-Mar-13 10:39", "fixed_version": "2015-Mar-13 10:39", "broken_version": "v080102", "priority": "3", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "#3911", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "jfrey@cs.wisc.edu,bbockelm@cse.unl.edu", "due_date": ""}