{"id": 7500, "title": "Ticket #7500: Clients should not suggest authentication methods they don't support", "description": "<blockquote>\nWe had a surprisingly long security-handshake-debugging session that came down to the fact  that the client will happily suggest to the server various authentication methods that it doesn't support.  It's only later, when the client and server are exchanging integers, that the client silently refuses to use the suggested protocol.\n\n<p>Can we:\n\n</p><p></p><ol>\n<li>Note at <em>at least</em> at D_FULLDEBUG (maybe D_SECURITY?  D_ALWAYS?) when the sysadmin has configured an unknown protocol name?\n</li><li>Similarly, when the client is rejecting unsupported protocols from the server, we should note this reason in the logs.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2020-Apr-18 18:45:19 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>Fixed a non-const char * warning.\n\n</p><p>Otherwise this looks sane, although I wonder if it makes sense to have the READ-implies-CLAIMSTOBE special case tucked away in <code>getDefaultAuthenticationMethods()</code>.  I don't know enough about the logic of the special case to tell if it's actually intrinsic in the default authentication methods or if it only applies to the caller.\n\n</p><p></p><hr/>\n<em>2020-Apr-18 18:46:47 by tlmiller:</em> <br/>\n\nMerged to master.  Assigning back to you to decide if this needs a release note or not.  (I guess it could result in some connections unexpectedly starting to work?)</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jul-31 17:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60298\">[60298]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7500\" onclick=\"get_ticket_and_populate_wrapper('7500'); return false;\" title=\"Clients should not suggest authentication methods they don't support\">#7500</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7627\" onclick=\"get_ticket_and_populate_wrapper('7627'); return false;\" title=\"Support CPU affinity with Docker\">#7627</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7647\" onclick=\"get_ticket_and_populate_wrapper('7647'); return false;\" title=\"UW condor 8.9.7 RPM does not pull in Python bindings\">#7647</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7712\" onclick=\"get_ticket_and_populate_wrapper('7712'); return false;\" title='Add \"--debug\" option to bosco_cluster'>#7712</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7753\" onclick=\"get_ticket_and_populate_wrapper('7753'); return false;\" title=\"RHEL-based Bosco tarballs using the wrong version\">#7753</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-18 18:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=59414\">[59414]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7500\" onclick=\"get_ticket_and_populate_wrapper('7500'); return false;\" title=\"Clients should not suggest authentication methods they don't support\">#7500</a></span>) Fix a pair of warnings.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-18 09:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=59412\">[59412]</a></span>: Filter authentication methods. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7500\" onclick=\"get_ticket_and_populate_wrapper('7500'); return false;\" title=\"Clients should not suggest authentication methods they don't support\">#7500</a></span> - Centralize all method determination logic (which was inconsistent based on the call site). - Remove auth methods from the list that are not in the current build (e.g., no NTSSPI on Linux) or cannot be used. - Remove auth methods that don't exist in any build of\u00a0[...]\n (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Jul-31 17:40", "status": "resolved", "created": "2020-Feb-10 20:43", "fixed_version": "2020-Feb-10 20:43", "broken_version": "", "priority": "3", "subsystem": "Security", "assigned_to": "bbockelm", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "bbockelman@morgridge.org", "due_date": ""}