{"id": 6071, "title": "Ticket #6071: Change default thread count in cream_gahp", "description": "<blockquote>\nSome of our users have experienced problems when there's a large difference between the number of requests the gridmanager will issue to the cream_gahp (GRIDMANAGER_MAX_PENDING_REQUESTS, default 50) and the number of requests the cream_gahp can execute in parallel (CREAM_GAHP_WORKER_THREADS, default 6). This problem is worst when some of the requests take a long time to complete. When the gridmanager's timeout for a request is reached, the gridmanager will discard it and issue a new request in its place. But the cream_gahp will still execute the timed-out request as well as the new one. Thus, the cream_gahp may have a backlog of requests much larger than GRIDMANAGER_MAX_PENDING_REQUESTS queued up internally, with the gridmanager's timeout ticking away before the cream_gahp has started processing them.\n\n<p>Setting these config params to the same value by default will help avoid this backlog from building. Better yet, the cream_gahp can start rejecting new requests if it has too many queued already. We do this already for the blahp (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5253\" onclick=\"get_ticket_and_populate_wrapper('5253'); return false;\" title=\"Blahp thread limit can kill gridmanager\">#5253</a></span>).</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Apr-15 08:51:01 by tim:</em> <br/>\n\n<strong>CODE REVIEW:</strong> Nice change\n\n<p></p><hr/>\n<em>2017-Apr-20 10:29:35 by tim:</em> <br/>\n\n<strong>DOC REVIEW:</strong> OK</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Apr-18 10:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50504\">[50504]</a></span>: Docs for CREAM_GAHP_WORKER_THREADS default value change. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6071\" onclick=\"get_ticket_and_populate_wrapper('6071'); return false;\" title=\"Change default thread count in cream_gahp\">#6071</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Apr-14 16:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=50482\">[50482]</a></span>: Change default value of CREAM_GAHP_WORKER_THREADS. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6071\" onclick=\"get_ticket_and_populate_wrapper('6071'); return false;\" title=\"Change default thread count in cream_gahp\">#6071</a></span> The new default is $(GRIDMANAGER_MAX_PENDING_REQUESTS), which will prevent a potential backlog of issued commands in the cream_gahp that will timeout. This has been observed repeatedly at some users' sites.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Apr-20 10:29", "status": "resolved", "created": "2016-Dec-22 16:29", "fixed_version": "2016-Dec-22 16:29", "broken_version": "v080500", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "#5975", "creator": "jfrey", "rust": "", "customer_group": "cern", "visibility": "public", "notify": "", "due_date": ""}