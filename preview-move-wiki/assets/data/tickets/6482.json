{"id": 6482, "title": "Ticket #6482: Google coredumper doesn't work on rhel7", "description": "<blockquote>\nOn RHEL7 and friends, the Google coredumper produces core files that gdb doesn't like. The code hasn't been maintained in many years, so a fix from upstream is unlikely. We can return to having the kernel producing core files. The problem with the kernel not writing core files for processes that switch uids can be addressed with <code>prctl(PR_SET_DUMPABLE)</code>. The downside is that we would lose the ability to choose the name of the core file.</blockquote>", "remarks": "<blockquote>\n<em>2017-Dec-12 15:54:16 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> changes look good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Dec-13 14:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52998\">[52998]</a></span>: Docs for fixing core files on linux. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6482\" onclick=\"get_ticket_and_populate_wrapper('6482'); return false;\" title=\"Google coredumper doesn't work on rhel7\">#6482</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Nov-21 16:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52855\">[52855]</a></span>: Remove Google coredumper. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6482\" onclick=\"get_ticket_and_populate_wrapper('6482'); return false;\" title=\"Google coredumper doesn't work on rhel7\">#6482</a></span> The Google coredumper doesn't write usable core files on rhel7. It hasn't had any updates in many years, so we're unlikely to see a fix. Now that we can make the kernel write core files for daemons that change uid, we can use that instead. The small drawback is that we\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Nov-21 14:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52854\">[52854]</a></span>: Fix core dumps of setuid daemons by the kernel on linux. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6482\" onclick=\"get_ticket_and_populate_wrapper('6482'); return false;\" title=\"Google coredumper doesn't work on rhel7\">#6482</a></span> Set the PR_SET_DUMPABLE process flag in our damoncore signal handler. This flag is disabled by default for processes that change their uid  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Dec-13 14:23", "status": "resolved", "created": "2017-Nov-09 14:37", "fixed_version": "2017-Nov-09 14:37", "broken_version": "", "priority": "3", "subsystem": "Libs", "assigned_to": "jfrey", "derived_from": "#6476", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}