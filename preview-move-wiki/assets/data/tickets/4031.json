{"id": 4031, "title": "Ticket #4031: Add simple meta-params to enable complex features with default", "description": "<blockquote>\nA meta-param is a single knob that when set, changes the value of multiple config params.  Meta-knobs will be defined in the default param table like this\n\n<p></p><div class=\"code\">\n<pre class=\"code\">[$FLAVOR.CHOCOLATE]\nfriendly_name=Enable the chocolate daemon\ndefault = @end\n    DAEMON_LIST=$(DAEMON_LIST) CHOCOLATE\n    CHOCOLATE_DEBUG=D_FULLDEBUG\n    CHOCOLATE_LOG=$(LOG)/ChocolateLog\n@end\n\n[$FLAVOR.LEMON]\nfriendly_name=Enable the lemon daemon\ndefault = @end\n    DAEMON_LIST=$(DAEMON_LIST) LEMON\n    LEMON_LOG=$(LOG)/LemonLog\n@end\n</pre></div>\n\n\n<p>Meta-params are used by adding the following to the config file.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">use flavor : lemon chocolate\n</pre></div>\n\n\n<p>This will behave exactly the same as if the config file contains the following\nat the point where the <code>use flavor</code> line is.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">DAEMON_LIST=$(DAEMON_LIST) LEMON\nLEMON_LOG=$(LOG)/LemonLog\nDAEMON_LIST=$(DAEMON_LIST) CHOCOLATE\nCHOCOLATE_DEBUG=D_FULLDEBUG\nCHOCOLATE_LOG=$(LOG)/ChocolateLog\n</pre></div>\n\n\n<p>As part of this change, attempts to use : to do simple parameter assignments in the config file will generate a warning that : is reserved for meta operations.\n\n</p><p>Initially the only meta operation will be \"use\", later we may add \"include\" and other meta operations.  The syntax for use will be\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">[@]use &lt;category&gt; : &lt;option-in-category&gt;\n</pre></div>\n\nwhere\n<ul>\n<li><code>@</code> is an optional character that makes the line not valid for earlier\nversions of HTCondor, but otherwise has no effect on the result.\n</li><li><code>use</code> is the case-insensitive keyword that indicates a meta knob reference\n</li><li><code>&lt;category&gt;</code> is one of a small number of meta knob categories. ROLE, POLICY, SECURITY, and FEATURE are the current categories.\n</li><li><code>&lt;option-in-category&gt;</code> is the name of the metaknob in the given <code>&lt;category&gt;</code>, for instance <code>VMWARE</code> is one of the metaknobs in the <code>FEATURE</code> category.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Mar-11 16:01:32 by gthain:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n\n<p>THE ALWAYS_RUN knob:\n\n</p><p>Let's stick a comment in front of the max job retirement time knob to let people know what happens if they set it to non-zero\n\n</p><p>Let's remove the PERIODIC_CHECKPOINT = false knob -- even if we don't preempt, we may want to checkpoint to be able to restart when the machine crashes.\n\n</p><p>also, let's set\n\n</p><p>NEGOTIATOR_CONSIDER_PREEMPTION = false\n\n</p><p>which makes the negotiator go faster\n\n</p><p></p><hr/>\n<em>2014-Mar-31 13:41:50 by tannenba:</em> <br/>\n\nSo instead of a syntax of\n\n<p></p><pre>   $CATEGORY : Knob\n</pre>\n\n<p>how about instead having\n\n</p><p></p><pre>   use category : knob\n</pre>\n\n<p>So what used to be this\n\n</p><p></p><pre>   $ROLE : Desktop\n   $USE : GPU\n</pre>\n\n<p>would instead become\n\n</p><p></p><pre>   use ROLE : Desktop\n   use USE : GPU\n</pre>\n\n<p>Down the road we could have other reserved keywords such as INCLUDE, eg\n\n</p><p></p><pre>   INCLUDE : /usr/local/condor/myconfig.local\n</pre>\n\n<p>As we would essentially be re-purposing the \":\" chracter, this would require that the config parser EXCEPTS with a clear error message if a line contains an assignment with an \":\" character and does not start with a reserved keyword such as AUTOCONFIG or INSTALL.  Unfortunately, for no good reason at all, <a class=\"file\" href=\"rlog?f=src/condor_examples/condor_config.generic\">/src/condor_examples/condor_config.generic</a> uses a colon to define <code>RunBenchmarks</code>. :(</p></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4390\" onclick=\"get_ticket_and_populate_wrapper('4390'); return false;\" title=\"Revert GSI_DAEMON_NAME to be unset by default\">#4390</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nRevert GSI_DAEMON_NAME to be unset by default</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-10 12:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40374\">[40374]</a></span>: better definitions of predefined metaknobs in 8.2.0 <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-29 14:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40271\">[40271]</a></span>: define the new @include and @use syntax for configuration. Documentation is in the 8.2.0 manual, even though the feature is in 8.1.6. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4319\" onclick=\"get_ticket_and_populate_wrapper('4319'); return false;\" title=\"add #include like mechanism to config file parser\">#4319</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-21 15:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40203\">[40203]</a></span>: extended 8.1.6 version history item to identify all the new configuration file changes <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3820\" onclick=\"get_ticket_and_populate_wrapper('3820'); return false;\" title=\"Param system improvements for v8.1 series\">#3820</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4325\" onclick=\"get_ticket_and_populate_wrapper('4325'); return false;\" title=\"Strip default condor_config file down to the bare essentials.\">#4325</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3894\" onclick=\"get_ticket_and_populate_wrapper('3894'); return false;\" title=\"condor_config_val -dump should work remotely\">#3894</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4319\" onclick=\"get_ticket_and_populate_wrapper('4319'); return false;\" title=\"add #include like mechanism to config file parser\">#4319</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4211\" onclick=\"get_ticket_and_populate_wrapper('4211'); return false;\" title=\"Add #ifdef-like mechanism to config file parser\">#4211</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-19 14:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40176\">[40176]</a></span>: add placeholder section for where documentation about new if/else configuration file syntax will go <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3820\" onclick=\"get_ticket_and_populate_wrapper('3820'); return false;\" title=\"Param system improvements for v8.1 series\">#3820</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4211\" onclick=\"get_ticket_and_populate_wrapper('4211'); return false;\" title=\"Add #ifdef-like mechanism to config file parser\">#4211</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-19 13:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40175\">[40175]</a></span>: documentation of new configuration file syntax, use &lt;category&gt;:&lt;name&gt; <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3820\" onclick=\"get_ticket_and_populate_wrapper('3820'); return false;\" title=\"Param system improvements for v8.1 series\">#3820</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-14 11:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40123\">[40123]</a></span>: document new configuration file include: syntax <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4319\" onclick=\"get_ticket_and_populate_wrapper('4319'); return false;\" title=\"add #include like mechanism to config file parser\">#4319</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3820\" onclick=\"get_ticket_and_populate_wrapper('3820'); return false;\" title=\"Param system improvements for v8.1 series\">#3820</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-07 16:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40093\">[40093]</a></span>: tidy up SECURITY:HOST_BASED, USER_BASED meta-knobs based on ZKM's input <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-07 15:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40085\">[40085]</a></span>: add default security policy (HOST_BASED) to condor_config.generic <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-06 17:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40068\">[40068]</a></span>: cleanup and fix bad refs in security metaknobs <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> also add CONDOR_HOST=127.0.0.1 to role:personal ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-22 08:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40009\">[40009]</a></span>: fix minor crashing bug in condor_config for meta-knobs <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> also expand usage message for -writeconfig ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-18 10:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39986\">[39986]</a></span>: optional @ before use (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span>) or include keywords (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4319\" onclick=\"get_ticket_and_populate_wrapper('4319'); return false;\" title=\"add #include like mechanism to config file parser\">#4319</a></span>) in config <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3820\" onclick=\"get_ticket_and_populate_wrapper('3820'); return false;\" title=\"Param system improvements for v8.1 series\">#3820</a></span> Also change all config keywords to case-insensitive. ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-17 11:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39969\">[39969]</a></span>: fix recursion detection for meta knobs <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> ===VersionHistory:None=== bug never shipped.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-17 09:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39967\">[39967]</a></span>: change use of : for param assigment to warning from error <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span>. Fix condor_config_val -set &amp; -rset to properly handle meta-params ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-16 15:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39962\">[39962]</a></span>: define metaknobs for SECURITY, part of <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-15 10:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39930\">[39930]</a></span>: fix ccv_remote test for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-15 09:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39929\">[39929]</a></span>: Change syntax for using meta knobs from \"$cat:value\" to \"use cat:value\" <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> This change also makes the colon (:) no longer a legal assignment operator in normal param assignment. only = is allowed for param assignment, : is now reserved for meta knob use and possible future behaviors such as include\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Mar-31 17:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39804\">[39804]</a></span>: rename existing metaknobs to conform with revised design <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-07 16:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=38129\">[38129]</a></span>: basic implementation simple meta-params in param_info.in and their use in config files. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4031\" onclick=\"get_ticket_and_populate_wrapper('4031'); return false;\" title=\"Add simple meta-params to enable complex features with default\">#4031</a></span> this patch also includes changes to condor_config_val to show meta-param values and to indicate the meta-param source for an active config param. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Sep-22 10:54", "status": "resolved", "created": "2013-Nov-01 10:09", "fixed_version": "2013-Nov-01 10:09", "broken_version": "v080100", "priority": "3", "subsystem": "Libs", "assigned_to": "johnkn", "derived_from": "#3820", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "pfcouvar@syr.edu, gthain@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}