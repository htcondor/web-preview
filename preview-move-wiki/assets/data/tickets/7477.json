{"id": 7477, "title": "Ticket #7477: Unable to pre-sign some old \"path-style\" S3 bucket URLs", "description": "<blockquote>\nIn the days of yore, Amazon allowd you to create S3 buckets with names that don't quite jive with DNS; these must be accessed via URLs of the form <a class=\"external\" href=\"http://s3.amazonaws.com/&lt;bucket&gt;/&lt;key&gt;\">http://s3.amazonaws.com/&lt;bucket&gt;/&lt;key&gt;</a>, with the region set to <code>us-east-1</code> for signing purposes.\n\n<p>The Amazon <a class=\"external\" href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html\">documentation</a> about this strongly implies that we can identify such buckets by checking for upper case letters and underscores; if either is found, we must use the special URL form.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Jan-14 15:58:14 by tlmiller:</em> <br/>\n\nWe kind of need a user to test this for us. :(\n\n<p>I tested it to the point where I can generate correctly-signed URLs in the correct form for buckets with underscores or capital letters and thus get 404s rather than 403s, but actually downloading something successfully would be better.  (I also retested normal buckets, which it looks like I managed to avoid breaking.)\n\n</p><p></p><hr/>\n<em>2020-Jan-22 12:33:01 by tlmiller:</em> <br/>\n\nThe user confirms that this fix works for them.\n<hr/>\n<em>2020-Apr-10 07:46:37 by tim:</em> <br/>\n\nBulk change of target version from v080906 to v080907 using ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-22 13:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6b7c01ab25ae1cd550b61aba0d61b33cea1b16e8\">[59022]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7477\" onclick=\"get_ticket_and_populate_wrapper('7477'); return false;\" title='Unable to pre-sign some old \"path-style\" S3 bucket URLs'>#7477</a></span>) Release note.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jan-14 15:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5d0640f45ccebc1b2f1b0cc9caa8b933935357e6\">[58843]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7477\" onclick=\"get_ticket_and_populate_wrapper('7477'); return false;\" title='Unable to pre-sign some old \"path-style\" S3 bucket URLs'>#7477</a></span>) Buckets with underscores or capitals must be accessed \"path-style\".  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Apr-10 07:47", "status": "resolved", "created": "2020-Jan-14 13:52", "fixed_version": "2020-Jan-14 13:52", "broken_version": "", "priority": "2", "subsystem": "FileTransfer", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, bbockelman@morgridge.org", "due_date": ""}