{"id": 565, "title": "Ticket #565: Over long subject in Quill too-large-db email", "description": "<blockquote>\nWhen Quill decides the database is too large, it sends email.  It unhelpfully puts the entire message in the header, and nothing in the body.  For example:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">Subject: Current database size (&gt; 21509 MB) is\n        bigger than 75 percent of the limit (20 GB). Please descrease\n        the values of these parameters:\n        QUILL_RESOURCE_HISTORY_DURATION, QUILL_RUN_HISTORY_DURATION,\n        QUILL_JOB_HISTORY_DURATION or QUILL_DBSIZE_LIMIT\n\nThis is an automated email from the Condor system\non machine \"north.cs.wisc.edu\".  Do not reply.\n</pre></div>\n\n\n<p>The code in question is  ManagedDatabase::PurgeDatabase() in ManageDatabase.cpp around line 254.  The current code is:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">\t\t\temail = email_admin_open(msg_body);\n</pre></div>\n\n\n<p>I believe it should look something like:\n</p><div class=\"code\">\n<pre class=\"code\">\n                        char msg_subject[4000];\n                        snprintf(msg_body, 4000,\n                            \"%s: Database too large (%d MB &gt; 75% of %d GB)\",\n                            hostname_str, dssize, dbSizeLimit);\n\t\t\temail = email_admin_open(msg_subject);\n                        fprintf(email, \"%s\", msg_body);\n</pre></div>\n\n\n<p>Finding hostname_str is left as an exercise to the implementer.</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2010-Oct-20 15:59:08 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:21:33 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2011-Feb-01 14:51", "status": "new", "created": "2009-Jun-15 16:00", "fixed_version": "2009-Jun-15 16:00", "broken_version": "", "priority": "4", "subsystem": "Quill", "assigned_to": "", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}