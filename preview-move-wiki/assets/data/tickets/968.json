{"id": 968, "title": "Ticket #968: daemon ads contain many copies of sinful string", "description": "<blockquote>\nDaemon ads contain four copies of the address: <code>SubsysIpAddr</code>, <code>MyAddress</code>, <code>PublicNetworkIpAddr</code>, and <code>PrivateNetworkIpAddr</code>.  This is overly complicated and we have begun to accumulate potential compatibility complexity where bits of condor pay attention to different attributes.\n\n<p>Since 7.3.0, <code>PrivateNetworkIpAddr</code> is redundant, because the private address and network name are attributes of the full contact string advertised in all of the other attributes.  Furthermore, when private network attributes are set, we chose to break compatibility with releases prior to 7.3.0, due to the change in the format of the sinful string, so continuing to support <code>PrivateNetworkIpAddr</code> does not gain us any added backward compatibility.\n\n</p><p>Prior to 7.2.0, the negotiator depends on startds advertising the same <code>StartdIpAddr</code> or <code>MyAddress</code> in the public and private ads.  Beginning in 7.2.0, the collector copies over <code>MyAddress</code> from the public to the private ad.\n\n</p><p>The collector creates a hash key using <code>SubsysIpAddr</code>.  It does not pay attention to <code>MyAddress</code> when doing this, so for backwards compatibility with older collectors, we need to keep advertising <code>SubsysIpAddr</code>.\n\n</p><p>The daemon client object does not pay attention to <code>MyAddress</code>.\n\n</p><p>Ads written into a daemon ad file do not contain <code>MyAddress</code>.  Only ads sent to the collector do.</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Nov-17 12:35:56 by danb:</em> <br/>\n\nFor 7.5.0, I removed <code>PublicNetworkIpAddr</code> and <code>PrivateNetworkIpAddr</code> since this should not create any compatibility problems.  I left <code>SubsysIpAddr</code> and <code>MyAddress</code> in place but tried to clean things up so that if we wanted to phase out <code>SubsysIpAddr</code> in the future, we could.\n\n<p>I made the daemon client object pay attention to <code>MyAddress</code> if <code>SubsysIpAddr</code> is not there.\n\n</p><p>Daemon ad files now contain <code>MyAddress</code>.\n\n</p><p>The collector now uses <code>MyAddress</code> or <code>SubsysIpAddr</code> when creating hash keys.\n\n</p><p></p><hr/>\n<em>2009-Nov-17 13:04:45 by matt:</em> <br/>\n\nCan we get a ticket targeting 7.7 that says <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubsysIpAddr\" title=\"Subsys Ip Addr\">SubsysIpAddr</a></span> should be removed before the release of 7.8? Otherwise we're going to forget.\n\n<p></p><hr/>\n<em>2009-Nov-17 13:31:30 by danb:</em> <br/>\n\nGood idea.  I added <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=971\" onclick=\"get_ticket_and_populate_wrapper('971'); return false;\" title=\"remove SubsysIpAddr and replace with MyAddress\">#971</a></span> to remind us to remove <code>SubsysIpAddr</code>.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=971\" onclick=\"get_ticket_and_populate_wrapper('971'); return false;\" title=\"remove SubsysIpAddr and replace with MyAddress\">#971</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nremove <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubsysIpAddr\" title=\"Subsys Ip Addr\">SubsysIpAddr</a></span> and replace with <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyAddress\" title=\"My Address\">MyAddress</a></span></td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Nov-17 12:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/36307b6b651054d95eef14b50313cb5b62b2b1a7\">[25126]</a></span>: Documented cleanup of daemon address publication. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=968\" onclick=\"get_ticket_and_populate_wrapper('968'); return false;\" title=\"daemon ads contain many copies of sinful string\">#968</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Nov-17 12:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a7a7bf9df5223149f35c836aa958afe4af2fef00\">[16358]</a></span>: Removed <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=PublicNetworkIpAddr\" title=\"Public Network Ip Addr\">PublicNetworkIpAddr</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=PrivateNetworkIpAddr\" title=\"Private Network Ip Addr\">PrivateNetworkIpAddr</a></span>. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=968\" onclick=\"get_ticket_and_populate_wrapper('968'); return false;\" title=\"daemon ads contain many copies of sinful string\">#968</a></span> Also fixed up usage of <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubsysIpAddr\" title=\"Subsys Ip Addr\">SubsysIpAddr</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyAddress\" title=\"My Address\">MyAddress</a></span> so that we can phase out <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SubsysIpAddr\" title=\"Subsys Ip Addr\">SubsysIpAddr</a></span> some day.  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2010-Jan-31 08:04", "status": "resolved", "created": "2009-Nov-17 12:30", "fixed_version": "2009-Nov-17 12:30", "broken_version": "v070500", "priority": "4", "subsystem": "Daemons", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}