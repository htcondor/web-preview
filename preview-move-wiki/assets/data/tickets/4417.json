{"id": 4417, "title": "Ticket #4417: Condor does not support limiting swap space via cgroups", "description": "<blockquote>\nMany machines in CHTC are configure with much more physical memory than swap space.  For example, one generation of 24 core machines has 96 Gb physical memory and 24 Gb of swap.  When cgroups were enabled on these machine, several jobs ran that required 8 Gb total virtual address space, that specified the default of  1Gb Request_Memory.  The cgroup-enabled starter correctly limited these jobs to 1 gb ram, and pushed the remaining 7 Gb to swap.  This machine then quickly ran out of swap space (according to \"free\"), even though it had 16 Gb of free ram.  In this state, odd things started happening.  ps would hang hard, the procd would frequently lock up, and the machine was often unresponsive, even though there was significant free memory.</blockquote>", "remarks": "<blockquote>\n<em>2018-Aug-24 13:16:55 by tannenba:</em> <br/>\n\nThe version history blurb for this ticket sums it up:\n\n<p></p><div class=\"blockquote\">\n<table width=\"95%\"><tbody><tr><td>\u00a0</td><td>\n  \n\"If cgroups are enabled on Linux, the amount of swap space used by a job is now limited to the VirtualMemory (slot attriburte) size of the slot it is running on.\"\n</td></tr></tbody></table></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Aug-29 15:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41067\">[41067]</a></span>: minor edit of 8.3.1 version history item <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4417\" onclick=\"get_ticket_and_populate_wrapper('4417'); return false;\" title=\"Condor does not support limiting swap space via cgroups\">#4417</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Aug-07 16:11</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40905\">[40905]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4417\" onclick=\"get_ticket_and_populate_wrapper('4417'); return false;\" title=\"Condor does not support limiting swap space via cgroups\">#4417</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Aug-07 16:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40904\">[40904]</a></span>: Enforce virtual memory limits with cgroups <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4417\" onclick=\"get_ticket_and_populate_wrapper('4417'); return false;\" title=\"Condor does not support limiting swap space via cgroups\">#4417</a></span> This relies on the value of the slot's <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=VirtualMemory\" title=\"Virtual Memory\">VirtualMemory</a></span> attribute, and uses it to set the memory + swap limit with cgroups.  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2018-Aug-24 13:17", "status": "resolved", "created": "2014-Jun-25 09:43", "fixed_version": "2014-Jun-25 09:43", "broken_version": "v080200", "priority": "4", "subsystem": "", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "", "due_date": ""}