{"id": 1938, "title": "Ticket #1938: Run blahp over ssh on remote pbs/lsf machine", "description": "<blockquote>\nCurrently, for Condor to submit jobs to a PBS or LSF cluster, a schedd must be running on the frontend node of the cluster. We would like to remove that requirement and allow job submission to a PBS/LSF cluster with no prior software installation on the frontend node and only SSH access. Ideally, a user's local schedd would be able to submit jobs to multiple remote clusters via SSH.\n\n<p>As a first step, we will demonstrate the ability to submit jobs when the blahp is preinstalled on the frontend node and all job files remain on the frontend node. The gridmanager will start and communicate with the blahp remotely via ssh.\n\n</p><p><span class=\"subsection\"></span></p><h3>Summary </h3>\n\n<p>We have been working on a job universe type in Condor-G that allows a\nuser to submit a job destined to run on a remote PBS or LSF cluster in\nwhich the head node of the remote cluster does not have any grid gateway\nsoftware installed (such as Condor-C, Globus, Cream, etc). Instead, all\nthat is required is for the user to have ssh access into the head node.\n\n</p><p>On the Condor-G submit side, the user needs to enumerate all the cluster front\nends in which he/she has ssh access, where the blahp is installed on\neach, and an ssh key file and passphrase to authenticate with each.\n\n</p><p>On each cluster frontend, the blahp must be installed. At this point, we\ndon't do any file transfer, so all job executables and data files must\nbe installed on each cluster frontend as well. Job output files will be left\non the cluster frontend.\n\n</p><p>The user can then submit their jobs to Condor-G as a standard LSF/PBS grid\nuniverse job. New parameters in the submit file specify which cluster\nfrontend to use and where the job's files are located on the remote\nmachine.\n\n</p><p>Aside from file transfer, all Condor-G functionality should work as\nnormal. We plan to add file tranasfer in the future if demand warrants.\n\n</p><p><span class=\"subsection\"></span></p><h3>Milestones </h3>\n\n<p></p><ul>\n<li>Setup a local PBS cluster for testing. <strong>[DONE]</strong>\n</li><li>Submit a job by running the blahp remotely via ssh with no file transfer and hacky handling of ssh credentials. <strong>[DONE]</strong>\n</li><li>Allow disabling of all file existence and permission checks in condor_submit.\n</li><li>Determine best handling of ssh credentials. <strong>[DONE]</strong>\n</li><li>Test submitting many jobs. <strong>[DONE]</strong>\n</li><li>Test failure recovery. <strong>[DONE]</strong>\n</li><li>Setup test installation useable by Josh. <strong>[DONE]</strong>\n</li><li>Plan how to handle file transfers. (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2386\" onclick=\"get_ticket_and_populate_wrapper('2386'); return false;\" title=\"Add file transfer to BOSCO\">#2386</a></span>)\n</li><li>Figure out how to determine whether jobs are progressing through batch queue (Marco)\n</li></ul>\n\n<p><span class=\"subsection\"></span></p><h3>Ideas for future work</h3></blockquote>", "remarks": "<blockquote>\n<em>2011-Mar-11 15:30:05 by jfrey:</em> <br/>\n\nI ran some tests submitting multiple jobs to a single remote cluster and killing the gridmanager. Both worked as expected.\n\n<p></p><hr/>\n<em>2011-Apr-27 13:09:19 by jfrey:</em> <br/>\n\nWork for this ticket is being done on branch V7_7-blahp_over_ssh-publicbranch.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2068\" onclick=\"get_ticket_and_populate_wrapper('2068'); return false;\" title=\"Investigate authentication options for blahp-over-ssh\">#2068</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nInvestigate authentication options for blahp-over-ssh</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2085\" onclick=\"get_ticket_and_populate_wrapper('2085'); return false;\" title=\"Write shim script for blahp-over-ssh\">#2085</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nWrite shim script for blahp-over-ssh</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2386\" onclick=\"get_ticket_and_populate_wrapper('2386'); return false;\" title=\"Add file transfer to BOSCO\">#2386</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd file transfer to BOSCO</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2421\" onclick=\"get_ticket_and_populate_wrapper('2421'); return false;\" title=\"Create simple installation for current blahp over ssh\">#2421</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nCreate simple installation for current blahp over ssh</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Apr-27 13:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cf34e67f795e30a145c8c816ae53bf5a4aafe72a\">[21606]</a></span>: First pass at blahp-over-ssh changes in gridmanager. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1938\" onclick=\"get_ticket_and_populate_wrapper('1938'); return false;\" title=\"Run blahp over ssh on remote pbs/lsf machine\">#1938</a></span> Gridmanager now accepts an optional resource id in the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GridResource\" title=\"Grid Resource\">GridResource</a></span> attribute for blahp-based job types. The id is passed to the blahp on the command line. This allows a shim script to start a blahp on the selected remote resource to interact\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Aug-04 11:40", "status": "resolved", "created": "2011-Mar-01 16:59", "fixed_version": "2011-Mar-01 16:59", "broken_version": "", "priority": "2", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tannenba@cs.wisc.edu", "due_date": ""}