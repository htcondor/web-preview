{"id": 5368, "title": "Ticket #5368: condor_transfer_data fails and causes schedd to except", "description": "<blockquote>\nDue to same safeguards added in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4522\" onclick=\"get_ticket_and_populate_wrapper('4522'); return false;\" title=\"priv-state code may unset supplemental groups\">#4522</a></span>, the SchedD will except when transferring data out to the condor_transfer_data tool.\n\n<p>Gory details: the problem is in <span class=\"quote\">BuildFileCatalog</span> in the file transfer object, which hard-codes a parameter to the instantiation of a Directory object as PRIV_USER.  This causes the Directory object to attempt to switch to user priv when iterating the contents of spool, which we don't want since user_privs have not been initted and spool is owned by the condor user anyway.\n\n</p><p>The reason this is a regression is that without this check, some warnings would get dprintf'ed into the log, but it was not fatal.  The commits in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4522\" onclick=\"get_ticket_and_populate_wrapper('4522'); return false;\" title=\"priv-state code may unset supplemental groups\">#4522</a></span> change the failure semantics.\n\n</p><p>I could simply change the one call site that I'm aware of, but am uncertain we wouldn't be bitten again by a different use case.  As such, my preference for 8.4.2 is to revert the change, going back to the same behavior as 8.4.0, and leave this alone for the stable series.  We should put the EXCEPT back in and fix call sites in the dev series.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Nov-04 23:00:00 by zmiller:</em> <br/>\n\nThe commits from <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4522\" onclick=\"get_ticket_and_populate_wrapper('4522'); return false;\" title=\"priv-state code may unset supplemental groups\">#4522</a></span> were reverted.\n\n<p></p><hr/>\n<em>2015-Nov-18 16:10:37 by tim:</em> <br/>\n\nOSG reports that all the extra log messages are annoying in 8.4.2.\n\n<p></p><hr/>\n<em>2015-Nov-18 17:26:46 by zmiller:</em> <br/>\n\nWhich messages?  Can you paste an example here?  (All I did was revert some commits so I'm curious how that could add debug messages that weren't there in 8.4.0)\n\n<p></p><hr/>\n<em>2015-Nov-18 17:38:40 by blin:</em> <br/>\n\nLog snippets here: <a class=\"external\" href=\"https://jira.opensciencegrid.org/browse/SOFTWARE-2084?focusedCommentId=333136&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-333136\">https://jira.opensciencegrid.org/browse/SOFTWARE-2084?focusedCommentId=333136&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-333136</a>\n\n<p></p><hr/>\n<em>2015-Dec-03 16:03:08 by tim:</em> <br/>\n\nFollow on ticket <span class=\"ticket\"><a class=\"abandoned\" href=\"/tickets?ticket=5429\" onclick=\"get_ticket_and_populate_wrapper('5429'); return false;\" title='\"Permission denied\" log messages with HTCondor CE'>#5429</a></span> created. Abandoning this ticket.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2015-Dec-03 16:03", "status": "abandoned", "created": "2015-Nov-04 15:39", "fixed_version": "2015-Nov-04 15:39", "broken_version": "v080401", "priority": "1", "subsystem": "FileTransfer", "assigned_to": "zmiller", "derived_from": "#4555", "creator": "zmiller", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "blin@cs.wisc.edu", "due_date": "20151105"}