{"id": 7044, "title": "Ticket #7044: param calls in submit_utils should happen only when used by tools", "description": "<blockquote>\nThere are several places in submit_utils where param() is called.  We must NOT invoke param() when materializing jobs in the Schedd, the value of param() from the tool must be used instead.\n\n<p>For the most part we will fix this by refactoring submit_utils to use the param() only when building the cluster ad (which always happens on the tool side and never in the Schedd), or we will capture the value of the param() and stuff it into the submit digest - like we currently do with the current working directory.\n\n</p><p>A similar correctness issue is that there are many places in submit_utils where a default action is taken when the submit file has no keyword.  The is the correct behavior when processing a submit file, but NOT the correct behavior when processing a submit digest (which may have been pruned back to the essential statements).  When materializing in the presence of a clusterAd, the values of the clusterAd should always be used when a submit keyword is unspecified.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-30 12:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57008\">[57008]</a></span>: doc and version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6941\" onclick=\"get_ticket_and_populate_wrapper('6941'); return false;\" title=\"add a json output option to the userlog and event log\">#6941</a></span>. version history and minor bugfix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7044\" onclick=\"get_ticket_and_populate_wrapper('7044'); return false;\" title=\"param calls in submit_utils should happen only when used by tools\">#7044</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-10 14:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56847\">[56847]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7044\" onclick=\"get_ticket_and_populate_wrapper('7044'); return false;\" title=\"param calls in submit_utils should happen only when used by tools\">#7044</a></span>, allow both signed and unsigned ints in submit_utils table  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-10 11:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56842\">[56842]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7044\" onclick=\"get_ticket_and_populate_wrapper('7044'); return false;\" title=\"param calls in submit_utils should happen only when used by tools\">#7044</a></span>, make sure that <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=BufferSize\" title=\"Buffer Size\">BufferSize</a></span> and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=BufferBlockSize\" title=\"Buffer Block Size\">BufferBlockSize</a></span> are set for standard universe jobs.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-10 09:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56841\">[56841]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7044\" onclick=\"get_ticket_and_populate_wrapper('7044'); return false;\" title=\"param calls in submit_utils should happen only when used by tools\">#7044</a></span>, logically dead code found by coverity  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-09 16:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=56833\">[56833]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7044\" onclick=\"get_ticket_and_populate_wrapper('7044'); return false;\" title=\"param calls in submit_utils should happen only when used by tools\">#7044</a></span>. refactor submit_utils so that defaults and param() calls happen only when building the cluster ad and/or when invoked by a tool and not by late materialization. This is accomplished by 1) moving most of the functionality into a big table mapping submit keyword to job attributes 2) moving all\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-May-30 13:02", "status": "resolved", "created": "2019-May-09 14:22", "fixed_version": "2019-May-09 14:22", "broken_version": "", "priority": "4", "subsystem": "Libs", "assigned_to": "johnkn", "derived_from": "#6166", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}