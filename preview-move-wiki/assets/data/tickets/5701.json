{"id": 5701, "title": "Ticket #5701: broken argument passing for history_helper on windows", "description": "<blockquote>\nOn windows, the <code>condor_history_helper.exe</code> always returns error 1 which indicates bad argument passing.\n\n<p></p><pre>    if (argc != 5)\n    {\n         ....\n         exit(1)\n    }\n</pre>\n\n<p>Given the fact that args are NOT passed as an array into windows programs, and that several of these arguments are likely to be complex and contain \"\", the fact that argc isn't exactly 5 is unsurprising.  Further investigation is needed to be sure, but it seems likely that the way arguments are passed will have to be re-designed.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Jun-01 16:55:02 by johnkn:</em> <br/>\n\nUpon further investigation, the history_helper was also parsing lines from the history file as if they were using new-classad escaping rules, so \\ was getting lost.\n\n<p>Both of these bugs were a consequence of making a new binary to be the history_helper instead of just enhancing condor_history so that it could be asked to write classads into a socket.\n\n</p><p></p><hr/>\n<em>2016-Jun-02 15:34:52 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>These changes look good.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-02 20:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4becfc2ddd17efb994390830b094f8a3c95a04b1\">[48479]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5701\" onclick=\"get_ticket_and_populate_wrapper('5701'); return false;\" title=\"broken argument passing for history_helper on windows\">#5701</a></span>, fix schedd's remote history query to handle projections in the standard format.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-02 10:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0c6dad740dd3c044b2d5d2deb8cedcf3c2f9108f\">[48468]</a></span>: version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5701\" onclick=\"get_ticket_and_populate_wrapper('5701'); return false;\" title=\"broken argument passing for history_helper on windows\">#5701</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-02 10:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/52198163bf2408d4a25b38a20ae906f374a6d6f1\">[48467]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5701\" onclick=\"get_ticket_and_populate_wrapper('5701'); return false;\" title=\"broken argument passing for history_helper on windows\">#5701</a></span>, argument parsing broken for history_helper on windows. This commit also fixes the problem with returning items from the history file that have \\ in them which is a serious problem on Windows, and an unlikely occurrance on *nix. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-01 16:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/da8af4e2a8b7953155e8fac01877b3ec69967655\">[48464]</a></span>: fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5701\" onclick=\"get_ticket_and_populate_wrapper('5701'); return false;\" title=\"broken argument passing for history_helper on windows\">#5701</a></span>, argument parsing broken for history_helper on windows. This commit also fixes the problem with returning items from the history file that have \\ in them which is a serious problem on Windows, and an unlikely occurrance on *nix. ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Jun-02 19:06", "status": "resolved", "created": "2016-May-31 09:28", "fixed_version": "2016-May-31 09:28", "broken_version": "v080000", "priority": "3", "subsystem": "Win32", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}