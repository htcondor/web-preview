{"id": 4312, "title": "Ticket #4312: Final status for aborted DAG is incorrect", "description": "<blockquote>\nIf a DAG is aborted (unless the abort-dag-on return value is 0) the final DAG status (in the node status fil) shows up as\n\n<p></p><pre>  DagStatus = 6; /* STATUS_ERROR (removed) */\n</pre>\n\n<p>when it should be\n\n</p><p></p><pre>  DagStatus = 6; /* STATUS_ERROR (aborted) */\n</pre>\n\n<p>(See the job_dagman_abort-B test, which is currently disabled because it fails because of this error.)</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Jul-23 15:37:52 by wenger:</em> <br/>\n\nI was just working on this on V8_2-branch, but now I've created V8_2-gittrac_4312-branch for it.\n\n<p></p><hr/>\n<em>2014-Aug-07 13:08:25 by wenger:</em> <br/>\n\nNote:  I haven't added anything to the version history yet, because the version history item needs to go into 8.2.3, and my branch is older than that.\n\n<p>Also, once this all gets merged, job_dagman_abort-B should get enabled in master.\n\n</p><p></p><hr/>\n<em>2014-Sep-22 13:30:34 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong>: Looks good!</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-24 11:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41229\">[41229]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: Added job_dagman_abort-B to the new Test_Requirements file.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-22 15:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41208\">[41208]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: Enabled job_dagman_abort-B test on master.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-22 14:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41206\">[41206]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: Merged fix into 8.2 and added version history entry.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jul-28 16:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40767\">[40767]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: Hopefully final implementation of main bug fix; removed temporary code.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jul-28 12:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40760\">[40760]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: All node status file-related tests now work; still lots of temporary debug code, etc., and I want to re-check intermediate states.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jul-23 17:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40734\">[40734]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: Fixed the main problem documented in this ticket; current commit has a bunch of temporary debug code, notes, etc.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jul-14 10:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40628\">[40628]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>: Added failure subroutines to some DAGMan tests that were missing them; also prepended \"Error\" to fatal error messages in those tests. (Note: this change isn't directly part of <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4312\" onclick=\"get_ticket_and_populate_wrapper('4312'); return false;\" title=\"Final status for aborted DAG is incorrect\">#4312</a></span>, but I found these problems in the course of working on that ticket, so I'm including the changes under\u00a0[...]\n (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Sep-22 15:10", "status": "resolved", "created": "2014-Apr-15 14:40", "fixed_version": "2014-Apr-15 14:40", "broken_version": "v080006", "priority": "3", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "#4209", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.w", "due_date": ""}