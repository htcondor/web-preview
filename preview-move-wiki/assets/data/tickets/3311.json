{"id": 3311, "title": "Ticket #3311: DAGManNodesMask is not working correctly", "description": "<blockquote>\nWe have the following set in jobs submitted by DAGMan:\n<div class=\"code\">\n<pre class=\"code\">DAGManNodesMask = \"0,1,5,9,12,13,16\"\n</pre></div>\n\nThis means that the dagman log is only supposed to see events with those numbers.  But, in LMCG, I have the following in the log.\n<div class=\"code\">\n<pre class=\"code\">006 (013.000.000) 11/08 13:58:15 Image size of job updated: 11356\n006 (014.000.000) 11/08 13:58:15 Image size of job updated: 1\n006 (014.000.000) 11/08 14:03:16 Image size of job updated: 3363552\n006 (013.000.000) 11/08 14:03:16 Image size of job updated: 3400724\n006 (013.000.000) 11/08 14:08:17 Image size of job updated: 3400724\n006 (014.000.000) 11/08 14:08:17 Image size of job updated: 3458656\n006 (013.000.000) 11/08 14:18:17 Image size of job updated: 3429484\n006 (014.000.000) 11/08 14:18:17 Image size of job updated: 3460768\n006 (013.000.000) 11/08 14:28:18 Image size of job updated: 3429484\n006 (013.000.000) 11/08 14:33:18 Image size of job updated: 3429484\n006 (013.000.000) 11/08 14:43:20 Image size of job updated: 3443060\n006 (014.000.000) 11/08 14:43:20 Image size of job updated: 3467976\n006 (014.000.000) 11/08 14:53:21 Image size of job updated: 3467976\n006 (015.000.000) 11/08 15:15:22 Image size of job updated: 1\n006 (015.000.000) 11/08 15:20:22 Image size of job updated: 5759356\n006 (015.000.000) 11/08 15:25:23 Image size of job updated: 5759408\n</pre></div>\n\nSo, the masking does not seem to be working correctly.</blockquote>", "remarks": "<blockquote>\n<em>2012-Nov-09 08:26:08 by nwp:</em> <br/>\n\nLooks like I took out the code that handles the mask attribute when I \"fixed\" <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3111\" onclick=\"get_ticket_and_populate_wrapper('3111'); return false;\" title=\"DAGMan log events do not get written in local universe\">#3111</a></span>. I wrote a fix and ran it through NMI last night; everything is green.  Once I get clearance from TJ, I will put it in 7.9.2.\n\n<p></p><hr/>\n<em>2012-Nov-16 12:41:59 by wenger:</em> <br/>\n\nHey, I have a concern about the whole DAGManNodesMask idea in general -- this might break Pegasus.  I'm going to check with them, but it looks like they want to see GRID_SUBMIT and GLOBUS_SUBMIT events.\n\n<p>Also, what's the purpose of DAGManNodesMask?  Just to make the log file smaller?  And is it something we want to document for users?\n\n</p><p></p><hr/>\n<em>2012-Nov-16 14:12:36 by nwp:</em> <br/>\n\nYes, the point of DAGManNodesMask is to limit the amount of information DAGMan digests.  If the user does not define a log, then dagman.nodes.log will contain all the events.  If the user does define a log, the events will go into the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=UserLog\" title=\"User Log\">UserLog</a></span>.  The idea is that DAGMan has its own log that it is using for its own purposes.  In particular, Pegasus should use the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=UserLog\" title=\"User Log\">UserLog</a></span> if both <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=UserLog\" title=\"User Log\">UserLog</a></span> and DAGManNodeLog are defined in the job classad.\n\n<p></p><hr/>\n<em>2012-Nov-16 14:14:46 by nwp:</em> <br/>\n\nAs far as documenting it, it is documented already, similar to DAGManJobId and such, that is useful for DAGMan (only).\n\n<p></p><hr/>\n<em>2012-Nov-16 15:29:53 by wenger:</em> <br/>\n\nOkay, I'm going to turn back on the logging of the events that Pegasus wants to see.  As far as I know right now it's just the GLOBUS_SUBMIT and GRID_SUBMIT events, so it shouldn't make that much difference to the log file size.\n\n<p></p><hr/>\n<em>2012-Nov-19 08:05:47 by nwp:</em> <br/>\n\nPegasus should not be looking at DAGMan's log.  So ULOG_GLOBUS_SUBMIT and ULOG_GRID_SUBMIT do not need to be in the mask.\n\n<p></p><hr/>\n<em>2012-Nov-19 11:13:32 by wenger:</em> <br/>\n\nPegasus currently still parses the dagman.out file (I just checked with Karan about this).  The plan is that Pegasus should switch over to having DAGMan generate the jobstate.log file, and look at that.  Either way, any event that Pegasus needs to see needs to be in the DAG node log file.\n\n<p></p><hr/>\n<em>2012-Nov-20 09:38:30 by wenger:</em> <br/>\n\nHmm -- it just occurred to me that we should document that the DAGMan node log file doesn't have all of the events, so users don't get confused if they happen to notice that.\n\n<p></p><hr/>\n<em>2012-Nov-20 14:02:41 by wenger:</em> <br/>\n\nI've updated the definition of DAGManNodesMask, so as far as I'm concerned this is all set to go.\n\n<p></p><hr/>\n<em>2012-Nov-20 14:24:11 by nwp:</em> <br/>\n\nChanges look fine to me.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3328\" onclick=\"get_ticket_and_populate_wrapper('3328'); return false;\" title=\"Create a DAGManNodesMask test\">#3328</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nCreate a DAGManNodesMask test</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-28 14:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bf3b8e404f9f79534126ff1fc955cc1218ffd25f\">[34209]</a></span>: minor edits ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3311\" onclick=\"get_ticket_and_populate_wrapper('3311'); return false;\" title=\"DAGManNodesMask is not working correctly\">#3311</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-20 13:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f2f6d39f7fb57329090e173b6294234f7b826562\">[34165]</a></span>: Clarified the definitions of DAGManJobId, DAGManNodesLog, and DAGManNodesMask; fixed a typo. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3311\" onclick=\"get_ticket_and_populate_wrapper('3311'); return false;\" title=\"DAGManNodesMask is not working correctly\">#3311</a></span>  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-16 16:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c3c73486995b598805c5d210a55000d338e0e040\">[34149]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3311\" onclick=\"get_ticket_and_populate_wrapper('3311'); return false;\" title=\"DAGManNodesMask is not working correctly\">#3311</a></span>: added a bunch of events back into the DAGManNodesMask (events that either DAGMan itself looks at or Pegasus looks at).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Nov-09 08:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/850e3faa74f16e36655e24278d4684ad2bc91a79\">[34065]</a></span>: Initialize the mask in user logs <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3311\" onclick=\"get_ticket_and_populate_wrapper('3311'); return false;\" title=\"DAGManNodesMask is not working correctly\">#3311</a></span> Took a cut too deep in the fix for gt3111. Version history included, as the bug this fixes was shipped in 7.9.1.  (By Nathan W. Panike )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jan-29 14:16", "status": "resolved", "created": "2012-Nov-08 15:29", "fixed_version": "2012-Nov-08 15:29", "broken_version": "v070901", "priority": "3", "subsystem": "Dag", "assigned_to": "nwp", "derived_from": "#2807", "creator": "nwp", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu", "due_date": ""}