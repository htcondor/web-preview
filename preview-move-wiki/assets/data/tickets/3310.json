{"id": 3310, "title": "Ticket #3310: STARTER_RLIMIT_AS not enforced for PreCmd and PostCmd", "description": "<blockquote>\n(reproduced w/o modification from <a class=\"external\" href=\"https://bugzilla.redhat.com/show_bug.cgi?id=874526\">https://bugzilla.redhat.com/show_bug.cgi?id=874526</a>)\n\n<p></p><div class=\"verbatim\">\n<pre> Bert DeKnuydt 2012-11-08 06:34:52 EST\n\nDescription of problem:\n\nThe variable STARTER_RLIMIT_AS is enforced for the normal job, but\nnot for pre- and post-scripts, as specified through optional +PreCmd\nresp. +PostCmd lines in the job description file.\n\nThis gives an easy way for the 'less cooperative' user to circumvent\nlimits.\n\nVersion-Release number of selected component (if applicable):\n\ncondor-7.9.1-0.1.fc17.2\n\nHow reproducible:\n\nAlways\n\nSteps to Reproduce:\n1. Set e.g. STARTER_RLIMIT_AS = 1024\n2. Have a 'ulimit -a' in a +PreCmd script\n3. Have a 'ulimit -a' in the job itself\n4. Run the lot.\n\nActual results:\n\nPreScript output: (only relevant part)\n\nvirtual memory          (kbytes, -v) unlimited\n\nJoblog output:\n\nvirtual memory          (kbytes, -v) 1024000\n\nExpected results:\n\nI'd expect limits enforced to both Pre-script, job and Post-script.\nOtherwise, an inventive user just runs the real job in an unlimited\npre-script, and has a limited, but empty job script.\n\nAdditional info:\n\nActually, it's worse than that: common practice is to tame users using\nthe USER_JOB_WRAPPER script, to put e.g. max. number of processes there,\nor clever things with cpuset.  However, USER_JOB_WRAPPER is not invoked\nfor neither the Pre- and Post- scripts.  So here too, a creative user can\nescape our magic ...\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2012-Nov-08 07:14", "status": "new", "created": "2012-Nov-08 07:14", "fixed_version": "2012-Nov-08 07:14", "broken_version": "", "priority": "4", "subsystem": "Daemons", "assigned_to": "", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}