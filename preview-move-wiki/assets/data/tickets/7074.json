{"id": 7074, "title": "Ticket #7074: Enable SSL authentication by default", "description": "<blockquote>\nSimilar to <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7070\" onclick=\"get_ticket_and_populate_wrapper('7070'); return false;\" title=\"Enable TOKEN auth by default\">#7070</a></span> for TOKENs, we should enable SSL by default.  TODO list:\n\n<p></p><ol>\n<li>Have sane defaults for the server cert and key location.  This is <code>/etc/pki/tls/certs/localhost.crt</code> and <code>/etc/pki/tls/private/localhost.key</code>, respectively, on RHEL.\n<ul>\n<li>This <a class=\"external\" href=\"https://help.ubuntu.com/lts/serverguide/certificates-and-security.html.en\">page</a> suggests that the correct locations are <code>/etc/ssl/certs/server.crt</code> and <code>/etc/ssl/private/server.key</code>, respectively, for Debian\n</li></ul>\n</li><li>Use system trust anchors by default.  I believe this can be handled by default by OpenSSL (needs investigation).\n</li><li>Enable SSL by default if there is a file where the host cert and key are expected.  Similar to TOKEN, this should only be tried once per reconfig to avoid repeated queries of the filesystem.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2019-Jun-04 20:11:15 by bbockelm:</em> <br/>\n\nPer discussion with TimT, reassigning this to him for any Debian-related touch-ups.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Aug-04 18:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57581\">[57581]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span>) Account for different PKI locations on Debian/Ubuntu  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Aug-02 09:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57552\">[57552]</a></span>: Add documentation for SSL enabled-by-default. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-03 22:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57061\">[57061]</a></span>: Do not eliminate all possible SSL algorithms. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> OpenSSL prior to 1.0.0 did not support TLSv1.2; make sure that, in this case, we at least allow TLS v1.1 to be used.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-03 10:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57057\">[57057]</a></span>: Fixup linking issue with SSL_CTX_set_options. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-03 10:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57056\">[57056]</a></span>: Fixup: Use correct type name. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> Issue was overlooked as the build issue was ifdef'd such that it only shows up on non-PROPER builds.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-03 09:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57055\">[57055]</a></span>: Fixup build around SSL options. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> Fixes a number of small issues on OpenSSL 1.1.0 and 0.9.8 that were not caught by the Travis-CI builds.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-27 20:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57053\">[57053]</a></span>: On SSL failures, query OpenSSL for the error message. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> This causes us to log the actual failure message instead of the cryptic string \"library failure. see error queue?\"  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-27 20:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57052\">[57052]</a></span>: Only try SSL if a certificate is installed. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> When we are <em>not</em> a client, only offer SSL as a authentication method if there is a host cert and key available.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-27 20:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57051\">[57051]</a></span>: Add reasonable defaults for SSL for RHEL. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> Non-RHEL-based Linux distributions will likely need to have some of these defaults customized.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-27 20:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57050\">[57050]</a></span>: Improve SSL defaults. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7074\" onclick=\"get_ticket_and_populate_wrapper('7074'); return false;\" title=\"Enable SSL authentication by default\">#7074</a></span> Given that we have sufficiently recent versions of OpenSSL on all supported platforms, only accept TLS v1.2 (or higher) and a modern set of ciphers suggested by Mozilla.  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Apr-08 14:34", "status": "resolved", "created": "2019-May-26 11:41", "fixed_version": "2019-May-26 11:41", "broken_version": "", "priority": "3", "subsystem": "Security", "assigned_to": "bbockelm", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "other", "visibility": "public", "notify": "zmiller@cs.wisc.edu", "due_date": ""}