{"id": 7169, "title": "Ticket #7169: Startd can't update starter when EncryptExecuteDirectory=true", "description": "<blockquote>\nThe startd periodically sends slot ad updates to the starter by writing a file in the job's execute directory. It always tries to write to <code>$(EXECUTE)/dir_&lt;pid&gt;/.update.ad</code>. But when the execute directory is encrypted, it should write to <code>$(EXECUTE)/encrypted##/dir_&lt;pid&gt;/.update.ad</code>.\n\n<p>There may be other places where the startd uses the wrong execute directory when encryption is enabled.\n\n</p><p>In CHTC, this causes our policy to evict long running jobs to not fire, since it relies on attributes updated by the startd to the starter.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Aug-06 16:08:22 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>Looks good to me.</p></blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Aug-05 16:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57595\">[57595]</a></span>: Docs for .update.ad in encrypted execute dir bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7169\" onclick=\"get_ticket_and_populate_wrapper('7169'); return false;\" title=\"Startd can't update starter when EncryptExecuteDirectory=true\">#7169</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Aug-01 15:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=57545\">[57545]</a></span>: Startd can't update starter when EncryptExecuteDirectory=true <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7169\" onclick=\"get_ticket_and_populate_wrapper('7169'); return false;\" title=\"Startd can't update starter when EncryptExecuteDirectory=true\">#7169</a></span> Starter::executeDir() now always returns the value of parameter EXECUTE configured for the given starter process. When an encrypted workspace is requested, this will be different than the EXECUTE value for slot. This fixes a bug where\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Aug-06 16:09", "status": "resolved", "created": "2019-Jul-26 13:10", "fixed_version": "2019-Jul-26 13:10", "broken_version": "", "priority": "3", "subsystem": "DaemonsExecNode", "assigned_to": "jfrey", "derived_from": "#6477", "creator": "jfrey", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "", "due_date": ""}