{"id": 3164, "title": "Ticket #3164: Missing format strings", "description": "<blockquote>\nFrom Florian Weimer -\n\n<p>I've found several missing format strings, see the attached patches.  I'm unsure about the impact.\n\n</p><p>The patches are against Matt's condor-security tree.\n\n</p><p>There are further obstacles against switch on -Werror=format-nonliteral:\n\n</p><p></p><ul>\n<li>AttrGetName() in condor_utils/condor_attributes.cpp\n</li><li>AttrListPrintMask::registerFormat() in condor_utils/ad_printmask.cpp\n</li><li>EnvGetName() in condor_utils/condor_environ.cpp\n</li><li>writeUsageAd() in condor_utils/condor_event.cpp\n</li><li>Condor_Auth_Kerberos::dprintf_krb5_principal() in condor_io/condor_auth_kerberos.cpp\n</li><li>SecMan::getSecSetting_implementation() in condor_io/condor_secman.cpp\n</li><li>FormatFloat() in condor_tools/user_prio.c (??? this file contains dodgy string handling, including sprintf-to-argument)\n</li><li>ViewServer::WriteHistory() in condor_collector.V6/view_server.cpp\n</li></ul>\n\n<p>Some of those can be worked around (often by using width/precision parameters such as \"%*.*f\"), but AttrListPrintMask::registerFormat() is exposed on the condor_q, condor_history command line, so it is difficult to retire.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Jul-31 15:23:15 by jfrey:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n\n<p>I reviewed the following patches forwarded by Matt. They look good.\n\n</p><p></p><ul>\n<li>0001-HashKey-sprintf-char-remove-dangerous-API.patch\n</li><li>0016-DCMsg-cancelMessage-add-missing-format-string-3164.patch\n</li><li>0017-AddNode-add-missing-format-string-3164.patch\n</li><li>0018-AmazonVMStart-workerFunction-add-missing-format-stri.patch</li></ul>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-17 19:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33397\">[33397]</a></span>: DCMsg::cancelMessage(): add missing format string, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3164\" onclick=\"get_ticket_and_populate_wrapper('3164'); return false;\" title=\"Missing format strings\">#3164</a></span> Signed-off-by: Signed-off-by: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Committer: Matthew Farrellee  (By Florian Weimer )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-17 19:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33396\">[33396]</a></span>: HashKey::sprintf(char *): remove dangerous API, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3164\" onclick=\"get_ticket_and_populate_wrapper('3164'); return false;\" title=\"Missing format strings\">#3164</a></span> Signed-off-by: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Committer: Matthew Farrellee  (By Florian Weimer )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 12:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33367\">[33367]</a></span>: DCMsg::cancelMessage(): add missing format string, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3164\" onclick=\"get_ticket_and_populate_wrapper('3164'); return false;\" title=\"Missing format strings\">#3164</a></span> Signed-off-by: Signed-off-by: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Committer: Matthew Farrellee  (By Florian Weimer )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 12:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33368\">[33368]</a></span>: AddNode(): add missing format string, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3164\" onclick=\"get_ticket_and_populate_wrapper('3164'); return false;\" title=\"Missing format strings\">#3164</a></span> Signed-off-by: Signed-off-by: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Committer: Matthew Farrellee  (By Florian Weimer )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 12:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33369\">[33369]</a></span>: AmazonVMStart::workerFunction(): add missing format string, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3164\" onclick=\"get_ticket_and_populate_wrapper('3164'); return false;\" title=\"Missing format strings\">#3164</a></span> Signed-off-by: Signed-off-by: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Committer: Matthew Farrellee  (By Florian Weimer )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Sep-13 12:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33352\">[33352]</a></span>: HashKey::sprintf(char *): remove dangerous API, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3164\" onclick=\"get_ticket_and_populate_wrapper('3164'); return false;\" title=\"Missing format strings\">#3164</a></span> Signed-off-by: Jaime Frey &lt;jfrey@cs.wisc.edu&gt; Committer: Matthew Farrellee  (By Florian Weimer )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Dec-17 12:53", "status": "resolved", "created": "2012-Jul-30 14:41", "fixed_version": "2012-Jul-30 14:41", "broken_version": "v070600", "priority": "2", "subsystem": "Daemons", "assigned_to": "zmiller", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}