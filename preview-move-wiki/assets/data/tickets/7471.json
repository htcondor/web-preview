{"id": 7471, "title": "Ticket #7471: Condor-G jobs cannot find remote scitokens schedd", "description": "<blockquote>\nWithout <code>SCITOKENS_FILE</code> specified in the HTCondor configuration, <code>condor_submit</code> will fail to find the remote schedd, even with <code>+SciTokensFile</code> specified in the submit file:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">[blin@fermicloud052.fnal.gov scitokens]$ cat remote.sub\nlog = remote.log\nerror = remote.err\noutput = remote.out\n\nexecutable = /bin/env\n+ScitokensFile = \"/tmp/token\"\n\nqueue\n[blin@fermicloud052.fnal.gov scitokens]$ condor_submit -remote itb-ce2.chtc.wisc.edu -pool itb-ce2.chtc.wisc.edu:9619 remote.sub\n\nERROR: Can't find address of schedd itb-ce2.chtc.wisc.edu\n[blin@fermicloud052.fnal.gov scitokens]$ _condor_SCITOKENS_FILE=/tmp/token condor_submit -remote itb-ce2.chtc.wisc.edu -pool itb-ce2.chtc.wisc.edu:9619 remote.sub\nSubmitting job(s).\n1 job(s) submitted to cluster 273700.\n</pre></div>\n\n\n<p>This also appears to affect the Gridmanager, which is more annoying because you can't specify the appropriate config on the command line:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">[blin@fermicloud052.fnal.gov scitokens]$ condor_config_val SCITOKENS_FILE\nNot defined: SCITOKENS_FILE\n[blin@fermicloud052.fnal.gov scitokens]$ cat condorg.sub\nuniverse = grid\ngrid_resource = condor itb-ce2.chtc.wisc.edu itb-ce2.chtc.wisc.edu:9619\nremote_universe = vanilla\n\nlog = condorg.log\nerror = condorg.err\noutput = condorg.out\n\nexecutable = /bin/env\n+ScitokensFile = \"/tmp/token\"\n\nqueue\n\n[blin@fermicloud052.fnal.gov scitokens]$ condor_submit condorg.sub\nSubmitting job(s).\n1 job(s) submitted to cluster 16.\n[blin@fermicloud052.fnal.gov scitokens]$ tail /var/log/condor/GridmanagerLog.blin\n01/09/20 11:30:00 DaemonCore: private command socket at &lt;127.0.0.1:9618?addrs=127.0.0.1-9618&amp;alias=fermicloud052.fnal.gov&amp;noUDP&amp;sock=gridmanager_3124771_9975_1&gt;\n01/09/20 11:30:03 [3125298] Found job 16.0 --- inserting\n01/09/20 11:30:03 [3125298] gahp server not up yet, delaying ping\n01/09/20 11:30:03 [3125298] (16.0) doEvaluateState called: gmState GM_INIT, remoteState 0\n01/09/20 11:30:03 [3125298] GAHP server pid = 3125313\n01/09/20 11:30:11 [3125298] resource itb-ce2.chtc.wisc.edu is now down\n01/09/20 11:30:11 [3125298] gahp-&gt;condor_job_status_constrained returned 1 for remote schedd itb-ce2.chtc.wisc.edu\n01/09/20 11:30:11 [3125298] Requesting ping of resource\n01/09/20 11:30:11 [3125298] (16.0) doEvaluateState called: gmState GM_SUBMIT, remoteState 0\n01/09/20 11:35:13 [3125298] resource itb-ce2.chtc.wisc.edu is still down\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2020-Nov-02 14:26:26 by blin:</em> <br/>\n\nMoved to Jira: <a class=\"external\" href=\"https://opensciencegrid.atlassian.net/browse/HTCONDOR-47\">https://opensciencegrid.atlassian.net/browse/HTCONDOR-47</a></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2020-Nov-02 14:26", "status": "abandoned", "created": "2020-Jan-09 11:38", "fixed_version": "2020-Jan-09 11:38", "broken_version": "v0800905", "priority": "3", "subsystem": "Security", "assigned_to": "bbockelm", "derived_from": "", "creator": "blin", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "blin@cs.wisc.edu, bbockelman@morgridge.org", "due_date": ""}