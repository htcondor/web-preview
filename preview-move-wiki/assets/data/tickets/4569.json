{"id": 4569, "title": "Ticket #4569: Debugging tools for JobRouter.", "description": "<blockquote>\nWe've received strong feedback from OSG site admins that the job router is quite difficult to debug.  We'd like to see some client tools to help analyze setups.\n\n<p>Suggestions we've received:\n</p><ol>\n<li>Have a tool which can print all the routes (with or without defaults) and warn about any syntax errors (people often forget line continuations).\n</li><li>Have a tool which can print all jobs matching the umbrella requirements and, for each job, print the route names which match.\n</li><li>Given a single job&amp;#65533;and a route name, determine whether the job passes the umbrella requirements, passes the route requirements, and print the changes the router would make.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Sep-08 10:57:18 by bbockelm:</em> <br/>\n\nTo help motivate <strong>why</strong> we ask for these tools, I include Bob Ball's notes from deploying the HTCondor-CE:\n\n<p><a class=\"external\" href=\"https://www.aglt2.org/wiki/bin/view/AGLT2/CondorCE\">https://www.aglt2.org/wiki/bin/view/AGLT2/CondorCE</a>\n\n</p><p>Not all bullet-points result in bugs or work item - but I hope it'll give an flavor of what a knowledgable sysadmin finds confusing.\n\n</p><p></p><hr/>\n<em>2014-Sep-18 10:17:36 by johnkn:</em> <br/>\n\n<span class=\"chng\"><a href=\"chngview?cn=41163\">[41163]</a></span> provides a way to\n\n<p></p><ul>\n<li>Print all routes with defaults. There is currently no way to show routes without defaults because that would require non-trivial changes to the way the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobRouter\" title=\"Job Router\">JobRouter</a></span> class works. Use the command <div class=\"code\">\n<pre class=\"code\">condor_job_router_tool -config</pre></div>\n\n</li><li>Given a file of job ads, print umbrella requirements, which jobs match umbrella requirements and a random route that the job might be given.  (i.e. run the round-robin routing algorithm and print the result). Use the command <div class=\"code\">\n<pre class=\"code\">condor_job_router_tool -match -job &lt;file-of-job-ads&gt;</pre></div>\n\n</li></ul>\n\n<p><span class=\"chng\"><a href=\"chngview?cn=41166\">[41166]</a></span> enhances the above (on master branch only) to do\n\n</p><p></p><ul>\n<li>Given a file of job ads, print the above, and also print all routes that match each job (this breaks down if the number of job ads in the file exceeds the routing limit of any route).\n</li></ul>\n\n<p></p><hr/>\n<em>2014-Sep-18 10:21:57 by bbockelm:</em> <br/>\n\nIs it possible to, instead of a file, point the tool at jobs in a schedd?\n\n<p>As a \"poor man's\" version, maybe just give an example in the \"-help\" output on how to pipe the output from condor_q into this tool?\n\n</p><p></p><hr/>\n<em>2014-Nov-10 15:46:59 by adesmet:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n<em>review notes moved to new ticket</em> <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=4734\" onclick=\"get_ticket_and_populate_wrapper('4734'); return false;\" title=\"Improve debugging tools for JobRouter\">#4734</a></span></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4707\" onclick=\"get_ticket_and_populate_wrapper('4707'); return false;\" title=\"make man page for condor_job_router_tool\">#4707</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nmake man page for condor_job_router_tool</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Dec-23 11:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=42028\">[42028]</a></span>: Additional files in unified RPM for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4375\" onclick=\"get_ticket_and_populate_wrapper('4375'); return false;\" title=\"VM universe should better handle failures to launch (guest VM)\">#4375</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Nov-20 12:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41710\">[41710]</a></span>: condor_job_router_tool man page rename, tried again, with correct sequence of git commands <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4707\" onclick=\"get_ticket_and_populate_wrapper('4707'); return false;\" title=\"make man page for condor_job_router_tool\">#4707</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Nov-20 11:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41707\">[41707]</a></span>: tool name change condor_job_router_info becomes condor_job_router_info <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4707\" onclick=\"get_ticket_and_populate_wrapper('4707'); return false;\" title=\"make man page for condor_job_router_tool\">#4707</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Nov-19 17:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41693\">[41693]</a></span>: renam condor_job_router_tool to condor_job_router_info <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> ===VersionHistory:None=== tool never shipped*  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-24 16:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41242\">[41242]</a></span>: for condor_job_router_tool. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> Add support for reading jobs from stdin and ignoring routing attributes in the job. ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-24 14:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41239\">[41239]</a></span>: fix bug in condor_job_router_tool tool that caused it to always behave as if running as non-root. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 22:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41199\">[41199]</a></span>: coverity fixes for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> ===VersionHistory:None===  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-15 16:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=41163\">[41163]</a></span>: Add very basic debugging tool for JOB_ROUTER. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4569\" onclick=\"get_ticket_and_populate_wrapper('4569'); return false;\" title=\"Debugging tools for JobRouter.\">#4569</a></span> condor_job_router_tool This new tool can read the job router configuration and the dump the table of routes. It can also read job ad's from a file and match them to routes, printing the first matching route for each job that has a match.\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Nov-19 17:33", "status": "resolved", "created": "2014-Sep-04 08:15", "fixed_version": "2014-Sep-04 08:15", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "#4555", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "bbockelm@cse.unl.edu, blin@cs.wisc.edu, johnkn@cs.wisc.edu marian.zvada@cern.ch", "due_date": ""}