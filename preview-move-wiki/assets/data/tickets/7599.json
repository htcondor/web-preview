{"id": 7599, "title": "Ticket #7599: Assertion error w/ ft plugin with multiple output remaps in CHTC", "description": "<blockquote>\n<div class=\"verbatim\">\n<pre>executable = /usr/bin/touch\ntransfer_executable = false\narguments = file1 file2\n\ntransfer_plugins = dummy=dummy_plugin.py\ntransfer_output_remaps = \"file1 = dummy://path/to/file1; file2 = dummy://path/to/file2\"\n\nlog = log\n\nrequest_memory = 1GB\nrequest_disk = 1GB\n\nqueue 1\n</pre></div>\n\n\n<p>dummy_plugin.py: <a class=\"external\" href=\"https://gist.github.com/jasoncpatton/6a32e3af7ef97c61b783a3e542b7a52e\">https://gist.github.com/jasoncpatton/6a32e3af7ef97c61b783a3e542b7a52e</a>\n\n</p><p>Submitting this from submit2.chtc.wisc.edu results in log (more often than not):\n\n</p><p></p><div class=\"verbatim\">\n<pre>000 (6028850.000.000) 2020-04-15 10:27:53 Job submitted from host: &lt;128.104.101.92:9618?addrs=128.104.101.92-9618+[2607-f388-107c-501-a236-9fff-fe3c-caa8]-9618&amp;alias=submit2.chtc.wisc.edu&amp;noUDP&amp;sock=schedd_3841921_d3c3&gt;\n...\n040 (6028850.000.000) 2020-04-15 10:28:17 Started transferring input files\n\tTransferring to host: &lt;128.105.245.44:9618?addrs=128.105.245.44-9618&amp;alias=e3244.chtc.wisc.edu&amp;noUDP&amp;sock=slot1_3_12598_2e39_46129&gt;\n...\n040 (6028850.000.000) 2020-04-15 10:28:17 Finished transferring input files\n...\n001 (6028850.000.000) 2020-04-15 10:28:18 Job executing on host: &lt;128.105.245.44:9618?addrs=128.105.245.44-9618&amp;alias=e3244.chtc.wisc.edu&amp;noUDP&amp;sock=startd_4238_7e75&gt;\n...\n006 (6028850.000.000) 2020-04-15 10:28:18 Image size of job updated: 100\n\t1  -  MemoryUsage of job (MB)\n\t100  -  ResidentSetSize of job (KB)\n...\n040 (6028850.000.000) 2020-04-15 10:28:18 Started transferring output files\n...\n040 (6028850.000.000) 2020-04-15 10:28:21 Finished transferring output files\n...\n007 (6028850.000.000) 2020-04-15 10:28:21 Shadow exception!\n\tError from slot1_3@e3244.chtc.wisc.edu: Assertion ERROR on (m_ft_info.hold_code != 0)\n\t0  -  Run Bytes Sent By Job\n\t5384  -  Run Bytes Received By Job\n...\n</pre></div>\n\n\n<p>Given long enough, this job will complete successfully, but may take a few cycles of running on a new slot and the assertion error happening after file output. I have seen jobs complete successfully on the same slot that they previously failed.\n\n</p><p></p><div class=\"verbatim\">\n<pre>040 (6028850.000.000) 2020-04-15 10:35:17 Started transferring input files\n\tTransferring to host: &lt;128.105.245.58:9618?addrs=128.105.245.58-9618&amp;alias=e3258.chtc.wisc.edu&amp;noUDP&amp;sock=slot1_5_15530_0a31_53717&gt;\n...\n040 (6028850.000.000) 2020-04-15 10:35:17 Finished transferring input files\n...\n001 (6028850.000.000) 2020-04-15 10:35:18 Job executing on host: &lt;128.105.245.58:9618?addrs=128.105.245.58-9618&amp;alias=e3258.chtc.wisc.edu&amp;noUDP&amp;sock=startd_3016_4db9&gt;\n...\n040 (6028850.000.000) 2020-04-15 10:35:18 Started transferring output files\n...\n040 (6028850.000.000) 2020-04-15 10:35:38 Finished transferring output files\n...\n005 (6028850.000.000) 2020-04-15 10:35:38 Job terminated.\n\t(1) Normal termination (return value 0)\n\t\tUsr 0 00:00:00, Sys 0 00:00:00  -  Run Remote Usage\n\t\tUsr 0 00:00:00, Sys 0 00:00:00  -  Run Local Usage\n\t\tUsr 0 00:00:00, Sys 0 00:00:00  -  Total Remote Usage\n\t\tUsr 0 00:00:00, Sys 0 00:00:00  -  Total Local Usage\n\t0  -  Run Bytes Sent By Job\n\t5384  -  Run Bytes Received By Job\n\t0  -  Total Bytes Sent By Job\n\t48456  -  Total Bytes Received By Job\n\tPartitionable Resources :    Usage  Request Allocated\n\t   Cpus                 :        0        1         1\n\t   Disk (KB)            :       32  1048576   1581520\n\t   IoHeavy              :                           0\n\t   Memory (MB)          :        1     1024      1024\n\n\tJob terminated of its own accord at 2020-04-15T15:35:18Z.\n...\n</pre></div>\n\n\n<p>Have not been able to reproduce in a personal condor running 8.9.6. This bug may require multiple nodes to reproduce.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-16 21:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/632a0cec340001331787a70a77f4ee0248c9dc72\">[59375]</a></span>: fix bug in file_transfer that incorrectly incremented a pointer instead of what it pointed to. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7599\" onclick=\"get_ticket_and_populate_wrapper('7599'); return false;\" title=\"Assertion error w/ ft plugin with multiple output remaps in CHTC\">#7599</a></span> (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-May-21 13:22", "status": "resolved", "created": "2020-Apr-15 10:47", "fixed_version": "2020-Apr-15 10:47", "broken_version": "v080901", "priority": "2", "subsystem": "FileTransfer", "assigned_to": "johnkn", "derived_from": "", "creator": "jpatton", "rust": "", "customer_group": "scitokens", "visibility": "public", "notify": "johnkn@cs.wisc.edu,zmiller@cs.wisc.edu,jpatton@cs.wisc.edu,coatsworth@cs.wisc.edu", "due_date": ""}