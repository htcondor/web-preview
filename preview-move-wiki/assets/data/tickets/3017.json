{"id": 3017, "title": "Ticket #3017: Parallel Universe jobs with ParallelSchedulingGroups can stay idle", "description": "<blockquote>\nParallel universe jobs that specify they want parallel scheduling groups can stay idle when there are available machines in a group they could match to.  This is because of the two phase matching in the dedicated scheduling.  When PSG is on, the job is tentatively matched in the schedd, and if a match is found, the dedicated scheduler asks the negotiator for machines.  However, it does not ask for any particular machines, so the machines given out by the matchmaker may be from arbitrary parallel scheduling groups.\n\n<p>To fix this, when the dedicated scheduler matches to a particular parallel scheduling group, it will amend the requirements of that match to add in the PSG, so that the negotiator will be forced to give it machines from that group.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Oct-26 08:52:59 by samf:</em> <br/>\n\nNot fixed yet. I managed to submit jobs with Parallel Scheduling Groups (PSGs) that remain idle.\n\n<p></p><div class=\"code\">\n<pre class=\"code\">#############################################\n##   submit description file for a parallel program\n#############################################\nuniverse = parallel\nexecutable = /bin/sleep\ngetenv=true\narguments = 60\n\nshould_transfer_files = yes\nwhen_to_transfer_output = on_exit_or_evict\n\noutput = o.$(NODE)\nerror  = e.$(NODE)\nlog    = l\n\nnotification = never\nmachine_count = 2\n+WantParallelSchedulingGroups = True\n\ninitialdir = job.$(Process)\nqueue 8\n</pre></div>\n\n\n<p>Yet, if I run the same code but change\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">queue 8\n</pre></div>\n\n\n<p>to\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">queue\n</pre></div>\n\n\n<p>and manually submit the otherwise identical code on the command line 8 times, the jobs do not become idle.\n\n</p><p>Additionally, it looks like PSGs may need to have a condor restart instead of doing a condor_reconfig in order to have PSGs initialize (at least on a slot-by-slot basis).\n\n</p><p></p><hr/>\n<em>2012-Nov-12 17:45:38 by samf:</em> <br/>\n\nSo it looks like the code does what it's supposed to do. But the manual does not describe what the code does. I'm working on writing some text to update the manual.\n\n<p></p><hr/>\n<em>2013-May-24 16:23:59 by samf:</em> <br/>\n\nI've updated the documentation about the <code>queue</code> command in <code>condor_submit</code>. It's in the V8_0_0-branch. See Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3339\" onclick=\"get_ticket_and_populate_wrapper('3339'); return false;\" title=\"manual description of parallel universe needs improvement\">#3339</a></span> for where the commits are.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3339\" onclick=\"get_ticket_and_populate_wrapper('3339'); return false;\" title=\"manual description of parallel universe needs improvement\">#3339</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nmanual description of parallel universe needs improvement</td></tr>\n</tbody></table>", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jun-06 14:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32216\">[32216]</a></span>: big edit to get details of Parallel Scheduling Groups right ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3017\" onclick=\"get_ticket_and_populate_wrapper('3017'); return false;\" title=\"Parallel Universe jobs with ParallelSchedulingGroups can stay idle\">#3017</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-May-30 09:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32140\">[32140]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3017\" onclick=\"get_ticket_and_populate_wrapper('3017'); return false;\" title=\"Parallel Universe jobs with ParallelSchedulingGroups can stay idle\">#3017</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-May-30 08:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32138\">[32138]</a></span>: Fix parallel universe not matching jobs with <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ParallelSchedulingGroups\" title=\"Parallel Scheduling Groups\">ParallelSchedulingGroups</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3017\" onclick=\"get_ticket_and_populate_wrapper('3017'); return false;\" title=\"Parallel Universe jobs with ParallelSchedulingGroups can stay idle\">#3017</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jun-03 15:33", "status": "resolved", "created": "2012-May-30 08:32", "fixed_version": "2012-May-30 08:32", "broken_version": "v070700", "priority": "2", "subsystem": "Parallel", "assigned_to": "samf", "derived_from": "", "creator": "gthain", "rust": "s8126", "customer_group": "other", "visibility": "public", "notify": "gthain@cs.wisc.edu, tannenba@cs.wisc.edu, samf@cs.wisc.edu", "due_date": "20130527"}