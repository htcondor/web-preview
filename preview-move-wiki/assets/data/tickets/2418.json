{"id": 2418, "title": "Ticket #2418: IPv6 Windows port", "description": "<blockquote>\nStatus: After far too much work, have a Windows build environment. Working on updating the KRB5 external for the int32_t test.\n2011-09-21: Finish KRB5 update. Have building Windows. Start looking at test failures.\n\n<p></p><ul>\n<li>OPEN int32_t isn't defined\n<ul>\n<li>Raised new problem: c:\\temp\\condor\\krb5-1.4.3-p0\\install\\include\\win-mac.h(61) : error C2371: 'int32_t' : redefinition; different basic types\n</li><li>c:\\condor\\execute\\dir_1460\\userdir\\src\\condor_includes\\condor_sys_nt.h(89) : see declaration of 'int32_t'\n</li></ul>\n</li><li>TESTING WindowsNetworkAdapter's constructor needs to be updated to take (const condor_sockaddr&amp; ip_addr) instead of (LPCSTR ip_addr, unsigned int) or (LPCSTR description)\n</li><li>HACKED <a class=\"file\" href=\"rlog?f=src/condor_utils/ipv6_interface.cpp\">/src/condor_utils/ipv6_interface.cpp</a> line 5: fatal error C1083: Cannot open include file: 'ifaddrs.h': No such file or directory\n<ul>\n<li>Not available under Windows. <a class=\"external\" href=\"http://stackoverflow.com/questions/3069082/porting-getifaddrs-to-win-xp\">details</a>\n</li><li>I'm not sure the current implementation (getting the scope ID from the NETWORK_INTERFACE) is correct. See <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=2422\" onclick=\"get_ticket_and_populate_wrapper('2422'); return false;\" title=\"IPv6 sin6_scope_id likely wrong?\">#2422</a></span> for details.\n</li></ul>\n</li><li>TESTING <a class=\"file\" href=\"rlog?f=src/condor_utils/internet.cpp\">/src/condor_utils/internet.cpp</a> has several functions failing to return values. (\"error C4716: 'X' : must return a value\")\n<ul>\n<li>line 357 calc_subnet_name\n</li><li>line 774 string_to_ipstr\n</li><li>line 796 string_to_hostname\n</li></ul>\n</li><li>TESTING <a class=\"file\" href=\"rlog?f=src/condor_utils/cron_job_mgr.cpp\">/src/condor_utils/cron_job_mgr.cpp</a> line 35: warning C4355: 'this' : used in base member initializer list - Not IPv6 related, moved to <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=2419\" onclick=\"get_ticket_and_populate_wrapper('2419'); return false;\" title=\"CronJobMgr uses *this in constructor C4355\">#2419</a></span>.\n</li><li>TESTING <a class=\"file\" href=\"rlog?f=src/condor_io/condor_ipverify.cpp\">/src/condor_io/condor_ipverify.cpp</a> line400: warning C4554: '&amp;' : check operator precedence for possible error; use parentheses to clarify precedence\n</li></ul>\n\n<p>Progress: Delayed while focusing on testing IPv6 on Linux.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-27 17:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27439\">[27439]</a></span>: krb5 updated to deal with clash with IPv6 changes. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span> Both sets of code defined uint32_t on Windows.  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-27 15:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=27438\">[27438]</a></span>: Can't set herrno on Windows. Set 0-length structure, rely on libc to flag error. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-25 15:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26985\">[26985]</a></span>: CRUDE WORKAROUND for lack of getifaddrs on Windows. IPv6 WILL NOT WORK ON WINDOWS! Temporary step just so it compiles and I can confirm that IPv6 didn't break IPv4 on all platforms. A proper fix requires more thought, see <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=2422\" onclick=\"get_ticket_and_populate_wrapper('2422'); return false;\" title=\"IPv6 sin6_scope_id likely wrong?\">#2422</a></span> for details. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-25 13:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26982\">[26982]</a></span>: Updated WindowsNetworkAdapter's constructor to take a condor_sockaddr instead of a string IP address. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-25 13:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26981\">[26981]</a></span>: Define int32_t on Win32. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-25 13:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26980\">[26980]</a></span>: Dealt with unimplemented functions calc_subnet_name, string_to_ipstr, string_to_hostname - calc_subnet_name: Only used in checkpoint server for advertising. Removed. - string_to_ipstr: Replaced with safer sinful_to_ipstr. - string_to_hostname: Unused. Removed. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Aug-25 11:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=26979\">[26979]</a></span>: Typo fix &amp; where &amp;&amp; was meant. Unreleased branch. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2418\" onclick=\"get_ticket_and_populate_wrapper('2418'); return false;\" title=\"IPv6 Windows port\">#2418</a></span>  (By Alan De Smet )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Nov-21 15:55", "status": "resolved", "created": "2011-Aug-24 17:32", "fixed_version": "2011-Aug-24 17:32", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "adesmet", "derived_from": "#9", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": "20110921"}