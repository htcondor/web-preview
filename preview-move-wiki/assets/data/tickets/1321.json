{"id": 1321, "title": "Ticket #1321: condor_status -submitter only lists a single machine", "description": "<blockquote>\nUser has two schedds, but condor_status -submitter is only returning information from one.  Current hypothesis: if a given user appears in multiple ads, only the first is used.\n\n<p><span class=\"section\"></span></p><h2>Result </h2>\n\n<p>Somewhere, probably between 7.2.0 and 7.4.0, how we handle submitter ads changed.  They used to be MyType=\"Scheduler\", and the collector internally checked for the existence of particular keys to distinguish Submitter ads from real Scheduler ads.  Now they have MyType=\"Submitter\".\n\n</p><p>The user had a 7.4.x schedd reporting for a 7.0.x collector. When the collector was asked for submitter ads, it looked for MyType=\"Scheduler\" (old style), not the new style, and the 7.4.x schedd entries disappeared.\n\n</p><p>The user was advised to either downgrade the 7.4.x machine, or to upgrade the collector to 7.4.x.\n\n</p><p>RESOLVED.\n\n</p><p><span class=\"section\"></span></p><h2>Scratch space</h2>\n\n<p></p><div class=\"code\">\n<pre class=\"code\">condor_status -any -format '%d ' 'MyType==\"Submitter\"' -format '%s ' Name -format '%s ' Machine -format '%s ' ScheddName -format '\\n' MyType | grep '^1 ' | sort</pre></div>\n\n\n<p></p><div class=\"code\">\n<pre class=\"code\">condor_status -any -format '%-20.20s ' Name -format '%-10.10s ' Machine -format '%8d' RunningJobs -format '%8d' IdleJobs -format '%8d' HeldJobs -format ' %d\\n' 'MyType==\"Submitter\"' | grep 1$\n</pre></div>\n\n\n<p>So far: evidence is that condor_status isn't seeing the information in the first place.  Logging every ad received reveals that the gw-4 machine ads are never seen.  Now confirmed; the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CollectorLog\" title=\"Collector Log\">CollectorLog</a></span> reports 23 ads sent, which matches the count from \"condor_status -submitter\".  We would expect about 37 ads, which matches the output of \"condor_status -any,\" filtering for just submitter ads.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "incident", "last_change": "2010-Mar-31 16:40", "status": "resolved", "created": "2010-Mar-30 17:32", "fixed_version": "2010-Mar-30 17:32", "broken_version": "v070402", "priority": "2", "subsystem": "Tools", "assigned_to": "adesmet", "derived_from": "", "creator": "adesmet", "rust": "s7895", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}