{"id": 7092, "title": "Ticket #7092: Prefer this subsystem's specific token, if available.", "description": "<blockquote>\nWhen a daemon operating as a client looks for a token to use, look for tokens for the daemon's subsystem before checking any others (especially including tokens for other subsystems).\n\n<p>See the commit 'Improve token location algorithm. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7006\" onclick=\"get_ticket_and_populate_wrapper('7006'); return false;\" title=\"Add support for a token request workflow\">#7006</a></span>' from\n<a class=\"external\" href=\"https://github.com/htcondor/htcondor/pull/50\">https://github.com/htcondor/htcondor/pull/50</a></p></blockquote>", "remarks": "<blockquote>\n<em>2019-Jun-07 07:51:22 by bbockelm:</em> <br/>\n\nSeparated out into <a class=\"external\" href=\"https://github.com/htcondor/htcondor/pull/55\">https://github.com/htcondor/htcondor/pull/55</a>\n\n<p></p><hr/>\n<em>2019-Jun-08 22:02:41 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>Looked good to me.  Changed 'subsys' to 'subsys_agt_name', perhaps unnecessarily.\n\n</p><p></p><hr/>\nNote that, despite the name, findTokens() doesn't return a list of tokens that could work, but simply the first one of those it finds.  Thus, this commit isn't an optimization, but also a correctness issue.  As such, this deserves a test.\n\n<p></p><hr/>\n<em>2019-Aug-04 13:37:51 by bbockelm:</em> <br/>\n\nAs the auto-generated tokens were not released prior to the change in this ticket, I am going to be including this ticket's documentation in the docs for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7094\" onclick=\"get_ticket_and_populate_wrapper('7094'); return false;\" title=\"Auto-request tokens based on missing trust domains.\">#7094</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7080\" onclick=\"get_ticket_and_populate_wrapper('7080'); return false;\" title=\"Auto-approve token rules\">#7080</a></span>.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-08 21:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4830c3ab76eb9b1a10d708bc2ce04e2492c54356\">[57128]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7092\" onclick=\"get_ticket_and_populate_wrapper('7092'); return false;\" title=\"Prefer this subsystem's specific token, if available.\">#7092</a></span>) Change a variable name, hopefully improving clarity.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-07 07:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f2e60879f37877f4172692f2fb9122d658b30664\">[57126]</a></span>: Improve token location algorithm. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7092\" onclick=\"get_ticket_and_populate_wrapper('7092'); return false;\" title=\"Prefer this subsystem's specific token, if available.\">#7092</a></span> Prefer using the auto-generated token first for the corresponding subsystem type (i.e., STARTD uses `startd_auto_generated_token`). This way we avoid the startd using the schedd's auto-generated token when utilizing a personal condor setup.  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Aug-04 13:38", "status": "resolved", "created": "2019-Jun-04 14:26", "fixed_version": "2019-Jun-04 14:26", "broken_version": "v080903", "priority": "4", "subsystem": "Daemons", "assigned_to": "bbockelm", "derived_from": "#7006", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}