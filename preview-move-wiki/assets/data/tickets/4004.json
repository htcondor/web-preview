{"id": 4004, "title": "Ticket #4004: Use POST instead of GET for EC2 Query API for RunInstances", "description": "<blockquote>\nThe <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RunInstances\" title=\"Run Instances\">RunInstances</a></span> action allows the specification of instance metadata (\"userdata\") up to 16 kB:\n\n<p><a class=\"external\" href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AESDG-chapter-instancedata.html\">AWS instance data</a>\n\n</p><p>However, Apache is hard-coded to use max URI request length of 8 kB; it requires patching and recompilation to do more, so there's an inherent problem if the userdata is too big. The good news is that the EC2 API states that query requests can be HTTP/HTTPS GET or POST:\n\n</p><p><a class=\"external\" href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-query-api.html\">AWS query API</a>\n\n</p><p>and I think one of the most-used client libraries (boto) implements it this way:\n\n</p><p><a class=\"external\" href=\"https://github.com/boto/boto/blob/develop/boto/ec2/connection.py#L882-L883\">https://github.com/boto/boto/blob/develop/boto/ec2/connection.py#L882-L883</a></p></blockquote>", "remarks": "<blockquote>\n<em>2013-Nov-27 12:03:34 by tannenba:</em> <br/>\n\nBeta test of proposed patch so far looks good; email from Massimo after trying a pre-release of code using POST instead of GET:\n\n<p></p><pre>   I tried the new condor tarball on the glideinwms factory and it seems ok: I\n   was able to use a voms proxy as a pilot proxy (the scenario that triggered an\n   error with condor 8.1.2)\n</pre>\n\n<p></p><pre>   Many thanks\n</pre>\n\n<p></p><pre>   Cheers, Massimo</pre>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jan-15 10:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=39160\">[39160]</a></span>: edit of 8.1.4 version history item <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4004\" onclick=\"get_ticket_and_populate_wrapper('4004'); return false;\" title=\"Use POST instead of GET for EC2 Query API for RunInstances\">#4004</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Dec-10 10:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=38968\">[38968]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4004\" onclick=\"get_ticket_and_populate_wrapper('4004'); return false;\" title=\"Use POST instead of GET for EC2 Query API for RunInstances\">#4004</a></span>) Add version history item.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Dec-04 16:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=38930\">[38930]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4004\" onclick=\"get_ticket_and_populate_wrapper('4004'); return false;\" title=\"Use POST instead of GET for EC2 Query API for RunInstances\">#4004</a></span>) Fix simulator to play nicely with POST.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Dec-03 11:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=38918\">[38918]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4004\" onclick=\"get_ticket_and_populate_wrapper('4004'); return false;\" title=\"Use POST instead of GET for EC2 Query API for RunInstances\">#4004</a></span>) Use POST instead of GET for EC2 commands to permit userdata &gt;8KB when using stock Apache daemons.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Dec-10 10:16", "status": "resolved", "created": "2013-Oct-23 10:49", "fixed_version": "2013-Oct-23 10:49", "broken_version": "v0708000", "priority": "2", "subsystem": "Grid", "assigned_to": "tlmiller", "derived_from": "", "creator": "burt", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "burt@fnal.gov, tannenba@cs.wisc.edu", "due_date": ""}