{"id": 6980, "title": "Ticket #6980: condor_annex segfaults", "description": "<blockquote>\nCarles Acosta reported a problem with v8.8.1's condor_annex segfaulting; the problem did not occur when he repeated the test with v8.9.0.  I was unable to reproduce the problem, but diffing the sources revealed a patch <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6533ba9e160bd5dced2f72721893d3998f6de862\">[55873]</a></span> released in 8.9.0 that also applies to the stable branch.  This needs to be cherry-picked back; based on a core file Carles sent along, it also seems reasonable for this code to have caused the problem he was seeing.</blockquote>", "remarks": "<blockquote>\n<em>2019-Apr-05 14:04:37 by tlmiller:</em> <br/>\n\nShould be mentioned in the release notes.\n\n<p></p><hr/>\n<em>2019-Apr-09 14:33:01 by tlmiller:</em> <br/>\n\nNow mentioned in the release notes.\n\n<p></p><hr/>\n<em>2019-Apr-10 12:34:23 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> : change looks good.\n\n<p>In general, the code appears to be full of potential leaks, but it is a tool so a leak before exiting isn't a very high priority to fix.\n\n</p><p></p><hr/>\n<em>2019-Apr-10 13:30:49 by tlmiller:</em> <br/>\n\nFWIW, the 'reply' pointer that's no longer being deleted is deleted in ReplyAndClean's operator() during normal operation.  That's not to say other stuff doesn't leak during normal operation, or that 'reply' doesn't leak during abnormal operation, but at least nobody will try to write into or read from a deleted object with this patch.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Apr-09 14:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/06304b9f684e1dd29bc7ba042c7fae8ffe8cce3d\">[56543]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6980\" onclick=\"get_ticket_and_populate_wrapper('6980'); return false;\" title=\"condor_annex segfaults\">#6980</a></span>) Fix memory leak(s) and corruption(s) in condor_annex.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Apr-05 13:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a319108a12879725f6829f4dc6d679a3527119c4\">[56516]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6980\" onclick=\"get_ticket_and_populate_wrapper('6980'); return false;\" title=\"condor_annex segfaults\">#6980</a></span>) Fix memory leak(s) and corruption(s) in condor_annex.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Sep-09 09:49", "status": "resolved", "created": "2019-Apr-05 13:58", "fixed_version": "2019-Apr-05 13:58", "broken_version": "v080801", "priority": "2", "subsystem": "Annex", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}