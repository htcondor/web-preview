{"id": 4341, "title": "Ticket #4341: condor_sockaddr::is_link_local fails to detect IPv4 169.254.*.*", "description": "<blockquote>\njohnkn reports that on his Windows box, HTCondor really, really likes advertising his IPv4 link local address (169.254.x.x).  He has a publicly routable address, so this is wrong.  The public address should be preferred to the link local.\n\n<p>Theory: condor_sockaddr::is_link_local (<a class=\"file\" href=\"rlog?f=src/condor_utils/condor_sockaddr.cpp\">/src/condor_utils/condor_sockaddr.cpp</a> 586) is wrong.  It's using a hard coded test (0xa9fe0000 &amp; address).  That code smells fishy to me.  In particular, is the endianness correct?\n\n</p><p>Confirmed: The test is wrong. Original code tried to hard code an integer value and failed to account for endianness.\n\n</p><p>See also <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4345\" onclick=\"get_ticket_and_populate_wrapper('4345'); return false;\" title=\"IPv6 code for condor_sockaddr::is_private_network() seems wrong.\">#4345</a></span></p></blockquote>", "remarks": "<blockquote>\n<em>2014-Jun-13 13:40:31 by adesmet:</em> <br/>\n\nWork is incomplete. Turns out there are two code paths we need to worry about.\n\n<p></p><hr/>\n<em>2014-Jul-08 13:48:43 by adesmet:</em> <br/>\n\nWork is on Alan's master-sockaddr-work branch.</blockquote>", "derived_tickets": "", "attachments": "", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-16 09:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40430\">[40430]</a></span>: minor 8.2.0 version history item edit. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4341\" onclick=\"get_ticket_and_populate_wrapper('4341'); return false;\" title=\"condor_sockaddr::is_link_local fails to detect IPv4 169.254.*.*\">#4341</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jun-13 13:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40412\">[40412]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4341\" onclick=\"get_ticket_and_populate_wrapper('4341'); return false;\" title=\"condor_sockaddr::is_link_local fails to detect IPv4 169.254.*.*\">#4341</a></span>  (By Alan De Smet )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-06 16:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=40067\">[40067]</a></span>: Correctly detect IPv4 link local addresses Fixes <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4341\" onclick=\"get_ticket_and_populate_wrapper('4341'); return false;\" title=\"condor_sockaddr::is_link_local fails to detect IPv4 169.254.*.*\">#4341</a></span>  (By Alan De Smet )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2018-Jan-17 10:11", "status": "resolved", "created": "2014-May-06 14:09", "fixed_version": "2014-May-06 14:09", "broken_version": "v080000", "priority": "4", "subsystem": "", "assigned_to": "adesmet", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}