{"id": 6815, "title": "Ticket #6815: Pslot preemption with non-fungible custom resources crashes the startd", "description": "<blockquote>\nPslot preemption doesn't work with non-fungible custom resources. That is, custom resources that have distinct identities, like GPUs. This is because the startd assigns the resources to a new dslot before the preempted slots are completely deallocated, and you can't share between two jobs. But the negotiator will happily make a pslot preemption match in this situation, and the startd will EXCEPT() at claim time.\n\n<p>The negotiator and startd should be patched to refuse pslot preemption involving non-fungible custom resources.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Nov-05 15:41:06 by jfrey:</em> <br/>\n\nYou can use PREEMPTION _REQUIREMENTS to prevent the negotiator from making matches that will crash the startd. For example, you can do the following for GPUs:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">PREEMPTION_REQUIREMENTS = RequestGPUs =?= Undefined || GPUs =?= Undefined\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2018-Nov-05 15:41", "status": "new", "created": "2018-Nov-05 15:22", "fixed_version": "2018-Nov-05 15:22", "broken_version": "", "priority": "4", "subsystem": "DaemonsExecNode", "assigned_to": "jfrey", "derived_from": "#6297", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}