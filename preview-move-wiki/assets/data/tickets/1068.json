{"id": 1068, "title": "Ticket #1068: HAD is confused by private network info", "description": "<blockquote>\nThe following address comparison in the HAD code gets confused if there is any extra information packed into the daemon contact string:\n\n<p></p><div class=\"verbatim\">\n<pre>        if(strcmp( sinful_addr, my_sinful ) == 0 ) {\n</pre></div>\n\n\n<p>This results in the following message from HAD:\n\n</p><p></p><div class=\"verbatim\">\n<pre>my address '&lt;128.105.143.12:51450?PrivNet=cs.wisc.edu.internal&gt;'is not\n present in HAD_LIST\n</pre></div>\n\n\n<p>This showed up in a pre-release of 7.4.1 because the fix for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=973\" onclick=\"get_ticket_and_populate_wrapper('973'); return false;\" title=\"Private network address and name not in contact string\">#973</a></span> caused private network information to be consistently advertised in the way that was intended when the handling of private network info was revised in 7.3.0.\n\n</p><p>Two fixes should be made:\n\n</p><p></p><ol>\n<li>HAD should use Sinful::addressPointsToMe() to do the address comparison properly.\n\n<p></p></li><li>The private network name should only be published if it is really needed.  If there is no private address or CCB information, it is not needed.  This reduces the scope of other bugs similar to the one in HAD and it allows us to retain backward compatibility with Condor prior to 7.3.0 in more cases.</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2009-Dec-17 16:46:35 by danb:</em> <br/>\n\nA fix has been committed to 7.4.1.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-16 17:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bc855713c939fdf939e68fd60196069cc8d56256\">[16694]</a></span>: Fixed a bug in my recent HAD patch. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1068\" onclick=\"get_ticket_and_populate_wrapper('1068'); return false;\" title=\"HAD is confused by private network info\">#1068</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-16 14:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a989c3f7d5bb41e765d3c3e7e0179a10ddc15419\">[16685]</a></span>: Avoid confusion in HAD when there is private net info in daemon address. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1068\" onclick=\"get_ticket_and_populate_wrapper('1068'); return false;\" title=\"HAD is confused by private network info\">#1068</a></span>  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Dec-16 14:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8473c6035234a1f9766f649d5cbd10ebf77037db\">[16686]</a></span>: Only publish the private net name if there is a private net or CCB address. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1068\" onclick=\"get_ticket_and_populate_wrapper('1068'); return false;\" title=\"HAD is confused by private network info\">#1068</a></span>  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2009-Dec-17 16:46", "status": "resolved", "created": "2009-Dec-16 11:32", "fixed_version": "2009-Dec-16 11:32", "broken_version": "v070401", "priority": "4", "subsystem": "Daemons", "assigned_to": "danb", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "other", "visibility": "public", "notify": "zmiller@cs.wisc.edu,nleroy@cs.wisc.edu,dan@hep.wisc.edu", "due_date": ""}