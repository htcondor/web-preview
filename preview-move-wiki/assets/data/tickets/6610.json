{"id": 6610, "title": "Ticket #6610: python htcondor.reload_config() does not see environment var changes", "description": "<blockquote>\nSpecifically on Windows, the python bindings call htcondor.reload_config() does not see environment variable changes made by the Python program.\n\n<p>Again, this is specific ONLY to Windows.  It works on Linux.\n\n</p><p>Example:\n\n</p><p></p><div class=\"snip\">\n<pre class=\"sniplabel\">Note the last line should be 'blah', but it is not</pre>\n<pre class=\"snip\">&gt;&gt;&gt; import htcondor\n&gt;&gt;&gt; import os\n&gt;&gt;&gt; htcondor.param['schedd']\n'C:\\\\condor\\\\bin\\\\condor_schedd.exe'\n&gt;&gt;&gt; os.environ['_condor_schedd']='blah'\n&gt;&gt;&gt; htcondor.reload_config()\n&gt;&gt;&gt; htcondor.param['schedd']\n'C:\\\\condor\\\\bin\\\\condor_schedd.exe'\n</pre></div>\n\n\n<p>This bug is particularly annoying since setting the environment variable CONDOR_CONFIG and then doing a reload_config() call is a common idiom that fails to work on Windows.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Mar-15 15:30:38 by tannenba:</em> <br/>\n\nThe issue here is there are two sets of environment variables on Windows; one maintained by the C runtime library, and another maintained by the Win32 API.  Python only modifies the Win32 set, and meanwhile HTCondor's configuration code only looks at the C runtime set.  Sigh.\n\n<p>See <a class=\"external\" href=\"https://bugs.python.org/issue16633\">https://bugs.python.org/issue16633</a>\n\n</p><p></p><hr/>\n<em>2018-Mar-19 09:17:26 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> env_ptr is checked for null before freeing it, but not before dereferencing it.\n\n<p></p><hr/>\n<em>2020-Jul-13 12:51:34 by blin:</em> <br/>\n\nThis doesn't smell like an OSG ticket. What should it be marked as?</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jul-21 09:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f77b8aa5d148ed591c1089ffbc0e606586da7ef4\">[60163]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6610\" onclick=\"get_ticket_and_populate_wrapper('6610'); return false;\" title=\"python htcondor.reload_config() does not see environment var changes\">#6610</a></span>) Address code review comments  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Mar-15 16:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/521eb0549a957efdc59aa4957b17430adf5a779c\">[54528]</a></span>: Version blurb for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6610\" onclick=\"get_ticket_and_populate_wrapper('6610'); return false;\" title=\"python htcondor.reload_config() does not see environment var changes\">#6610</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Mar-15 16:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/15c7fb255135430f66fdd6cc0c32b707c53bc67b\">[54526]</a></span>: Fix on Win32 for Python binding htcondor.reload_config(). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6610\" onclick=\"get_ticket_and_populate_wrapper('6610'); return false;\" title=\"python htcondor.reload_config() does not see environment var changes\">#6610</a></span> This fix allows HTCondor on Win32 to see changes to environment variables like _condor_XXX or CONDOR_CONFIG made by a Python program.  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Jul-21 09:05", "status": "resolved", "created": "2018-Mar-15 15:24", "fixed_version": "2018-Mar-15 15:24", "broken_version": "v080600", "priority": "3", "subsystem": "PythonBinding", "assigned_to": "tannenba", "derived_from": "", "creator": "tannenba", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tannenba@cs.wisc.edu", "due_date": ""}