{"id": 4642, "title": "Ticket #4642: Avoid condor_history DoS attacks on schedd", "description": "<blockquote>\nPeter Couvares reports that they've essenitally suffered denial of service attacks because of part of the OSG infrastructure running so many condor_history commands, thereby goofing up the schedd.\n\n<p>We're not sure what the best way is to ameliorate the problem.  Some ideas:\n</p><ul>\n<li>Fork off a separate process to service condor_history commands (but there might still be problems with disk bandwidth).\n</li><li>Throttle the condor_history processing somehow -- possibly limit the number of condor_history commands that will be serviced within a certain time window, or limit the number of concurrent condor_history commands (if the command keeps an open connection to the schedd).</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Oct-09 16:02:57 by tannenba:</em> <br/>\n\nThe schedd already does fork off a separate process to service condor_history commands.\n\n<p>Also, remote condor_history queries can already be throttled. But I am not surprised you were not aware of this, because somehow these knobs did not get documented!  I added ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4643\" onclick=\"get_ticket_and_populate_wrapper('4643'); return false;\" title=\"knobs to throttle remote condor_history queries never documented\">#4643</a></span> to address this.\n\n</p><p>Assuming the information in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4643\" onclick=\"get_ticket_and_populate_wrapper('4643'); return false;\" title=\"knobs to throttle remote condor_history queries never documented\">#4643</a></span> is sufficient for Peter's needs, I am abandoning this ticket.  Peter, feel free to reopen and/or remark why the existing throttling mechanism is not sufficient, or if you feel the defaults are stupid...  thanks.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2014-Oct-09 16:05", "status": "abandoned", "created": "2014-Oct-09 15:25", "fixed_version": "2014-Oct-09 15:25", "broken_version": "v080301", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "", "derived_from": "", "creator": "wenger", "rust": "a27392", "customer_group": "osg", "visibility": "public", "notify": "pfcouvar@syr.edu, wenger@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}