{"id": 5698, "title": "Ticket #5698: Add GAHP statistics to grid ads", "description": "<blockquote>\nAdd some statistics about GAHP commands to the Grid ads advertised by the gridmanager. The stats will be collected by the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpServer\" title=\"Gahp Server\">GahpServer</a></span> object and reported by each Resource object.\n\n<p>Since multiple Resource objects may share the same GAHP server, multiple Grid ads may have stats for the same GAHP. The stats are for all commands handled by that GAHP server, not just commands involving a specific Resource's service. Detecting which Grid ads share a GAHP can be done by examining the new <code>GahpPid</code> attribute.\n\n</p><p>Some GAHPs are not represented, because no Resource object uses them. For example, the nordugrid_gahp used to do file transfers for cream jobs.\n\n</p><p>These are the new statistics\n\n</p><p></p><ul>\n<li><code>GahpCommandsIssued</code> Total number of commands issued, plus a <code>Recent</code> count\n</li><li><code>GahpCommandsTimedOut</code> Total number of commands that the gridmanager timed out, plus a <code>Recent</code> count.\n</li><li><code>GahpCommandsInFlight</code> Current number of commands issued, plus a <code>Peak</code> count. This is commands issued for which the gridmanager is awaiting a result (does not include timed out commands).\n</li><li><code>GahpCommandsQueued</code> Current number of commands waiting to be issued (not issued yet due to throttles), plus a <code>Peak</code> count.\n</li><li><code>GahpCommandRuntime</code> Stats on time it took for commands to complete in the GAHP, including average, min, max, std.dev., and sum. Both lifetime and <code>Recent</code>.\n</li></ul>\n\n<p>If the gridmanager times out a command (due to GRIDMANAGER_GAHP_CALL_TIMEOUT), the runtime of the command is GRIDMANAGER_GAHP_CALL_TIMEOUT. Timed out commands do not count in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpCommandsIssued\" title=\"Gahp Commands Issued\">GahpCommandsIssued</a></span>. We may want to change this behavior.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jun-21 15:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48609\">[48609]</a></span>: Version history for gahp stats in grid ads. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5698\" onclick=\"get_ticket_and_populate_wrapper('5698'); return false;\" title=\"Add GAHP statistics to grid ads\">#5698</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-May-27 14:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=48433\">[48433]</a></span>: Add stats to grid ads for GAHP commands. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5698\" onclick=\"get_ticket_and_populate_wrapper('5698'); return false;\" title=\"Add GAHP statistics to grid ads\">#5698</a></span> Grid resource ads now include a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpPid\" title=\"Gahp Pid\">GahpPid</a></span> attribute and these statistics about commands issued to their gahp server: <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpCommandsIssued\" title=\"Gahp Commands Issued\">GahpCommandsIssued</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpCommandsTimedOut\" title=\"Gahp Commands Timed Out\">GahpCommandsTimedOut</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpCommandsInFlight\" title=\"Gahp Commands In Flight\">GahpCommandsInFlight</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpCommandsQueued\" title=\"Gahp Commands Queued\">GahpCommandsQueued</a></span> <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GahpCommandRuntime\" title=\"Gahp Command Runtime\">GahpCommandRuntime</a></span>  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Jun-21 15:50", "status": "resolved", "created": "2016-May-27 13:24", "fixed_version": "2016-May-27 13:24", "broken_version": "v080500", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}