{"id": 7411, "title": "Ticket #7411: Send fewer attributes in session resuming classad", "description": "<blockquote>\nWhen we resume a session, in either TCP or UDP, CEDAR looks up the session and sends the entire <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span>.  This is not necessary, and we really only need to send a subset of attributes that are ever potentially looked at.  The list of attributes we need to send (because they are looked at) are:\n<ul>\n<li>ATTR_SEC_USE_SESSION\n</li><li>ATTR_SEC_SID\n</li><li>ATTR_SEC_COMMAND\n</li><li>ATTR_SEC_AUTH_COMMAND\n</li><li>ATTR_SEC_SERVER_COMMAND_SOCK\n</li><li>ATTR_SEC_CONNECT_SINFUL\n</li><li>ATTR_SEC_COOKIE\n</li></ul>\n\n<p>As Jaime pointed out, putClassAd can already take a projection so the code is quite straightforward.</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Dec-04 14:48:31 by jfrey:</em> <br/>\n\nputClassAd() takes a whitelist of attributes to send over CEDAR, so no need to construct a separate <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> object.\n\n<p></p><hr/>\n<em>2019-Dec-04 16:47:50 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>We should build the projection of session attribute names once in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SecMan\" title=\"Sec Man\">SecMan</a></span>, then use it when needed.\n\n</p><p></p><hr/>\n<em>2019-Dec-06 16:10:46 by zmiller:</em> <br/>\n\nThanks, Jaime.  Reworked the code as you suggested.  Please re-review.\n\n<p></p><hr/>\n<em>2020-Jan-02 11:24:24 by tannenba:</em> <br/>\n\n<strong>CODE REVIEW</strong>\n\n<p>Quick addition to Jaime's code review above....\n\n</p><p>There are \"ZKM\" dprintfs in this commit.  Even worse, there are ZKM dprintfs that are D_ALWAYS in code that is expected to always be hit.  Adding insult to injury, there are ZKM dprintfs that have spelling mistakes.\n\n</p><p>Lets make a point of always remembering to remove development debugging cruft please. D_ALWAYS should be reserved for problems / errors / wrap-up of major events, not for small \"I made it here in the code\" business as usual messages.  Developer initials should never appear in code that gets merged into our master branch.\n\n</p><p></p><hr/>\n<em>2020-Jan-02 15:21:11 by zmiller:</em> <br/>\n\nFully agree with Todd.  There was one leftover dprintf that was committed by accident, and has now been removed.\n\n<p></p><hr/>\n<em>2020-Jan-02 15:27:44 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>The code looks good now.\n\n</p><p></p><hr/>\n<em>2020-Feb-18 13:48:53 by jfrey:</em> <br/>\n\nZach and Jaime believe this small performance improvement doesn't merit a version history entry.\n<hr/>\n<em>2020-Apr-10 07:46:37 by tim:</em> <br/>\n\nBulk change of target version from v080906 to v080907 using ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jan-02 15:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=58800\">[58800]</a></span>: remove accidental lefter ZKM dprintf. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7411\" onclick=\"get_ticket_and_populate_wrapper('7411'); return false;\" title=\"Send fewer attributes in session resuming classad\">#7411</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Dec-06 15:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=58606\">[58606]</a></span>: Per code review, build the projection list just once. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7411\" onclick=\"get_ticket_and_populate_wrapper('7411'); return false;\" title=\"Send fewer attributes in session resuming classad\">#7411</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Dec-04 16:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=58593\">[58593]</a></span>: Only send attributes that are actually needed to resume a session. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7411\" onclick=\"get_ticket_and_populate_wrapper('7411'); return false;\" title=\"Send fewer attributes in session resuming classad\">#7411</a></span>  (By zmiller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Apr-10 07:46", "status": "resolved", "created": "2019-Dec-04 14:09", "fixed_version": "2019-Dec-04 14:09", "broken_version": "v080900", "priority": "2", "subsystem": "Security", "assigned_to": "jfrey", "derived_from": "", "creator": "zmiller", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "zmiller@cs.wisc.edu, tannenba@cs.wisc.edu, gthain@cs.wisc.edu, jfrey@cs.wisc.edu", "due_date": ""}