{"id": 2409, "title": "Ticket #2409: credd crashes when there are many entries in the map file", "description": "<blockquote>\nMichael reported on condor-users:\n\n<p>A problem was occurring in 7.4 and 7.5 with the CREDD Service where the mapfile with more than 73 or some odd entries causes the service to crash and the pool password cannot be set. This was briefly mentioned during the Condor week conference and based on the version revision notes, I thought a lot of work on the CREDD service was done.\n\n</p><p>I spent some time switching over our condor nodes so each machine in the Condor pool used a unique SSL paired key. However, the CREDD service crashes and throws a core file. I reverted back such that I am now only using two keys (one for the server/CM and a second for all nodes). This fixed the problem, but I am curious if the condor development team is aware that the problem still exists. There is a work around, which I stated here, but I was curious if any efforts are being made to resolve this problem.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Dec-14 13:59:26 by johnkn:</em> <br/>\n\nFrom my debugging of the code, it appears that it's &gt; 0x80 entries that triggers the crash, since that is the point where the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ExtArray\" title=\"Ext Array\">ExtArray</a></span> containing the entries resizes. -tj</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Dec-14 10:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c675f6411b6d0c8b1fcbdae8660809238717208e\">[28762]</a></span>: version history for bug <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2409\" onclick=\"get_ticket_and_populate_wrapper('2409'); return false;\" title=\"credd crashes when there are many entries in the map file\">#2409</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Dec-07 16:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9e75795e6be1b954a9111e9b661db3fa503645ac\">[28658]</a></span>: fix crash using security map files on windows when file contained more than 128 entries. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2409\" onclick=\"get_ticket_and_populate_wrapper('2409'); return false;\" title=\"credd crashes when there are many entries in the map file\">#2409</a></span> The problem was the Regex::Clone was using malloc rather than pcre_malloc. Also changed <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MapFile\" title=\"Map File\">MapFile</a></span> code to wait and compile the regexes only after it finished reading the whole file. This avoids unnessary clones\u00a0[...]\n (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Dec-17 12:38", "status": "resolved", "created": "2011-Aug-23 10:57", "fixed_version": "2011-Aug-23 10:57", "broken_version": "v070400", "priority": "2", "subsystem": "Win32", "assigned_to": "zmiller", "derived_from": "", "creator": "odonnellm", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "odonnellm@usgs.gov, tannenba@cs.wisc.edu, tstclair@redhat.com", "due_date": "20111212"}