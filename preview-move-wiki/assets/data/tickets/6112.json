{"id": 6112, "title": "Ticket #6112: Annex Support for On-Demand Instances", "description": "<blockquote>\nIf we limit our initial support for on-demand instances to a single instance type per invocation and matching the current spot fleet -based implementation's size semantics, we can support on-demand instances with two simple extensions to the existing EC2 GAHP: one to allow us to request more than one identical instance in EC2_VM_START (and to return the full list of instance IDs), and another to let us terminate more than one instance at a time in EC2_VM_STOP, for rollback.  The other potentially-tricky piece of coding is to adjust the lease implementation so it will terminate on-demand instances in addition to spot fleets.\n\n<p>To simplify the initial implementation, it will be limited to 1000 instances (in the lease code and in the instance-termination code).</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Jan-30 14:44:04 by tlmiller:</em> <br/>\n\nThis implementation is currently missing support for the existing user data flags (and plumbing).  However, that support isn't immediately necessary; an annex composed of on-demand instances can be (and has been) created without it, using the default/recommended AMI.\n\n<p>See <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=6113\" onclick=\"get_ticket_and_populate_wrapper('6113'); return false;\" title=\"Finish user data support for ODI annexes\">#6113</a></span>.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-27 13:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d700face2381d7ec7ead4c4c3ebe17a0f82470cc\">[50074]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6112\" onclick=\"get_ticket_and_populate_wrapper('6112'); return false;\" title=\"Annex Support for On-Demand Instances\">#6112</a></span>) Add key name and security groups for ODI.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-27 11:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/016d3e472adbabc92cdd4233ba76111b401274fc\">[50073]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6112\" onclick=\"get_ticket_and_populate_wrapper('6112'); return false;\" title=\"Annex Support for On-Demand Instances\">#6112</a></span>) Bunch of badly-implemented UI fix-ups.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-27 10:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3ffb23e0f34ad7425dc2539502aa2ba1a0eda403\">[50072]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6112\" onclick=\"get_ticket_and_populate_wrapper('6112'); return false;\" title=\"Annex Support for On-Demand Instances\">#6112</a></span>) Implement bulk instance termination, as well, for rollback.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-26 15:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/42c1682d646b0164da6da894c1319b05921c9b89\">[50062]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6112\" onclick=\"get_ticket_and_populate_wrapper('6112'); return false;\" title=\"Annex Support for On-Demand Instances\">#6112</a></span>) Proof-of-concept implementation completed for on-demand instances (ODI) in annex. Much work remains to be done...  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jan-25 15:17</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/47491a63bfda5556516c04f746a962876174b56d\">[50061]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6112\" onclick=\"get_ticket_and_populate_wrapper('6112'); return false;\" title=\"Annex Support for On-Demand Instances\">#6112</a></span>) The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MaxCount\" title=\"Max Count\">MaxCount</a></span> parameter to RunInstances() is now an argument to EC2_VM_START, which will (now) return multiple instance IDs in that case.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "experimental", "last_change": "2017-Feb-15 14:47", "status": "resolved", "created": "2017-Jan-30 14:41", "fixed_version": "2017-Jan-30 14:41", "broken_version": "", "priority": "1", "subsystem": "Annex", "assigned_to": "tlmiller", "derived_from": "#6111", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}