{"id": 6371, "title": "Ticket #6371: filetransfer plugins w/ relative dynamic libraries fail if run as root", "description": "<blockquote>\nHTCondor has an option to run your filetransfer plugins as root. (This is not the default and should only be enabled if you need it and know what you are doing!)\n\n<p>In that situation, the plugin is invoked with real uid 0 and effective uid of the user doing the transfer.\n\n</p><p>If the plugin uses shared libraries that are specified in the binary's <code>RUNPATH</code> relative to <code>$ORIGIN</code> as opposed to absolute paths, the loader will refuse to load them for security reaons when the uid and euid do not match.\n\n</p><p>There's isn't much HTCondor can do about this other than try to print a helpful message in the log.  The sysadmin has the option of installing the necessary shared libraries in a system location such as <code>/usr/lib[64]/</code>.  Setting <code>LD_LIBRARY_PATH</code> doesn't do the trick either.  Check man page for <code>ld.so</code>, although it's fairly lacking.  Search the web for \"ld.so setuid shared library\" or similar.</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Sep-06 09:38:02 by tim:</em> <br/>\n\n<strong>CODE REVIEW:</strong> Looks good, can only result in a new log message. Does not affect any code path.\n\n<p><strong>DOC REVIEW:</strong> None needed.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Aug-10 14:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52058\">[52058]</a></span>: Print a helpful error message for a hard-to-debug situation. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6371\" onclick=\"get_ticket_and_populate_wrapper('6371'); return false;\" title=\"filetransfer plugins w/ relative dynamic libraries fail if run as root\">#6371</a></span>  (By zmiller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Sep-06 09:38", "status": "resolved", "created": "2017-Aug-10 14:51", "fixed_version": "2017-Aug-10 14:51", "broken_version": "v080600", "priority": "2", "subsystem": "FileTransfer", "assigned_to": "zmiller", "derived_from": "", "creator": "zmiller", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "", "due_date": "20170811"}