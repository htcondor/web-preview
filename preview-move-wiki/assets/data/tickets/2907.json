{"id": 2907, "title": "Ticket #2907: glexec new default umask causes issues", "description": "<blockquote>\nRecent versions of glexec have changed the default umask to 077.  This breaks Condor-glexec integration.\n\n<p>The issue is that condor_glexec_setup will call \"mkdir\" to create the sandbox.  This previously resulted in a sandbox with perms 0755; it now results in 0700 (owned by the payload).\n\n</p><p>Condor will then attempt to chdir to the sandbox (as the pilot) and invoke glexec again.  For the new behavior, the chdir fails due to EPERM and the job goes on hold.\n\n</p><p>This can be fixed by using \"install -m 755 -d\" instead of \"mkdir -p\" in condor_glexec_setup.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Apr-02 14:54:42 by danb:</em> <br/>\n\nThanks for the suggested fix, Brian.  I applied it.\n\n<p></p><hr/>\n<em>2012-Apr-02 14:57:01 by bbockelm:</em> <br/>\n\nFor posterity's sake: it appears the umask change in glexec was a development bug.  However, I still think it's appropriate future-proofing to explicitly set the mode.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-02 14:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/347a6c45f268c8355096212f1eabbb11cbe49a08\">[31069]</a></span>: Documented fix for glexec umask problem. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2907\" onclick=\"get_ticket_and_populate_wrapper('2907'); return false;\" title=\"glexec new default umask causes issues\">#2907</a></span> ===VersionHistory:Complete===  (By Dan Bradley )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Apr-02 14:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e33a0d24237f892736f8e4782922613ef1bc8576\">[31068]</a></span>: Explicitly set glexec job sandbox directory permission rather than relying on the default. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2907\" onclick=\"get_ticket_and_populate_wrapper('2907'); return false;\" title=\"glexec new default umask causes issues\">#2907</a></span>  (By Dan Bradley )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Apr-02 14:57", "status": "resolved", "created": "2012-Mar-27 09:41", "fixed_version": "2012-Mar-27 09:41", "broken_version": "", "priority": "2", "subsystem": "Daemons", "assigned_to": "danb", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "other", "visibility": "public", "notify": "bbockelm@cse.unl.edu", "due_date": ""}