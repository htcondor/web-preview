{"id": 778, "title": "Ticket #778: condor_submit -dump segfaults with multiple jobs in cluster", "description": "<blockquote>\n$ condor_version\n$CondorVersion: 7.0.4 Jul 30 2008 BuildID: RH-7.0.4-2.el4 $\n$CondorPlatform: I386-LINUX_RH_UNKNOWN $\n\n<p>$ cat test1.job\nuniverse = vanilla\nexecutable = /bin/sleep\nqueue 2\n\n</p><p>$ condor_submit -dump /dev/null test1.job\nStoring job ClassAd(s).ERROR \"Assertion ERROR on (job-&gt;LookupString\n(ATTR_JOB_CMD, buff))\" at line 1974 in file submit.C\nSegmentation fault\n\n</p><p>$ cat test2.job\nuniverse = vanilla\nexecutable = /bin/sleep\nqueue\nqueue\n\n</p><p>$ condor_submit -dump /dev/null test2.job\nStoring job ClassAd(s).ERROR \"Assertion ERROR on (job-&gt;LookupString\n(ATTR_JOB_CMD, buff))\" at line 1974 in file submit.C\nSegmentation fault</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/99/condor_submit_dump_fix.patch\">condor_submit_dump_fix.patch</a>\n440 bytes added by rrati on 2009-Sep-25 17:59:22 UTC.\n<br/>\nThe issue was with the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ProcId\" title=\"Proc Id\">ProcId</a></span>.  When doing a dump, it is never set which would cause condor_submit to attempt to calculate the image size for every job even though the cmd attribute is only set on the first job in the cluster.  This patch will set the clusterid to 1 for all jobs after the first one in the cluster (thus avoiding the binary calculation)<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Sep-25 14:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=15768\">[15768]</a></span>: Fixed core dump in condor_submit if the -dump param is used with a submit file that is queueing more than one job at a time (queue x), where x &gt; 1 (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=778\" onclick=\"get_ticket_and_populate_wrapper('778'); return false;\" title=\"condor_submit -dump segfaults with multiple jobs in cluster\">#778</a></span>)  (By Robert Rati )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Jan-08 08:10", "status": "resolved", "created": "2009-Sep-25 12:57", "fixed_version": "2009-Sep-25 12:57", "broken_version": "v070004", "priority": "4", "subsystem": "Tools", "assigned_to": "rrati", "derived_from": "", "creator": "rrati", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}