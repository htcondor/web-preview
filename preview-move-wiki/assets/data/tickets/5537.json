{"id": 5537, "title": "Ticket #5537: Landmine in PREFER_OUTBOUND_IPV4", "description": "<blockquote>\n<a class=\"file\" href=\"rlog?f=src/condor_io/sock.cpp\">/src/condor_io/sock.cpp</a> around line 1176 inside of Sock::chooseAddrFromAddrs:\n\n<p></p><pre>    // These constants assume that the max desirability() &lt; 10.\n    d *= 100;\n</pre>\n\n<p>contrast to <a class=\"file\" href=\"rlog?f=src/condor_includes/condor_sockaddr.h\">/src/condor_includes/condor_sockaddr.h</a> around line 153:\n\n</p><p></p><pre>    // How desirable is this address for public use?  Prefers public addresses\n    // over private addresses.  Higher numbers are more desirable.  The number\n    // will be less than 10000.  0 will only be used for errors, otherwise it\n    // will be positive.  No other promises are made; do NOT make decisions\n    // based on specific numbers, only compare relative numbers to identify\n    // more desireable addresses.\n</pre>\n\n<p>These should be reconciled. Today it happens that desirability never exceeds 10, but not forever.\n\n</p><p>We might need/want a \"<code>const int MAX_DESIRABILITY=10000</code>\" so code wanting to do math can do so generically.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Mar-02 15:40:10 by adesmet:</em> <br/>\n\nBrief chat with ToddM. Conclusions:\n<ul>\n<li>Comment is just wrong. Code is safe in all cases. Delete the comment.\n</li><li>*=100 and -=10 is unnecessarily large, but harmless.  Could be *=2 and -=1 to get same sorting result.\n</li></ul>\n\n<p></p><hr/>\n<em>2016-Mar-02 15:48:43 by tlmiller:</em> <br/>\n\nCommit only changed comment, no version history item necessary.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Mar-02 15:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=47670\">[47670]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5537\" onclick=\"get_ticket_and_populate_wrapper('5537'); return false;\" title=\"Landmine in PREFER_OUTBOUND_IPV4\">#5537</a></span>) Replace incorrect &amp; disturbing comment with correct one.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Apr-26 13:44", "status": "resolved", "created": "2016-Feb-29 16:14", "fixed_version": "2016-Feb-29 16:14", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "tlmiller", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}