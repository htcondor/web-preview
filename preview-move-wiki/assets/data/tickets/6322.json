{"id": 6322, "title": "Ticket #6322: condor_annex -check-setup should check security config", "description": "<blockquote>\n<ol>\n<li>Check if SEC_PASSWORD_FILE is set, and if so, if it can be read.\n</li><li>Check if PASSWORD method is available?\n</li><li>Check if condor_pool@* is in the appropriate ALLOW lists?\n</li><li>Run condor_ping to verify connectivity to collector?\n</li></ol>\n\n<p>It's unclear how many of these checks need to be explicit, and it's certainly possible to configure the collector so that machines with the password which don't come from AWS can't authenticate.  OTOH, this tool is really for newbies, so maybe we shouldn't worry about that.</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Sep-18 12:13:34 by tlmiller:</em> <br/>\n\nWe already do no.1; see <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6237\" onclick=\"get_ticket_and_populate_wrapper('6237'); return false;\" title=\"Improve pool password error handling.\">#6237</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/acd81ad09de81376a1d3c56953ad49ffb1e909e6\">[50691]</a></span>.\n\n<p></p><hr/>\n<em>2017-Sep-18 15:55:16 by tlmiller:</em> <br/>\n\nChecking for no.2 and no.3 only works for personal condors (or other situations where condor_annex is running on the collector host with access to its configuration), so no.4 makes more sense for the set-up we're testing in CHTC, and implicitly includes no.2 and no.3 anyway.\n\n<p>Conversely, checking no.4 involves making some unnecessary assumptions (we already require the correct pool password file, but we don't need anything more than read access to the collector), but they're rather likely assumptions (that you don't care where your pool password comes from, or if you do, you're OK with it coming from your own machines; that if the connectivity-and-identity check from AWS succeeds, so will the update startd ad command).  Because of that, checking no.4 will probably be useful.  Nonetheless, the initial version will warn about no.4 rather than fail.  If that turns out to be too generous, we can change it (and either add a bypass flag or check no.4 /after/ we check the AWS account set-up).\n\n</p><p></p><hr/>\n<em>2017-Oct-24 14:44:27 by tlmiller:</em> <br/>\n\nDocumentation (updated) mostly in the wiki, which will have to change at some point.\n\n<p></p><hr/>\n<em>2017-Oct-25 16:28:46 by tim:</em> <br/>\n\n<strong>Doc Review:</strong> OK</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-24 14:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/60ee8ace3d64496313816d2bd7404ad4b2b132fa\">[52638]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6408\" onclick=\"get_ticket_and_populate_wrapper('6408'); return false;\" title=\"condor_annex off\">#6408</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6322\" onclick=\"get_ticket_and_populate_wrapper('6322'); return false;\" title=\"condor_annex -check-setup should check security config\">#6322</a></span>) Release notes, doc updates.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-18 14:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9f4533364b316e94eb850fcc924021e0aac2ade8\">[52377]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6322\" onclick=\"get_ticket_and_populate_wrapper('6322'); return false;\" title=\"condor_annex -check-setup should check security config\">#6322</a></span>) Check if we can connect to the collector.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Oct-25 16:28", "status": "resolved", "created": "2017-Jun-27 11:13", "fixed_version": "2017-Jun-27 11:13", "broken_version": "v080702", "priority": "2", "subsystem": "Annex", "assigned_to": "tlmiller", "derived_from": "#6111", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}