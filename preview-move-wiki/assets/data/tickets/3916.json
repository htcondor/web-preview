{"id": 3916, "title": "Ticket #3916: Condor Tool caused failures/Intermittent test failures - Lists", "description": "<blockquote>\nCondor tools are a critical analysis technique in the test suite. These results are frequently our only validation that the scenario we establish is met. We have a robust system call which is very flexible called \"runcmd\". However if \"runcmd\" is not told it is ok for the command to fail, our test dies instantly! We have another command \"runCondorTool\" which allows for failure of any condor tool and attempts again up to some fixed number of times. Analysis recently showed that we never told \"runcmd\" that these \"runCondorTool\" calls could fail. Now we get critical followup attempts allowing us the results we need to judge the run of the test.\n\n<p>However we have many places in intermittent test failures where we do not call condor tools in this safe way. Another routine \"runToolNTimes\" can be used where we just want the output or not which behaves like a system call\nsubstitution,\n\n</p><p>These tools mean we will be fixing tests to use these methods to resolve many \"random\" failing tests.\n\n</p><p>Done Recently\n</p><ol>\n<li>cmd_drain (needs more on windows)\n</li><li>job_negotiator_restart\n</li><li>condor_submit_dashspool\n</li></ol>\n\n<p>Todo\n</p><ol>\n<li>condor_view_classad_types.run (W)\n</li><li>job_services_during_neg_cycle\n</li><li>job_core_macros-dollardollar_van (W)\n</li><li>condorc_ab_van (W)\n</li><li>cmd_drain windows\n</li><li>dagman_basic\n</li><li>job_coree_niceuser\n</li><li>job_basic_kill</li></ol>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-23 09:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37695\">[37695]</a></span>: Wrap condor tool calls. <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=3916\" onclick=\"get_ticket_and_populate_wrapper('3916'); return false;\" title=\"Condor Tool caused failures/Intermittent test failures - Lists\">#3916</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-17 14:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37637\">[37637]</a></span>: Harden and wrap condor_tool calls <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=3916\" onclick=\"get_ticket_and_populate_wrapper('3916'); return false;\" title=\"Condor Tool caused failures/Intermittent test failures - Lists\">#3916</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-13 15:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37618\">[37618]</a></span>: Fixed mispelling of new tool <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=3916\" onclick=\"get_ticket_and_populate_wrapper('3916'); return false;\" title=\"Condor Tool caused failures/Intermittent test failures - Lists\">#3916</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-13 14:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37616\">[37616]</a></span>: Use calls to runToolNTimes and runCondorTool to make the use of these tools more predictable and thus make these test hopefully all green. They sometime failed multiple time per test run. <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=3916\" onclick=\"get_ticket_and_populate_wrapper('3916'); return false;\" title=\"Condor Tool caused failures/Intermittent test failures - Lists\">#3916</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-13 14:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37615\">[37615]</a></span>: Made sure we honored requests to allow failure to runcmd. We have to not die on the spot as it was but to allow runCondorTool to wrap these calls with persistent multiple attempts to get tool data to verify test expected results. <span class=\"ticket\"><a class=\"active\" href=\"/tickets?ticket=3916\" onclick=\"get_ticket_and_populate_wrapper('3916'); return false;\" title=\"Condor Tool caused failures/Intermittent test failures - Lists\">#3916</a></span>  (By Bill Taylor )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Sep-13 14:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=37614\">[37614]</a></span>: Corrected the staging runcmd calls from runCondorTool as correctly saying failure is an option so runCondorTool can persist to keeping working on getting tool data, added a function runToolNTimes to use that and essentially being a simply system call replacement but more robust and now export both funtions\u00a0[...]\n (By Bill Taylor )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Sep-23 13:37", "status": "active", "created": "2013-Sep-13 14:44", "fixed_version": "2013-Sep-13 14:44", "broken_version": "", "priority": "4", "subsystem": "Tests", "assigned_to": "bt", "derived_from": "#3594", "creator": "bt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}