{"id": 3994, "title": "Ticket #3994: Require DAGMan to run in workflow log mode?", "description": "<blockquote>\nI'm wondering whether, at some point, we should transition to requiring DAGMan to run in workflow log mode, disallowing the monitoring of individual log files specified in the node job submit files.  This would simplify a bunch of other things, especially <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=3993\" onclick=\"get_ticket_and_populate_wrapper('3993'); return false;\" title=\"Replace rescue DAG with recovery mode?\">#3993</a></span> and <span class=\"ticket\"><a class=\"reviewdesign\" href=\"/tickets?ticket=3889\" onclick=\"get_ticket_and_populate_wrapper('3889'); return false;\" title=\"Periodically dump rescue DAG while continuing to run\">#3889</a></span>).\n\n<p>The main down side I can think of with this is that such a DAGMan could not run on a pre-7.9 schedd.  I guess as we get further past 7.9 this will eventually, at least, not be much of an issue.\n\n</p><p>(Also see <span class=\"ticket\"><a class=\"reviewdesign\" href=\"/tickets?ticket=3889\" onclick=\"get_ticket_and_populate_wrapper('3889'); return false;\" title=\"Periodically dump rescue DAG while continuing to run\">#3889</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3843\" onclick=\"get_ticket_and_populate_wrapper('3843'); return false;\" title=\"DAGMan:  don't look for log file names in submit files\">#3843</a></span>.)</p></blockquote>", "remarks": "<blockquote>\n<em>2013-Oct-18 14:37:02 by wenger:</em> <br/>\n\nI wonder if we should switch over to this fairly soon and see if anyone screams (in 8.1, not 8.0 obviously).\n\n<p>Doing this would actually clear up a lot of <span class=\"ticket\"><a class=\"stalled\" href=\"/tickets?ticket=3334\" onclick=\"get_ticket_and_populate_wrapper('3334'); return false;\" title=\"DAGMan default node log code and documentation need cleanup\">#3334</a></span>, and I think we could cut a fair amount of code out of DAGMan once we were sure we didn't need to backtrack.\n\n</p><p></p><hr/>\n<em>2013-Oct-21 14:14:50 by wenger:</em> <br/>\n\nHmm -- the more I think about this, the more I think we should do it.\n\n<p>We could disable non-workflow log mode and do a release, and then if nobody screams after a while, remove the code needed to deal with non-workflow log mode.\n\n</p><p></p><hr/>\n<em>2013-Oct-21 14:31:42 by wenger:</em> <br/>\n\nPeter and Stuart, do you see any problem with this from the LIGO end?  Are you ever forcing DAGMan to run in non-workflow log mode?  The change would take effect in the 8.1 series, so if you're staying with stable series only you wouldn't see it for quite a while.\n\n<p></p><hr/>\n<em>2013-Oct-21 15:38:06 by pfc:</em> <br/>\n\nI don't see any reason we would need to run 7.9 or earlier DAGMan jobs on 8.2 or later schedds, so if I correctly understand that to be the only real issue, then I think we have no problem with this.\n\n<p></p><hr/>\n<em>2013-Oct-21 16:56:58 by wenger:</em> <br/>\n\nIf we actually do this, this ticket should just refer to disabling non-workflow log mode and updating the manual.  There should be a derived ticket for taking all of the non-workflow log code out of DAGMan.\n\n<p></p><hr/>\n<em>2014-Jan-24 10:52:22 by wenger:</em> <br/>\n\nOne note -- I just remembered that workflow log mode doesn't work for Stork nodes, so if we still support Stork nodes we have to leave some of the old-style code in place.\n\n<p></p><hr/>\n<em>2014-May-12 10:30:55 by pfc:</em> <br/>\n\nI don't think anyone has used Stork in forever.  I would deprecate support for it if I were you.\n\n<p></p><hr/>\n<em>2014-Aug-11 11:42:06 by wenger:</em> <br/>\n\nHmm -- something to think about here:  should we completely remove the -dont_use_default_node_log command line flag and DAGMAN_ALWAYS_USE_NODE_LOG config code, or should we leave them in place but report errors if they're used?  If we completely remove them, using the command-line flag would generate an error, but using the config macro would be silently ignored.\n\n<p>Also, if we leave the code in place, should these options still be documented, but noted as no longer allowed?  Or should we take them totally out of the documentation?\n\n</p><p></p><hr/>\n<em>2014-Aug-12 10:20:09 by pfc:</em> <br/>\n\nI think that if you remove them, (a) specifying them should produce a warning or error (lest people get confused); and (b) they should <strong>remain</strong> in the documentation (for a few years, if not forever) with a note saying that the feature has been removed as of version x.y.z (and if possible, a concise explanation of why or a link to the ticket) so that anyone who is bitten by it (or searches for it based on an old email) can easily understand what happened...\n\n<p></p><hr/>\n<em>2014-Aug-12 11:05:11 by wenger:</em> <br/>\n\nYes, I talked with Karen Miller about this yesterday, and that's pretty much the plan we came up with...\n\n<p></p><hr/>\n<em>2014-Aug-12 12:20:34 by wenger:</em> <br/>\n\nNote:  Documentation can't get fully updated until <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=2218\" onclick=\"get_ticket_and_populate_wrapper('2218'); return false;\" title=\"Add a command-line option to put DAGMan into recovery mode?\">#2218</a></span> (Add a command-line option to put DAGMan into recovery mode?) is merged into the master.\n\n<p></p><hr/>\n<em>2014-Aug-12 14:43:31 by wenger:</em> <br/>\n\nThis has been committed to master; I'm going to assign it to Zach for a retroactive review.\n\n<p></p><hr/>\n<em>2015-Oct-21 11:54:51 by wenger:</em> <br/>\n\nI'm going to resolve this, since it's been in the code for over a year now...</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4091\" onclick=\"get_ticket_and_populate_wrapper('4091'); return false;\" title=\"Add deprecation warning for DAGMan non-workflow log mode?\">#4091</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd deprecation warning for DAGMan non-workflow log mode?</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4528\" onclick=\"get_ticket_and_populate_wrapper('4528'); return false;\" title=\"Remove old DAGMan per-job log file code\">#4528</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nRemove old DAGMan per-job log file code</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Aug-21 14:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d29e369e1b935b3c07005711c1b2698e15d95ce8\">[41012]</a></span>: doc edits to 8.3.1 DAGMan improvement. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3994\" onclick=\"get_ticket_and_populate_wrapper('3994'); return false;\" title=\"Require DAGMan to run in workflow log mode?\">#3994</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Aug-12 14:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d34b79b4f814c9e47cc7e89f6dd27ef2faf63015\">[40947]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3994\" onclick=\"get_ticket_and_populate_wrapper('3994'); return false;\" title=\"Require DAGMan to run in workflow log mode?\">#3994</a></span>: Disabled DAGMan non-workflow log mode, and updated the manual accordingly.  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Oct-21 11:55", "status": "resolved", "created": "2013-Oct-18 14:10", "fixed_version": "2013-Oct-18 14:10", "broken_version": "v080102", "priority": "2", "subsystem": "Dag", "assigned_to": "zmiller", "derived_from": "#3993", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, tannenba@cs.wisc.edu,pfcouvar@syr.edu,anderson@ligo.caltech.edu", "due_date": ""}