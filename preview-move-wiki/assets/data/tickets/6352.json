{"id": 6352, "title": "Ticket #6352: Improve condor_top", "description": "<blockquote>\nThe current condor_top is more or less a straight port of condor_top.pl to Python except that it uses the Python bindings to query the Collector directly for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> rather than reading them from files passed via command-line. While helpful, there are many improvements that could be made to condor_top:\n\n<p></p><ol>\n<li>Allow for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> to be queried directly (current behavior) <em>or</em> supplied from the command-line (enhancement).\n</li><li>Add a \"non-live\" mode where stdout can be redirected or piped.\n</li><li>Default to monitoring whatever the role of the current machine is. If multiple roles are defined, default to monitoring the Schedd.\n</li><li>Focus the columnar output on ClassAd-to-ClassAd changes (in runtimes, counts, rates, etc.) rather than totals since daemon start.\n</li><li>Minor fixes and changes to condor_top (see below).\n</li></ol>\n\n<p>These changes will make condor_top a more flexible tool that will allow admins to quickly find what subprocesses are spinning their wheels as well as help us to provide quicker support by analyzing emailed (i.e. offline) <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> or condor_top output.\n\n</p><p>Minor fixes:\n</p><ul>\n<li>Decrease the display width by one to avoid wrap in some terminal emulators.\n</li><li>Fix the RAM suffixes, they are off by one.\n</li><li>Display the daemon name and query time(s).\n</li><li>Discard some specific attributes (e.g. SCGetAutocluster_cchit).</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2017-Jul-19 10:01:42 by jpatton:</em> <br/>\n\n<ol>\n<li>condor_top can either take two <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> files or grab <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> live from the Collector.\n</li><li>Continual live updates requires use of a flag (-l), otherwise condor_top prints once and quits.\n</li><li>condor_top defaults to monitoring the local Schedd if run on a submit node. (Startd on execute node.)\n</li><li>When running in \"live\" mode, condor_top prints out the recent duty cycle as a placeholder.\n</li><li>Added/modified a bunch of columns. Their descriptions are in the man page.\n</li><li>Added an option (-c) to choose which set of columns to display. \"-c all\" is fun with a wide terminal screen.\n</li><li>When stdout is piped, columns/lines are not fit to the terminal window.\n</li><li>All the \"Updating\" and \"Warning\" info now goes through stderr.\n</li></ol>\n\n<p></p><hr/>\n<em>2017-Sep-07 17:21:09 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> this looks very good. A lot of good improvements here.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Sep-11 14:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=52302\">[52302]</a></span>: Adding version history for condor_top changes <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6352\" onclick=\"get_ticket_and_populate_wrapper('6352'); return false;\" title=\"Improve condor_top\">#6352</a></span>  (By Jason Patton )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-28 14:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51960\">[51960]</a></span>: Merged <span class=\"chng\"><a href=\"chngview?cn=51958\">[51958]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=51959\">[51959]</a></span>, Improved and documented condor_top <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6352\" onclick=\"get_ticket_and_populate_wrapper('6352'); return false;\" title=\"Improve condor_top\">#6352</a></span> Major changes listed in the gittrac ticket. Briefly... 1. Added <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAd\" title=\"Class Ad\">ClassAd</a></span> file support 2. Prioritized monitoring of Schedd 3. Does not live update by default 4. New columns, described in man page  (By Jason Patton )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-19 09:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51959\">[51959]</a></span>: Updating man page for improved condor_top <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6352\" onclick=\"get_ticket_and_populate_wrapper('6352'); return false;\" title=\"Improve condor_top\">#6352</a></span>  (By Jason Patton )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Jul-19 08:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=51958\">[51958]</a></span>: Improved condor_top <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6352\" onclick=\"get_ticket_and_populate_wrapper('6352'); return false;\" title=\"Improve condor_top\">#6352</a></span> Major changes: 1. <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAds\" title=\"Class Ads\">ClassAds</a></span> from files or from the Collector 2. Live and non-live (e.g. for piping) modes 3. Default daemon based on local machine role 4. New and renamed columns  (By Jason Patton )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Sep-11 23:02", "status": "resolved", "created": "2017-Jul-18 16:01", "fixed_version": "2017-Jul-18 16:01", "broken_version": "", "priority": "2", "subsystem": "Tools", "assigned_to": "jpatton", "derived_from": "#6205", "creator": "jpatton", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}