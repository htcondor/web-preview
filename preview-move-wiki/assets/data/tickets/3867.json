{"id": 3867, "title": "Ticket #3867: condor_ssh_to_job / condor_submit -i and held jobs", "description": "<blockquote>\nIf you run condor_submit -i and the resulting job goes on hold, condor_submit will not notify you; it instead assumes that the hold is a transient condition, and the command hangs.  (It may, in fact, just be very patient.)  Likewise, condor_ssh_to_job -auto-retry appears to hang when you specify a job that's on hold.\n\n<p>Since this will only be useful is in the case that you have a periodic release expression defined (which I understand to be relatively uncommon), it would seem that we could do better.\n\n</p><p>For condor_ssh_to_job -auto-retry, we should report to the user (on each retry?) that the job is on hold, why (the hold reason), and that you will probably need to manually intervene.\n\n</p><p>For condor_submit -i, we should report the job going on hold to the user, as above, but because we know the job was submitted for the sole purpose of interactive access, also ask the user if they'd like to release the job (perhaps reminding them that interrupting the console will remove it).  If condor_submit -i (as I would expect) just calls condor_ssh_to_job, this could be trickier to arrange.\n\n</p><p>Implementing the first suggestion for EC2 jobs should be simple (condor_ssh_to_job already has the EC2 job's status attribute), but implementation for other jobs would probably best done in the schedd (getJobConnectInfo()), by altering the 'retry_sensible' output parameter, but this may have other implications.\n\n</p><p>Perhaps the second suggestion could just implement as an undocumented flag to condor_ssh_to_job?</p></blockquote>", "remarks": "<blockquote>\n<em>2014-Jan-07 12:07:41 by johnkn:</em> <br/>\n\nThis may be hard to do, but it seems to me that ssh_to_job should inform you that the job is on hold and ask if you want either quit, or release it.\n\n<p></p><hr/>\n<em>2014-Jan-07 14:48:37 by tlmiller:</em> <br/>\n\nAfter talking to ToddT, not implementing the release/remove/quit question.\n\n<p></p><hr/>\n<em>2014-Jan-07 14:51:41 by tlmiller:</em> <br/>\n\nTesting confirms that older clients talking to ignore the extra information in the reply, and that newer clients talking to older servers revert to their previous behaviour.\n\n<p>Changes may be too extensive for cherry-picking back to stable; review?</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Feb-06 13:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cf6ca78e84d39fa03aff5a2f00b3e90ed6cc0c1b\">[39350]</a></span>: collapse 2 8.1.4 version history items into 1 and edit <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3867\" onclick=\"get_ticket_and_populate_wrapper('3867'); return false;\" title=\"condor_ssh_to_job / condor_submit -i and held jobs\">#3867</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jan-31 14:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e1460322dee4bac0b3dfc4244668a7cc10396125\">[39284]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3867\" onclick=\"get_ticket_and_populate_wrapper('3867'); return false;\" title=\"condor_ssh_to_job / condor_submit -i and held jobs\">#3867</a></span>) Document that we now detect held jobs and won't try to SSH to them.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jan-07 11:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bfee1c96b554128eee36414106e2825860baa7e5\">[39117]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3867\" onclick=\"get_ticket_and_populate_wrapper('3867'); return false;\" title=\"condor_ssh_to_job / condor_submit -i and held jobs\">#3867</a></span>) Detect held jobs and stop trying to SSH to them.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Jan-31 14:25", "status": "resolved", "created": "2013-Aug-21 15:09", "fixed_version": "2013-Aug-21 15:09", "broken_version": "v080000", "priority": "4", "subsystem": "", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "s8369", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}