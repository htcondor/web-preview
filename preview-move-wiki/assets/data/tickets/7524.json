{"id": 7524, "title": "Ticket #7524: Python bindings negotiation flow causes segfault", "description": "<blockquote>\n<a class=\"external\" href=\"https://github.com/htcondor/htcondor-python-bindings-tutorials/issues/11\">https://github.com/htcondor/htcondor-python-bindings-tutorials/issues/11</a> is an issue with the Python bindings negotiation mechanism: it can cause segfaults. The issue appears to be in the iterator over the resource requests you get from the negotiation session object.\n\n<p>Reproduction script is at <a class=\"external\" href=\"https://github.com/htcondor/python-bindings-crashes/blob/master/tests/negotiation.py\">https://github.com/htcondor/python-bindings-crashes/blob/master/tests/negotiation.py</a> (reproduction tools are in that repository; clone it, run <code>dr.sr</code> or <code>dr.cmd</code> to get a Docker container with the right environment, then <code>./get_core_dump.sh python tests/negotiation.py</code> to run the script under <code>gdb</code>).\n\n</p><p>Here's a core dump from running the example script:\n</p><div class=\"code\">\n<pre class=\"code\">#0  PyErr_Restore (type=&lt;type at remote 0x7f2046cf0ac0&gt;, value=&lt;optimized out&gt;, traceback=traceback@entry=0x0) at /usr/src/debug/Python-2.7.5/Python/errors.c:39\n#1  0x00007f2046a54539 in PyErr_SetObject (exception=exception@entry=&lt;type at remote 0x7f2046cf0ac0&gt;, value=value@entry='Failed to get reply from schedd.')\n    at /usr/src/debug/Python-2.7.5/Python/errors.c:57\n#2  0x00007f2046a5456f in PyErr_SetString (exception=&lt;type at remote 0x7f2046cf0ac0&gt;, string=&lt;optimized out&gt;) at /usr/src/debug/Python-2.7.5/Python/errors.c:70\n#3  0x00007f204463d9fd in getNextRequest (this=0x112ac30) at /usr/src/debug/condor-8.9.5/src/python-bindings/schedd.cpp:368\n#4  RequestIterator::next (this=0x112ac30) at /usr/src/debug/condor-8.9.5/src/python-bindings/schedd.cpp:390\n#5  0x00007f2044640f1e in invoke&lt;boost::python::to_python_value&lt;boost::shared_ptr&lt;ClassAdWrapper&gt; const&amp;&gt;, boost::shared_ptr&lt;ClassAdWrapper&gt; (RequestIterator::*)(), boost::python::arg_from_python&lt;RequestIterator&amp;&gt; &gt; (rc=..., tc=&lt;synthetic pointer&gt;, f=&lt;optimized out&gt;) at /usr/include/boost169/boost/python/detail/invoke.hpp:86\n#6  operator() (args_=&lt;optimized out&gt;, this=&lt;optimized out&gt;) at /usr/include/boost169/boost/python/detail/caller.hpp:221\n#7  boost::python::objects::caller_py_function_impl&lt;boost::python::detail::caller&lt;boost::shared_ptr&lt;ClassAdWrapper&gt; (RequestIterator::*)(), boost::python::default_call_policies, boost::mpl::vector2&lt;boost::shared_ptr&lt;ClassAdWrapper&gt;, RequestIterator&amp;&gt; &gt; &gt;::operator() (this=&lt;optimized out&gt;, args=&lt;optimized out&gt;, kw=&lt;optimized out&gt;) at /usr/include/boost169/boost/python/object/py_function.hpp:38\n#8  0x00007f2043a13505 in operator() (kw=0x0, args=(&lt;ResourceRequestIterator at remote 0x7f2041e6d578&gt;,), this=0x108bf80) at boost/python/object/py_function.hpp:147\n#9  boost::python::objects::function::call (this=0x108bf70, args=(&lt;ResourceRequestIterator at remote 0x7f2041e6d578&gt;,), keywords=0x0) at libs/python/src/object/function.cpp:221\n#10 0x00007f2043a13848 in operator() (this=&lt;optimized out&gt;) at libs/python/src/object/function.cpp:580\n#11 boost::detail::function::void_function_ref_invoker0&lt;boost::python::objects::(anonymous namespace)::bind_return, void&gt;::invoke (function_obj_ptr=...) at boost/function/function_template.hpp:193\n#12 0x00007f2043a1c163 in operator() (this=0x7ffe47dff090) at boost/function/function_template.hpp:764\n#13 boost::python::handle_exception_impl (f=...) at libs/python/src/errors.cpp:25\n#14 0x00007f2043a12029 in handle_exception&lt;boost::python::objects::(anonymous namespace)::bind_return&gt; (f=...) at boost/python/errors.hpp:29\n#15 boost::python::objects::function_call (func=&lt;optimized out&gt;, args=&lt;optimized out&gt;, kw=&lt;optimized out&gt;) at libs/python/src/object/function.cpp:621\n#16 0x00007f20469b0ab3 in PyObject_Call (func=func@entry=&lt;Boost.Python.function at remote 0x108bf70&gt;, arg=arg@entry=(&lt;ResourceRequestIterator at remote 0x7f2041e6d578&gt;,), kw=kw@entry=0x0)\n    at /usr/src/debug/Python-2.7.5/Objects/abstract.c:2529\n#17 0x00007f20469bfaa5 in instancemethod_call (func=&lt;Boost.Python.function at remote 0x108bf70&gt;, arg=(&lt;ResourceRequestIterator at remote 0x7f2041e6d578&gt;,), kw=0x0)\n    at /usr/src/debug/Python-2.7.5/Objects/classobject.c:2602\n#18 0x00007f20469b0ab3 in PyObject_Call (func=func@entry=&lt;instancemethod at remote 0x7f2046e88aa0&gt;, arg=arg@entry=(), kw=kw@entry=0x0) at /usr/src/debug/Python-2.7.5/Objects/abstract.c:2529\n#19 0x00007f2046a06f93 in call_method (o=&lt;optimized out&gt;, name=&lt;optimized out&gt;, nameobj=0x7f2046d23ca0 &lt;next_str.12121&gt;, format=&lt;optimized out&gt;) at /usr/src/debug/Python-2.7.5/Objects/typeobject.c:1261\n#20 0x00007f2046a44c91 in PyEval_EvalFrameEx (f=f@entry=Frame 0x7f2046ebfa00, for file tests/negotation.py, line 39, in &lt;module&gt; (), throwflag=throwflag@entry=0)\n    at /usr/src/debug/Python-2.7.5/Python/ceval.c:2860\n#21 0x00007f2046a4c08d in PyEval_EvalCodeEx (co=co@entry=0x7f2046e3fa30,\n    globals=globals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated),\n    locals=locals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated), args=args@entry=0x0, argcount=argcount@entry=0, kws=kws@entry=0x0, kwcount=kwcount@entry=0, defs=defs@entry=0x0, defcount=defcount@entry=0,\n    closure=closure@entry=0x0) at /usr/src/debug/Python-2.7.5/Python/ceval.c:3640\n#22 0x00007f2046a4c192 in PyEval_EvalCode (co=co@entry=0x7f2046e3fa30,\n    globals=globals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated),\n    locals=locals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated)) at /usr/src/debug/Python-2.7.5/Python/ceval.c:689\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#23 0x00007f2046a655cf in run_mod (mod=&lt;optimized out&gt;, filename=filename@entry=0x7ffe47e018c5 \"tests/negotation.py\",\n    globals=globals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated),\n    locals=locals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated), flags=flags@entry=0x7ffe47dff820, arena=arena@entry=0xf9bd20) at /usr/src/debug/Python-2.7.5/Python/pythonrun.c:1374\n#24 0x00007f2046a6679e in PyRun_FileExFlags (fp=fp@entry=0xf9bd40, filename=filename@entry=0x7ffe47e018c5 \"tests/negotation.py\", start=start@entry=257,\n    globals=globals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated),\n    locals=locals@entry={'session': &lt;ScheddNegotiate at remote 0x7f2041e6d500&gt;, 'startd_ads': [&lt;ClassAd at remote 0x7f2046d8bcf8&gt;, &lt;ClassAd at remote 0x7f2046d8bd70&gt;, &lt;ClassAd at remote 0x7f2046d8bde8&gt;, &lt;ClassAd at remote 0x7f2046d8be60&gt;, &lt;ClassAd at remote 0x7f2046d8bed8&gt;, &lt;ClassAd at remote 0x7f2046d8bf50&gt;, &lt;ClassAd at remote 0x7f2041e6d050&gt;, &lt;ClassAd at remote 0x7f2041e6d0c8&gt;, &lt;ClassAd at remote 0x7f2041e6d140&gt;, &lt;ClassAd at remote 0x7f2041e6d1b8&gt;, &lt;ClassAd at remote 0x7f2041e6d230&gt;, &lt;ClassAd at remote 0x7f2041e6d2a8&gt;, &lt;ClassAd at remote 0x7f2041e6d320&gt;, &lt;ClassAd at remote 0x7f2041e6d398&gt;, &lt;ClassAd at remote 0x7f2041e6d410&gt;, &lt;ClassAd at remote 0x7f2041e6d488&gt;], 'ad': &lt;...&gt;, 'schedd': &lt;Schedd at remote 0x7f2041e683c0&gt;, '__builtins__': &lt;module at remote 0x7f2046f06b08&gt;, '__file__': 'tests/negotation.py', '__package__': None, 'pvt_ad': &lt;ClassAd at remote 0x7f2046d8bc80&gt;, 'private_ads': [&lt;ClassAd at remote 0x7f2046d8b578&gt;, &lt;ClassAd at remote 0x7f2046d8b5f0&gt;, &lt;ClassAd at remote 0x7f2046d8b668&gt;, &lt;ClassAd at remote 0x7f2046d8b6e0&gt;, &lt;Clas...(truncated), closeit=closeit@entry=1, flags=flags@entry=0x7ffe47dff820) at /usr/src/debug/Python-2.7.5/Python/pythonrun.c:1360\n#25 0x00007f2046a67a29 in PyRun_SimpleFileExFlags (fp=fp@entry=0xf9bd40, filename=filename@entry=0x7ffe47e018c5 \"tests/negotation.py\", closeit=closeit@entry=1, flags=flags@entry=0x7ffe47dff820)\n    at /usr/src/debug/Python-2.7.5/Python/pythonrun.c:952\n#26 0x00007f2046a67f43 in PyRun_AnyFileExFlags (fp=fp@entry=0xf9bd40, filename=filename@entry=0x7ffe47e018c5 \"tests/negotation.py\", closeit=closeit@entry=1, flags=flags@entry=0x7ffe47dff820)\n    at /usr/src/debug/Python-2.7.5/Python/pythonrun.c:756\n#27 0x00007f2046a78bdf in Py_Main (argc=&lt;optimized out&gt;, argv=&lt;optimized out&gt;) at /usr/src/debug/Python-2.7.5/Modules/main.c:640\n#28 0x00007f2045c94505 in __libc_start_main (main=0x400640 &lt;main&gt;, argc=2, argv=0x7ffe47dff9e8, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7ffe47dff9d8)\n    at ../csu/libc-start.c:266\n#29 0x000000000040066e in _start ()\n</pre></div>\n\n\n<p>It looks like the last place we have control is <a class=\"external\" href=\"https://github.com/htcondor/htcondor/blob/master/src/python-bindings/schedd.cpp#L368\">https://github.com/htcondor/htcondor/blob/master/src/python-bindings/schedd.cpp#L368</a>\n</p><div class=\"code\">\n<pre class=\"code\">#3  0x00007f204463d9fd in getNextRequest (this=0x112ac30) at /usr/src/debug/condor-8.9.5/src/python-bindings/schedd.cpp:368\n#4  RequestIterator::next (this=0x112ac30) at /usr/src/debug/condor-8.9.5/src/python-bindings/schedd.cpp:390\n</pre></div>\n\n\n<p>That block of code hasn't been changed since 2016, but it does acquire the module lock, which makes me think the recent module lock changes are what broke this.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Feb-26 16:02:02 by tannenba:</em> <br/>\n\nI tend to think of the bindings for negotiation and COD as experimental, and I am not aware of any existing (or planned) users.  Not certain I want to commit to support these methods once 8.9 moves to a new stable series; we have other higher priority work to do.  Thus my thinking is we should remove the negotiation and COD examples from the tutorials and documentation for now instead of spending development effort fixing/documenting them.\n\n<p></p><hr/>\n<em>2020-Feb-27 09:01:29 by karpel:</em> <br/>\n\nDone. Will downgrade priority, but leave the ticket open for now.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-18 15:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/f84fb1356ab60a86186ad4131dcd926f0a3057c7\">[59914]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7690\" onclick=\"get_ticket_and_populate_wrapper('7690'); return false;\" title=\"Deprecate old, bad Python interfaces\">#7690</a></span>) Also deprecate Schedd.negotiate(), as per gt#7524.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Feb-27 08:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5786cf2d327e9a1d37a16abfb011a641b29fb859\">[59060]</a></span>: (<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7524\" onclick=\"get_ticket_and_populate_wrapper('7524'); return false;\" title=\"Python bindings negotiation flow causes segfault\">#7524</a></span>) do not display negotiation and COD methods in the Python bindings docs  (By Josh Karpel )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Nov-09 12:24", "status": "new", "created": "2020-Feb-26 10:07", "fixed_version": "2020-Feb-26 10:07", "broken_version": "v080905", "priority": "4", "subsystem": "PythonBinding", "assigned_to": "johnkn", "derived_from": "", "creator": "karpel", "rust": "", "customer_group": "other", "visibility": "public", "notify": "karpel@wisc.edu, bbockelm@morgridge.org, johnkn@cs.wisc.edu", "due_date": ""}