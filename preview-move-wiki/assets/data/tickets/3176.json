{"id": 3176, "title": "Ticket #3176: Schedd can't remove local universe execute directories", "description": "<blockquote>\nWhen the schedd starts up, it ensures the execute directory for local universe jobs exists and is empty. It uses Directory::Remove_Entire_Directory() to clean out any subdirectories. But when it instantiates the Directory object, it doesn't provide a privilege level. As a result, Remove_Entire_Directory() tries to remove files/directories only as the current privilege (i.e. condor). But the directories are owned by the owner job, so the removal fails. If we passed in PRIV_CONDOR to the Directory constructor, then Remove_Entire_Directory() would also try the removal as the file/directory owner.\n\n<p>This all takes place in Scheduler::initLocalStarterDir().</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Aug-03 16:03:51 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong> by zmiller: i approve jaime's proposed change.\n<hr/>\n<em>2012-Aug-23 14:11:52 by zmiller:</em> <br/>\n\nBulk change of target version from v070802 to v070803 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-24 10:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=33147\">[33147]</a></span>: minor spelling correction ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3176\" onclick=\"get_ticket_and_populate_wrapper('3176'); return false;\" title=\"Schedd can't remove local universe execute directories\">#3176</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Aug-06 16:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=32968\">[32968]</a></span>: Let the schedd remove old local universe execute directories. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3176\" onclick=\"get_ticket_and_populate_wrapper('3176'); return false;\" title=\"Schedd can't remove local universe execute directories\">#3176</a></span> On startup, the schedd removes everything under the local universe execute directory (param LOCAL_UNIV_EXECUTE). But it only tries to do so as user condor. The removal will fail if the subdirectories contain any files, since they're\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2012-Aug-23 14:11", "status": "resolved", "created": "2012-Aug-02 15:31", "fixed_version": "2012-Aug-02 15:31", "broken_version": "v070800", "priority": "4", "subsystem": "Daemons", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}