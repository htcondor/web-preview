{"id": 208, "title": "Ticket #208: Dagman.out files broken for external subdags", "description": "<blockquote>\nOn at least some platforms, the _CONDOR_DAGMAN_LOG environment variable gets goofed up for external subdags.  (Instead of getting its own value of _CONDOR_DAGMAN_LOG, the lower-level DAGMan gets the parent DAGMan's value.  This causes the lower-level DAGMan to write to the parent DAGMan's .dagman.out file.)  (Pete and I verified that the environment variable is getting goofed up by looking at the classad for the child DAGMan saved in the nightly tests.)\n\n<p>Strangely enough, I can't duplicate this right now with some stand-alone test DAGs that I have.  I'm working on changing my subdag test that's part of the test suite to detect the problem, though.\n\n</p><p>Pete and I (Kent) are suspicious of the recent daemoncore changes relating to how DAGMan deals with X509_CERT_DIR -- that's why I'm assigning this ticket to Nick.</p></blockquote>", "remarks": "<blockquote>\n2009-02-10: The job_dagman_subdag-A test now checks for this problem.\n\n<p>2009-02-12: Okay, condor_submit environment fix from yesterday fixed this.  The problem was that the \"don't overwrite stuff from the environment line\" check got accidentally left out when the condor_submit environment handling code got refactored.  The change to condor_submit_dag didn't actually affect the problem.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Sep-28 08:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b0415cd8d2d1cbc9dac479212c683664918f3186\">[64498]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1d682797c4de74f320bec30bafeeaca3834401c5\">[64352]</a></span>, Merge pull request <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span> from htcondor/master-HTCONDOR-720-branch HTCONDOR-720 add NOBODY_SLOT_USER. a better way to configure SLOT&lt;n&gt;_\u00e2\u20ac\u00a6 Committer: <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GitHub\" title=\"Git Hub\">GitHub</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Feb-11 16:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/476adb055da9ac4602ed864b9191be3dbdb0e1ae\">[13911]</a></span>: Fixed gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span> (dagman.out files broken for external subdags) -- restored checking in condor_submit environment handling that avoids overriding variables set in \"environment=...\" (the changes for gittrac <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=29\" onclick=\"get_ticket_and_populate_wrapper('29'); return false;\" title=\"DAGMan overwrites X509_CERT_DIR and friends\">#29</a></span> broke this).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Feb-10 18:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8d5800f20717e09c6a38a40f34ec0e7b93b07965\">[13902]</a></span>: job_dagman_subdag-A.run now checks for proper dagman.out files (see gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span> and <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=166\" onclick=\"get_ticket_and_populate_wrapper('166'); return false;\" title=\"Create regression test of evironment for DAGMan jobs with getenv=true\">#166</a></span>).  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2009-Feb-10 18:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0b5f8e4e88d9b304c799c7d192095d8305f985ab\">[13901]</a></span>: job_dagman_subdag-A.run now checks for proper dagman.out files (see gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=208\" onclick=\"get_ticket_and_populate_wrapper('208'); return false;\" title=\"Dagman.out files broken for external subdags\">#208</a></span> and <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=166\" onclick=\"get_ticket_and_populate_wrapper('166'); return false;\" title=\"Create regression test of evironment for DAGMan jobs with getenv=true\">#166</a></span>).  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-Jan-31 08:36", "status": "resolved", "created": "2009-Feb-10 17:11", "fixed_version": "2009-Feb-10 17:11", "broken_version": "v070300", "priority": "2", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "#166", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}