{"id": 3985, "title": "Ticket #3985: condor_q -analyze crashing with illegal instruction", "description": "<blockquote>\ncondor_q -analyze is crashing in CHTC on the following Requirements expression.\n\n<p></p><div class=\"verbatim\">\n<pre>Requirements =\n( ( Target.SlotID &lt; 2 &amp;&amp; HasVMJahnsKvm ) &amp;&amp;\n  ( MY.JobUniverse == 12 || MY.JobUniverse == 7 ||\n    MY.WantFlocking || MY.WantGlidein || TARGET.PoolName == \"CHTC\" ||\n    TARGET.COLLECTOR_HOST_STRING == \"infopool.cs.wisc.edu\" ) &amp;&amp;\n  ( TARGET.Arch == \"X86_64\" ) &amp;&amp;\n  ( TARGET.HasVM ) &amp;&amp;\n  ( TARGET.VM_Type == \"kvm\" ) &amp;&amp;\n  ( TARGET.VM_AvailNum &gt; 0 ) &amp;&amp;\n  ( TARGET.Disk &gt;= RequestDisk ) &amp;&amp;\n  ( TARGET.HasFileTransfer &amp;&amp;\n    stringListMember(\"file\",HasFileTransferPluginMethods) ) ) &amp;&amp;\n( TARGET.FileSystemDomain == MY.FileSystemDomain ) &amp;&amp;\n( TARGET.TotalMemory &gt;= 1968 ) &amp;&amp;\n( TARGET.VM_Memory &gt;= 1968 ) &amp;&amp;\n( TARGET.VM_Networking ) &amp;&amp;\n( stringListIMember(\"nat\",TARGET.VM_Networking_Types,\",\") )\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2013-Oct-15 09:30:00 by johnkn:</em> <br/>\n\nStepping through the code shows that the problematic part of this expression is\n\n<p></p><pre>    ( stringListIMember(\"nat\",TARGET.VM_Networking_Types,\",\") )\n</pre>\n\n<p>The enclosing () are required, as is the fact that this is a function.  The underlying bug (a bad cast) has been in the code since the original analyze went in, but it only began to manifest as a crashing bug when we shrunk some of the classad nodes in 7.9.x.\n\n</p><p></p><hr/>\n<em>2013-Oct-15 10:36:09 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>This code change looks good.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-15 11:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6c84e601c2b79f96fca89569a81d5c5eac374df2\">[37863]</a></span>: very minor 8.0.4 version history item edit <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3985\" onclick=\"get_ticket_and_populate_wrapper('3985'); return false;\" title=\"condor_q -analyze crashing with illegal instruction\">#3985</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-15 09:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a4bed42d7e5b6af25acd5ae018c09af15aa2205d\">[37847]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3985\" onclick=\"get_ticket_and_populate_wrapper('3985'); return false;\" title=\"condor_q -analyze crashing with illegal instruction\">#3985</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Oct-15 09:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3f2189df0f6575fcf2c518c3989d00e965325377\">[37846]</a></span>: fix bug that caused illegal instruction in condor_q -analyze <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3985\" onclick=\"get_ticket_and_populate_wrapper('3985'); return false;\" title=\"condor_q -analyze crashing with illegal instruction\">#3985</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Aug-04 11:52", "status": "resolved", "created": "2013-Oct-14 15:55", "fixed_version": "2013-Oct-14 15:55", "broken_version": "v080000", "priority": "4", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}