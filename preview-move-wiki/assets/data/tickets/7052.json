{"id": 7052, "title": "Ticket #7052: Print detailed error stack when GSI authentication fails", "description": "<blockquote>\nWhen GSI authentication fails in CEDAR, we attempt to log the detailed error stack from GSI in the daemon log. On the server side, this was frequently getting lost. We would overwrite the error data with that from a subsequent GSI cleanup function (which was succeeding). As a result, the error information written to the log would look like this:\n\n<p></p><div class=\"verbatim\">\n<pre>05/14/19 10:45:56 Condor GSI authentication failure\nGSS Major Status: Authentication Failed\nGSS Minor Status Error Chain:\n(null)\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2019-Jun-19 14:22:18 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong>:  In this commit, on line 1203 we set major_status and minor_status2 (note the <strong>2</strong>), but on line 1223 we report the error using major_status and minor_status (no <strong>2</strong>).  This seems like a mismatch.\n\n<p></p><hr/>\n<em>2019-Jun-20 11:29:39 by jfrey:</em> <br/>\n\nI agree on the mismatch. I'll change it to use minor_status for that call. The globus_gss_assist code this is based on has the same mismatch.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-20 13:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3598afd79d88c87f1dd9b6f31a1d2bb85ca62af1\">[57197]</a></span>: Fix grammar in version history. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7052\" onclick=\"get_ticket_and_populate_wrapper('7052'); return false;\" title=\"Print detailed error stack when GSI authentication fails\">#7052</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-20 12:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/edd9557905ab21347f7638c2966a3e83be766f6f\">[57196]</a></span>: Docs for improved GSI error message logging. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7052\" onclick=\"get_ticket_and_populate_wrapper('7052'); return false;\" title=\"Print detailed error stack when GSI authentication fails\">#7052</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jun-20 11:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b9d302d8b1794095f9466a36d131d9f1eaf46d9f\">[57194]</a></span>: Change minor_status variable, per code review. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7052\" onclick=\"get_ticket_and_populate_wrapper('7052'); return false;\" title=\"Print detailed error stack when GSI authentication fails\">#7052</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-May-14 11:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/304adabcbaa2a2e8b0e696f899dc11ad6f63893a\">[56877]</a></span>: Print detailed error stack when GSI authentication fails <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7052\" onclick=\"get_ticket_and_populate_wrapper('7052'); return false;\" title=\"Print detailed error stack when GSI authentication fails\">#7052</a></span> After GSI authentication fails, don't overwrite the minor_status when calling GSI cleanup functions. Use a separate status variable for those calls. This matches the behavior in libglobus_gss_assist. Otherwise, we loss the error information\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Jul-03 10:15", "status": "resolved", "created": "2019-May-14 11:07", "fixed_version": "2019-May-14 11:07", "broken_version": "", "priority": "3", "subsystem": "Security", "assigned_to": "jfrey", "derived_from": "#7024", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}