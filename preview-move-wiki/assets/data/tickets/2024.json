{"id": 2024, "title": "Ticket #2024: JAVA_MAXHEAP_ARGUMENT should be removed/deprecated/fixed", "description": "<blockquote>\nJAVA_MAXHEAP_ARGUMENT handling is problematic.  According to the documentation it is supposed to indicate the flag users use to indicate the max heap argument to the JVM, not including the value we want it set to.  This works in older versions of the JVM, or at least in IBM's version circa 1.4.x, but Sun/Oracle JVMs since at least the 1.6 series require a numerical value such as -Xmx100m.  The code for passing a value to the JVM checks for the presence of a value in JAVA_MAXHEAP_ARGUMENT and checks to make sure it begins with -Xmx.  The way this check is written seems to imply that users can add an actual value after \"-Xmx\", which contradicts what the comments above the config knob say.  The comment is also incorrect in saying that passing just \"-Xmx\" works in the Sun JVM.\n\n<p>If the check for \"-Xmx\" passes, Condor passes the value on without further modification without appending any additional values to it, again in contradiction to the comments above the configuration option.  If the test fails, it will construct a -Xmx argument by appending the amount of memory divided by the number of slots to -Xmx before passing it onto the JVM.  Users that remove \"-Xmx\" from the configuration file and using the JAVA_EXTRA_ARGUMENTS configuration knob to pass in their own -Xmx value are thus passing in two values, which the JVM accepts but I do not know what actually gets used.\n\n</p><p>This is primarily causing Windows users a lot of grief as they tend to have newer versions of Java installed.\n\n</p><p>Proposed Solution: Remove JAVA_MAXHEAP_ARGUMENT entirely.  Users that need to pass a value in are often already doing so via JAVA_EXTRA_ARGUMENTS.  The documentation for this configuration knob is incorrect as it is and the behavior makes assumptions that are no longer valid.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2246\" onclick=\"get_ticket_and_populate_wrapper('2246'); return false;\" title=\"condor_hdfs does not start up anymore\">#2246</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ncondor_hdfs does not start up anymore</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/312/javaheap.diff\">javaheap.diff</a>\n1692 bytes added by ziliang on 2011-Apr-01 18:12:14 UTC.\n<br/>\nPatch against 7.6 branch for removing JAVA_MAXHEAP_ARGUMENT from config file and code.<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Apr-06 15:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=25994\">[25994]</a></span>: final changes to implement <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2024\" onclick=\"get_ticket_and_populate_wrapper('2024'); return false;\" title=\"JAVA_MAXHEAP_ARGUMENT should be removed/deprecated/fixed\">#2024</a></span>, removal of config knob JAVA_MAXHEAP_ARGUMENT  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Apr-05 16:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=25989\">[25989]</a></span>: the start of documenting <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2024\" onclick=\"get_ticket_and_populate_wrapper('2024'); return false;\" title=\"JAVA_MAXHEAP_ARGUMENT should be removed/deprecated/fixed\">#2024</a></span>, removal of JAVA_MAXHEAP_ARGUMENT config knob  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Apr-04 10:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=21247\">[21247]</a></span>: Apply Z's patch to eliminate JAVA_MAXHEAP_ARGUMENT (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2024\" onclick=\"get_ticket_and_populate_wrapper('2024'); return false;\" title=\"JAVA_MAXHEAP_ARGUMENT should be removed/deprecated/fixed\">#2024</a></span>).  (By Cathrin Weiss )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Apr-04 10:47", "status": "resolved", "created": "2011-Apr-01 13:00", "fixed_version": "2011-Apr-01 13:00", "broken_version": "v070400", "priority": "1", "subsystem": "Libs", "assigned_to": "ziliang", "derived_from": "", "creator": "ziliang", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com, matt@cs.wisc.edu", "due_date": "20110401"}