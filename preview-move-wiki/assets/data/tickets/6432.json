{"id": 6432, "title": "Ticket #6432: notifications when job fails with exit code", "description": "<blockquote>\nThere has been previous discussion and confusion within LIGO and on the htcondor-users list about the behavior of notifications on \"notification = Error\". Many users reasonably believe this to mean that if the job exits with a code other than 0 that they will receive an e-mail notification. In fact, it only generates a notification when a job exits abnormally.\n\n<p>I think it would be reasonable to hard-wire this into \"notification = Error\" or perhaps \"notification = Failure\". I think \"Error\" is better because the difference is not self-evident to users.\n\n</p><p></p><div class=\"verbatim\">\n<pre>&gt; Todd / etc:\n&gt;\n&gt; Should we, in fact, expect \"notification = error\" to generate e-mails\n&gt; upon exit code != 0 in Condor 8.5.8+? Todd's e-mail implies that we\n&gt; should, but I don't see evidence of that in the release notes.\n&gt;\n\nThe success_exit_code stuff in v8.5.8+ is used in conjunction with\nmax_retries and retry_until submit macros (i.e. first-class job retries\nsimilar to dagman), but was not wired into notification=error.  I think\nit should be.... If LIGO agrees and want this, I could make a ticket\nwith the specifics for your review, add it into v8.7.x and provide a\nconfig blurb you can put into condor_config on v8.6.x to get the same\neffect (courtesy job transforms, of course!).\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2017-Oct-17 14:13:34 by tlmiller:</em> <br/>\n\nOff in a branch while it's in testing.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Dec-13 18:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b27968de0e18deb623bbe9e0a0a22b744dbf39bc\">[53007]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4818\" onclick=\"get_ticket_and_populate_wrapper('4818'); return false;\" title=\"Add SCHEDD and JOB aliases for SUBMIT_REQUIREMENTS evaluations.\">#4818</a></span>, <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6432\" onclick=\"get_ticket_and_populate_wrapper('6432'); return false;\" title=\"notifications when job fails with exit code\">#6432</a></span>, <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6446\" onclick=\"get_ticket_and_populate_wrapper('6446'); return false;\" title=\"Only last submit warning reported.\">#6446</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6465\" onclick=\"get_ticket_and_populate_wrapper('6465'); return false;\" title=\"Empty submit warnings written to job log.\">#6465</a></span>) Documentation. Committer: Tim Theisen  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Dec-11 15:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a12c10d411bd219ee5e643d78c030f490fa616d9\">[52970]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4818\" onclick=\"get_ticket_and_populate_wrapper('4818'); return false;\" title=\"Add SCHEDD and JOB aliases for SUBMIT_REQUIREMENTS evaluations.\">#4818</a></span>, <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6432\" onclick=\"get_ticket_and_populate_wrapper('6432'); return false;\" title=\"notifications when job fails with exit code\">#6432</a></span>, <span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6446\" onclick=\"get_ticket_and_populate_wrapper('6446'); return false;\" title=\"Only last submit warning reported.\">#6446</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6465\" onclick=\"get_ticket_and_populate_wrapper('6465'); return false;\" title=\"Empty submit warnings written to job log.\">#6465</a></span>) Documentation.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-17 16:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a84eb6fcadcb1d5e4f21cedcdce5c7b4b137d7aa\">[52599]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6432\" onclick=\"get_ticket_and_populate_wrapper('6432'); return false;\" title=\"notifications when job fails with exit code\">#6432</a></span>) Missed some brain-damage in standard universe.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-17 13:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0a27ac62b1f921af51411c3cb0659a80fffb1ebd\">[52591]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6432\" onclick=\"get_ticket_and_populate_wrapper('6432'); return false;\" title=\"notifications when job fails with exit code\">#6432</a></span>) All email involving a job ad now goes through ShouldSend().  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Oct-16 17:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/eff19b5f1ef71c26b0f6e5283ff4abc94d1b2a11\">[52590]</a></span>: (<span class=\"ticket\"><a class=\"defer\" href=\"/tickets?ticket=6432\" onclick=\"get_ticket_and_populate_wrapper('6432'); return false;\" title=\"notifications when job fails with exit code\">#6432</a></span>) Rename email_open() to email_nonjob_open() to discourage potential misuse. Update Email::shouldSend() to not reply false for ERROR notifications if the exit code equals the ATTR_JOB_SUCCESS_EXIT_CODE. Remove undocumented standard universe -only feature that involved email.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2017-Dec-11 15:17", "status": "defer", "created": "2017-Oct-06 12:45", "fixed_version": "2017-Oct-06 12:45", "broken_version": "v080703", "priority": "5", "subsystem": "DaemonsSubmitNode", "assigned_to": "tlmiller", "derived_from": "", "creator": "tpdownes", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "pcouvare@caltech.edu", "due_date": ""}