{"id": 3050, "title": "Ticket #3050: Once MODIFY_REQUEST_EXPR_ Fails the machine will no longer accept jobs", "description": "<blockquote>\nIf for whatever reason a job fails on MODIFY_REQUEST_EXPR_ to split it will no longer accept any jobs an get caught in a fatal loop rendering machine useless until a restart.\n\n<p>To repro:\n\n</p><p>1. Create a dual pSlot config and give most of the memory to one of the pSlots.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">NUM_CPUS=16\n\nSLOT_TYPE_1 = cpus=8 mem=10%\nNUM_SLOTS_TYPE_1 = 1\nSLOT_TYPE_1_PARTITIONABLE=TRUE\nSLOT_TYPE_2 = cpus=8 mem=90%\nNUM_SLOTS_TYPE_2 = 1\nSLOT_TYPE_2_PARTITIONABLE=TRUE\n</pre></div>\n\n\n<p>2. Submit a large number of sleep jobs to *this personal condor.\n\n</p><p>3. Wait for the \"Job no longer matches partitionable slot after MODIFY_REQUEST_EXPR_ edits, retrying w/o edits\" log message then the machine will enter a spiral.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Jun-11 15:43:46 by tstclair:</em> <br/>\n\nThe death spiral may be related to ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3051\" onclick=\"get_ticket_and_populate_wrapper('3051'); return false;\" title=\"SHADOW_LOCK fail death spiral\">#3051</a></span>\n<hr/>\n<em>2012-Sep-11 11:06:53 by johnkn:</em> <br/>\n\nBulk change of target version from v070803 to v070804 using ./ticket-target-mover.\n<hr/>\n<em>2012-Sep-19 16:15:53 by zmiller:</em> <br/>\n\nBulk change of target version from v070804 to v070805 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2012-Oct-09 10:35:09 by tstclair:</em> <br/>\n\nOn 1st blush it appears that Ian's issue hits the same segment, but different behavior from what I observed originally.\n\n<p></p><div class=\"code\">\n<pre class=\"code\">&gt;10/08/12 09:21:16 slot1: Partitionable slot can't be split to allocate a\n&gt;dynamic slot large enough for the claim\n&gt;Stack dump for process 7352 at timestamp 1349684476 (4 frames)\n&gt;/Condor/x86_64/condor-7.8.4-x86_64_deb_6.0-stripped/sbin/../lib/libcondor_\n&gt;utils_7_8_4.so(dprintf_dump_stack+0x131)[0x7f4c0f428051]\n&gt;/Condor/x86_64/condor-7.8.4-x86_64_deb_6.0-stripped/sbin/../lib/libcondor_\n&gt;utils_7_8_4.so(_Z18linux_sig_coredumpi+0x40)[0x7f4c0f596a00]\n&gt;/lib64/libpthread.so.0(+0xeff0)[0x7f4c0b208ff0]\n</pre></div>\n\n\n<p>If the logs are available I would be happy to dig.\n\n</p><p></p><hr/>\n<em>2012-Oct-09 11:01:21 by tstclair:</em> <br/>\n\nDan found the root in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3260\" onclick=\"get_ticket_and_populate_wrapper('3260'); return false;\" title=\"startd crash when using MODIFY_REQUEST_EXPR\">#3260</a></span></blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3260\" onclick=\"get_ticket_and_populate_wrapper('3260'); return false;\" title=\"startd crash when using MODIFY_REQUEST_EXPR\">#3260</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nstartd crash when using MODIFY_REQUEST_EXPR</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2012-Oct-09 11:01", "status": "abandoned", "created": "2012-Jun-11 13:25", "fixed_version": "2012-Jun-11 13:25", "broken_version": "v070600", "priority": "2", "subsystem": "Daemons", "assigned_to": "tstclair", "derived_from": "", "creator": "tstclair", "rust": "", "customer_group": "users", "visibility": "public", "notify": "tstclair@redhat.com, matt@cs.wisc.edu, eje@cs.wisc.edu, tannenba@cs.wisc.edu, gthain@cs.wisc.edu", "due_date": ""}