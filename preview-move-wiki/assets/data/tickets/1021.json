{"id": 1021, "title": "Ticket #1021: libvirt version mismatch from distro (x,y,z)", "description": "<blockquote>\nIf the distro version of the virt daemon is different then the one bound into condor, they will not be able to run xen or kvm jobs.</blockquote>", "remarks": "<blockquote>\n<em>2009-Dec-10 12:05:56 by tstclair:</em> <br/>\n\nThis requires documentation for 7.4.1 and fix as part of a umbrella ticket of dynamic linking for 7.5.0\n\n<p></p><hr/>\n<em>2009-Dec-14 06:46:11 by matt:</em> <br/>\n\nThis should also be fixed in 7.4. It represents a regression in functionality.\n\n<p></p><hr/>\n<em>2010-Jun-24 07:24:56 by matt:</em> <br/>\n\nCondor is currently using libvirt 0.6.2 with no GnuTLS\n\n<p><a class=\"external\" href=\"https://condor-wiki.cs.wisc.edu/index.cgi/dir?d=externals/bundles/libvirt/0.6.2\">https://condor-wiki.cs.wisc.edu/index.cgi/dir?d=externals/bundles/libvirt/0.6.2</a>\n</p><hr/>\n<em>2010-Aug-23 17:07:50 by adesmet:</em> <br/>\n\nBulk change of target version from v070402 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2010-Nov-29 13:33:09 by bbockelm:</em> <br/>\n\nCan I bump this ticket?  The issue has hit us at HCC (CentOS 5.5 + EPEL, Condor 7.5.4).\n\n<p>I'm working on a personal build of Condor for our site based on Redhat's 7.4.2 SRPM, but it would be nicer if it was fixed upstream.\n\n</p><p></p><hr/>\n<em>2010-Dec-01 14:39:02 by tstclair:</em> <br/>\n\nA possible solution which may work, would be to dynamically bind to libvirt.so versus static binding the .a.  Runtime detection of signature matches could be clean and fail gracefully when needed.\n\n<p></p><hr/>\n<em>2010-Dec-06 15:31:15 by bbockelm:</em> <br/>\n\nWhen compiling with cmake and enabling a \"proper\" build, it correctly links in libvirt instead of static compilation.\n\n<p></p><hr/>\n<em>2010-Dec-16 08:37:13 by tstclair:</em> <br/>\n\nA much cleaner and simpler solution, is to install native in nmi and only go non-proper if not found.\n\n<p></p><hr/>\n<em>2010-Dec-16 14:44:19 by tstclair:</em> <br/>\n\nSo after much brooding and conversations, the afore mentioned comment + the following should be a good long term strategy for vm:u\n\n<p>1.) Move all libvirt deps to a separate vmgahp2 w/cleanup (7.6)\n\n</p><p>2.) Create a plugin factory which loads elements of base &lt;hypervisor&gt; for vmgahp to allow users to easily add new ones, and disable if not needed. (7.7)\n\n</p><p></p><hr/>\n<em>2011-Jan-07 11:38:08 by tstclair:</em> <br/>\n\nWill use local system version if found.  Otherwise will fall-back to non-proper builds.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jan-19 10:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/33313261b676715e91e90bf516a3eee1aa79c452\">[20017]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1021\" onclick=\"get_ticket_and_populate_wrapper('1021'); return false;\" title=\"libvirt version mismatch from distro (x,y,z)\">#1021</a></span>: Update to produce 2 binaries one with dynamic libvirt support and one w/o libvirt deps (Temporary).  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jan-07 14:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d955609daf0a888f42b2e899eb437dc2cfffde0c\">[19884]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1021\" onclick=\"get_ticket_and_populate_wrapper('1021'); return false;\" title=\"libvirt version mismatch from distro (x,y,z)\">#1021</a></span>: libxml2 still needed as dep for other externals, always build.  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Jan-07 11:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/900c683bbb10311b8ec6ad8d660d48da0b7ac1e8\">[19882]</a></span>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1021\" onclick=\"get_ticket_and_populate_wrapper('1021'); return false;\" title=\"libvirt version mismatch from distro (x,y,z)\">#1021</a></span>: Always perfer system version of libvirt and fallback only if not available.  (By Timothy St. Clair )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2011-Jan-07 11:38", "status": "resolved", "created": "2009-Dec-04 15:10", "fixed_version": "2009-Dec-04 15:10", "broken_version": "v070400", "priority": "2", "subsystem": "Daemons", "assigned_to": "tstclair", "derived_from": "#1135", "creator": "tstclair", "rust": "", "customer_group": "users", "visibility": "public", "notify": "matt@cs.wisc.edu, tstclair@redhat.com", "due_date": ""}