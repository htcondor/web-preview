{"id": 750, "title": "Ticket #750: DeferralTime jobs should only list as \"R\"unning when actually running", "description": "<blockquote>\n(Based on a report by Scot Kronenfeld for the VDT.)\n\n<p>If I have a job with deferred execution time, it always shows up as running, even when it's in between runs.  For example, I run the following script with these attributes in the submission file:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">DeferralPrepTime        = 180\nDeferralTime    = (CurrentTime + 300 + random(30))\nDeferralWindow  = 99999999\nNotification    = never\nOnExitRemove    = false\nPeriodicRelease = (HoldReasonCode =!= 1) &amp;&amp; ((CurrentTime -\nEnteredCurrentStatus) &gt; 60)\nUniverse        = local\n</pre></div>\n\n\n<p>When I run condor_q, I see that it is in the 'R\" state.  But I can check my process table and see that it is not currently executing.  It never leaves the 'R' state that I've seen.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">-- Submitter: vdt-rhas4-ia32.cs.wisc.edu : &lt;192.168.0.204:32999&gt; :\nvdt-rhas4-ia32.cs.wisc.edu\n ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD\n  13.0   vdttest         9/15 14:44   0+00:00:11 R  0   0.0  gratia-script-cons\n</pre></div>\n\n\n<p>We shouldn't force people to look at the process table to tell if a job is currently running.\n\n</p><p>Note: When I run a job with the cron* attributes instead of the deferral* attributes, jobs do get listed as idle when they are not running.\n\n</p><p></p><hr/>\nProposed behavior, by Alan De Smet:\n\n<p>Good: If the job is actually running, list it as Running.  If no resources (that is, a starter) are allocated, list the job as Idle.  If the starter is running in the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DeferralPrepTime\" title=\"Deferral Prep Time\">DeferralPrepTime</a></span> but waiting for the exact <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DeferralTime\" title=\"Deferral Time\">DeferralTime</a></span>, the job can be listed as Idle or Running.  (If you list it as Idle a user might not realize that he is using a startd slot.  If you list it as running, the user might wonder why it isn't actually doing anything.)\n\n</p><p>Better: As above, but during the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DeferralPrepTime\" title=\"Deferral Prep Time\">DeferralPrepTime</a></span> window put the job into some other state, probably a new one.  Perhaps \"P\"reparing?</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Sep-22 11:35:57 by adesmet:</em> <br/>\n\nRelated madness: jobs in the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DeferralPrepTime\" title=\"Deferral Prep Time\">DeferralPrepTime</a></span> window look report the following, which isn't helpful:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">% condor_q -run\n\n\n-- Submitter: puffin.cs.wisc.edu : &lt;128.105.185.14:47137&gt; : puffin.cs.wisc.edu\n ID      OWNER            SUBMITTED     RUN_TIME HOST(S)\n  88.0   adesmet         9/22 11:32   0+00:02:31 [????????????????]\n</pre></div>\n\n<hr/>\n<em>2010-Oct-20 15:59:08 by jfrey:</em> <br/>\n\nBulk change of target version from v070504 to v070505 using ./ticket-target-mover.\n<hr/>\n<em>2011-Jan-27 14:46:04 by danb:</em> <br/>\n\nBulk change of target version from v070505 to v070506 using ./ticket-target-mover.\n<hr/>\n<em>2011-Feb-01 14:49:30 by tannenba:</em> <br/>\n\nBulk change of target version from v070506 to NULL using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "enhance", "last_change": "2013-Jan-22 09:35", "status": "new", "created": "2009-Sep-22 11:27", "fixed_version": "2009-Sep-22 11:27", "broken_version": "", "priority": "5", "subsystem": "Daemons", "assigned_to": "gthain", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}