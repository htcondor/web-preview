{"id": 7785, "title": "Ticket #7785: Failure to spawn local universe job crashes the schedd", "description": "<blockquote>\nLIGO and others report that the schedd is asserting when running many local universe jobs.  For some reason, the schedd is unable to register a local universe job with the procd, with the procd complaining that this pid already exists.  I haven't been able to reproduce that problem, but when that happens, the schedd marks the local universe job as idle and tries again.  However, at that point, the srec for the failed local universe job hasn't been completely removed from the schedd's tables, and when the schedd goes to start the now-idle local universe job a second time, it finds the srec in the table of srec's by job id, and asserts.  We'll fix this immediate problem, and keep an eye on the procd problem.</blockquote>", "remarks": "<blockquote>\n<em>2020-Aug-05 15:51:51 by anderson:</em> <br/>\n\n\"procd complaining that this pid already exists\" sounds pretty scary. Is it worth adding some additional debugging information to help track this down if it occurs again (albeit now with a schedd restart)?\n\n<p></p><hr/>\n<em>2020-Aug-11 10:10:58 by pfc:</em> <br/>\n\nFrom LIGO's perspective, this is a priority=2, but it may be 1 for Condor internally.\n\n<p></p><hr/>\n<em>2020-Oct-12 16:59:35 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> change looks good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Oct-13 15:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3daad8d491526870a22662436474485672d3f417\">[61486]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7785\" onclick=\"get_ticket_and_populate_wrapper('7785'); return false;\" title=\"Failure to spawn local universe job crashes the schedd\">#7785</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Aug-05 15:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/82a841ef05f35abdc88ea1ac480347ac98a5af75\">[60382]</a></span>: Prevent assertion failure in schedd when local uni jobs can't start <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7785\" onclick=\"get_ticket_and_populate_wrapper('7785'); return false;\" title=\"Failure to spawn local universe job crashes the schedd\">#7785</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Oct-13 15:09", "status": "resolved", "created": "2020-Aug-05 14:51", "fixed_version": "2020-Aug-05 14:51", "broken_version": "v080800", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "ligo", "visibility": "public", "notify": "", "due_date": ""}