{"id": 5007, "title": "Ticket #5007: Condor-C double-counts runtime when job restarts", "description": "<blockquote>\nIf a Condor-C job is evicted and restarted quickly, such that the gridmanager doesn't see the job in idle status, then condor_q will double-count the runtime of the job's first execution in its report of total job runtime.\n\n<p>This is because when the job is evicted, the remote schedd adds the runtime of the first execution to <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RemoteWallClockTime\" title=\"Remote Wall Clock Time\">RemoteWallClockTime</a></span>, and when the job is restarted, <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowBday\" title=\"Shadow Bday\">ShadowBday</a></span> is set to the start time of the second execution.\nThe gridmanager doesn't notice that the job restarted. It copies the new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RemoteWallClockTime\" title=\"Remote Wall Clock Time\">RemoteWallClockTime</a></span> value into the local job ad, but keeps the old <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowBday\" title=\"Shadow Bday\">ShadowBday</a></span>. Then, condor_q adds the time since the old <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowBday\" title=\"Shadow Bday\">ShadowBday</a></span> to the new <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RemoteWallClockTime\" title=\"Remote Wall Clock Time\">RemoteWallClockTime</a></span>.\n\n</p><p>This was observed by Argo Graphics, Inc.\n\n</p><p>The gridmanager should always use the remote schedd's <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowBday\" title=\"Shadow Bday\">ShadowBday</a></span> value, along with the other job execution stats.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Apr-30 16:39:58 by jfrey:</em> <br/>\n\nThis problem also occurs if the remote schedd restarts.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-01 13:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44926\">[44926]</a></span>: minor 8.2.9 version history item edit <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=329\" onclick=\"get_ticket_and_populate_wrapper('329'); return false;\" title=\"Condor-C over-reports RemoteWallClockTime\">#329</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5007\" onclick=\"get_ticket_and_populate_wrapper('5007'); return false;\" title=\"Condor-C double-counts runtime when job restarts\">#5007</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-30 16:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44772\">[44772]</a></span>: Docs for Condor-C runtime double-count bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=329\" onclick=\"get_ticket_and_populate_wrapper('329'); return false;\" title=\"Condor-C over-reports RemoteWallClockTime\">#329</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5007\" onclick=\"get_ticket_and_populate_wrapper('5007'); return false;\" title=\"Condor-C double-counts runtime when job restarts\">#5007</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-30 16:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=44771\">[44771]</a></span>: Don't double count the runtime of Condor-C jobs. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=329\" onclick=\"get_ticket_and_populate_wrapper('329'); return false;\" title=\"Condor-C over-reports RemoteWallClockTime\">#329</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5007\" onclick=\"get_ticket_and_populate_wrapper('5007'); return false;\" title=\"Condor-C double-counts runtime when job restarts\">#5007</a></span> Instead, take all runtime attributes (including <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ShadowBday\" title=\"Shadow Bday\">ShadowBday</a></span>) from the remote schedd and don't modify them in the gridmanager.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Jun-02 16:08", "status": "resolved", "created": "2015-Apr-16 11:57", "fixed_version": "2015-Apr-16 11:57", "broken_version": "v080000", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "#329", "creator": "jfrey", "rust": "s8540", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}