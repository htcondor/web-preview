{"id": 3429, "title": "Ticket #3429: Improve blahp querying of Condor job status", "description": "<blockquote>\nThe blahp's querying of Condor for a job's status can take much longer than necessary. We have seen this result in the blahp timing out and returning failure to the gridmanager.\n\n<p>The blahp attempts to reduce the number of times condor_q is called by caching the output for subsequent status queries. If the cached condor_q output doesn't include the desired job, then the blahp calls condor_history. If condor_history doesn't turn up the job, the blahp calls condor_q for the one job, in case the cached condor_q output is too stale.\n\n</p><p>If Condor's history file is fairly large, the condor_history command can take a long time. We can reduce this time by using the -match option to tell condor_history to exit once it finds one matching job.\n\n</p><p>In the Condor build of the blahp, the caching of condor_q output doesn't work properly. Thus, all job status queries end up calling condor_history. If the job is still in the queue, then the -match option of condor_history won't reduce the runtime of the command. We can solve this by calling condor_q explicitly before condor_history (duplicating the call made after condor_history).\n\n</p><p>In a future release, we should try to fix the condor_q caching code, at which point we could remove the added call to condor_q.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Feb-01 10:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/074f39e6f0dee88889848fa6e70601709c8de8a3\">[34815]</a></span>: Version history for blahp querying Condor timeout bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3429\" onclick=\"get_ticket_and_populate_wrapper('3429'); return false;\" title=\"Improve blahp querying of Condor job status\">#3429</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Jan-10 11:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a7dca09ed164a11db237f1bd7e9453cd0c49934f\">[34576]</a></span>: Improve blahp querying of Condor job status <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3429\" onclick=\"get_ticket_and_populate_wrapper('3429'); return false;\" title=\"Improve blahp querying of Condor job status\">#3429</a></span> If Condor's history file is large, then the blahp can timeout trying to query the status of a Condor job. We make two changes to address this: 1) Always call condor_q before condor_history, in case the caching of condor_q output isn't working. 2) Use\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2013-Feb-01 10:13", "status": "resolved", "created": "2013-Jan-10 10:29", "fixed_version": "2013-Jan-10 10:29", "broken_version": "v070800", "priority": "4", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "", "due_date": ""}