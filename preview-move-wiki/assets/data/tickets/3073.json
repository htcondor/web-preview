{"id": 3073, "title": "Ticket #3073: RFE: chirp in local universe", "description": "<blockquote>\n+WantIOProxy (chirp) is not available for jobs running in the local universe.\n\n<p>chirp provides both remote file IO and job ad attribute operations.\n\n</p><p>The attribute operations are important in this situation. Remote file IO in local universe is less important (job is not remote).\n\n</p><p>FYI, local universe has the schedd running a starter directly, there is no shadow in play.\n\n</p><p>FYI, chirp fails with: Can't open /var/lib/condor/spool/local_univ_execute/dir_5021/chirp.config file\ncannot chirp_connect to shadow</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2012-Oct-22 14:59:14 by zmiller:</em> <br/>\n\nBulk change of target version from v070901 to v070902 using ./ticket-target-mover.\n<hr/>\n<em>2012-Dec-11 16:38:39 by johnkn:</em> <br/>\n\nBulk change of target version from v070902 to v070903 using ./ticket-target-mover.\n<hr/>\n<em>2013-Jan-22 10:54:51 by johnkn:</em> <br/>\n\nBulk change of target version from v070903 to v070904 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2013-Jan-29 16:15:02 by jrt:</em> <br/>\n\nLooking at the chirp-&gt;starter(ioproxy-&gt;qmgr_job_updater)-&gt;schedd path.\n<hr/>\n<em>2013-Mar-05 10:58:27 by johnkn:</em> <br/>\n\nBulk change of target version from v070904 to v070905 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2013-Mar-18 14:48:41 by jrt:</em> <br/>\n\nAttached a patch to add chirp to local U. All vanilla functionality exists including I/O. Flow is chirp-&gt;local_io_proxy_handler-&gt;jobupdater for attr related. I/O is handled in the new local_io_proxy_handler object much like it is in NTReceivers/pseudo_ops in vanilla chirp.\n\n<p>On a side note, there are two bugs in chirp not related to this: 1) 3542 and 2) write has a bug on the condor_chirp side where swrite isn't even being used and there is no way to perform some types of simple writes.\n\n</p><p></p><hr/>\n<em>2013-May-07 18:15:51 by eje:</em> <br/>\n\nI'm concerned about the massive parallel code paths IOProxyHandler::handle_standard_request() and LocalIOProxyHandler::handle_standard_request().  That will double the dev/testing effort for any future changes to chirp commands, and just as likely become a bug factory when they drift out of sync.\n\n<p>It would be worth some effort to figure out how to unify REMOTE_CONDOR_xxx() with xxx(), so we can keep handle_standard_request() unified.\n\n</p><p></p><hr/>\n<em>2013-May-08 08:09:03 by jrt:</em> <br/>\n\nEither you have one large parallel code path where the difference between local and vanilla is clear from the very beginning when the ioproxy object is created or you put if (vanilla).. in 22 functions. I think it's mostly a matter of choice although as I recall there are some visibility issues with putting everything in NTsenders.\n\n<p>I'll take a look to see if moving the code is workable.\n\n</p><p></p><hr/>\n<em>2013-May-22 15:43:20 by bbockelm:</em> <br/>\n\nFWIW - look at <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=3353\" onclick=\"get_ticket_and_populate_wrapper('3353'); return false;\" title=\"custom attributes published by user code in job\">#3353</a></span>, where a lot of this code is migrating around.\n\n<p></p><hr/>\n<em>2013-May-24 13:27:01 by eje:</em> <br/>\n\nREVIEW:\n\n<p>one comment: we are trying to deprecate <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span> in favor of std::string.   Common functions that accepted <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span> should also now support overloading for std::string.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/704/local13.patch\">local13.patch</a>\n52071 bytes added by jrt on 2013-Mar-19 15:49:30 UTC.\n<br/>\nfixed a typo<br/>\n</li><li><a href=\"../files/707/chirp_local_U.odt\">chirp_local_U.odt</a>\n24389 bytes added by jrt on 2013-Mar-20 21:12:41 UTC.\n<br/>\nchirp in local U design doc<br/>\n</li><li><a href=\"../files/740/local-chirpv3.patch\">local-chirpv3.patch</a>\n124979 bytes added by jrt on 2013-May-22 20:14:53 UTC.\n<br/>\nReworked patch. obsoletes 3542 due to having to handle the fd in ioproxyhandler. removed/fixed some whitespace<br/>\n</li><li><a href=\"../files/746/local_chirpv4.patch\">local_chirpv4.patch</a>\n127180 bytes added by jrt on 2013-Jun-06 20:29:43 UTC.\n<br/>\nReplaced <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MyString\" title=\"My String\">MyString</a></span> with std::string<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "", "type": "enhance", "last_change": "2014-May-21 10:45", "status": "review", "created": "2012-Jun-21 08:08", "fixed_version": "2012-Jun-21 08:08", "broken_version": "v070901", "priority": "3", "subsystem": "Daemons", "assigned_to": "gthain", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "other", "visibility": "public", "notify": "matt@cs.wisc.edu,jthomas@redhat.com,tstclair@redhat.com", "due_date": ""}