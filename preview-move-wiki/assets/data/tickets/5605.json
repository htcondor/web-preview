{"id": 5605, "title": "Ticket #5605: Have a default for -batch-name (at least for DAGs)", "description": "<blockquote>\nI guess we could have something like the top-level DAGMan's CondorID be the default, although that would mean that we couldn't implement the default in condor_submit_dag.  Maybe another possibility would be the submit timestamp, or a combination of the username and the submit timestamp?\n\n<p>Hmm -- note that the value would have to survive a condor_hold/condor_release, which we'd have to be careful about.\n\n</p><p>(Probably implement this in conjunction with <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5493\" onclick=\"get_ticket_and_populate_wrapper('5493'); return false;\" title=\"Propagate batch-name to all jobs in a workflow\">#5493</a></span>: Propagate batch-name to all jobs in a workflow.)</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Apr-06 17:16:21 by wenger:</em> <br/>\n\nWorking on this in V8_5-gittrac_5493-branch (in combination with <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5493\" onclick=\"get_ticket_and_populate_wrapper('5493'); return false;\" title=\"Propagate batch-name to all jobs in a workflow\">#5493</a></span>).\n\n<p></p><hr/>\n<em>2016-Apr-08 14:39:42 by wenger:</em> <br/>\n\nLots of nice green on my test build -- so I'm going to change this ticket to the\n review state...\n\n<p></p><hr/>\n<em>2016-Apr-08 15:36:01 by wenger:</em> <br/>\n\nHmm -- Lauren really wants the default to be the DAG file name, rather than the top-level HTCondor ID -- so I'll make that change...\n\n<p></p><hr/>\n<em>2016-Apr-11 16:06:12 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong>: Needs input validation.\n\n<p>See review in <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5493\" onclick=\"get_ticket_and_populate_wrapper('5493'); return false;\" title=\"Propagate batch-name to all jobs in a workflow\">#5493</a></span>.  Filename is technically user-provided input, so the code needs to cleanly handle file with spaces, dashes, commas, quotes, etc. in the filename. (Rare, perhaps, but possible... :)\n\n</p><p></p><hr/>\n<em>2016-Apr-12 16:15:01 by wenger:</em> <br/>\n\nJust had a discussion with Lauren and TJ about whether the default should be DAG file name, top-level Condor ID, or DAG file name concatenated with top-level Condor ID.  Decided to get more input, and let this percolate for a day or two before deciding...\n\n<p></p><hr/>\n<em>2016-Apr-14 15:34:29 by wenger:</em> <br/>\n\nOkay, I've tested this with batch names having various special characters, and it works okay; I've also changed the default after a number of discussions.  So I'm going to send this back to Zach for (hopefully) final approval.\n\n<p></p><hr/>\n<em>2016-Apr-15 11:04:01 by wenger:</em> <br/>\n\nI've gone ahead and merged V8_5-gittrac_5493-branch to master.\n\n<p></p><hr/>\n<em>2016-Apr-22 15:57:51 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong>:  All good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/935/gt5493_dif\">gt5493_dif</a>\n15863 bytes added by wenger on 2016-Apr-07 20:54:24 UTC.\n<br/>\nHere's a diff of the whole branch.<br/>\n</li><li><a href=\"../files/937/gt5493-2_dif\">gt5493-2_dif</a>\n17927 bytes added by wenger on 2016-Apr-10 18:10:13 UTC.\n<br/>\nHere's a complete diff of the branch with today's changes.<br/>\n</li><li><a href=\"../files/938/gt5493-3_dif\">gt5493-3_dif</a>\n19640 bytes added by wenger on 2016-Apr-14 20:28:41 UTC.\n<br/>\nAn updated complete branch diff...<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-14 15:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3e200034b1ed7411be8d19a32a5d9f08973fe254\">[48209]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5605\" onclick=\"get_ticket_and_populate_wrapper('5605'); return false;\" title=\"Have a default for -batch-name (at least for DAGs)\">#5605</a></span>: Changed default DAG batch name to the primary DAG file name + top-level cluster, after discussion with Lauren, TJ, and Zach; DAGMan batch name of ' ' does <strong>not</strong> override batch names specified in lower-level submit files.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-10 13:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a1a1647f90a7c8ab6acfb63197d5cacf2db00084\">[48195]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5605\" onclick=\"get_ticket_and_populate_wrapper('5605'); return false;\" title=\"Have a default for -batch-name (at least for DAGs)\">#5605</a></span>: Changed default DAG batch name to the primary DAG file name, as requested by Lauren.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-07 15:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/a94bd698b4ca37aca0b14f4cd1ffe02f58e30866\">[48184]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5493\" onclick=\"get_ticket_and_populate_wrapper('5493'); return false;\" title=\"Propagate batch-name to all jobs in a workflow\">#5493</a></span> / <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5494\" onclick=\"get_ticket_and_populate_wrapper('5494'); return false;\" title=\"Create a test for -batch-name\">#5494</a></span> / <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5605\" onclick=\"get_ticket_and_populate_wrapper('5605'); return false;\" title=\"Have a default for -batch-name (at least for DAGs)\">#5605</a></span>: Oops -- deleting temporary code left in the test...  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-07 15:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e96a2a6e6c9ae131045b8a70cc51a392bf5776f8\">[48183]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5493\" onclick=\"get_ticket_and_populate_wrapper('5493'); return false;\" title=\"Propagate batch-name to all jobs in a workflow\">#5493</a></span> / <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5494\" onclick=\"get_ticket_and_populate_wrapper('5494'); return false;\" title=\"Create a test for -batch-name\">#5494</a></span> / <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5605\" onclick=\"get_ticket_and_populate_wrapper('5605'); return false;\" title=\"Have a default for -batch-name (at least for DAGs)\">#5605</a></span>: Replaced instances of literal \"<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobBatchName\" title=\"Job Batch Name\">JobBatchName</a></span>\" string with the appropriate #defined constant for safety. Cleaned up temporary code, and added version history items.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Apr-07 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/894fb01648dea5338df1c9cd3d5dcab7266e2d83\">[48181]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5493\" onclick=\"get_ticket_and_populate_wrapper('5493'); return false;\" title=\"Propagate batch-name to all jobs in a workflow\">#5493</a></span> / <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5494\" onclick=\"get_ticket_and_populate_wrapper('5494'); return false;\" title=\"Create a test for -batch-name\">#5494</a></span> / <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=5605\" onclick=\"get_ticket_and_populate_wrapper('5605'); return false;\" title=\"Have a default for -batch-name (at least for DAGs)\">#5605</a></span>: DAGMan now defaults to setting a batch name of the top-level DAGMan's CondorID; batch name is now passed down to all jobs within a workflow (including sub-DAGs); created a test for this. (Note: still needs a little cleanup, and needs documentation.)  (By Kent Wenger )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2016-Apr-22 16:07", "status": "resolved", "created": "2016-Apr-06 14:08", "fixed_version": "2016-Apr-06 14:08", "broken_version": "v080504", "priority": "3", "subsystem": "Dag", "assigned_to": "wenger", "derived_from": "", "creator": "wenger", "rust": "", "customer_group": "other", "visibility": "public", "notify": "wenger@cs.wisc.edu, zmiller@cs.wisc.edu", "due_date": ""}