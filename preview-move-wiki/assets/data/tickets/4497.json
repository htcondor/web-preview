{"id": 4497, "title": "Ticket #4497: Add support for running Docker jobs under HTCondor", "description": "<blockquote>\nThis is the parent ticket for adding Docker support to HTCondor.\n\n<p>See the <a class=\"external\" href=\"http://goo.gl/EEyJGf\">design document on google docs</a>.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Jan-15 16:10:53 by tlmiller:</em> <br/>\n\nDo NOT document for 8.3.3.  We just want to distribute the detection code and see how it works and what shows up.\n\n<p></p><hr/>\n<em>2015-Apr-15 11:43:50 by smoler:</em> <br/>\n\nAll Docker-related documentation commented out for version 8.3.5 with SHA1 422bc2e17c789f7f0a92c2d55c31e22a91a24073.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4498\" onclick=\"get_ticket_and_populate_wrapper('4498'); return false;\" title=\"Add preliminary Docker support to the starter\">#4498</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd preliminary Docker support to the starter</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-10 17:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/97375108ff5008f48234f98ba473b0fe6fd12eb7\">[45025]</a></span>: add complete submit file example and ordered installation instructions for docker universe <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-10 11:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c0201ed0ed55b43425fb12a8d4622ddfddd20ca7\">[45012]</a></span>: documentation of the new docker universe <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-21 08:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e2527d608d13660b5204f7a23367d233ec550b04\">[44687]</a></span>: Allow docker to run if condor is in docker group <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-16 11:09</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/19aed7e776abc7267ca62e9f1af122569513e5f5\">[44643]</a></span>: allow docker universe submit files without executable statement <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span> ===VersionHistory:None=== bug never shipped.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-16 08:19</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7036429f1e8ef0ecfda45168b9465b2432c5bb6b\">[44640]</a></span>: Put docker universe job on hold if OOM killer fires <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-15 13:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1b9108ac48e6f0c89e70f02cb798a80223734936\">[44619]</a></span>: correct the de-documenting of the docker universe <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-25 00:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/04694171adba7b048f0a536a2e7c422692ba9b63\">[43716]</a></span>: Docker universe jobs should user log an execute event <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-24 20:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0a158d479e13e0a34cfbe53ad97fbae815eba925\">[43714]</a></span>: Make sure previous commit compiles on windows. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-24 15:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0a42181e28f808a004f04e32b90a0bfedd42fa4a\">[43701]</a></span>: Add resource limits and run as user to docker universe <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-24 14:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/0b21e091460ad3240dbbfd5d07dd97aef1127853\">[43691]</a></span>: Fix problems running docker universe under a rootly condor <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-12 11:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e72a263df9fb8d6e5df9ac4f0a0278860231041c\">[43568]</a></span>: completion of the first pass of documentation for the docker universe <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-10 16:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/bcb11f2dea05488ea46dc77e7e9c517798b5d673\">[43555]</a></span>: more Docker universe documentation <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-10 12:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4c581147fc600fd17589ab487936ff281e70a88b\">[43554]</a></span>: a bit of doc refactoring to add the right subsection for the docker universe <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-09 17:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c4936c5f4ecfd8e9675ebf3333381c59a5a61a73\">[43548]</a></span>: add mostly placeholders in the manual for docker universe documentation <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-22 16:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/45cf6d55fed08acb173a94b5786e6a9883ab3283\">[42326]</a></span>: for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>, add sudo docker parsing for DockerApi:inspect (it got lost in a merge).  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-22 15:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d3ed8aeefac185f00ce59ef353ecdf94753401ca\">[43214]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Make the docker inspect polling code less awful. Return less-wrong exit codes (Docker gets them wrong, too, so there's only so much we can do.)  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-22 13:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/faffdee74deca7400008b52fc2d1f3243590d094\">[42323]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Remove containerID output parameter from run() to avoid race condition. Check for other race conditions related to process exit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-16 16:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5ebe8c5697630c1c6b721ab038b73fab6d329ac3\">[42271]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) publish environment into docker job, currently this is the same environment that a vanilla job would get.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-16 14:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/14fd4c8e1788743034cde69b2d142144fa4f73b7\">[42269]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Do not ignore <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DockerVersion\" title=\"Docker Version\">DockerVersion</a></span>.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-16 14:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6922f3c8eb86e3acc994fc0c9430e3c501f32c6b\">[42268]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Do not ignore <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=DockerVersion\" title=\"Docker Version\">DockerVersion</a></span>.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-16 11:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/112c65e430ac5dec69dd35f1f4a7fb0f6c4aaf8b\">[42258]</a></span>: standardize on docker_image rather than docker_image_id, FOR <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-16 09:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9b107dc3f42e2d56b0a6dae426f43cb9552033a4\">[42252]</a></span>: add docker universe to submit for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>. also fix build break on windows.  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-15 15:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ea8fd0f40193e17ecbf7becc104f95e857448c82\">[42239]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Clean the code up a bit before the merge to master.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-15 15:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3f230058a123aac428af393b3de62226ac7eb067\">[42238]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Report the Docker version during detection, as well.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-15 14:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ef6bac1418b68fc95d771a9dae831e1306e1f433\">[42237]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Handle stdio to/from the container. Should probably be reimplemented.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jan-15 11:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c0f11ae84f9cd8485e7854e1b53ca7a454226ed4\">[42230]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=4497\" onclick=\"get_ticket_and_populate_wrapper('4497'); return false;\" title=\"Add support for running Docker jobs under HTCondor\">#4497</a></span>) Add detection (advertises <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=HasDocker\" title=\"Has Docker\">HasDocker</a></span>), bug fixes, notes updates.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Jun-14 19:58", "status": "resolved", "created": "2014-Jul-29 16:23", "fixed_version": "2014-Jul-29 16:23", "broken_version": "v080000", "priority": "3", "subsystem": "", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}