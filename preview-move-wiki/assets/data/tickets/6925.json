{"id": 6925, "title": "Ticket #6925: Jobs killed by OOM even when using less RAM than requested", "description": "<blockquote>\nA <a class=\"external\" href=\"https://www-auth.cs.wisc.edu/lists/htcondor-users/2019-February/msg00062.shtml\">user on htcondor-users</a> justifiably was confused when HTCondor held his job with the following hold reason:\n\n<p></p><pre>   \"Job has gone over memory limit of 8192 megabytes. Peak usage: 8007 megabytes.\"\n</pre>\n\n<p>Granted it is pretty close, but it doesn't seem like it should have\nheld the job given that message.\n\n</p><p>The issue is if the OOM killer fires, HTCondor will protect any job using less than 90% of the slot memory from being killed.  This 90% seems rather arbitrary... starting with HTCondor v8.9.1, lets change it so HTCondor will protect any job from being killed that using less memory than provisioned in the slot.\n\n</p><p>Thank you Michael Di Domenico for pointing out the above confusion!</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7367\" onclick=\"get_ticket_and_populate_wrapper('7367'); return false;\" title=\"Jobs not getting OOM killed when out of memory\">#7367</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nJobs not getting OOM killed when out of memory</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Nov-12 15:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6110e94594a0bd8e65bae20163fffacf3a887a92\">[58435]</a></span>: Revert \"Avoid killing jobs using between 90% and 99% of memory limit. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6925\" onclick=\"get_ticket_and_populate_wrapper('6925'); return false;\" title=\"Jobs killed by OOM even when using less RAM than requested\">#6925</a></span>\" <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7367\" onclick=\"get_ticket_and_populate_wrapper('7367'); return false;\" title=\"Jobs not getting OOM killed when out of memory\">#7367</a></span> This reverts commit 4ee91f14c3a654273269a653851610437063153a.  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-21 14:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c779c4469a73b1cd6ec4f9328de4b1ea11efe2ea\">[56228]</a></span>: Documentation for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6925\" onclick=\"get_ticket_and_populate_wrapper('6925'); return false;\" title=\"Jobs killed by OOM even when using less RAM than requested\">#6925</a></span>  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Feb-21 14:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4ee91f14c3a654273269a653851610437063153a\">[56227]</a></span>: Avoid killing jobs using between 90% and 99% of memory limit. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6925\" onclick=\"get_ticket_and_populate_wrapper('6925'); return false;\" title=\"Jobs killed by OOM even when using less RAM than requested\">#6925</a></span> Previous to this commit, the  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2019-Feb-21 14:59", "status": "resolved", "created": "2019-Feb-21 14:29", "fixed_version": "2019-Feb-21 14:29", "broken_version": "", "priority": "3", "subsystem": "DaemonsExecNode", "assigned_to": "tannenba", "derived_from": "#5775", "creator": "tannenba", "rust": "", "customer_group": "users", "visibility": "public", "notify": "", "due_date": ""}