{"id": 1249, "title": "Ticket #1249: CONDOR_VIEW_HOST doesn't support multiple destinations", "description": "<blockquote>\nCONDOR_VIEW_HOST is used to configure one collector to forward ads to another collector.  (Incidentally, only some types of ads are forwarded--just what the view server and negotiator are interested in.  Perhaps this should be generalized, see <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1901\" onclick=\"get_ticket_and_populate_wrapper('1901'); return false;\" title=\"RFE: CONDOR_VIEW_CLASSAD_TYPES\">#1901</a></span>.)\n\n<p>It would be nice to be able to forward to multiple destinations.  One use-case is an HA version of the multi-tier collector described in <span class=\"wiki\"><a href=\"wiki?p=HowToConfigCollectors\" title=\"How To Config Collectors\">HowToConfigCollectors</a></span>.  Another use-case is more flexible aggregation of condor view results from various pools.  Similarly, startd-flocking (e.g. super-pools) could be flexibly implemented by forwarding ads between collectors rather than directly from the startds themselves, since this would cut down quite a bit on the authentication load of the collectors that aggregate large numbers of startds.\n\n</p><p>The same sort of logic to avoid forwarding to one's self should probably be retained for convenience.</p></blockquote>", "remarks": "<blockquote>\n<em>2011-Feb-05 09:58:29 by matt:</em> <br/>\n\nThis change should unify the CONDOR_VIEW_HOST code with the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CollectorList\" title=\"Collector List\">CollectorList</a></span>, create() could take a param allowing for \"CONDOR_VIEW\" to be passed in. Also, the time-slicing code in send_classad_to_sock should enhance DCCollector's sendUpdate.\n\n<p>Also, CM_IP_ADDR is sketchy and should be evaluated as cruft.\n\n</p><p></p><hr/>\n<em>2011-Mar-29 21:52:29 by eje:</em> <br/>\n\nTest configuration for multiple view server entries:\n\n<p></p><div class=\"verbatim\">\n<pre>VIEWSERV01 = $(COLLECTOR)\nVIEWSERV01_ARGS = -f -p 12345 -local-name VIEWSERV01\nVIEWSERV01_ENVIRONMENT = \"_CONDOR_COLLECTOR_LOG=$(LOG)/ViewServerLog01\"\nVIEWSERV01.POOL_HISTORY_DIR = $(LOCAL_DIR)/poolhist01\nVIEWSERV01.KEEP_POOL_HISTORY = TRUE\nVIEWSERV01.CONDOR_VIEW_HOST =\n\nVIEWSERV02 = $(COLLECTOR)\nVIEWSERV02_ARGS = -f -p 24680 -local-name VIEWSERV02\nVIEWSERV02_ENVIRONMENT = \"_CONDOR_COLLECTOR_LOG=$(LOG)/ViewServerLog02\"\nVIEWSERV02.POOL_HISTORY_DIR = $(LOCAL_DIR)/poolhist02\nVIEWSERV02.KEEP_POOL_HISTORY = TRUE\nVIEWSERV02.CONDOR_VIEW_HOST =\n\nCONDOR_VIEW_HOST = localhost.localdomain:12345 localhost.localdomain:24680\n\nDAEMON_LIST = $(DAEMON_LIST) VIEWSERV01 VIEWSERV02\n</pre></div>\n\n\n<p></p><hr/>\n<em>2011-Apr-25 14:25:39 by danb:</em> <br/>\n\nCode Review:\n\n<p>Matt suggested using <code>CollectorList</code>.  Any reason why that did not pan out?  <code>CollectorList</code> contains its own built-in timeslice stuff for temporarily blacklisting destinations that consume unreasonable amounts of time when we attempt to connect to them.  Although I don't think it is a deal-breaker, the proposed patch implements this logic with one timeslice shared between all of the destinations, rather than each of them having their own timeslice.\n\n</p><p>Other than that, I don't spot any problems with this patch, and I am eager to have the feature!\n\n</p><p></p><hr/>\n<em>2011-Aug-04 12:08:37 by smoler:</em> <br/>\n\nDocumentation forgotten.  Defn of <code>CONDOR_VIEW_HOST</code> must be changed, and version history item was needed.  Note that reopened ticket taken by Karen.\n\n<p></p><hr/>\n<em>2011-Aug-09 11:24:12 by matt:</em> <br/>\n\nPlease open a new sub-ticket for documentation changes instead.\n\n<p></p><hr/>\n<em>2011-Aug-10 09:51:16 by smoler:</em> <br/>\n\nNew ticket status of (something like) \"documentation pending\" does not yet exist.\nTherefore, changing this ticket's type to doc.\n\n<p></p><hr/>\n<em>2011-Aug-10 09:56:15 by matt:</em> <br/>\n\nPlease open a new ticket for a doc only change here. I'll put the assignment here back to eje and fix the type and version.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2431\" onclick=\"get_ticket_and_populate_wrapper('2431'); return false;\" title=\"forgotten doc for #1249: multiple dest. for CONDOR_VIEW_HOST\">#2431</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nforgotten doc for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1249\" onclick=\"get_ticket_and_populate_wrapper('1249'); return false;\" title=\"CONDOR_VIEW_HOST doesn't support multiple destinations\">#1249</a></span>: multiple dest. for CONDOR_VIEW_HOST</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/306/gt1249_multi_view_host.patch\">gt1249_multi_view_host.patch</a>\n13999 bytes added by eje on 2011-Mar-30 02:50:23 UTC.\n<br/>\nImplements multiple entries on CONDOR_VIEW_HOST\n<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Sep-08 10:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/97444f9a1c600262e31acb08054f1ef28d949aa4\">[27124]</a></span>: A partial attempt at insufficient documentation of changes to CONDOR_VIEW_SERVER. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1249\" onclick=\"get_ticket_and_populate_wrapper('1249'); return false;\" title=\"CONDOR_VIEW_HOST doesn't support multiple destinations\">#1249</a></span> ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2431\" onclick=\"get_ticket_and_populate_wrapper('2431'); return false;\" title=\"forgotten doc for #1249: multiple dest. for CONDOR_VIEW_HOST\">#2431</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Apr-25 15:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1da6e86385a31337f3d9a2b142f904bd3816aebc\">[21562]</a></span>: Implemented multiple view servers for collector CONDOR_VIEW_HOST - <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=1249\" onclick=\"get_ticket_and_populate_wrapper('1249'); return false;\" title=\"CONDOR_VIEW_HOST doesn't support multiple destinations\">#1249</a></span>  (By Erik Erlandson )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2011-Aug-10 09:56", "status": "resolved", "created": "2010-Feb-24 14:54", "fixed_version": "2010-Feb-24 14:54", "broken_version": "v070000", "priority": "2", "subsystem": "Daemons", "assigned_to": "eje", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "other", "visibility": "public", "notify": "dan@hep.wisc.edu matt@cs.wisc.edu tstclair@redhat.com eje@redhat.com smoler@cs.wisc.edu", "due_date": ""}