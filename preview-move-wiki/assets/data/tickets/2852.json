{"id": 2852, "title": "Ticket #2852: CollectorList::query should pick a random collector vs. first in list.", "description": "<blockquote>\nIn the vain of scalability the CollectorList::query f(n) should pick a collector at random vs. the first in a list.\n\n<p>This should distribute the query load.</p></blockquote>", "remarks": "<blockquote>\n<em>2012-Mar-07 15:26:38 by jfrey:</em> <br/>\n\nMy one concern with this patch is that daemons will no longer avoid collectors that are blacklisted (ones they know were unreachable recently).\n\n<p></p><hr/>\n<em>2012-Mar-07 15:38:05 by tstclair:</em> <br/>\n\nI'm not following your comment, the blacklist code is still in place and should function exactly as it had before.\n\n<p></p><hr/>\n<em>2012-Mar-07 16:17:43 by jfrey:</em> <br/>\n\nThe calls daemon-&gt;blacklistMonitorQueryStarted() and daemon-&gt;blacklistMonitorQueryFinished() are for detecting a bad collector and blacklisting it. The first for-loop in CollectorList::query() is where the avoidance of bad collectors is done. They get shuffled to the end of sorted_collectors. In the original code, this meant they would be consulted last, only if all of the non-blacklisted collectors fail. With your change, blacklisted collectors are just as likely to be picked as non-blacklisted ones.\n\n<p></p><hr/>\n<em>2012-Mar-09 14:18:33 by tstclair:</em> <br/>\n\nupdated per comments.</blockquote>", "derived_tickets": "", "attachments": "<blockquote>\n<ul>\n<li><a href=\"attach_get/536/rand_query.patch\">rand_query.patch</a>\n2872 bytes added by tstclair on 2012-Feb-29 21:40:59 UTC.\n<br/>\nquery in random order. <br/>\n</li></ul>\n</blockquote>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-09 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=30878\">[30878]</a></span>: Update from code review, avoids blacklisted collectors. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2852\" onclick=\"get_ticket_and_populate_wrapper('2852'); return false;\" title=\"CollectorList::query should pick a random collector vs. first in list.\">#2852</a></span>  (By Timothy St. Clair )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-02 14:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=30797\">[30797]</a></span>: Update to CollectorList::query to pick at random vs. in order ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=2852\" onclick=\"get_ticket_and_populate_wrapper('2852'); return false;\" title=\"CollectorList::query should pick a random collector vs. first in list.\">#2852</a></span>  (By Timothy St. Clair )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2012-Sep-26 13:35", "status": "resolved", "created": "2012-Feb-29 14:40", "fixed_version": "2012-Feb-29 14:40", "broken_version": "v070706", "priority": "3", "subsystem": "Daemons", "assigned_to": "tstclair", "derived_from": "", "creator": "tstclair", "rust": "", "customer_group": "users", "visibility": "public", "notify": "tstclair@redhat.com, jfrey@cs.wisc.edu", "due_date": ""}