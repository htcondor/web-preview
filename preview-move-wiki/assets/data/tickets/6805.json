{"id": 6805, "title": "Ticket #6805: Fix cleanup after failed azure instance creation", "description": "<blockquote>\nIf the AZURE_VM_CREATE command fails, it can leave behind some resource related to the instance in the Azure service. For example, we could have a resource group with network, public IP address, and disk resources, but no compute resource. This partial set of resources doesn't show up in AZURE_VM_LIST. Currently, the gridmanager won't attempt cleanup if AZURE_VM_LIST doesn't show anything.\n\n<p>The resources can be cleaned up with AZURE_VM_DELETE, but that command will fail if there's no resource group at all. A failure would cause the gridmanager to put the job on hold.\n\n</p><p>To ensure proper cleanup, we need to do one of the following:\n</p><ul>\n<li>Have AZURE_VM_LIST include partial resource sets with an indication that they are in a failed state.\n</li><li>Have AZURE_VM_DELETE return success if there's no resource group for the given name.\n</li><li>Have the gridmanager recognize a \"no such group\" error from AZURE_VM_DELETE and treat it as a success.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2019-Aug-05 16:32", "status": "new", "created": "2018-Oct-24 16:17", "fixed_version": "2018-Oct-24 16:17", "broken_version": "v080710", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}