{"id": 6226, "title": "Ticket #6226: Use modern security encryption methods (AES supplied by openssl)", "description": "<blockquote>\nCurrent work is being committed to <strong>V8_9-gt6226-zkm-branch</strong>\n\n<p>The <strong>V8_9-gt6226-zkm-branch</strong> will be squash-merged to <strong>V8_9-gt6226-branch</strong> after  cleanup and then that branch will be merged to <strong>master</strong>.\n\n</p><p><span class=\"subsection\"></span></p><h3>Summary </h3>\nThis is the first draft of AES-GCM support in CEDAR. AES-GCM, being an AEAD approach, integrates both encryption and authentication into a single operation and utilizes modern algorithms compared to the existing options (e.g., BLOWFISH + MD5). By leveraging OpenSSL for these operations, we get access to hardware-based acceleration.\n\n<p><span class=\"subsection\"></span></p><h3>Current Activity</h3>\nUpdating the V8_9-gt6226-branch code to use the new wrap()/unwrap() API merged into master from V8_9-crypto-wrap-branch from <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7725\" onclick=\"get_ticket_and_populate_wrapper('7725'); return false;\" title=\"clean up API to wrap / unwrap for encryption\">#7725</a></span>.\n\n<p>Currently, AES crypto \"works\" when doing, for example, a condor_ping command to the SchedD.  But I suspect socket inheritance of AES-enabled sockets is currently broken so you can't currently run an entire condor master/family requiring use of AES.\n\n</p><p><span class=\"subsection\"></span></p><h3>Notes </h3>\n<ul>\n<li>Because the AEAD encryption operations generate a message digest for each encryption call, we can't do an encryption call for each get_bytes (also, calls to get_bytes would no longer be associative). For AES-GCM, we have to switch to encrypting at the message level instead.\n</li><li>I realized the above fact after a first draft of the code, resulting in a bit of a messy commit history. I would suggest squashing the PR.\n</li><li>Most of the difficulty is in selection of the IV. Reuse of IVs is particularly problematic in AES-GCM and we have 12 bytes to work with. Here's the scheme:\n<ul>\n<li>The IV starts off as a 12 byte random number. We need some randomness as non-negotiated sessions (such as the family session) are reused.\n</li><li>The first 4 bytes are reused as a message counter.\n</li><li>For negotiated sessions, the second 4 bytes are reused as a \"connection counter\". The connection counter is incremented for each new TCP connection. For non-negotiated sessions, we thus have at least 8 bytes (2^64)of randomness -- significantly more if the connections are short (e.g., if all connections are elss less than 65,536 messages then we have 2^80). From the birthday paradox, this implies we can safely reuse this billions of times with a fairly low probability of collision (10^-9).\n<ul>\n<li>We can't have the \"connection counter\" for non-negotiated sessions because those sessions are reused across multiple daemons - there's no way to have a linear counter.\n</li><li>This also assumes a negotiated session is not shared with multiple entities. This assumption probably needs to be more battle tested.\n</li></ul>\n</li></ul>\n</li><li>The decryption and encryption side must agree on the connection counter and the message counter values for decryption to succeed. This prevents all replay attacks for negotiated sessions and replay attacks in the middle of a connection for non-negotiated sessions.\n</li><li>This is the first encryption algorithm with the longer keylength (256 bits). This is fine except for negotiated sessions as those are currently fixed-size at 128 bits. Right now, we just repeat the key twice (meaning non-negotiate sessions are really 128-bit security).\n</li></ul>\n\n<p><span class=\"subsection\"></span></p><h3>To Do</h3>\n<ol>\n<li><strong>[DONE]</strong> The relisock should calculate a message digest for the header handshake and include the digest in the AAD of the first encrypted packet. This ensures the relisock doesn't proceed if the header was tampered with.\n</li><li>The <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SafeSock\" title=\"Safe Sock\">SafeSock</a></span> path is entirely untested and likely doesn't work.\n</li><li><strong>[DONE]</strong> We generate the symmetric key based on the first letter in the encryption algorithm list. We should parse the list and generate a key only if the encryption algorithm is needed (otherwise we'll have to ensure all future algorithm names have unique first letters - e.g., adding AES-GCM-128 wouldn't work).\n</li><li><strong>[DONE]</strong> I suspect the padding and padding byte is actually not necessary. It looks like AEAD is doing some internal management of the blocks.\n</li><li><strong>[DONE]</strong> When generating a non-negotiated session we should either always generate a 256-bit key or generate a longer key if AES-GCM is being considered.\n</li><li>Move the V8_9-gt6226-branch code to use the new wrap()/unwrap() API merged into master from V8_9-crypto-wrap-branch from <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7725\" onclick=\"get_ticket_and_populate_wrapper('7725'); return false;\" title=\"clean up API to wrap / unwrap for encryption\">#7725</a></span>\n</li><li>Merge V8_9-gt6226-branch into master</li></ol>\n</blockquote>", "remarks": "<blockquote>\n<em>2020-Dec-29 09:57:57 by zmiller:</em> <br/>\n\nDue date pushed back by discovery of issues and handling tickets <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7893\" onclick=\"get_ticket_and_populate_wrapper('7893'); return false;\" title=\"improve attribute validation before 9.0.0 (part 1)\">#7893</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7894\" onclick=\"get_ticket_and_populate_wrapper('7894'); return false;\" title=\"improve attribute validation before 9.0.0 (part 2)\">#7894</a></span>.\n\n<p></p><hr/>\n<em>2021-Jan-11 11:46:50 by zmiller:</em> <br/>\n\nDate delayed due to one missed day of work and discovery of some bugs.  Now compiles and works in single tool-to-daemon session.  Current issue: Socket inheritance needs to preserve IV state.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-11 21:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62193\">[62193]</a></span>: AES-GCM: Do not reset header when we talk to the shared port <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> We typically have to reset the message digest for headers when shared port is in use (since the shared port daemon consumes the first CEDAR message and then hands the socket to the 'real' daemon).\u00a0[...]\n (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-11 09:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62185\">[62185]</a></span>: only look at and register the key if it actually exists. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-10 22:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62176\">[62176]</a></span>: To send UDP when AES is primary mode of crypto, fall back to BLOWFISH if allowed. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> Create a BLOWFISH key in addition to an AES key (if BLOWFISH is a possible protocol)\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-10 12:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62161\">[62161]</a></span>: Fix coverity-found errors in aes branch <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-10 12:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62160\">[62160]</a></span>: Fix coverity-found memory leak <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 21:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62154\">[62154]</a></span>: Clean up EVP_CIPHER_CTX deleter. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 20:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62152\">[62152]</a></span>: Fully initialize, remove dead code, clean up debug messages. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 19:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62151\">[62151]</a></span>: Create a custom deleter for an EVP_CIPHER_CTX. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 19:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62150\">[62150]</a></span>: Use a unique_ptr to manage the EVP_CIPHER_CONTEXT. Should use proper deleter (EVP_CIPHER_CTX_free). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 15:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62143\">[62143]</a></span>: remove extra * in serialized info <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 14:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62141\">[62141]</a></span>: serialize state in m_final_mds <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-09 10:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62140\">[62140]</a></span>: Only lookup crypto method if the key exists and is set. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 17:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62137\">[62137]</a></span>: Make debug less noisy. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 17:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62136\">[62136]</a></span>: Rename \"AESGCM\" to just \"AES\" (as visible to the admin/user). <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 17:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62128\">[62128]</a></span>: reserve() doesn't necessarily make any elements valid, use resize() instead with zero fill. Windows was complaining. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 16:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62127\">[62127]</a></span>: AES-GCM: Fixup a small misleading debug message. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 16:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62126\">[62126]</a></span>: AES-GCM: For AES-GCM non-negotiated sessions, generate key. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> This uses the new HKDF function in Condor_Crypt to generate an appropriately-sized key.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 16:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62125\">[62125]</a></span>: AES-GCM: Expose HKDF as part of Condor_Crypt. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> HKDF is a useful, real key generation function for keys of arbitrary length. Let's utilize the existing implementation in OpenSSL instead of coming up with our own function.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 15:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62123\">[62123]</a></span>: Massive cleanup of dead code, comments, dprintfs prepping for merge. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 14:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62121\">[62121]</a></span>: AES-GCM: Avoid using the `.` character in exported session. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> It turns out that `,` is a reserved character in a Claim ID (since we use `StringList` to split lists of claim IDs, we use `.` instead.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 12:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62118\">[62118]</a></span>: Remove connection counter code, clean up IV union. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-08 11:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62114\">[62114]</a></span>: AES-GCM: Re-enable digest of unencrypted handshake. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-07 14:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62110\">[62110]</a></span>: AES-GCM: Fixup logic for auto-enable encryption. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> Do not auto-enable encryption when there was no authentication method.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-07 14:13</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62109\">[62109]</a></span>: AES-GCM: Always reset crypto state at the EOM. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> This fixes a subtle bug with mixed-encryption messages. Previously, the crypto state was reset for each message; the AES-GCM branch incorrectly changed this to only reset the crypto state for messages that had encryption enabled at EOM.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-07 12:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62107\">[62107]</a></span>: AES-GCM: Have session ads reflect reality. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> When AES-GCM is used, it does integrity checking and always encrypts. Make sure this is reflected in the internal session ads, what's sent on the wire back to the client, and the output of condor_ping.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-05 21:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62101\">[62101]</a></span>: Add a few debug messages. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-05 10:24</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62068\">[62068]</a></span>: Fix build to work with libressl. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-04 23:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62060\">[62060]</a></span>: Updates to only send/receive the IV on initial message and re-enable message counting so IV is unique each time. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Feb-04 22:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62059\">[62059]</a></span>: Fix IV size. D'oh! <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-31 19:21</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62036\">[62036]</a></span>: More build fixes <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-31 18:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62035\">[62035]</a></span>: Switch on openssl version for changed API between 1.0 and 1.1. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-31 18:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62034\">[62034]</a></span>: Fix a warning <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-28 21:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62030\">[62030]</a></span>: refactor so no stream-specific info lives the session. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch) all aes-related stream/connection info has been moved to the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorCryptoState\" title=\"Condor Crypto State\">CondorCryptoState</a></span> object under a member called m_stream_crypto_state, of type <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=StreamCryptoState\" title=\"Stream Crypto State\">StreamCryptoState</a></span>.\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-28 20:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62029\">[62029]</a></span>: this must be symmetric for AESGCM but just fixing for posterity. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-28 17:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62027\">[62027]</a></span>: Make IV 16 bytes instead of 12. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-28 16:36</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=62026\">[62026]</a></span>: include &lt;algorithm&gt; for std::min and std::max <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-26 19:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61992\">[61992]</a></span>: ALWAYS send IV. this appears to work just fine. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-23 23:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61981\">[61981]</a></span>: Several fixes for AES <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch) clean up inconsistency in deciding if this is the first message in this connection (and hence should include an IV)\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-19 15:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61959\">[61959]</a></span>: Don't decrypt negative lengths <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> V8_9-gt6226-zkm-branch  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-19 14:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61958\">[61958]</a></span>: reset AES properly, EXCEPT when inherited. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-19 07:04</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61957\">[61957]</a></span>: FOR DEBUGGING: <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch) Disable message counting, Previous MAC authentition Add comments More debug messages  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-18 21:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61956\">[61956]</a></span>: Add one explicet <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ConnCryptoState\" title=\"Conn Crypto State\">ConnCryptoState</a></span> creation and more debug <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-18 18:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61955\">[61955]</a></span>: Debug msgs <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-18 18:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61954\">[61954]</a></span>: Debug msgs <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-15 23:10</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61952\">[61952]</a></span>: fix unsigned char which was serializing 'FF' instead of actual value. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (on V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-15 22:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61951\">[61951]</a></span>: Did a bit more debug message cleanup <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (on V8_9-gt6226-zkm-branch)  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-15 22:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61950\">[61950]</a></span>: continue work on <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (on V8_9-gt6226-zkm-branch) useful changes: added serialization/deserialization for socket inhertiance of attributes in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ReliSock\" title=\"Reli Sock\">ReliSock</a></span> for AAD content\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-15 01:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61949\">[61949]</a></span>: More work on <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> (in the V8_9-gt6226-zkm-branch branch) Useful changes: Added code for serializing <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ConnCryptoState\" title=\"Conn Crypto State\">ConnCryptoState</a></span> object during socket inheritance\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2021-Jan-08 19:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61914\">[61914]</a></span>: Progress on commits for <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> made into V8_9-gt6226-zkm-branch which will eventually be squash-merged into V8_9-gt6226-branch and then to master\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Sep-14 12:14</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=61288\">[61288]</a></span>: Merged <span class=\"chng\"><a href=\"chngview?cn=60503\">[60503]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61152\">[61152]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61153\">[61153]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61182\">[61182]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61183\">[61183]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61188\">[61188]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61190\">[61190]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61196\">[61196]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61197\">[61197]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61199\">[61199]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61205\">[61205]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61209\">[61209]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61218\">[61218]</a></span>, <span class=\"chng\"><a href=\"chngview?cn=61219\">[61219]</a></span>, Merge branch 'master' into V8_9-gt6226-branch and update API. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>\u00a0[...]\n (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-23 17:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60517\">[60517]</a></span>: Update protocol to remove most IVs on the wire. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> Also include the prior tag in the AAD of the next packet.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-23 17:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60516\">[60516]</a></span>: Actually parse the crypto methods available. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-23 07:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60515\">[60515]</a></span>: Remove unnecessary padding. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-23 00:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60514\">[60514]</a></span>: Add message digest for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ReliSock\" title=\"Reli Sock\">ReliSock</a></span> handshake. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> This causes the AAD to include a message digest of the data sent and received during the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ReliSock\" title=\"Reli Sock\">ReliSock</a></span> handshake (everyting up until the encryption is enabled). This prevents tampering with the crypto handshake -- both sides must agree on what they saw pass\u00a0[...]\n (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-20 10:34</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60507\">[60507]</a></span>: Functioning version of put_bytes encryption. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span> This is a WIP commit as I plan to soon switch to encrypting the packet instead.  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-19 22:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60506\">[60506]</a></span>: Add forgotten header. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-19 22:48</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60505\">[60505]</a></span>: Add implementation files. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-19 22:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"chngview?cn=60504\">[60504]</a></span>: First attempt at adding an AEAD mode. <span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=6226\" onclick=\"get_ticket_and_populate_wrapper('6226'); return false;\" title=\"Use modern security encryption methods (AES supplied by openssl)\">#6226</a></span>  (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2021-May-11 16:44", "status": "resolved", "created": "2017-Apr-13 15:49", "fixed_version": "2017-Apr-13 15:49", "broken_version": "v080700", "priority": "1", "subsystem": "Security", "assigned_to": "zmiller", "derived_from": "#7850", "creator": "zmiller", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "zmiller@cs.wisc.edu, tannenba@cs.wisc.edu, BBockelman@morgridge.org", "due_date": "20210112"}