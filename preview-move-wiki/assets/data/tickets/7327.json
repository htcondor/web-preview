{"id": 7327, "title": "Ticket #7327: transfer_output_remaps doesn't remap implicitly-listed files", "description": "<blockquote>\n<div class=\"file\">\n<pre class=\"filelabel\">test.submit</pre>\n<pre class=\"file\">universe = vanilla\noutput = s3/output\nerror = s3/error\nlog = s3/log\n\nexecutable = /bin/sleep\narguments = 1\ntransfer_executable = false\n\nshould_transfer_files = always\ntransfer_input_files = ../input\ntransfer_output_files = input\ntransfer_output_remaps = \"input = output\"\n\nqueue\n</pre></div>\n\n\n<p>The preceding submit file copies <code>../input</code> to <code>output</code> on the submit node, but the following submit file does not.\n\n</p><p></p><div class=\"file\">\n<pre class=\"filelabel\">test2.submit</pre>\n<pre class=\"file\">universe = vanilla\noutput = s3/output\nerror = s3/error\nlog = s3/log\n\nexecutable = /bin/sleep\narguments = 1\ntransfer_executable = false\n\nshould_transfer_files = always\ntransfer_input_files = ../input\ntransfer_output_remaps = \"input = output\"\n\nqueue\n</pre></div>\n\n\n<p>In fact, <code>test2.submit</code> doesn't produce any output at all, probably because HTCondor noticed that 'input' was unchanged.  However, while the following copies back the whole sandbox, it does not rename 'input' to 'output':\n\n</p><p></p><div class=\"file\">\n<pre class=\"filelabel\">test3.submit</pre>\n<pre class=\"file\">universe = vanilla\noutput = s3/output\nerror = s3/error\nlog = s3/log\n\nexecutable = /bin/sleep\narguments = 1\ntransfer_executable = false\n\nshould_transfer_files = always\ntransfer_input_files = ../input\ntransfer_output_files = .\ntransfer_output_remaps = \"input = output\"\n\nqueue\n</pre></div>\n\n\n<p>Naming 'input' in <code>transfer_output_files</code> causes both 'input' and 'output' to appear on the submit node:\n\n</p><p></p><div class=\"file\">\n<pre class=\"filelabel\">test4.submit</pre>\n<pre class=\"file\">universe = vanilla\noutput = s3/output\nerror = s3/error\nlog = s3/log\n\nexecutable = /bin/sleep\narguments = 1\ntransfer_executable = false\n\nshould_transfer_files = always\ntransfer_input_files = ../input\ntransfer_output_files = input, .\ntransfer_output_remaps = \"input = output\"\n\nqueue\n</pre></div>\n\n\n<p>This strongly suggests we're either applying the remaps early (before we expand dirnames) or to the wrong list (<code>transfer_output_files</code> rather than the dirname expanded list).\n\n</p><p>The manual says \"Note that this remap function only works with files but not with directories,\" but that seems more like it means remapping directory 'a' to 'b' won't do anything, rather than 'you must explicitly specify all output files you want to remap'.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Apr-30 09:31:58 by zmiller:</em> <br/>\n\nSee also <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7597\" onclick=\"get_ticket_and_populate_wrapper('7597'); return false;\" title=\"Fix docs for file transfer input/output remaps and directory support\">#7597</a></span>\n\n<p>Some of the itmes above imply that code changes might be needed.  Some of this is just outright lies in the documentation.  Linking this ticket to <span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7597\" onclick=\"get_ticket_and_populate_wrapper('7597'); return false;\" title=\"Fix docs for file transfer input/output remaps and directory support\">#7597</a></span> which is all about fixing up docs.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2020-Apr-30 09:31", "status": "new", "created": "2019-Oct-16 15:26", "fixed_version": "2019-Oct-16 15:26", "broken_version": "v080904", "priority": "2", "subsystem": "FileTransfer", "assigned_to": "zmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, zmiller@cs.wisc.edu", "due_date": ""}