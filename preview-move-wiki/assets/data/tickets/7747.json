{"id": 7747, "title": "Ticket #7747: condor_submit_as_dag", "description": "<blockquote>\nThere remain (many?) features available in DAGMan that aren't (yet?) available via <strong>condor_submit</strong>, but it's a pain to convert from the (efficient and easy-to-use) queue in/matching/from statements to the equivalent DAG.\n\n<p>One (short-term?) approach to dealing with this issue is to automate the conversion process.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Jul-21 13:44:25 by tlmiller:</em> <br/>\n\n<ul>\n<li>Consider rewriting <code>condor_submit_as_dag</code> to use the Python bindings, in particular, <code>htcondor.Submit.itemdata()</code>, instead of calling <code>condor_submit</code>.\n</li><li><code>condor_submit_dag</code> will need to set ITEMINDEX, ROW, and STEP, as well.\n</li><li>It would be much better to set PROCESS and PROCID rather than try to parse the submit file well enough to replace all references thereto.  Changes to PROCESS won't take without changes to HTCondor though; TJ has identified why and believes it to be a bug.\n</li></ul>\n\n<p>It's not clear, if we want this to become a real tool, if it should work with older versions of HTCondor; that might be nice, it might be OK if user have to manually switch references to PROCESS to PROCID on older versions.  What version did <code>htcondor.Submit.itemdata()</code> show up in?\n\n</p><p></p><hr/>\n<em>2020-Jul-21 13:45:12 by tlmiller:</em> <br/>\n\nTJ wrote:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">&gt; if you want to do a quick and dirty test, open up submit.cpp find\nvoid init_vars(SubmitHash &amp; hash, int cluster_id, StringList &amp; vars)\n&gt; and comment out this line\nhash.set_live_submit_variable(SUBMIT_KEY_Process, ProcessString);\n</pre></div>\n\n\n<p></p><hr/>\n<em>2020-Sep-28 17:18:51 by tlmiller:</em> <br/>\n\nMoved both open issues to subtickets to close this one for release.\n\n<p></p><hr/>\n<em>2020-Sep-28 17:24:08 by tlmiller:</em> <br/>\n\nNot sure if we want to publicize this tool in its current form, actually.</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7867\" onclick=\"get_ticket_and_populate_wrapper('7867'); return false;\" title=\"condor_submit_as_dag should use Python API\">#7867</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ncondor_submit_as_dag should use Python API</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"new\" href=\"/tickets?ticket=7868\" onclick=\"get_ticket_and_populate_wrapper('7868'); return false;\" title=\"submit utils should not ignore setting $(PROCESS)\">#7868</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nsubmit utils should not ignore setting $(PROCESS)</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Sep-08 15:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/926d3689b0ceeed9edbf52f1dba6dbe3c500d4fd\">[61241]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7747\" onclick=\"get_ticket_and_populate_wrapper('7747'); return false;\" title=\"condor_submit_as_dag\">#7747</a></span>) Handle invalid submit files less badly. Thanks to JessV for finding the issue.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Aug-03 11:38</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fa6f273222834ac30d45853bc67338df211cc9db\">[60321]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/tickets?ticket=7747\" onclick=\"get_ticket_and_populate_wrapper('7747'); return false;\" title=\"condor_submit_as_dag\">#7747</a></span>) Add ITEMINDEX, ROW, and STEP support to condor_submit_as_dag. Remove (probably broken) $(Process)/$(ProcID) support. Until further notice, submit files will have to be manually rewritten to use $(ProcID) instead.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Sep-29 13:45", "status": "resolved", "created": "2020-Jul-21 13:02", "fixed_version": "2020-Jul-21 13:02", "broken_version": "", "priority": "2", "subsystem": "Tools", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu", "due_date": ""}