{"id": 4259, "title": "Ticket #4259: examine \".throttle.io_service_bytes\" instead of \".io_service_bytes\"", "description": "<blockquote>\nI'd like to verify this a bit more, but my understanding of the blkio controller semantics is that \"blkio.io_service_bytes\" counts a subset of \"blkio.throttle.io_service_bytes\", which suggests it would be better to examine the \"throttle\" version.\n\n<p><a class=\"external\" href=\"https://www.kernel.org/doc/Documentation/cgroups/blkio-controller.txt\">https://www.kernel.org/doc/Documentation/cgroups/blkio-controller.txt</a>\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">- blkio.throttle.io_service_bytes\n\t- Number of bytes transferred to/from the disk by the group. These\n\t  are further divided by the type of operation - read or write, sync\n\t  or async. First two fields specify the major and minor number of the\n\t  device, third field specifies the operation type and the fourth field\n\t  specifies the number of bytes.\n\n\t  These numbers should roughly be same as blkio.io_service_bytes as\n\t  updated by CFQ. The difference between two is that\n\t  blkio.io_service_bytes will not be updated if CFQ is not operating\n\t  on request queue.\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Mar-14 14:37:39 by eje:</em> <br/>\n\nI got some additional confirmation of this:\n\n<p></p><div class=\"verbatim\">\n<pre>&lt;eje&gt; ... then anything counted by blkio.io_service_bytes is also counted by the \"throttle\" version ?\n&lt;vgoyal&gt; yes\n&lt;vgoyal&gt; first IO passes through throttling layer and is counted\n&lt;vgoyal&gt; then it passes through CFQ and is counted again\n&lt;vgoyal&gt; so same IO shows up both in blkio.io_service_bytes as well as blkio.throttle.io_service_bytes\n</pre></div>\n\n\n<p>I'm pretty sure I've caught this happening.   \"blkio.io_service_bytes\" unpopulated and non-zero measurements in \"blkio.throttle.io_service_bytes\"\n\n</p><p></p><hr/>\n<em>2014-May-21 14:21:00 by tannenba:</em> <br/>\n\nThis appears to be a bug fix to the cgroup code that went in back in 7.7 or so.  If so, why is it not marked as a defect ticket and merged into v8.0? (instead was marked as enhance and put in v8.1) Also would be nice if the ticket description described the symptom of the bug, i.e. \"When using cgroups, the <code>BlockReadKbytes</code> attribute in the job classad will be incorrect by....\".  For that matter, would be nice if the ticket was titled \"Fix incorrect block read/write values in job classad\" instead of title being an implementation detail.  This is all assuming I understand what is going on here, I am not super familiar with this part of the code...  Thanks.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Mar-14 16:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6afe3a322459e8f94126a5ca3c64b2582f41f08c\">[39626]</a></span>: examine blkio.throttle.io_service_bytes instead of blkio.io_service_bytes <span class=\"ticket\"><a class=\"review\" href=\"/tickets?ticket=4259\" onclick=\"get_ticket_and_populate_wrapper('4259'); return false;\" title='examine \".throttle.io_service_bytes\" instead of \".io_service_bytes\"'>#4259</a></span>  (By Erik Erlandson )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-May-21 14:21", "status": "review", "created": "2014-Mar-14 14:19", "fixed_version": "2014-Mar-14 14:19", "broken_version": "", "priority": "3", "subsystem": "DaemonProcD", "assigned_to": "gthain", "derived_from": "#1831", "creator": "eje", "rust": "", "customer_group": "other", "visibility": "public", "notify": "bbocklem@cse.unl.edu, tstclair@redhat.com, tannenba@cs.wisc.edu, eje@cs.wisc.edu", "due_date": ""}