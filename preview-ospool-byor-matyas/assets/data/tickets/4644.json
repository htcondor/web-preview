{"id": 4644, "title": "Ticket #4644: HISTORY_HELPER_MAX_CONCURRENCY default is actually 10,000", "description": "<blockquote>\nIn the schedd code, the default for HISTORY_HELPER_MAX_CONCURRENCY is 2; but in the param table it's 10,000!!\n\n<p>This bug was discovered when it caused problems as Syracuse was joining OSG, as apparently the OSG Gratia monitoring system was effectively doing a denial of service against the schedd - says Peter at Syracuse:\n\n</p><p></p><div class=\"blockquote\">\n<table width=\"95%\"><tbody><tr><td>\u00a0</td><td>\n  \n   \"We've got a piece of misbehaving OSG infrastructure that's stacking up\ncondor_history commands, and they are causing the schedd to fall behind and\n cause mayhem. Obviously the OSG stuff shouldn't be stacking up condor_history commands, but is there any way to make Condor more robust against this kind of unintentional DOS?\"\n</td></tr></tbody></table></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Oct-10 14:46:09 by tannenba:</em> <br/>\n\nOf course, a workaround is to simply put the following explicitly into condor_config:\n\n<p></p><pre>    HISTORY_HELPER_MAX_CONCURRENCY = 2</pre>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body><blockquote>\n<ul>\n<li><a href=\"../files/847/gt4644_dif\">gt4644_dif</a>\n1635 bytes added by wenger on 2014-Oct-10 15:24:52 UTC.\n<br/>\nHere's the diff of my proposed change...<br/>\n</li></ul>\n</blockquote></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-24 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fac17b37b374b445d9b6339dc4113c3407c5084a\">[41472]</a></span>: Change default for HISTORY_HELPER_MAX_CONCURRENCY from 10k to 2. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4644\" onclick=\"get_ticket_and_populate_wrapper('4644'); return false;\" title=\"HISTORY_HELPER_MAX_CONCURRENCY default is actually 10,000\">#4644</a></span> Committer: Todd L Miller  (By Todd Tannenbaum )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-24 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7af826adf14d1895027a11574a9f44e0a425d061\">[41473]</a></span>: minor doc edits for 2 related tickets: <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4643\" onclick=\"get_ticket_and_populate_wrapper('4643'); return false;\" title=\"knobs to throttle remote condor_history queries never documented\">#4643</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4644\" onclick=\"get_ticket_and_populate_wrapper('4644'); return false;\" title=\"HISTORY_HELPER_MAX_CONCURRENCY default is actually 10,000\">#4644</a></span> Committer: Todd L Miller  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-10 15:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9cf16485628e677bcf344b3c7501f998cc01e5ff\">[41376]</a></span>: minor doc edits for 2 related tickets: <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4643\" onclick=\"get_ticket_and_populate_wrapper('4643'); return false;\" title=\"knobs to throttle remote condor_history queries never documented\">#4643</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4644\" onclick=\"get_ticket_and_populate_wrapper('4644'); return false;\" title=\"HISTORY_HELPER_MAX_CONCURRENCY default is actually 10,000\">#4644</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-10 14:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ad7798d307d2467d449bf84f338a85bba93a7a4a\">[41374]</a></span>: Gittrac <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4644\" onclick=\"get_ticket_and_populate_wrapper('4644'); return false;\" title=\"HISTORY_HELPER_MAX_CONCURRENCY default is actually 10,000\">#4644</a></span>: Fixed the bug and documented the fix in the version history.  (By Kent Wenger )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Oct-10 14:40</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/21fa6c12835cb9d7b265de9b32332c1f09179d97\">[41372]</a></span>: Change default for HISTORY_HELPER_MAX_CONCURRENCY from 10k to 2. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4644\" onclick=\"get_ticket_and_populate_wrapper('4644'); return false;\" title=\"HISTORY_HELPER_MAX_CONCURRENCY default is actually 10,000\">#4644</a></span>  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Oct-10 14:46", "status": "resolved", "created": "2014-Oct-09 16:28", "fixed_version": "2014-Oct-09 16:28", "broken_version": "v080102", "priority": "1", "subsystem": "DaemonsSubmitNode", "assigned_to": "tannenba", "derived_from": "#4643", "creator": "wenger", "rust": "a27392", "customer_group": "osg", "visibility": "public", "notify": "wenger@cs.wisc.edu, tannenba@cs.wisc.edu, pfcouvar@syr.edu", "due_date": ""}