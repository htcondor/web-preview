{"id": 7602, "title": "Ticket #7602: quota incorrectly calculated for jobs that request more than 1 cpu", "description": "<blockquote>\nSeveral users are reporting that the surplus quota code in the negotiator is inappropriately calculating quota, and skipping negotiation for groups too early.\n\n<p>The issue is a bug introduced in HTCondor v8.8.3 that results in quota being incorrectly calculated for jobs that request more than 1 cpu.\n\n</p><p>Specifically due to a classad Lookup Weighted Running and Idle jobs as float</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Apr-26 11:02:56 by tim:</em> <br/>\n\n<strong>CODE REVIEW:</strong> Good patch, I like that it logs when it cannot lookup the values.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-27 09:55</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/b7464f3a219a25cd9e96265993be92254d747c16\">[59506]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7602\" onclick=\"get_ticket_and_populate_wrapper('7602'); return false;\" title=\"quota incorrectly calculated for jobs that request more than 1 cpu\">#7602</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-17 13:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/be9402e89f77e236cbb9097a99151036dab57c54\">[59400]</a></span>: Lookup Weighted Running and Idle jobs as float <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7602\" onclick=\"get_ticket_and_populate_wrapper('7602'); return false;\" title=\"quota incorrectly calculated for jobs that request more than 1 cpu\">#7602</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-17 13:58</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2f82f1916ac4691c12351b2ac018e1e4604ca88d\">[59399]</a></span>: Revert \"Skip early out check when surplus code thinks we're over quota conditionally <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7602\" onclick=\"get_ticket_and_populate_wrapper('7602'); return false;\" title=\"quota incorrectly calculated for jobs that request more than 1 cpu\">#7602</a></span>\" This reverts commit 62ecfc5b648275e0809b60019ab24a35c61baf4d.  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Apr-16 11:15</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/62ecfc5b648275e0809b60019ab24a35c61baf4d\">[59365]</a></span>: Skip early out check when surplus code thinks we're over quota conditionally <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7602\" onclick=\"get_ticket_and_populate_wrapper('7602'); return false;\" title=\"quota incorrectly calculated for jobs that request more than 1 cpu\">#7602</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2020-Jun-26 09:38", "status": "resolved", "created": "2020-Apr-16 11:15", "fixed_version": "2020-Apr-16 11:15", "broken_version": "", "priority": "1", "subsystem": "", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "atlas", "visibility": "public", "notify": "", "due_date": ""}