{"id": 6861, "title": "Ticket #6861: scitokens: oauth client secret should not be stored in condor_config", "description": "<blockquote>\nThe condor_credd needs to know the client_secret for OAuth providers, but this secret should not be defined in the world-readable condor_config. Instead, it should live in a file owned by the same uid that condor is running as. See Line 284 in <a class=\"file\" href=\"rlog?f=src/condor_credd/credd.cpp\">/src/condor_credd/credd.cpp</a> . Instead of &lt;provider&gt;_CLIENT_SECRET, perhaps we should have a config parameter named &lt;provider&gt;_CLIENT_SECRET_FILE.\n\n<p>Can this functionality of securely opening files for config purposes use other code we have (e.g. following pool password) or should we perhaps make some library code for this?</p></blockquote>", "remarks": "<blockquote>\n<em>2019-Jan-16 16:15:01 by jfrey:</em> <br/>\n\nI've pushed the change described in this ticket. The secret consists of all text up to, but not including, the first newline in the secure file. I've tested the new code in a stand-alone test harness, but someone else will need to test it in-place in the credd.\n\n<p></p><hr/>\n<em>2019-Feb-05 10:08:46 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> : looks good.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2019-Jan-16 16:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/16bb4e4849c3ec7ed2273b63f4fae3f3b17265d9\">[56003]</a></span>: Read <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SciTokens\" title=\"Sci Tokens\">SciTokens</a></span> client secret from a secure file. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6861\" onclick=\"get_ticket_and_populate_wrapper('6861'); return false;\" title=\"scitokens: oauth client secret should not be stored in condor_config\">#6861</a></span> Instead of specifying the OAuth client secret with configuration parameter &lt;provider&gt;_CLIENT_SECRET, we now read it from a secure file whose name is given by &lt;provider&gt;_CLIENT_SECRET_FILE.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2019-Feb-05 10:08", "status": "resolved", "created": "2019-Jan-16 11:23", "fixed_version": "2019-Jan-16 11:23", "broken_version": "v080800", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "jfrey", "derived_from": "#6513", "creator": "jpatton", "rust": "", "customer_group": "scitokens", "visibility": "public", "notify": "jpatton@cs.wisc.edu,tannenba@cs.wisc.edu", "due_date": ""}