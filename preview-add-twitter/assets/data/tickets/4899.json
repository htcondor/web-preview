{"id": 4899, "title": "Ticket #4899: Improvments to condor_submit for 8.3 series", "description": "<blockquote>\nUsers very often need to write scripts that invoke condor_submit because they can't express their needs in submit language.  We believe that a few small improvements to the submit language would make 90% of these scripts unnecessary.\n\n<p>The capabilities that are needed are\n\n</p><p></p><ul>\n<li>Queue a proc in the job cluster for each file in a set\n</li><li>Expanding $(Cluster) and $(Process) with a specified field width\n</li><li>Filename manipulation on macro expansion\n</li><li>Allow queue statement to be passed on the command line\n</li></ul>\n\n<p>Of less importance, but it should be easy to add\n\n</p><p></p><ul>\n<li>read file set for above from a file or from stdin\n</li><li>if/else syntax like config files\n</li><li>include/include output syntax like config files\n</li><li>stuffing the submit hashtable from the command line.\n</li></ul>\n\n<p>This ticket will serve as the master ticket for this work.\n</p><div>\n<table border=\"1\" cellpadding=\"2\" cellspacing=\"0\" summary=\"EMBED: Status Table of Derived Tickets\">\n<caption>\n  <a href=\"rptview?rn=86\" rel=\"nofollow\" title=\"EMBED: Status Table of Derived Tickets\">EMBED: Status Table of Derived Tickets</a>\n</caption>\n<tbody><tr>\n<td colspan=\"11\"><form action=\"rptview\" method=\"GET\">\n<input name=\"rn\" type=\"hidden\" value=\"86\"/>\nTN: <input name=\"TN\" type=\"text\" value=\"4899\"/>\n<input type=\"submit\" value=\"Go\"/>\n</form></td></tr> \n<tr>\n<th><a href=\"rptview?rn=86&amp;order_by=2&amp;order_dir=ASC&amp;TN=4899\">Developer</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=3&amp;order_dir=ASC&amp;TN=4899\">#</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=4&amp;order_dir=ASC&amp;TN=4899\">Status</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=5&amp;order_dir=ASC&amp;TN=4899\">Type</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=6&amp;order_dir=ASC&amp;TN=4899\">Pri</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=7&amp;order_dir=ASC&amp;TN=4899\">Created</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=8&amp;order_dir=ASC&amp;TN=4899\">Changed</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=9&amp;order_dir=ASC&amp;TN=4899\">Target</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=10&amp;order_dir=ASC&amp;TN=4899\">Due Date</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=11&amp;order_dir=ASC&amp;TN=4899\">Days left</a></th>\n<th><a href=\"rptview?rn=86&amp;order_by=12&amp;order_dir=ASC&amp;TN=4899\">Title</a></th>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=5159,86\">5159</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n2\n</td>\n<td valign=\"top\">\n2015 Jul\n</td>\n<td valign=\"top\">\n2015 Sep\n</td>\n<td valign=\"top\">\nv080308\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\ncondor_submit should allow an empty file transfer list.\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4981,86\">4981</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\n2015 Jun\n</td>\n<td valign=\"top\">\nv080306\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\nAdd -maxjobs flag to condor_submit\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4819,86\">4819</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Jan\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\nv080305\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\n\"queue\" for multiple files\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4944,86\">4944</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Mar\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\nv080305\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\nNew $macro expansion functions for submit\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4992,86\">4992</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\nv080305\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\ncondor_q -constraint should show summary line.\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4983,86\">4983</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\nv080305\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\ncondor_submit should allow setting of attribs BEFORE submit is parsed\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4933,86\">4933</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Mar\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\nv080305\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\nCondor_submit should allow -queue statement on command line\n</td>\n</tr>\n<tr bgcolor=\"#c8c8c8\">\n<td valign=\"top\">\njohnkn\n</td>\n<td valign=\"top\"><a href=\"tktview?tn=4913,86\">4913</a></td>\n<td valign=\"top\">\nresolved\n</td>\n<td valign=\"top\">\nenhance\n</td>\n<td valign=\"top\">\n3\n</td>\n<td valign=\"top\">\n2015 Feb\n</td>\n<td valign=\"top\">\n2015 Apr\n</td>\n<td valign=\"top\">\nv080305\n</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\u00a0</td>\n<td valign=\"top\">\nsubmit files should support if/else and include like config files\n</td>\n</tr>\n</tbody></table></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2015-Feb-18 15:20:04 by johnkn:</em> <br/>\n\nSome good suggestions from a thread on condor-users\n<a class=\"external\" href=\"https://www-auth.cs.wisc.edu/lists/htcondor-users/2015-February/msg00024.shtml\">https://www-auth.cs.wisc.edu/lists/htcondor-users/2015-February/msg00024.shtml</a>\n\n<p></p><hr/>\n<em>2015-Feb-18 22:29:40 by bbockelm:</em> <br/>\n\nSee also: <a class=\"external\" href=\"https://htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=4819\">https://htcondor-wiki.cs.wisc.edu/index.cgi/tktview?tn=4819</a>\n\n<p></p><hr/>\n<em>2015-Mar-23 11:36:03 by johnkn:</em> <br/>\n\nCompleted improvements that need testing/documentation:\n\n<p></p><ul>\n<li>queue syntax including\n<ul>\n<li>int expression for queue quantity\n</li><li>list of loop variables\n</li><li><strong>in,matching,from</strong> keywords\n</li><li><strong>files</strong> or <strong>dirs</strong> keywords after <strong>matching</strong> keyword\n</li><li><strong>in</strong> with or without <strong>()</strong>, single and multiline modes\n</li><li><strong>from</strong> filename, - meaning stdin, trailing | to treat filename as a script\n</li><li>from <strong>()</strong>, single and multiline modes, use of comment # and continuation \\ with multiline mode.\n</li><li><strong>matching</strong> with and without (), <strong>matching files</strong>, <strong>matching dirs</strong>\n</li><li><strong>[::]</strong> slices\n</li></ul>\n</li><li>-queue command line option, including error for conflicting queue statements\n<ul>\n<li>-queue in *.dat\n</li><li>&lt;cmd&gt; | condor_submit subfile -queue from -\n</li></ul>\n</li><li>warnings for empty globs/fields by default\n</li><li>silent for empty globs/fields if use strict : false\n</li><li>errors for empty globs/fields errors enabled (see use strict)\n</li><li>error return value for empty globs/fields when use strict : true\n</li><li>-dry-run command line option\n</li><li>new $() macro expansion functions including\n<ul>\n<li>$CHOICE\n</li><li>$SUBSTR\n</li><li>$INT and $REAL\n</li><li>$Fpdnxq, $BASENAME, $DIRNAME\n</li></ul>\n</li><li>if/else/include/use syntax (note: cannot refer to loop variables)\n</li><li>use strict : true | false | harsh\n</li><li>if $(IsWindows)|$(IsLinux)</li></ul>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4819\" onclick=\"get_ticket_and_populate_wrapper('4819'); return false;\" title='\"queue\" for multiple files'>#4819</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\n\"queue\" for multiple files</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4913\" onclick=\"get_ticket_and_populate_wrapper('4913'); return false;\" title=\"submit files should support if/else and include like config files\">#4913</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nsubmit files should support if/else and include like config files</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4933\" onclick=\"get_ticket_and_populate_wrapper('4933'); return false;\" title=\"Condor_submit should allow -queue statement on command line\">#4933</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nCondor_submit should allow -queue statement on command line</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4944\" onclick=\"get_ticket_and_populate_wrapper('4944'); return false;\" title=\"New $macro expansion functions for submit\">#4944</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nNew $macro expansion functions for submit</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4981\" onclick=\"get_ticket_and_populate_wrapper('4981'); return false;\" title=\"Add -maxjobs flag to condor_submit\">#4981</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd -maxjobs flag to condor_submit</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"abandoned\" href=\"/wiki-archive/tickets/?ticket=4982\" onclick=\"get_ticket_and_populate_wrapper('4982'); return false;\" title=\"condor_submit should have a command line arg to limit number of jobs\">#4982</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ncondor_submit should have a command line arg to limit number of jobs</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4983\" onclick=\"get_ticket_and_populate_wrapper('4983'); return false;\" title=\"condor_submit should allow setting of attribs BEFORE submit is parsed\">#4983</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ncondor_submit should allow setting of attribs BEFORE submit is parsed</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4992\" onclick=\"get_ticket_and_populate_wrapper('4992'); return false;\" title=\"condor_q -constraint should show summary line.\">#4992</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ncondor_q -constraint should show summary line.</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5159\" onclick=\"get_ticket_and_populate_wrapper('5159'); return false;\" title=\"condor_submit should allow an empty file transfer list.\">#5159</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\ncondor_submit should allow an empty file transfer list.</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-03 14:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c6d636898a059d3468fe0f025ed8dc11d7e75b64\">[44947]</a></span>: documentation and version history for aliases for $(Process) and $(Cluster) <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=4899\" onclick=\"get_ticket_and_populate_wrapper('4899'); return false;\" title=\"Improvments to condor_submit for 8.3 series\">#4899</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-May-19 10:44</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8cdf6e4c3910069decfdb6fe93be9cdb8258192e\">[44868]</a></span>: for <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=4899\" onclick=\"get_ticket_and_populate_wrapper('4899'); return false;\" title=\"Improvments to condor_submit for 8.3 series\">#4899</a></span>, allow $(ClusterId) and $(ProcId) as synonyms for $(Cluster) and $(Process)  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Jun-24 13:37", "status": "new", "created": "2015-Feb-18 15:09", "fixed_version": "2015-Feb-18 15:09", "broken_version": "", "priority": "3", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}