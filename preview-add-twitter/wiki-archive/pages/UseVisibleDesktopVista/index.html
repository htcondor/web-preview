<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="HTCondor Homepage">
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/web-preview/preview-add-twitter/assets/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/web-preview/preview-add-twitter/assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/web-preview/preview-add-twitter/assets/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/web-preview/preview-add-twitter/assets/images/favicons/site.webmanifest">
    <link rel="mask-icon" href="/web-preview/preview-add-twitter/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/web-preview/preview-add-twitter/assets/images/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/web-preview/preview-add-twitter/assets/images/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- Primary Meta Tags -->
    <meta name="title" content="HTCondor">
    <meta name="description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://htcondor.org/">
    <meta property="og:title" content="HTCondor">
    <meta property="og:description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">
    <meta property="og:image" content="https://htcondor.org/assets/images/HTC.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://htcondor.org/">
    <meta property="twitter:title" content="HTCondor">
    <meta property="twitter:description" content="HTCondor is a specialized workload management system for compute-intensive jobs. Built to be flexible, expressive, and compatible with Grid and Cloud computing environments HTCondor made to increase your Computational Throughput.">
    <meta property="twitter:image" content="https://htcondor.org/assets/images/HTC.png">

    <title>Use Visible Desktop Vista</title>

    <script src="/web-preview/preview-add-twitter/assets/js/sitewide.js" type="text/javascript" defer></script>
    <script src="/web-preview/preview-add-twitter/assets/js/bootstrap.js" type="text/javascript"></script>
    

    

    <meta name="robots" content="noindex">

    

    <link href="/web-preview/preview-add-twitter/assets/css/style-v1.css" media="screen, tv, projection" title="Default" rel="stylesheet">
    

</head>
<body class="vh-100 d-flex flex-column">

<!-- For non-visual user agents: -->
<a id="skip-link" href="#main-copy">Skip to main content.</a>

<header id="header">
    <div class="mb-4 container">
        <div class="row">
            <div class="col-12">
                <nav class="navbar navBar navbar-expand-lg navbar-light w-100">
                    <a href="/web-preview/preview-add-twitter/index.html" class="d-none d-md-inline"><img height="75" alt="Condor High Throughput Computing" src="/web-preview/preview-add-twitter/assets/images/CondorTitle.png" style="border:0"></a>
                    <a href="/web-preview/preview-add-twitter/index.html" class="d-inline d-md-none"><img height="65" alt="Condor High Throughput Computing" src="/web-preview/preview-add-twitter/assets/images/HTCondor_red_blk.svg" style="border:0"></a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav mb-2 mb-lg-0 ms-auto mt-auto">
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-add-twitter/">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-add-twitter/new">News</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-add-twitter/downloads">Downloads</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link " href="/web-preview/preview-add-twitter/publications">Publications</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="mailto:htcondor-admin@cs.wisc.edu">Contact Us</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
        <div class="row">
            

<script async src="https://cse.google.com/cse.js?cx=1056a9a876b1d1474"></script>
<div class="gcse-searchbox-only"></div>


        </div>
    </div>
</header>
<main id="main-copy" tabindex="-1">
    <div class="container mb-4">
    <h1>Use Visible Desktop Vista</h1>
<div id="content">
 <span class="section">
  <h2>
   How to run Windows GUI jobs on the visible desktop
  </h2>
 </span>
 <p>
  <strong>
   Note: In Windows 10, build 1703 and later this feature no longer works
  </strong>
  because the "Interactive Services Detection" service was removed in that Windows release.
 </p>
 <p>
  HTCondor is able to run GUI-based applications on the Windows operating system, so long as these applications do not block waiting for keyboard or mouse input (i.e. the GUI application must be able to run as a batch job).  How this works is HTCondor dynamically creates a non-visible desktop for each slot on the execute node, and it will launch the job on this non-visible desktop.  The result is the GUI job runs on the machine without windows popping up on the visible desktop, thus allowing a GUI job to effectively "run in the background" without disturbing the desktop user.
 </p>
 <p>
  However, at times you may want HTCondor to run your GUI job on the visible desktop.  For instance, perhaps you have a GUI job that appears to hang or otherwise fail - what could be happening is the job detected some problem and popped up an error window, but the only way to see this error window is to have the job run on the visible desktop.  To accomplish this, as the system administrator you will need to 1) tell Windows to allow the HTCondor service to access the visible desktop if you are running on Windows Vista or above, and then 2) tell HTCondor to use the visible desktop.
 </p>
 <p>
  The basic steps are
 </p>
 <ol>
  <li>
   Start the
   <code>
    Interactive Services Detection
   </code>
   service
  </li>
  <li>
   Enable
   <em>
    Allow service to interact with desktop
   </em>
   for the condor service
  </li>
  <li>
   set
   <code>
    USE_VISIBLE_DESKTOP=True
   </code>
   in your condor_config and restart the condor service
  </li>
 </ol>
 <p>
  The first two steps are accomplished via the Windows Services Management Console.
 </p>
 <p>
 </p>
 <ul>
  <li>
   Open the Services Management Console:
   <p>
   </p>
   <ol>
    <li>
     Click on the
     <em>
      Start Menu
     </em>
    </li>
    <li>
     Open the
     <strong>
      Control Panel
     </strong>
    </li>
    <li>
     Select
     <em>
      Administrative Tools
     </em>
    </li>
    <li>
     Select
     <em>
      Services
     </em>
    </li>
   </ol>
  </li>
 </ul>
 <p>
  [ note: If the
  <em>
   Services
  </em>
  option is missing, you could also type "start services.msc" from a command prompt ]
 </p>
 <p>
 </p>
 <ul>
  <li>
   Enable interactive services using Services Management Console:
   <p>
   </p>
   <ol>
    <li>
     Find the
     <strong>
      Interactive Services Detection
     </strong>
     service
    </li>
    <li>
     Bring up its properties by double-clicking on it
    </li>
    <li>
     Change the
     <em>
      Startup type
     </em>
     to
     <strong>
      Automatic
     </strong>
    </li>
    <li>
     Click on the
     <em>
      Start
     </em>
     button below the
     <em>
      Service status
     </em>
     label
    </li>
    <li>
     Click
     <em>
      OK
     </em>
    </li>
   </ol>
   <p>
   </p>
  </li>
  <li>
   Make the HTCondor service interactive using Services Management Console:
   <p>
   </p>
   <ol>
    <li>
     Find the
     <strong>
      condor
     </strong>
     service
    </li>
    <li>
     Bring up its properties by double-clicking on it
    </li>
    <li>
     Switch to the
     <em>
      Log On
     </em>
     page
    </li>
    <li>
     Check the
     <em>
      Allow service to interact with desktop
     </em>
     option
    </li>
    <li>
     Click
     <em>
      OK
     </em>
    </li>
   </ol>
   <p>
   </p>
  </li>
  <li>
   Tell HTCondor to use the visible desktop:
   <p>
   </p>
   <ol>
    <li>
     Add
     <code>
      USE_VISIBLE_DESKTOP=True
     </code>
     to your condor_config
    </li>
    <li>
     Restart the HTCondor service via "net stop condor" followed by "net start condor"
    </li>
   </ol>
  </li>
 </ul>
 <p>
  Thanks to Ben Burnett for this information which was copied from his original post on his Wiki -http://ben.versionzero.org/wiki/Condor_Enable_Visible_Desktop_on_Vista
 </p>
</div>

</div>
</main>
<div id="footer" class="border-top mt-auto">
    <div class="container py-4">
        <div class="row">
            <div class="col text-center">
                For comments or questions about this website, please email
                <a href="mailto:htcondor-admin@cs.wisc.edu">htcondor-admin@cs.wisc.edu</a><br />
                This work is supported by <a href="https://www.nsf.gov/div/index.jsp?div=OAC">NSF</a> under Cooperative Agreement <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2030508">OAC-2030508</a> as part of the <a href="https://path-cc.io/">PATh Project</a>. <br />
                <script type="text/javascript">
                    document.write("Updated &raquo; "+lastMod(document.lastModified))
                </script>
            </div>
        </div>
    </div>
</div>



</body>
</html>
