{"id": 4474, "title": "Ticket #4474: Non-windows job reconnect errors", "description": "<blockquote>\nI thought this reconnect failure was only on windows\nbut with the newly rewritten test we are seeing sporadic failures\nwhich are hard to blame on the test. More I have to look at the old test\nwhich should have been failing too.\n\n<p>From the log one can see that some of the jobs stay in the run state\nwhen the schedd restarts, but in the cases where this reconnection\nerror occurs some of the jobs show up in idle state.\n\n</p><p>This is true across the platforms failing.\n\n</p><p>The errors on the reconnect are an automatic failure if a\ncallback for the event is not used to catch the event. Unexpected\nevents have been an automatic failure for about 6 months.\n\n</p><p>I will update this tickets with userlog and daemon logs for these three\nwhich just failed. Ubuntu12(64), debian6(32) and rh5(32)\n\n</p><p>000 (001.000.000) 07/21 12:58:58 Job submitted from host: &lt;128.104.103.110:51688&gt;\n...\n000 (001.001.000) 07/21 12:58:58 Job submitted from host: &lt;128.104.103.110:51688&gt;\n...\n000 (001.002.000) 07/21 12:58:58 Job submitted from host: &lt;128.104.103.110:51688&gt;\n...\n000 (001.003.000) 07/21 12:58:58 Job submitted from host: &lt;128.104.103.110:51688&gt;\n...\n000 (001.004.000) 07/21 12:58:58 Job submitted from host: &lt;128.104.103.110:51688&gt;\n...\n001 (001.003.000) 07/21 12:59:24 Job executing on host: &lt;128.104.103.110:4487&gt;\n...\n001 (001.000.000) 07/21 12:59:24 Job executing on host: &lt;128.104.103.110:4487&gt;\n...\n001 (001.001.000) 07/21 12:59:24 Job executing on host: &lt;128.104.103.110:4487&gt;\n...\n001 (001.002.000) 07/21 12:59:24 Job executing on host: &lt;128.104.103.110:4487&gt;\n...\n001 (001.004.000) 07/21 12:59:24 Job executing on host: &lt;128.104.103.110:4487&gt;\n...\n022 (001.003.000) 07/21 12:59:25 Job disconnected, attempting to reconnect\n    Local schedd and job shadow died, schedd now running again\n    Trying to reconnect to slot4@exec-110.batlab.org &lt;128.104.103.110:4487&gt;\n...\n022 (001.004.000) 07/21 12:59:25 Job disconnected, attempting to reconnect\n    Local schedd and job shadow died, schedd now running again\n    Trying to reconnect to slot5@exec-110.batlab.org &lt;128.104.103.110:4487&gt;\n...\n022 (001.000.000) 07/21 12:59:25 Job disconnected, attempting to reconnect\n    Local schedd and job shadow died, schedd now running again\n    Trying to reconnect to slot1@exec-110.batlab.org &lt;128.104.103.110:4487&gt;\n...\n022 (001.001.000) 07/21 12:59:25 Job disconnected, attempting to reconnect\n    Local schedd and job shadow died, schedd now running again\n    Trying to reconnect to slot2@exec-110.batlab.org &lt;128.104.103.110:4487&gt;\n...\n022 (001.002.000) 07/21 12:59:25 Job disconnected, attempting to reconnect\n    Local schedd and job shadow died, schedd now running again\n    Trying to reconnect to slot3@exec-110.batlab.org &lt;128.104.103.110:4487&gt;\n...\n024 (001.004.000) 07/21 12:59:25 Job reconnection failed\n    Job not found at execution machine\n    Can not reconnect to slot5@exec-110.batlab.org, rescheduling job\n...\n023 (001.003.000) 07/21 12:59:25 Job reconnected to slot4@exec-110.batlab.org\n    startd address: &lt;128.104.103.110:4487&gt;\n    starter address: &lt;128.104.103.110:56784&gt;\n...\n023 (001.000.000) 07/21 12:59:26 Job reconnected to slot1@exec-110.batlab.org\n    startd address: &lt;128.104.103.110:4487&gt;\n    starter address: &lt;128.104.103.110:60163&gt;\n...\n023 (001.001.000) 07/21 12:59:26 Job reconnected to slot2@exec-110.batlab.org\n    startd address: &lt;128.104.103.110:4487&gt;\n    starter address: &lt;128.104.103.110:8987&gt;\n...\n023 (001.002.000) 07/21 12:59:26 Job reconnected to slot3@exec-110.batlab.org\n    startd address: &lt;128.104.103.110:4487&gt;\n    starter address: &lt;128.104.103.110:18267&gt;\n...\n006 (001.000.000) 07/21 12:59:33 Image size of job updated: 17564\n\t2  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MemoryUsage\" title=\"Memory Usage\">MemoryUsage</a></span> of job (MB)\n\t1476  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ResidentSetSize\" title=\"Resident Set Size\">ResidentSetSize</a></span> of job (KB)\n...\n006 (001.001.000) 07/21 12:59:33 Image size of job updated: 17564\n\t2  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MemoryUsage\" title=\"Memory Usage\">MemoryUsage</a></span> of job (MB)\n\t1476  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ResidentSetSize\" title=\"Resident Set Size\">ResidentSetSize</a></span> of job (KB)\n...\n006 (001.002.000) 07/21 12:59:33 Image size of job updated: 17564\n\t2  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MemoryUsage\" title=\"Memory Usage\">MemoryUsage</a></span> of job (MB)\n\t1476  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ResidentSetSize\" title=\"Resident Set Size\">ResidentSetSize</a></span> of job (KB)\n...\n006 (001.003.000) 07/21 12:59:33 Image size of job updated: 98232\n\t2  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=MemoryUsage\" title=\"Memory Usage\">MemoryUsage</a></span> of job (MB)\n\t1472  -  <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ResidentSetSize\" title=\"Resident Set Size\">ResidentSetSize</a></span> of job (KB)\n...\n009 (001.004.000) 07/21 12:59:39 Job was aborted by the user.\n\tvia condor_rm (by user slot3)</p></blockquote>", "remarks": "<blockquote>\nuerlog, test output and daemon logs are at ~bt/public/reconnectissues</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Jul-28 16:02</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/af6b879419042db66353b08d456bb3deb0ac71d4\">[40764]</a></span>: shared port was configured by the glue and <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CondorPersonal\" title=\"Condor Personal\">CondorPersonal</a></span> <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=4474\" onclick=\"get_ticket_and_populate_wrapper('4474'); return false;\" title=\"Non-windows job reconnect errors\">#4474</a></span> We now have configurable sockdir move to /tmp in condor personal and a separate switch to force shared port. services test had not had the line which has it to turn off shared port. Now it behaves like all regular test and gets USE_SHARED_PORT\u00a0[...]\n (By Bill Taylor )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2014-Jul-21 15:41", "status": "new", "created": "2014-Jul-21 13:53", "fixed_version": "2014-Jul-21 13:53", "broken_version": "v080202", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "tannenba", "derived_from": "", "creator": "bt", "rust": "", "customer_group": "chtc", "visibility": "public", "notify": "bt@cs.wisc.edu", "due_date": ""}