{"id": 7858, "title": "Ticket #7858: Global Job Priority breaks flocking", "description": "<blockquote>\nFermi reported some schedds doing little or no flocking to one of their pools. Investigation shows that the main pool (the CMS global pool) has global job priorities enabled (USE_GLOBAL_JOB_PRIOS=True). This causes the schedd to see multiple negotiation sessions during a negotiator cycle, each for a small range of job priority values. At the end of each session, the schedd recomputes the flocking level. If no jobs were rejected, then the schedd thinks all jobs for the submitter have a match and lowers the flocking level to that of the pool just negotiated with.\n\n<p>This is very similar to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7549\" onclick=\"get_ticket_and_populate_wrapper('7549'); return false;\" title=\"Negotiator prefetch breaks flocking\">#7549</a></span> (Negotiator prefetch breaks flocking). The negotiator config parameter NEGOTIATOR_JOB_CONSTRAINT can also cause this problem.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">\n<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7881\" onclick=\"get_ticket_and_populate_wrapper('7881'); return false;\" title=\"Add MIN_FLOCK_LEVEL knob\">#7881</a></span></td>\n<td align=\"center\" valign=\"center\" width=\"30\">\n<span class=\"icon ptr1\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\">\nAdd MIN_FLOCK_LEVEL knob</td></tr>\n</tbody></table>", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2020-Sep-29 16:27", "status": "new", "created": "2020-Sep-18 16:49", "fixed_version": "2020-Sep-18 16:49", "broken_version": "", "priority": "3", "subsystem": "DaemonsSubmitNode", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "s101459", "customer_group": "fermi", "visibility": "public", "notify": "jfrey@cs.wisc.edu,zmiller@cs.wisc.edu,timm@fnal.gov", "due_date": ""}