{"id": 4885, "title": "Ticket #4885: Improve debug() error message for missing classad functions", "description": "<blockquote>\nDerek ran into a misconfiguration issue when using HTCondor CE where he didn't specify the CE classad lib (libclassad_ce.so) in CLASSAD_USER_LIBS. This resulted in the less than informative error message, 'ERROR' in his <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=JobRouterLog\" title=\"Job Router Log\">JobRouterLog</a></span> when Condor couldn't find the userHome() function:\n\n<p></p><div class=\"verbatim\">\n<pre>/var/log/condor-ce/JobRouterLog.old-12/28/14 17:55:47 JobRouter (route=Local_PBS): Setting attribute environment to an evaluated expression\n/var/log/condor-ce/JobRouterLog.old:12/28/14 17:55:47 Classad debug: userHome(Owner,\"/\") --&gt; ERROR\n/var/log/condor-ce/JobRouterLog.old:12/28/14 17:55:47 Classad debug: [0.04101ms] strcat(\"HOME=\",userHome(Owner,\"/\"),\" \",ifThenElse(orig_environment is undefined,osg_environment,strcat(osg_environment,\" \",orig_environment))) --&gt; ERROR\n/var/log/condor-ce/JobRouterLog.old:12/28/14 17:55:47 Classad debug: [0.09394ms] strcat(\"HOME=\",userHome(Owner,\"/\"),\" \",ifThenElse(orig_environment is undefined,osg_environment,strcat(osg_environment,\" \",orig_environment))) --&gt; ERROR\n</pre></div>\n\n\n<p>The error message should indicate that it was unable to find the function it was looking for.</p></blockquote>", "remarks": "<blockquote>\n<em>2015-Apr-10 08:25:07 by bbockelm:</em> <br/>\n\nHow does this look:\n\n<p></p><div class=\"verbatim\">\n<pre>$ python\nPython 2.6.6 (r266:84292, Nov 21 2013, 12:39:37)\n[GCC 4.4.7 20120313 (Red Hat 4.4.7-3)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import classad\n&gt;&gt;&gt; import htcondor\n&gt;&gt;&gt; htcondor.param['TOOL_DEBUG'] = 'D_FULLDEBUG'\n&gt;&gt;&gt; htcondor.enable_debug()\n04/10/15 08:23:46 Result of reading /etc/issue:  Scientific Linux release 6.5 (Carbon)\n\n04/10/15 08:23:46 Using processor count: 6 processors, 6 CPUs, 0 HTs\n04/10/15 08:23:46 Reading condor configuration from '/etc/condor/condor_config'\n04/10/15 08:23:46 Enumerating interfaces: lo 127.0.0.1 up\n04/10/15 08:23:46 Enumerating interfaces: eth0 129.93.244.208 up\n04/10/15 08:23:46 I am: hostname: hcc-briantest, fully qualified doman name: hcc-briantest.unl.edu, IP: 129.93.244.208, IPv4: 129.93.244.208, IPv6:\n04/10/15 08:23:46 Initializing Directory: curr_dir = /etc/condor/config.d\n04/10/15 08:23:46 Enumerating interfaces: lo 127.0.0.1 up\n04/10/15 08:23:46 Enumerating interfaces: eth0 129.93.244.208 up\n04/10/15 08:23:46 Enumerating interfaces: lo ::1 up\n04/10/15 08:23:46 Enumerating interfaces: eth0 2600:900:6:1301:5054:ff:feab:a9fb up\n04/10/15 08:23:46 Enumerating interfaces: eth0 fe80::5054:ff:feab:a9fb up\n04/10/15 08:23:46 I am: hostname: hcc-briantest, fully qualified doman name: hcc-briantest.unl.edu, IP: 129.93.244.208, IPv4: 129.93.244.208, IPv6: 2600:900:6:1301:5054:ff:feab:a9fb\n&gt;&gt;&gt; htcondor.enable_classad_extensions()\n&gt;&gt;&gt; classad.ExprTree(\"debug(strcat(1, 2))\").eval()\n04/10/15 08:23:54 Classad debug: [0.01097ms] strcat(1,2) --&gt; 12\n04/10/15 08:23:54 Classad debug: [0.06580ms] strcat(1,2) --&gt; 12\n'12'\n&gt;&gt;&gt; classad.ExprTree(\"debug(strcatUndefined(1, 2))\").eval()\n04/10/15 08:24:04 Classad debug: strcatUndefined(1,2) --&gt; ERROR (function is not defined)\n04/10/15 08:24:04 Classad debug: [0.04697ms] strcatUndefined(1,2) --&gt; ERROR (function is not defined)\nclassad.Value.Error\n&gt;&gt;&gt;\n</pre></div>\n\n\n<p></p><hr/>\n<em>2015-Apr-10 10:08:53 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>This change looks good.\n\n</p><p></p><hr/>\n<em>2015-Apr-10 12:36:59 by bbockelm:</em> <br/>\n\nGot ahold of the original requester (blin) and he OK'd the changes to the error message.  Merging to master.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-05 16:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/305e28d8bee8094c3233083e6e60b0ea71ab3cd6\">[44994]</a></span>: minor edit of 8.3.6 version history item <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4885\" onclick=\"get_ticket_and_populate_wrapper('4885'); return false;\" title=\"Improve debug() error message for missing classad functions\">#4885</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Jun-05 14:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3e154e6ec8c6d3ead05b6101dee1a2bad6781fc5\">[44992]</a></span>: Version History for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4885\" onclick=\"get_ticket_and_populate_wrapper('4885'); return false;\" title=\"Improve debug() error message for missing classad functions\">#4885</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-10 12:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/dd1e388aa6ef89b5a4b07b046f5b8022e1832560\">[44589]</a></span>: Clarify debug message when a function does not exist. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4885\" onclick=\"get_ticket_and_populate_wrapper('4885'); return false;\" title=\"Improve debug() error message for missing classad functions\">#4885</a></span> When a function does't exist, the debug() invocation simply reports ERROR. This is difficult to differentiate between \"function evaluated to the constant ERROR\" versus \"function does not exist\". It now logs 'ERROR (function does not exist)'.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-10 08:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2d5be5fd13637ea5444bad2290a67d00ee837ac8\">[44581]</a></span>: Clarify debug message when a function does not exist. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4885\" onclick=\"get_ticket_and_populate_wrapper('4885'); return false;\" title=\"Improve debug() error message for missing classad functions\">#4885</a></span> When a function does't exist, the debug() invocation simply reports ERROR. This is difficult to differentiate between \"function evaluated to the constant ERROR\" versus \"function does not exist\". It now logs 'ERROR (function does not exist)'.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2015-Jun-05 14:26", "status": "resolved", "created": "2015-Feb-12 14:14", "fixed_version": "2015-Feb-12 14:14", "broken_version": "", "priority": "4", "subsystem": "DaemonsCM", "assigned_to": "bbockelm", "derived_from": "#4882", "creator": "blin", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "blin@cs.wisc.edu dweitzel@cse.unl.edu", "due_date": ""}