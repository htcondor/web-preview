{"id": 6365, "title": "Ticket #6365: daemons may not write out a core file when they get a fatal signal", "description": "<blockquote>\nThe dprintf setup code overwrites the signal handler for SIGSEGV and friends to a handler that doesn't use the google coredumper routines to write a core file.  This code is in daemon_core_main.  We should just use the daemon_core_main one.\n\n<p>Also, we should unconditionally use the google coredumper routines, not just if we're root.</p></blockquote>", "remarks": "<blockquote>\n<em>2017-Aug-07 10:10:19 by johnkn:</em> <br/>\n\n<strong>CODE_REVIEW</strong> this change breaks logging of stack traces in tools when they crash.\n\n<p></p><hr/>\n<em>2017-Sep-06 10:40:15 by gthain:</em> <br/>\n\nNote that tools that don't define a TOOL_DEBUG filename try to create a file called \"2&gt;\" in the current directory and writes the stack trace there.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Aug-04 09:54</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/49d20fe65b56103b623c8b23ce288ffa700b0573\">[52009]</a></span>: Transplant version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6364\" onclick=\"get_ticket_and_populate_wrapper('6364'); return false;\" title=\"schedd (or any daemon) crashes on reconfig when logging to syslog\">#6364</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6365\" onclick=\"get_ticket_and_populate_wrapper('6365'); return false;\" title=\"daemons may not write out a core file when they get a fatal signal\">#6365</a></span> in correct release  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Aug-03 21:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e15090fcfbd8c70e921edb59bfa56616d4511613\">[52007]</a></span>: Documnet <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6365\" onclick=\"get_ticket_and_populate_wrapper('6365'); return false;\" title=\"daemons may not write out a core file when they get a fatal signal\">#6365</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Aug-03 21:41</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1b56c2b5ab0303681aec4b119e5f54f1c9de5e5e\">[52005]</a></span>: Allow daemons to write core files should they crash <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6365\" onclick=\"get_ticket_and_populate_wrapper('6365'); return false;\" title=\"daemons may not write out a core file when they get a fatal signal\">#6365</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2017-Sep-06 10:40", "status": "resolved", "created": "2017-Aug-03 21:32", "fixed_version": "2017-Aug-03 21:32", "broken_version": "v080600", "priority": "1", "subsystem": "Daemons", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}