{"id": 6656, "title": "Ticket #6656: Environment variables aren't set inside Singularity Containers", "description": "<blockquote>\nAs of Singularity 2.4, when we create a container with a PID and IPC namespace, with the -C option, the environment is also cleared.  Condor now needs to explicitly pass environment variables to the container, not relying on the container to enherit all the parent's environment.</blockquote>", "remarks": "<blockquote>\n<em>2018-May-11 16:38:16 by tpdownes:</em> <br/>\n\nIs it reasonable to replace <code>-C</code> with <code>--ipc</code> and <code>--pid</code>?\n\n<p></p><hr/>\n<em>2018-May-14 14:22:15 by gthain:</em> <br/>\n\ntom:  I thought about that, but it seemed more future-proof to stick with -C, in case we want additional namespaces to be containerized in the future.\n\n<p></p><hr/>\n<em>2018-Jul-31 14:29:12 by tim:</em> <br/>\n\n<strong>CODE REVIEW:</strong> Looks good</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-31 11:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3b901249d4939b9ebd1f39d7e808d352db4a05ef\">[55243]</a></span>: Singularity now needs environment variables like SINGULARITYENV_foo=bar <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6656\" onclick=\"get_ticket_and_populate_wrapper('6656'); return false;\" title=\"Environment variables aren't set inside Singularity Containers\">#6656</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Jul-30 11:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/22ab5ec492627b7354a9c7adc124aba24719d343\">[55233]</a></span>: Document <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6656\" onclick=\"get_ticket_and_populate_wrapper('6656'); return false;\" title=\"Environment variables aren't set inside Singularity Containers\">#6656</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Apr-19 17:51</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/5bd644152df22f6a83abb1741996d06a04e7da05\">[54773]</a></span>: Singularity now needs environment variables like SINGULARITYENV_foo=bar <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6656\" onclick=\"get_ticket_and_populate_wrapper('6656'); return false;\" title=\"Environment variables aren't set inside Singularity Containers\">#6656</a></span>  (By Greg Thain )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2018-Jul-31 14:29", "status": "resolved", "created": "2018-Apr-19 13:59", "fixed_version": "2018-Apr-19 13:59", "broken_version": "v080600", "priority": "2", "subsystem": "DaemonsExecNode", "assigned_to": "gthain", "derived_from": "", "creator": "gthain", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}