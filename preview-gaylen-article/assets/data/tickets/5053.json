{"id": 5053, "title": "Ticket #5053: condor_q -g showing duplicates", "description": "<blockquote>\nI'm seeing some weirdness in <code>condor_q</code> in master (but not in 8.3.5).\n\n<p>It seems that some internal job buffer isn't cleared between schedds, leading to repetitive results.  See below example; there's really only two schedds with matching jobs, yet 5 schedd's worth of results are returned (three are identical).\n\n</p><p></p><div class=\"verbatim\">\n<pre>$ condor_q -g -pool vocms097.cern.ch -const 'WMAgent_RequestName=?=\"pdmvserv_FSQ-RunIISpring15DR74-00007_00008_v0_castor_150511_172908_7320\"'\n\n\n-- Schedd: vocms0310.cern.ch : &lt;128.142.209.47:4080?noUDP&amp;sock=1331419_9578_3&gt;\n ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD\n53665.0   cmst1           5/13 07:23   0+00:30:26 R  30150000 390.6 submit.sh pdmvserv\n\n1 jobs; 0 completed, 0 removed, 0 idle, 1 running, 0 held, 0 suspended\n\n\n-- Schedd: cmsgwms-submit2.fnal.gov : &lt;131.225.205.13:9615?noUDP&amp;sock=8719_66be_130&gt;\n ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD\n53665.0   cmst1           5/13 07:23   0+00:30:26 R  30150000 390.6 submit.sh pdmvserv\n\n0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended\n\n\n-- Schedd: vocms0308.cern.ch : &lt;128.142.209.42:4080?noUDP&amp;sock=1105847_f443_3&gt;\n ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD\n10774.2   cmst1           5/13 07:41   0+00:15:02 R  50150000 0.0  submit.sh pdmvserv\n10774.3   cmst1           5/13 07:41   0+00:15:02 R  50150000 0.0  submit.sh pdmvserv\n10774.11  cmst1           5/13 07:41   0+00:14:48 R  50150000 0.0  submit.sh pdmvserv\n10774.12  cmst1           5/13 07:41   0+00:14:56 R  50150000 0.0  submit.sh pdmvserv\n10774.14  cmst1           5/13 07:41   0+00:14:17 R  50150000 0.0  submit.sh pdmvserv\n10774.15  cmst1           5/13 07:41   0+00:15:16 R  30150000 390.6 submit.sh pdmvserv\n53665.0   cmst1           5/13 07:23   0+00:30:26 R  30150000 390.6 submit.sh pdmvserv\n\n6 jobs; 0 completed, 0 removed, 0 idle, 6 running, 0 held, 0 suspended\n\n\n-- Schedd: vocms0313.cern.ch : &lt;128.142.209.84:4080?noUDP&amp;sock=10462_f451_3&gt;\n ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD\n10774.2   cmst1           5/13 07:41   0+00:15:02 R  50150000 0.0  submit.sh pdmvserv\n10774.3   cmst1           5/13 07:41   0+00:15:02 R  50150000 0.0  submit.sh pdmvserv\n10774.11  cmst1           5/13 07:41   0+00:14:48 R  50150000 0.0  submit.sh pdmvserv\n10774.12  cmst1           5/13 07:41   0+00:14:56 R  50150000 0.0  submit.sh pdmvserv\n10774.14  cmst1           5/13 07:41   0+00:14:17 R  50150000 0.0  submit.sh pdmvserv\n10774.15  cmst1           5/13 07:41   0+00:15:16 R  30150000 390.6 submit.sh pdmvserv\n53665.0   cmst1           5/13 07:23   0+00:30:26 R  30150000 390.6 submit.sh pdmvserv\n\n0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended\n\n\n-- Schedd: vocms0309.cern.ch : &lt;128.142.209.43:4080?noUDP&amp;sock=931972_2a9c_12&gt;\n ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD\n10774.2   cmst1           5/13 07:41   0+00:15:02 R  50150000 0.0  submit.sh pdmvserv\n10774.3   cmst1           5/13 07:41   0+00:15:02 R  50150000 0.0  submit.sh pdmvserv\n10774.11  cmst1           5/13 07:41   0+00:14:48 R  50150000 0.0  submit.sh pdmvserv\n10774.12  cmst1           5/13 07:41   0+00:14:56 R  50150000 0.0  submit.sh pdmvserv\n10774.14  cmst1           5/13 07:41   0+00:14:17 R  50150000 0.0  submit.sh pdmvserv\n10774.15  cmst1           5/13 07:41   0+00:15:16 R  30150000 390.6 submit.sh pdmvserv\n53665.0   cmst1           5/13 07:23   0+00:30:26 R  30150000 390.6 submit.sh pdmvserv\n\n0 jobs; 0 completed, 0 removed, 0 idle, 0 running, 0 held, 0 suspended\n\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2015-May-13 08:38:09 by bbockelm:</em> <br/>\n\nConfirmed this on a clean box using TimT's 8.3.6 release candidate RPMs.\n\n<p></p><hr/>\n<em>2015-May-13 09:35:24 by johnkn:</em> <br/>\n\nSilly bug.  the guts of the clear_results() were wrong (and also commented out.) &lt;sigh&gt;</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-May-13 10:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1a6aaf92fa9dfca446354d847adfc588fa475b11\">[44845]</a></span>: fix for condor_q -global showing duplicates <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5053\" onclick=\"get_ticket_and_populate_wrapper('5053'); return false;\" title=\"condor_q -g showing duplicates\">#5053</a></span> ===VersionHistory:None=== bug never shipped.  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Jun-04 14:43", "status": "resolved", "created": "2015-May-13 08:29", "fixed_version": "2015-May-13 08:29", "broken_version": "v080306", "priority": "1", "subsystem": "Tools", "assigned_to": "johnkn", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "bbockelm@cse.unl.edu", "due_date": ""}