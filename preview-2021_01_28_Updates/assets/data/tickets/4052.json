{"id": 4052, "title": "Ticket #4052: RecentDaemonCoreDutyCycle is sometimes negative", "description": "<blockquote>\n<code>RecentDaemonCoreDutyCycle</code> for machines that are not spending a lot of time in select is sometimes reported as a negative number.  This happens because the two values that are used to calculate the duty cycle are both subject to independent quantization and error accumulation.\n\n<p>the duty cycle is calculated as\n</p><div class=\"code\">\n<pre class=\"code\">1.0 - (RecentSelectWaitTime / RecentDCPumpCycleSum);</pre></div>\n\n\n<p>When <code>RecentSelectWaitTime</code> is greater than <code>RecentDCPumpCycleSum</code> then the calculated value for duty cycle will be negative.  This can happen when nearly all of the pump cycle time is spent waiting in select, (i.e. the daemon is not busy).  It also appears to be the case that the select wait time is over-reported because of accumulated errors in summing the wait times for each select call.\n\n</p><p>The proposed fix is to add code to increase the accuracy of the select wait calculation, and also to suppress the publication of negative values when they occur.  0.0 will be published instead.</p></blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-27 09:23</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/6f2d78eeebfb18ab82185c418a167f03ea43a235\">[38868]</a></span>: 8.0.5 version history item added <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4052\" onclick=\"get_ticket_and_populate_wrapper('4052'); return false;\" title=\"RecentDaemonCoreDutyCycle is sometimes negative\">#4052</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2013-Nov-11 12:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4bd1b49bce258840da581af4638cea2605898c21\">[38692]</a></span>: Suppress negative values for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=RecentDaemonCoreDutyCycle\" title=\"Recent Daemon Core Duty Cycle\">RecentDaemonCoreDutyCycle</a></span> <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4052\" onclick=\"get_ticket_and_populate_wrapper('4052'); return false;\" title=\"RecentDaemonCoreDutyCycle is sometimes negative\">#4052</a></span> ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Nov-27 14:39", "status": "resolved", "created": "2013-Nov-08 13:22", "fixed_version": "2013-Nov-08 13:22", "broken_version": "v080000", "priority": "4", "subsystem": "Daemons", "assigned_to": "johnkn", "derived_from": "", "creator": "johnkn", "rust": "", "customer_group": "other", "visibility": "public", "notify": "johnkn@cs.wisc.edu", "due_date": ""}