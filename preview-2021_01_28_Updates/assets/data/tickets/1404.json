{"id": 1404, "title": "Ticket #1404: Bad ldap server can make nordugrid_gahp exit", "description": "<blockquote>\nThe nordugrid_gahp exits when it receives a SIGPIPE. The assumption is that a SIGPIPE indicates that one of the pipes to its client has been closed. However, a NORDUGRID_LDAP_QUERY command issued to a misconfigured ldap server can also result in a SIGPIPE. This is because a SIGPIPE is generated when the process writes to a closed pipe <strong>or</strong> socket.\n\n<p>Igor Sfiligoi had his nordugrid_gahp exit unexpectedly when attempting to query an ldap server that closed connections immediately after they were opened. The connections stayed open long enough for the ldap library to start sending data, triggering a SIGPIPE.\n\n</p><p>The solution is for the nordugrid_gahp to ignore SIGPIPE and exit if writing to stdout fails with EPIPE. Fortunately, virtually all writes to stdout are funneled through gahp_printf(), which makes adding a check easy.</p></blockquote>", "remarks": "<blockquote>\n<em>2010-May-13 11:54:22 by jfrey:</em> <br/>\n\nPushed a fix to V7_4-branch for 7.4.3. The nordugrid_gahp now ignores SIGPIPE and exits if writes to stdout fail with EPIPE.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2010-May-13 11:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9d936d89fa29996c754078e97b2f746109a267a4\">[17985]</a></span>: Bad ldap server can make nordugrid_gahp exit. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1404\" onclick=\"get_ticket_and_populate_wrapper('1404'); return false;\" title=\"Bad ldap server can make nordugrid_gahp exit\">#1404</a></span> The nordugrid_gahp exits when it receives a SIGPIPE. The assumption is that a SIGPIPE indicates that one of the pipes to its client has been closed. However, a NORDUGRID_LDAP_QUERY command issued to a misconfigured ldap server can also result in a SIGPIPE.\u00a0[...]\n (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2010-May-13 11:54", "status": "resolved", "created": "2010-May-13 11:27", "fixed_version": "2010-May-13 11:27", "broken_version": "v070400", "priority": "2", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}