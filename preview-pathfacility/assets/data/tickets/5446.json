{"id": 5446, "title": "Ticket #5446: Condor-C jobs aborted when lease is less than one hour", "description": "<blockquote>\nWhen a Condor-C job's lease duration is less than three hours, the lease may not be renewed frequently enough. If the lease duration is less than one hour, then it may not be renewed before it expires, causing the job to be aborted.\n\n<p>When all job leases are checked (and possibly renewed), a timer is set for the next time a renewal needs to happen (max 1 hour). If a new job shows up from the schedd or is submitted to the remote server, this timer isn't re-evaluated with the new job's lease. So if the new job has a shorter lease, it wouldn't get renewed when it should.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Jan-06 15:57:17 by jfrey:</em> <br/>\n\nAlso, in the job submitted to the remote schedd, the default lease duration should be 40 minutes, not 20 minutes. We changed this default in condor_submit in 8.3.\n\n<p></p><hr/>\n<em>2016-Feb-01 10:50:14 by tlmiller:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>Looks good.</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-28 14:01</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4f16937b1b12e99a98aa0349e6b75c287203add5\">[47511]</a></span>: Docs for Condor-C short job lease bug fix. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5446\" onclick=\"get_ticket_and_populate_wrapper('5446'); return false;\" title=\"Condor-C jobs aborted when lease is less than one hour\">#5446</a></span>  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-06 16:08</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/15123f90b88f5ccf6fbf7ebeadf4591433c3c598\">[47428]</a></span>: Condor-C jobs aborted when lease is less than one hour <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5446\" onclick=\"get_ticket_and_populate_wrapper('5446'); return false;\" title=\"Condor-C jobs aborted when lease is less than one hour\">#5446</a></span> The batched lease renewal code in the gridmanager can now be told to reevaluate the next time a lease needs to be renewed (e.g. when a new job is submitted). Without this, a new job with a short lease duration may not get its lease renewed\u00a0[...]\n (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Jan-06 16:03</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1aaf6d0eaf741b82a71fc901acc35a8744cd346e\">[47427]</a></span>: Update default job lease duration of remote job for Condor-C. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5446\" onclick=\"get_ticket_and_populate_wrapper('5446'); return false;\" title=\"Condor-C jobs aborted when lease is less than one hour\">#5446</a></span> In 8.3, we changed the default job lease duration for shadow-based jobs from 20 minutes to 40 minutes in condor_submit. We neglected to update the value used in the gridmanager when a Condor-C job is submitted to the remote schedd.  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Feb-01 13:59", "status": "resolved", "created": "2015-Dec-17 16:52", "fixed_version": "2015-Dec-17 16:52", "broken_version": "v080200", "priority": "3", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "jfrey", "rust": "", "customer_group": "cern", "visibility": "public", "notify": "", "due_date": ""}