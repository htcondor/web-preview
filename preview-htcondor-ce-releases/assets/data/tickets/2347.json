{"id": 2347, "title": "Ticket #2347: Condor-G misdetects GT5 as GT2", "description": "<blockquote>\nIt appears that Condor-G chronically identifies GT5 as GT2 and starts grid_monitors.  In my experience, this happens between 20-40% of the time for \"at scale\" tests.\n\n<p>Take a basic Condor-G job and do \"queue 5000\" on it, and you should be able to replicate.  You can use brian-test.unl.edu:/jobmanager-condor if you need a GT5 endpoint to test out.\n\n</p><p><strong>Milestones</strong>\n</p><ul>\n<li>20110812 Reproduce\n</li><li>20110812 Diagnose\n</li><li>20110819 Either patch Condor-G or notify Globus</li></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2011-Aug-08 14:36:58 by jfrey:</em> <br/>\n\nAdditional note from Brian: I saw the issue at the level of 50 or so jobs, then kill -9 the gahp_server\n\n<p></p><hr/>\n<em>2011-Aug-10 12:08:12 by jfrey:</em> <br/>\n\nSo far, I've been unable to reproduce this bug. I've submitted up to 100\njobs, killed the gridmanager, and let it recover. I'm testing against a\nGlobus 5.0.4 server. Brian, is there anything I'm missing?\n\n<p></p><hr/>\n<em>2011-Aug-10 12:40:49 by bbockelm:</em> <br/>\n\nHi Jaime,\n\n<p>If you're not able to replicate, that's good news!  It means the issue might be localized.  I'll take it from here and let you know.\n\n</p><p>It's quite possible that GT5/2 mis-detection could be due to the fact that my Condor-G build is with threaded Globus.\n\n</p><p></p><hr/>\n<em>2011-Aug-10 12:44:33 by jfrey:</em> <br/>\n\nBrian, if you send me a gridmanager log with D_FULLDEBUG enabled where the error occurs, I can determine whether the problem is in your gridmanager or your gahp_server.\n\n<p></p><hr/>\n<em>2011-Aug-15 15:25:55 by bbockelm:</em> <br/>\n\nSpent some more time with this one.  I noticed it happened for some jobs where I specify:\n\n<p>grid_resource = gt5 fermicloud019.fnal.gov:/jobmanager-condor\n\n</p><p>So, it's not necessarily in the detection code.  I didn't happen to be running at D_FULLDEBUG, but I see the following happen while gridmanager is trying to recover the jobs:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">08/15/11 15:21:05 [29768] gramCallbackHandler: Can't find record for globus job with contact https://fermicloud019.fnal.gov:50872/16145823335431311641/576462952707980460/ on globus state 64, errorcode 0, delaying\n08/15/11 15:21:05 [29768] (12901.74) gram callback: state 1, errorcode 0\n08/15/11 15:21:05 [29768] gramCallbackHandler: Can't find record for globus job with contact https://fermicloud019.fnal.gov:50872/16145823335431311641/576462952707980460/ on globus state 2, errorcode 0, delaying\n08/15/11 15:21:05 [29768] (12901.71) gram callback: state 1, errorcode 0\n08/15/11 15:21:05 [29768] (12901.76) gram callback: state 1, errorcode 0\n08/15/11 15:21:05 [29768] gramCallbackHandler: Can't find record for globus job with contact https://fermicloud019.fnal.gov:50872/16145823335431311641/576462952707980460/ on globus state 8, errorcode 0, delaying\n08/15/11 15:21:05 [29768] grid_monitor log file for fermicloud019.fnal.gov:2119 has error code 8\n08/15/11 15:21:05 [29768] Error with grid_monitor for fermicloud019.fnal.gov:2119, stopping.\n08/15/11 15:21:05 [29768] Giving up on grid_monitor for site fermicloud019.fnal.gov:2119.  Will retry in 3600 seconds (60 minutes)\n08/15/11 15:21:05 [29768] Stopping grid_monitor for resource fermicloud019.fnal.gov:2119\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2015-Feb-11 16:06", "status": "abandoned", "created": "2011-Aug-03 07:53", "fixed_version": "2011-Aug-03 07:53", "broken_version": "v076000", "priority": "2", "subsystem": "Grid", "assigned_to": "jfrey", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "osg", "visibility": "public", "notify": "tannenba@cs.wisc.edu, roy@cs.wisc.edu, bbockelm@cse.unl.edu", "due_date": "20110812"}