{"id": 5633, "title": "Ticket #5633: X509 attributes not parsed by schedd", "description": "<blockquote>\nIn <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5064\" onclick=\"get_ticket_and_populate_wrapper('5064'); return false;\" title=\"Set x509 job attributes from authenticated socket\">#5064</a></span>, the original branch parsed X509 attributes from delegated proxy files or the GSI connection.  Later commits had the <code>condor_schedd</code> parse <code>x509userproxy</code> on schedd side.\n\n<p>That code doesn't work:\n</p><ol>\n<li>Schedd doesn't switch to user priv to parse the file.  This means the proxy is parsed schedd-side only if the proxy is world-readable or owned by condor.\n</li><li>If a <code>condor_qedit</code> changes the proxy file to an invalid / unparsable file, the prior x509 attributes are overwritten.\n</li></ol>\n\n<p>Marking as fairly high priority because all condor submits now are missing x509 attributes.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Apr-18 13:04:52 by zmiller:</em> <br/>\n\nWill fix the first issue right away.  As a possible workaround you can use an older version of condor_submit.\n\n<p>The second issue is how it was designed to work.  The attributes should reflect what is contained in the current proxy.\n\n</p><p></p><hr/>\n<em>2016-Apr-18 13:12:14 by bbockelm:</em> <br/>\n\nIn that case, we should seriously consider rejecting qedit's that point to an invalid proxy.\n\n<p>Put another way - we did this so we could have some level of \"trust\" in these attributes to make reasonable decisions (i.e., put it in queue A instead of queue B).  The trust is established by the fact the user could prove he has a certain identity (can provide a proxy, authenticate a connection).  That goes away if a user can arbitrarily clear out the related attributes.\n\n</p><p></p><hr/>\n<em>2016-Apr-18 13:18:24 by zmiller:</em> <br/>\n\nRight.  If the user clears out their proxy, they have lost the ability to prove those things about themselves, and so clearing them from the job attributes reflects that reality.\n\n<p>Is there a situation where a user somehow has MORE access to things by not proving who they are?  That seems odd.\n\n</p><p>That said, I can get on board with rejecting updates to x509userproxy when the proxy is not valid.  Do you want them also not to be able to clear the value?\n\n</p><p></p><hr/>\n<em>2016-Apr-22 16:26:59 by zmiller:</em> <br/>\n\n<strong>NOTE</strong>: Ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5064\" onclick=\"get_ticket_and_populate_wrapper('5064'); return false;\" title=\"Set x509 job attributes from authenticated socket\">#5064</a></span> was reopened and the work plan for fixing this is in the remarks of that ticket.\n\n<p></p><hr/>\n<em>2016-Oct-19 10:27:05 by jfrey:</em> <br/>\n\nI believe the latest work on ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5064\" onclick=\"get_ticket_and_populate_wrapper('5064'); return false;\" title=\"Set x509 job attributes from authenticated socket\">#5064</a></span> resolves the issues with this ticket. Assuming no one objects, I plan to resolve this ticket.\n\n<p></p><hr/>\n<em>2016-Nov-21 14:00:10 by zmiller:</em> <br/>\n\nNo one objected, resolving.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2016-Nov-21 14:00", "status": "resolved", "created": "2016-Apr-16 09:07", "fixed_version": "2016-Apr-16 09:07", "broken_version": "v080504", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "zmiller", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "bbockelm@cse.unl.edu, zmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}