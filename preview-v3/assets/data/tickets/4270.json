{"id": 4270, "title": "Ticket #4270: Support PanDA monitoring", "description": "<blockquote>\nThe general idea is to use the <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAdLogPlugin\" title=\"Class Ad Log Plugin\">ClassAdLogPlugin</a></span> to stream updates from the schedd to the <a class=\"external\" href=\"https://twiki.cern.ch/twiki/bin/view/PanDA/BigPandaHTCondorAPI\">PanDA monitoring system</a>, via a GAHP-like binary provisionally named 'pandad'.  This makes it simple to avoid blocking the schedd in the plugin; the pandad uses the usual GAHP mechanism for pulling from the pipe to the schedd and doing blocking writes (using libcURL) to the monitor.\n\n<p>See the <a class=\"external\" href=\"https://docs.google.com/a/wisc.edu/document/d/1yGo45Ek0EP3afAylAUIsFfPzmQL0rawZhu6fxMf61vg/edit\">design document</a> for details.</p></blockquote>", "remarks": "<blockquote>\n<em>2014-May-19 16:55:13 by tlmiller:</em> <br/>\n\n<strong>SHOULD NOT BE DOCUMENTED</strong>\n\n<p>This feature is under active development, so it should not be documented, even though parts of it exist in released versions of HTCondor.\n\n</p><p></p><hr/>\n<em>2014-Sep-18 16:57:49 by tlmiller:</em> <br/>\n\nFor future documentation:\n\n<p></p><ul>\n<li>To reconfigure pandad, you must send it a SIGHUP directly.  Using condor_reconfigure will not work.  The pandad will respond (and log the new configuration) the next time it sends an event to the monitor, which will not happen until something changes in the queue.\n</li></ul>\n\n<p></p><hr/>\n<em>2015-Feb-16 14:50:12 by tlmiller:</em> <br/>\n\n<strong>Current Status</strong>\n\n<p>Although we have some ideas to make it easier to configure, I think the code is complete, and has been tested at 1Hz.  I think the hold-up was that the code had not been tested on a production schedd to make sure it didn't adversely affect performance.\n\n</p><p></p><hr/>\n<em>2015-Mar-11 17:41:25 by tlmiller:</em> <br/>\n\nAdded to 8.3.5 as an experimental feature as e-mail with Torre Wenaus and Peter Love.\n\n<p></p><hr/>\n<em>2015-Mar-11 17:41:34 by tlmiller:</em> <br/>\n\n<a class=\"external\" href=\"/wiki-archive/pages/ExperimentalPandaMonitor\">ExperimentalPandaMonitor</a></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Apr-02 22:50</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/85165f346b8000dc358c6225f3fc63e9f104779c\">[44514]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Add PanDA bits to unified RPM  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-31 12:12</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/85a7aaca2d9e0eceaf9fabc2b06d95b70538d118\">[44466]</a></span>: <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=PanDa\" title=\"Pan Da\">PanDa</a></span> -&gt; PanDA <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-25 14:39</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1a3b5956695b6dd6571e070e17f121a56cc53c30\">[43726]</a></span>: 8.3.5 version history item for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-11 17:33</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/25863927e3689389ef1def57fe813bb53a20af9d\">[43563]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Add experimental support for the PanDA job monitor. Squashed commit of the following: commit 4b5f903a06d2919902ae4ccd9660dcc8802762c9 Author: Todd L Miller &lt;tlmiller@cs.wisc.edu&gt; Date: Wed Mar 11 17:25:04 2015 -0500\u00a0[...]\n (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2015-Mar-11 17:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/4b5f903a06d2919902ae4ccd9660dcc8802762c9\">[43562]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Build fixes.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 16:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c7715a0f8b0883a128b956a78a331fd3d73bfcb3\">[41237]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Even more final tweaks.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 16:31</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/00e502450c3441f25d7c4e4725b87b5f8e297fa5\">[41236]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Final tweaks.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 15:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1e333c55dd0c7aeb5d055cad9af1509630bcee13\">[41235]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Use safe_open().  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 15:32</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fd13fed66535dafff925844bdea37c9c7ed0a3f0\">[41234]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Unbreak the build.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 14:16</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1c45884968076fa4726640e7797b9ec13db990ba\">[41232]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Add PANDA_STATISTICS_LOG config knob. Allow PANDA_UPDATE_TIMEOUT to be updated on a reconfig.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Sep-18 13:56</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/057656f117bb4e10694bf79694e376b0335cf17d\">[41231]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Force out a last update of our statistics at exit.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Mar-20 14:30</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7a2c9e39b3978ffec1755224e0d118121c922cd7\">[39672]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4270\" onclick=\"get_ticket_and_populate_wrapper('4270'); return false;\" title=\"Support PanDA monitoring\">#4270</a></span>) Improvements for <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=ClassAdLogPlugins\" title=\"Class Ad Log Plugins\">ClassAdLogPlugins</a></span>. Allow schedd plugins by default. Don't crash if GetJobAd() is called before the job queue is initialized. Add BeginTransaction() and EndTransaction(). Export ScheddGetJobAd() (avoid name collision with client API). Move BinaryLookup() to make it available outside\u00a0[...]\n (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "experimental", "last_change": "2015-Mar-11 17:41", "status": "resolved", "created": "2014-Mar-20 14:00", "fixed_version": "2014-Mar-20 14:00", "broken_version": "", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "tlmiller", "derived_from": "", "creator": "tlmiller", "rust": "", "customer_group": "atlas", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}