{"id": 7662, "title": "Ticket #7662: Allow job submits from GID 0", "description": "<blockquote>\nWhen doing some remote job submits, we've been hitting <code>condor_submit</code> issues because the <code>GID</code> is set to 0.  This is a bit silly as the job in the schedd is going to be mapped as some other user (even if it wasn't, it's being submitted as UID non-zero).\n\n<p>The schedd should be responsible for refusing jobs owned by root.  Assuming the schedd provides a reasonable error message, we should simply remove this check.</p></blockquote>", "remarks": "<blockquote>\n<em>2020-Jun-02 12:17:17 by zmiller:</em> <br/>\n\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=GitHub\" title=\"Git Hub\">GitHub</a></span> PR:\n\n<p><a class=\"external\" href=\"https://github.com/htcondor/htcondor/pull/116\">https://github.com/htcondor/htcondor/pull/116</a>\n\n</p><p></p><hr/>\n<em>2020-Jun-02 12:45:03 by johnkn:</em> <br/>\n\nyou can reasonably remove the GID check, but not the UID check, since you can't assume that the schedd is a modern one that does check for root.\n\n<p></p><hr/>\n<em>2020-Jun-12 08:43:51 by karpel:</em> <br/>\n\nCan we get this into 8.9.8? It's impacting people trying to use our Python bindings tutorials who want to do normal job submission without the bindings (the bindings already don't have this check).\n\n<p></p><hr/>\n<em>2020-Jun-12 11:46:22 by zmiller:</em> <br/>\n\nYep, talked to Todd this morning and am working on putting it in today.\n\n<p></p><hr/>\n<em>2020-Jun-12 17:10:53 by zmiller:</em> <br/>\n\nI have a suggestion for an improvement: If condor_submit is run as root, respond back who the job ultimately mapped to and is owned by, since it won't be \"root\".  However, that shouldn't and won't hold up this work so I'll make a separate ticket.\n\n<p></p><hr/>\n<em>2020-Jun-12 17:11:52 by zmiller:</em> <br/>\n\n<strong>CODE REVIEW</strong>: All good.  Merged.  IMHO doesn't need full documentation but should have a version history which I can do before resolving.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Aug-03 13:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/76e067872dc723385889b5eb8923945cf1d0e952\">[60323]</a></span>: Update history with correct ticket number. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7662\" onclick=\"get_ticket_and_populate_wrapper('7662'); return false;\" title=\"Allow job submits from GID 0\">#7662</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Aug-03 13:20</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/136314e41058ed867dfb9ad6184a92e18a7a1cfa\">[60322]</a></span>: Added version history for condor_submit with gid 0. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7662\" onclick=\"get_ticket_and_populate_wrapper('7662'); return false;\" title=\"Allow job submits from GID 0\">#7662</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-12 16:43</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/38d0bd507181db459a3f7ff322d660377c33e612\">[59860]</a></span>: Log info about decision to allow/deny setting owner. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7662\" onclick=\"get_ticket_and_populate_wrapper('7662'); return false;\" title=\"Allow job submits from GID 0\">#7662</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-Jun-12 12:45</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2154c7b3cb75ad8301fa069c0c76c99cd40a95d4\">[59859]</a></span>: Merged <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8c77d01ffcaa90502e72532318543fef85d616a6\">[59857]</a></span>, <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9313d373c4daac07888686590bf871612d1705b7\">[59858]</a></span>, Merge branch 'V8_9-gt7662-branch' <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7662\" onclick=\"get_ticket_and_populate_wrapper('7662'); return false;\" title=\"Allow job submits from GID 0\">#7662</a></span>  (By zmiller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-May-27 21:06</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9313d373c4daac07888686590bf871612d1705b7\">[59858]</a></span>: Do not refuse submit for UID / GID 0. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7662\" onclick=\"get_ticket_and_populate_wrapper('7662'); return false;\" title=\"Allow job submits from GID 0\">#7662</a></span> Increasingly, the submitting user in the schedd is decoupled from the Unix UID / GID that invoked condor_submit. This is especially true with remote submission cases and non-FS-authentication.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2020-May-27 20:47</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8c77d01ffcaa90502e72532318543fef85d616a6\">[59857]</a></span>: Defer reporting errors until commit time. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=7662\" onclick=\"get_ticket_and_populate_wrapper('7662'); return false;\" title=\"Allow job submits from GID 0\">#7662</a></span> Currently, the behavior in <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NoAck\" title=\"No Ack\">NoAck</a></span> mode is to immediately close the TCP socket when errors occur during <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=SetAttribute\" title=\"Set Attribute\">SetAttribute</a></span> - providing no opportunity to pass along an error message from the failed operation.\u00a0[...]\n (By Brian Bockelman )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2020-Aug-03 13:51", "status": "resolved", "created": "2020-May-23 15:51", "fixed_version": "2020-May-23 15:51", "broken_version": "", "priority": "3", "subsystem": "Tools", "assigned_to": "zmiller", "derived_from": "", "creator": "bbockelm", "rust": "", "customer_group": "cms", "visibility": "public", "notify": "zmiller@cs.wisc.edu, bbockelman@morgridge.org, karpel@wisc.edu", "due_date": ""}