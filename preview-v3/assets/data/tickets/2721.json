{"id": 2721, "title": "Ticket #2721: $$([]) not expended in Grid Universe", "description": "<blockquote>\n<div class=\"code\">\n<pre class=\"code\">&gt; https://condor-wiki.cs.wisc.edu/index.cgi/tktview?tn=2720\n\nThanks for the quick response.\n\nI did a bit more digging and figured out the actual problem. I am using Condor only for submitting jobs to Grid and it seems that grid universe (grid_type gt2) does not support the substitution.\n\nHere is my job:\n-----\nExecutable=/bin/hostname\nTransferExecutable = False\nLog=condorG.log\nOutput=hostname.gt2.$$([$(Process)+100]).out\nError=hostname.gt2.$$([$(Process)+100]).err\nskip_filechecks = True\nuniverse=grid\ngrid_resource = gt2 ce.cro-ngi.hr/jobmanager-maui\nqueue\n-----\n\nAfter submission I find in condorG.log:\n-----\n018 (010.000.000) 12/16 11:37:28 Globus job submission failed!\n    Reason: 48 the provided RSL could not be properly parsed\n-----\n\nFinally in the Globus log on the target machine I found that substitution is not done:\n-----\n&amp;(rsl_substitution=(GRIDMANAGER_GASS_URL https://ha.cro-ngi.hr:20886))(executable='/bin/hostname')(scratchdir='')(directory=$(SCRATCH_DIRECTORY))(stdout=$(GLOBUS_CACHED_STDOUT))(stderr=$(GLOBUS_CACHED_STDERR))(file_stage_out=($(GLOBUS_CACHED_STDOUT) $(GRIDMANAGER_GASS_URL)#'/home/eimamagi/hostname.gt2.$'#$([0+100])#'.out')($(GLOBUS_CACHED_STDERR) $(GRIDMANAGER_GASS_URL)#'/home/eimamagi/hostname.gt2.$'#$([0+100])#'.err'))(proxy_timeout=240)(save_state=yes)(two_phase=3600)(remote_io_url=$(GRIDMANAGER_GASS_URL))\n-----\n\nCheers\n--\nEmir Imamagic\n</pre></div>\n</blockquote>", "remarks": "<blockquote>\n<em>2011-Dec-16 09:20:16 by danb:</em> <br/>\n\nActually $$() is <em>sometimes</em> expanded for grid universe.  It happens when grid universe jobs use matchmaking.  Matchmaking in the grid universe is described here:\n\n<p><a class=\"external\" href=\"http://research.cs.wisc.edu/condor/manual/v7.6/5_3Grid_Universe.html#SECTION006310000000000000000\">http://research.cs.wisc.edu/condor/manual/v7.6/5_3Grid_Universe.html#SECTION006310000000000000000</a>\n\n</p><p>Perhaps the real problem here is that we are using $$([]) when we really want $([]).  The latter syntax is not implemented but seems a logical extension of $$([]).\n\n</p><p></p><ul>\n<li>$$([expr]) -- evaluate a classad expression in the context of the job and machine ad after the job has been matched.\n\n<p></p></li><li>$([expr]) -- evaluate a classad expression at parse time.  The expression may refer to submit file macros that have been previously defined, including Process and Cluster.\n</li></ul>\n<hr/>\n<em>2012-Sep-11 11:06:53 by johnkn:</em> <br/>\n\nBulk change of target version from v070803 to v070804 using ./ticket-target-mover.\n<hr/>\n<em>2012-Sep-19 16:15:53 by zmiller:</em> <br/>\n\nBulk change of target version from v070804 to v070805 using ./ticket-target-mover.\n<hr/>\n<em>2012-Oct-25 17:52:16 by johnkn:</em> <br/>\n\nBulk change of target version from v070806 to v070807 using ./ticket-target-mover.\n<hr/>\n<em>2012-Dec-19 09:30:04 by johnkn:</em> <br/>\n\nBulk change of target version from v070807 to v070808 using ./ticket-target-mover.\n<hr/>\n<em>2013-Mar-28 17:16:00 by johnkn:</em> <br/>\n\nBulk change of target version from v070808 to v070809 using ./ticket-target-mover.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "defect", "last_change": "2013-Mar-28 17:16", "status": "new", "created": "2011-Dec-16 05:53", "fixed_version": "2011-Dec-16 05:53", "broken_version": "v070100", "priority": "4", "subsystem": "Grid", "assigned_to": "", "derived_from": "", "creator": "matt", "rust": "", "customer_group": "users", "visibility": "public", "notify": "matt@cs.wisc.edu", "due_date": ""}