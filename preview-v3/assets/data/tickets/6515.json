{"id": 6515, "title": "Ticket #6515: pip-installed python bindings dependent on condor_config", "description": "<blockquote>\nAs reported on htcondor-users <a class=\"external\" href=\"https://lists.cs.wisc.edu/archive/htcondor-users/2017-December/msg00038.shtml\">https://lists.cs.wisc.edu/archive/htcondor-users/2017-December/msg00038.shtml</a>\n\n<p>If the htcondor package cannot find a condor_config, it prints a warning. Further use of the package can lead to the python interpreter exiting.\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">&gt;&gt;&gt; import htcondor\n\nNeither the environment variable CONDOR_CONFIG,\n/etc/condor/, /usr/local/etc/, nor ~condor/ contain a condor_config source.\nEither set CONDOR_CONFIG to point to a valid config source,\nor put a \"condor_config\" file in /etc/condor/ /usr/local/etc/ or ~condor/\n&gt;&gt;&gt; htcondor.version()\n'$CondorVersion: 8.7.4 Oct 30 2017 BuildID: UW_development $'\n&gt;&gt;&gt; c = htcondor.Collector('***.wisc.edu')\n&gt;&gt;&gt; c.query(htcondor.AdTypes.Collector)\nCan't find \"condor\" in the password file and CONDOR_IDS not defined in condor_config or as an environment variable.\n[root@6c1f958d20a2 /]# # no longer in python interpreter\n</pre></div>\n\n\n<p><strong>WORKAROUND:</strong> A blank condor_config seems to do the trick:\n</p><div class=\"code\">\n<pre class=\"code\">$ touch condor_config\n$ export CONDOR_CONFIG=$(pwd)/condor_config\n</pre></div>\n\n\n<p>It may be possible to use this workaround in the __init__.py script (which is only invoked with pip-installed packages) to avoid this problem. I think we should still print a warning message when CONDOR_HOST isn't set.</p></blockquote>", "remarks": "<blockquote>\n<em>2018-Feb-19 10:18:53 by jpatton:</em> <br/>\n\nPointing <code>CONDOR_CONFIG</code> to <code>/dev/null</code> also seems to work and would be the easiest way to implement this in python.\n\n<p></p><hr/>\n<em>2018-Feb-19 14:34:24 by jpatton:</em> <br/>\n\nHere is the new behavior:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">&gt;&gt;&gt; import htcondor\n/home/jpatton/.conda/envs/py36/lib/python3.6/site-packages/htcondor/__init__.py:25: UserWarning:\nUsing a null condor_config.\nNeither the environment variable CONDOR_CONFIG, /etc/condor/,\n/usr/local/etc/, nor ~/condor/ contain a condor_config source.\n  warnings.warn(message)\n&gt;&gt;&gt; collector = htcondor.Collector() # does not exit the interpreter!\n&gt;&gt;&gt; collector.query()\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nRuntimeError: Unable to determine collector host.\n&gt;&gt;&gt; collector = htcondor.Collector('XXXXXXX.wisc.edu')\n&gt;&gt;&gt; collector.query(htcondor.AdTypes.Collector)\n[[ RecentUpdatesTotal_Negotiator = 3; ...\n</pre></div>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Feb-19 14:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9c221b70a2ba2f9055ded4330c23877428871e58\">[54316]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6515\" onclick=\"get_ticket_and_populate_wrapper('6515'); return false;\" title=\"pip-installed python bindings dependent on condor_config\">#6515</a></span>  (By Jason Patton )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2018-Feb-19 14:22</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/2763289b670bad6ef5d612130d0cdc328792c9d6\">[54315]</a></span>: Updating python bindings wheel package to handle config-less installs <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6515\" onclick=\"get_ticket_and_populate_wrapper('6515'); return false;\" title=\"pip-installed python bindings dependent on condor_config\">#6515</a></span>  (By Jason Patton )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2018-Feb-26 13:51", "status": "resolved", "created": "2017-Dec-18 12:03", "fixed_version": "2017-Dec-18 12:03", "broken_version": "", "priority": "2", "subsystem": "PythonBinding", "assigned_to": "jpatton", "derived_from": "", "creator": "jpatton", "rust": "", "customer_group": "other", "visibility": "public", "notify": "jpatton@cs.wisc.edu", "due_date": ""}