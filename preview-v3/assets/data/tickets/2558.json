{"id": 2558, "title": "Ticket #2558: condor_startd can sometimes crash after enabling fetchwork", "description": "<blockquote>\nOn a ligo cluster startd crashes after running about 10 minutes when startd is using clone.  Does not appear to happen when using fork.</blockquote>", "remarks": "<blockquote>\n<em>2011-Oct-18 07:23:20 by bbockelm:</em> <br/>\n\nHi Todd,\n\n<p>This will break our ability to do filesystem namespaces.  Can we leave it on and debug the issue instead (note that <span class=\"ticket\"><a class=\"new\" href=\"/wiki-archive/tickets/?ticket=2208\" onclick=\"get_ticket_and_populate_wrapper('2208'); return false;\" title=\"Don't crash GDB in daemon core\">#2208</a></span> contains a patch to not crash gdb when using clone, if you want to debug clone itself)?\n\n</p><p></p><hr/>\n<em>2012-Feb-10 14:29:42 by pfc:</em> <br/>\n\nUpdated priority to match Todd's new scheme (1=fire, 2=soon, 3=time permitting, 4=not yet prioritized, 5=wishlist/ideas).\n\n<p></p><hr/>\n<em>2012-Apr-02 13:29:55 by adesmet:</em> <br/>\n\nTaking ownership. Open issue: why does clone() cause grief? We shouldn't need to disable it.\n\n<p></p><hr/>\n<em>2012-Apr-02 13:40:40 by tstclair:</em> <br/>\n\nWe discussed this in FW many moons ago, I thought this was already done?\n\n<p></p><hr/>\n<em>2012-Apr-03 13:45:50 by adesmet:</em> <br/>\n\nIf it was fixed, it wasn't documented, either here or in the version history.  All we have at the moment is the workaround (disable clone in most daemons), and we really don't want to ship that workaround for the long term.\n\n<p></p><hr/>\n<em>2012-Apr-03 13:51:52 by tstclair:</em> <br/>\n\nThe idea was: we don't need, or want, to use clone on the startd side.  The only place where it makes sense is the schedd.  That was the mod ++ there were a couple of other fixes after that relating to fork.\n\n<p></p><hr/>\n<em>2012-Apr-04 00:36:41 by matt:</em> <br/>\n\nInstead of hardcoding daemon core, it would be better to change the default for USE_CLONE_TO_CREATE_PROCESS to FALSE and introduce SCHEDD.USE_CLONE_TO_CREATE_PROCESS as TRUE.\n\n<p></p><hr/>\n<em>2012-Apr-04 08:58:48 by tstclair:</em> <br/>\n\nagreed\n\n<p></p><hr/>\n<em>2012-Apr-05 11:42:05 by adesmet:</em> <br/>\n\nNot being able to clone() will cause <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=1959\" onclick=\"get_ticket_and_populate_wrapper('1959'); return false;\" title=\"Implement per-job PID namespaces.\">#1959</a></span> (Implement per-job PID namespaces) problems.\n\n<p></p><hr/>\n<em>2012-Apr-06 13:35:09 by pfc:</em> <br/>\n\nReduced priority from 2 to 3 since the workaround is good enough for LIGO for now.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2011-Oct-17 20:52</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/625c1a6bfbee89dbfe986cba0e7fbdf4f2be99cb\">[27874]</a></span>: Change so USE_CLONE_TO_CREATE_PROCESS knob (which defaults to true) only impacts the schedd. All other daemons will always use fork, regardless of what this knob says. <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=2558\" onclick=\"get_ticket_and_populate_wrapper('2558'); return false;\" title=\"condor_startd can sometimes crash after enabling fetchwork\">#2558</a></span>  (By Todd Tannenbaum )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2015-Sep-21 11:38", "status": "defer", "created": "2011-Oct-17 20:50", "fixed_version": "2011-Oct-17 20:50", "broken_version": "v070603", "priority": "5", "subsystem": "Daemons", "assigned_to": "adesmet", "derived_from": "", "creator": "tannenba", "rust": "a22565", "customer_group": "ligo", "visibility": "public", "notify": "tstclair@redhat.com,pcouvare@caltech.edu", "due_date": ""}