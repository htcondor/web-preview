{"id": 406, "title": "Ticket #406: Recursive $(macro) expansion causes condor_submit to hang", "description": "<blockquote>\nIf a setting in the condor_submit submit file contains a recursive entry, condor_submit will hang.\n\n<p>Submit the following:\n</p><div class=\"code\">\n<pre class=\"code\">requirements=false\nuniverse=vanilla\narguments=foo\ncmd=/bin/date\nqueue\n</pre></div>\n\n\n<p>Observe that it works.  Now make a simple change and resubmit:\n\n</p><p></p><div class=\"code\">\n<pre class=\"code\">requirements=false\nuniverse=vanilla\narguments=foo\narguments=$(arguments) bar\ncmd=/bin/date\nqueue\n</pre></div>\n\n\n<p>Observe that condor_submit hangs.  It is chewing up as much processor as it can get, and its memory usage is slowly growing.  My guess is that it's expanding the second arguments using the second arguments, so it becomes \"$(arguments) bar bar\", then \"$(arguments) bar bar bar\", and so on.\n\n</p><p>Expected behavior:\n\n</p><p>Ideally?  This works like the condor configuration file, allow this sort of prepending and appending.  It's useful for supporting users; I can say something like \"Add requirements=($(requirements)) &amp;&amp; <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=NeedExtraBacon\" title=\"Need Extra Bacon\">NeedExtraBacon</a></span>\" after your existing requirements expression.\n\n</p><p>Acceptable: detect the loop and fail with an error explaining the problem.</p></blockquote>", "remarks": "<blockquote>\n<hr/>\n<em>2010-Aug-23 17:07:50 by adesmet:</em> <br/>\n\nBulk change of target version from v070402 to v070404 using ./ticket_target_mover.\n<hr/>\n<em>2010-Oct-27 16:39:01 by adesmet:</em> <br/>\n\nBulk change of target version from v070404 to v070405 using ./ticket-target-mover.\n\n<p></p><hr/>\n<em>2012-Apr-20 16:46:58 by nwp:</em> <br/>\n\nI am trying out a fix for <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=2807\" onclick=\"get_ticket_and_populate_wrapper('2807'); return false;\" title=\"Have DAGMan use a single node job user log file\">#2807</a></span>, and I came across this bug.  Was there ever a solution found?\n\n<p></p><hr/>\n<em>2012-Apr-20 16:51:51 by nwp:</em> <br/>\n\nThe resolved ticket <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2086\" onclick=\"get_ticket_and_populate_wrapper('2086'); return false;\" title=\"infinite recursion caused by recursive classad reference\">#2086</a></span> seems to a manifestation of a similar problem.\n\n<p></p><hr/>\n<em>2012-Oct-16 19:29:31 by matt:</em> <br/>\n\nThis does not appear to be a defect in 7.9.2.\n\n<p></p><hr/>\n<em>2013-Jun-04 11:38:30 by tannenba:</em> <br/>\n\nAlso confirmed this defect is gone in v8.0.0.  Resolving.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Jul-09 12:42</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/36f9ea466f1a99d8bc067db06a198d07571c958e\">[32619]</a></span>: Placed info into condor_submit man page, instead of leaving explanation in version history. ===GT=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=406\" onclick=\"get_ticket_and_populate_wrapper('406'); return false;\" title=\"Recursive $(macro) expansion causes condor_submit to hang\">#406</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-May-02 22:18</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1dc1254e92ce12fa03c2a8b75d06d56d70f0658d\">[31904]</a></span>: Let submit use recursive macros ===GT=== <span class=\"ticket\"><a class=\"defer\" href=\"/wiki-archive/tickets/?ticket=2807\" onclick=\"get_ticket_and_populate_wrapper('2807'); return false;\" title=\"Have DAGMan use a single node job user log file\">#2807</a></span> This has been suggested a lot. This is a partial solution to <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=406\" onclick=\"get_ticket_and_populate_wrapper('406'); return false;\" title=\"Recursive $(macro) expansion causes condor_submit to hang\">#406</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2428\" onclick=\"get_ticket_and_populate_wrapper('2428'); return false;\" title=\"allow macros in dagman log files to assist templating\">#2428</a></span>  (By Nathan W. Panike )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2013-Jun-04 11:39", "status": "resolved", "created": "2009-Apr-22 12:11", "fixed_version": "2009-Apr-22 12:11", "broken_version": "", "priority": "5", "subsystem": "Tools", "assigned_to": "nwp", "derived_from": "", "creator": "adesmet", "rust": "", "customer_group": "other", "visibility": "public", "notify": "", "due_date": ""}