{"id": 325, "title": "Ticket #325: CurrentRank is wrong", "description": "<blockquote>\nI noticed that on the master branch (and in 7.3.1 running on the CS pool), <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurrentRank\" title=\"Current Rank\">CurrentRank</a></span> that is advertised by the startd is wrong.\n\n<p>Example of how to reproduce:\n\n</p><p>configure startd with something like this:\n</p><div class=\"code\">\n<pre class=\"code\">STARTD_JOB_EXPRS = RequiresWholeMachine\nRank = 2.5 + Owner =?= \"dan\" + (RequiresWholeMachine =?=True) * 1000\n</pre></div>\n\n\n<p>Run a long sleep job on the startd and observe that <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurrentRank\" title=\"Current Rank\">CurrentRank</a></span> is totally wrong.\n\n</p><p>I think even much simpler expressions than the one above will show the same problem.\n\n</p><p>--Dan</p></blockquote>", "remarks": "<blockquote>\n<em>2009-Mar-16 12:47:40 by gthain:</em> <br/>\n\nHmm.  (machine) RANK = Target.Qdate seems to advertise the right value, and preempt appropriately.\n\n<p></p><hr/>\n<em>2009-Mar-16 13:45:52 by gthain:</em> <br/>\n\nI think this is independent of the STARTD_JOB_ATTRS:\n\n<p>$ condor_status -l -direct chevre | grep Rank\nRank = 2.500000 + Owner <code>?</code> \"gthain\"\n<span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CurrentRank\" title=\"Current Rank\">CurrentRank</a></span> = 0.000000\n\n</p><p></p><hr/>\n<em>2009-Mar-16 15:39:38 by gthain:</em> <br/>\n\nAfter further review, This looks like just a paren problem:\n\n<p></p><div class=\"code\">\n<pre class=\"code\">Rank = 2.5 + Owner =?= \"dan\" + (RequiresWholeMachine =?=True) * 1000\n\nshould be\n\nRank = 2.5 + (Owner =?= \"dan\") + (RequiresWholeMachine =?=True) * 1000\n\n</pre></div>\n\n\n<p>Now, what the startd should do when rank is undefined is another issue.  Currently, it goes to 0.00000.\n\n</p><p>-Greg</p></blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "", "type": "todo", "last_change": "2010-Jan-31 08:04", "status": "resolved", "created": "2009-Mar-16 10:47", "fixed_version": "2009-Mar-16 10:47", "broken_version": "", "priority": "4", "subsystem": "", "assigned_to": "gthain", "derived_from": "", "creator": "danb", "rust": "", "customer_group": "other", "visibility": "public", "notify": "dan@hep.wisc.edu", "due_date": ""}