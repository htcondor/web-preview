{"id": 2140, "title": "Ticket #2140: [Debian] Make symlinks to binaries instead of  copies/hardlinks", "description": "<blockquote>\nFor Debian, hardlinking at install time does not work as they end up as copies in the Debian package.</blockquote>", "remarks": "<blockquote>\n<em>2011-Dec-16 15:12:20 by jfrey:</em> <br/>\n\nIs hard-linking harmful? The binaries will continue to work correctly if not hard-linked. We could also get rid of the hard-linking on all platforms. With dynamic linking, the space savings is now fairly small.\n\n<p></p><hr/>\n<em>2011-Dec-17 07:25:59 by mih:</em> <br/>\n\nIt is not harmful. But hardlinks cannot be shipped in a Debian package -- everything gets basically copied. So to turn it around: Are softlinks harmful?\n\n<p></p><hr/>\n<em>2012-Jan-20 06:57:59 by mih:</em> <br/>\n\nI'm attaching a potential patch that addresses this. This patch is incomplete in the sense that the 'condor' command has clones in /usr/bin and /usr/sbin, but the symlinks always point to a 'condor' in the same directory. The author decided to address that with another symlink from /usr/bin/condor to /usr/sbin/condor, instead of moving to absolute symlink locations. Hardlinking at install time does not work as they end up as copies in the binary Debian package (cpio + ar archive).\n\n<p></p><pre>  --- a/build/cmake/macros/CloneInstall.cmake\n  +++ b/build/cmake/macros/CloneInstall.cmake\n  @@ -34,7 +34,11 @@\n           else()\n               #install (CODE \"execute_process(COMMAND cd \\${CMAKE_INSTALL_PREFIX} &amp;&amp; ${LN} -v -f ${_ORIG_INSTALL}/${_ORIG_TARGET} ${_INSTALL_LOC}/${new_target})\")\n               # because it's a hardlink absolute paths should not matter.\n  -\t    install (CODE \"execute_process(COMMAND ${LN} -v -f \\$ENV{DESTDIR}\\${CMAKE_INSTALL_PREFIX}/${_ORIG_INSTALL}/${_ORIG_TARGET} \\$ENV{DESTDIR}\\${CMAKE_INSTALL_PREFIX}/${_INSTALL_LOC}/${new_target})\")\n  +\t    #install (CODE \"execute_process(COMMAND ${LN} -v -f \\$ENV{DESTDIR}\\${CMAKE_INSTALL_PREFIX}/${_ORIG_INSTALL}/${_ORIG_TARGET} \\$ENV{DESTDIR}\\${CMAKE_INSTALL_PREFIX}/${_INSTALL_LOC}/${new_target})\")\n  +\t    # go with symlinks as hardlinks would end up as copyies in the Debian\n  +\t    # package\n  +\t    install (CODE \"exec_program(${CMAKE_COMMAND} ARGS -E create_symlink ${_ORIG_TARGET} \\\"\\$ENV{DESTDIR}\\${CMAKE_INSTALL_PREFIX}/${_INSTALL_LOC}/${new_target}\\\")\" )\n  +\n           endif()\n</pre>\n\n<p></p><pre>   \tendforeach(new_target)</pre>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Mar-08 09:37</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/9984c13affa626c2023c2c67bedd565f066b3514\">[30862]</a></span>: minor editing of 7.7.6 version history items (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2839\" onclick=\"get_ticket_and_populate_wrapper('2839'); return false;\" title=\"Fix copying of scaling factors in classad literals\">#2839</a></span> and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2140\" onclick=\"get_ticket_and_populate_wrapper('2140'); return false;\" title=\"[Debian] Make symlinks to binaries instead of  copies/hardlinks\">#2140</a></span>)  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Feb-14 13:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/50ccdadc4f39b5e36e5b9a0a1fcf8b0c00886d3a\">[30602]</a></span>: Version history for symlinking of binaries. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2140\" onclick=\"get_ticket_and_populate_wrapper('2140'); return false;\" title=\"[Debian] Make symlinks to binaries instead of  copies/hardlinks\">#2140</a></span> ===VersionHistory:Complete===  (By Jaime Frey )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2012-Feb-10 17:05</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8eb9d8b20e27ba8bd2ae4da0aee46d3c3d478ffb\">[30581]</a></span>: Use symlinks instead of hard links for The Tool and friends. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=2140\" onclick=\"get_ticket_and_populate_wrapper('2140'); return false;\" title=\"[Debian] Make symlinks to binaries instead of  copies/hardlinks\">#2140</a></span>  (By Jaime Frey )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2012-Feb-14 13:50", "status": "resolved", "created": "2011-May-06 10:46", "fixed_version": "2011-May-06 10:46", "broken_version": "v070000", "priority": "4", "subsystem": "", "assigned_to": "jfrey", "derived_from": "#2058", "creator": "cweiss", "rust": "", "customer_group": "other", "visibility": "public", "notify": "jfrey@cs.wisc.edu,cat@cs.wisc.edu , michael.hanke@gmail.com , cweiss@cs.wisc.edu", "due_date": ""}