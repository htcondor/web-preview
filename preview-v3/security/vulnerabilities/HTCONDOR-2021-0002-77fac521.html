<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>
HTCONDOR-2021-0002
</title>
<link type="text/css" rel="stylesheet" href="{{ '/assets/css/vulnerabilities.css' | relative_url }}">
</head>
<body>

    <span class='leftlogo'><a href="https://research.cs.wisc.edu/htcondor/"><img width="150" alt="U of Wisconsin logo" src="uw_logo_h_4c.gif" class="noborder" height="54"></a></span>

<h1>
<p>
HTCONDOR-2021-0002
<p>
<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25311">CVE-2021-25311</a>

</h1>
<hr>
<table width='100%' summary='whole page'>
<tr>
    <td width='25%'><p class='h'>Summary:</p></td>
    <td class='sv'><p class='v'>&nbsp;</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	A running condor_credd daemon can be instructed to create or write
	certain files as root that are outside of the directory specified by
	the parameter "SEC_CREDENTIAL_DIRECTORY_OAUTH".

	<p>If you have not added the CREDD to your DAEMON_LIST, you are
	not vulnerable to this issue.  (Keep in mind the CREDD is automatically
	added to the DAEMON_LIST if you have added "use feature:OAUTH")
        <!-- a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-X-Y">CVE-X-Y</a>  -->
    </p></td>
</tr>

<tr><td colspan='2'>
<br><table class='sumtable' width='100%' summary='short values'>
<tr>
<th width='20%'>Component</th>
<th width='20%'>Vulnerable Versions</th>
<th width='20%'>Platform</th>
<th width='20%'>Availability</th>
<th width='20%'>Fix Available</th>
</tr>
<tr>
<td class='sv'>CredD</td>
<td class='sv'>8.9.7 through 8.9.10 (inclusive)</td>
<td class='sv'>All</td>
<td class='sv'>Not known to be publicly exploited</td>
<td class='sv'>8.9.11</td>
</tr>
<tr>
<th width='20%'>Status</th>
<th width='20%'>Access Required</th>
<th width='20%'>Host Type Required</th>
<th width='20%'>Effort Required</th>
<th width='20%'>Impact/Consequences</th>
</tr>
<tr>
<td class='sv'>Verified</td>
<td class='sv'>Login</td>
<td class='sv'>Any</td>
<td class='sv'>Low</td>
<td class='sv'>High</td>
</tr>
<tr>
<th width='20%'>Fixed Date</th>
<th width='20%'>Credit</th>
</tr>
<tr>
<td class='sv'>2021-01-27</td>
<td class='sv'>Dave Dykstra<br>Zach Miller</td>
</tr>
</table>
</td></tr>
<tr>
    <td width='25%'><p class='h'>Access Required:</p></td>
    <td class='sv'><p class='v'>Login</p></td>
</tr>

<tr>
    <td colspan='2' class='sv'><p>
	An attacker must only be able to authenticate (as any user) to the
	condor_credd process.  By default, this can be done by any user who
	is able to login to the CredD machine.  Any type of authentication
	can be used including the default methods such as "FS" (on Linux) or
	"NTSSPI" (on Windows)</p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Effort Required:</p></td>
    <td class='sv'><p class='v'>Low</p></td>
</tr>

<tr>
    <td colspan='2' class='sv'><p>
	Any user can use command line tools supplied with HTCondor to convince
	the CredD to create or overwrite a file owned as root with contents
	specified by the attacker.
</tr>
<tr>
    <td width='25%'><p class='h'>Impact/Consequences:</p></td>
    <td class='sv'><p class='v'>High</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
	The file created by the attacker can be anywhere on the filesystem.
	The contents of the file can also be supplied by the attacker.  The
	filename of the file created CANNOT be completely specified by the
	attacker.  However, the file could be created in any number of places
	in /etc such the contents will be executed as root at some point.

</p></td>
</tr>
<tr>
    <td width='25%'><p class='h'>Workaround:</p></td>
</tr>
<tr>
    <td colspan='2' class='sv'><p>
        Do not enable the condor_credd if you are not depending on it.

    </p></td>
</tr>

<tr>
    <td width='25%'><p class='h'>Full Details:</p></td>
    <td class='sv'>
	Embargoed until future notice.
    </td>
</tr>

</table>

</body>
</html>

