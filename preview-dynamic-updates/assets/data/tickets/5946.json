{"id": 5946, "title": "Ticket #5946: MAX_JOBS_PER_OWNER broken if job specifies an accounting_group", "description": "<blockquote>\nThe config knob <code>MAX_JOBS_PER_OWNER</code> works great at specifying a limit per owner <em>unless</em> the job specifies an <code>accounting_group</code>, in which case it is possible to exceed the limit.\n\n<p>To reproduce, simply continuously submit jobs that specify an <code>accounting_group</code>.  The schedd will refuse to accept jobs above the limit until the schedd performs <em>count_jobs()</em> (typically within a minute or less), at which point jobs will incorrectly be accepted again.  The problem appears to be that the code introduced in <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4641\" onclick=\"get_ticket_and_populate_wrapper('4641'); return false;\" title=\"feature request: MAX_JOBS_PER_OWNER\">#4641</a></span> uses the submitter name (eg accounting principle) for past submits, and the owner name for recent submits that have occurred since the last <em>count_jobs()</em>.\n\n</p><p>Credit to INFN for reporting this bug; see <a class=\"external\" href=\"https://www-auth.cs.wisc.edu/lists/htcondor-users/2016-October/msg00001.shtml\">this thread in htcondor-users</a>.</p></blockquote>", "remarks": "<blockquote>\n<em>2016-Dec-01 13:26:38 by jfrey:</em> <br/>\n\n<strong>Code Review</strong>\n\n<p>This change looks good.\n\n</p><p></p><hr/>\n<em>2016-Dec-01 13:29:02 by jfrey:</em> <br/>\n\nAs a follow-on in 8.7, can we rename \"owner\" variables to \"submitter\" when they actually refer to the submitter identity?</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Nov-23 11:26</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3b30a6b53f2adcb4889e2b13b2dfccade6045cd5\">[49631]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5946\" onclick=\"get_ticket_and_populate_wrapper('5946'); return false;\" title=\"MAX_JOBS_PER_OWNER broken if job specifies an accounting_group\">#5946</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5983\" onclick=\"get_ticket_and_populate_wrapper('5983'); return false;\" title=\"REMOVE_SIGNIFICANT_ATTRIBUTES should not require a restart\">#5983</a></span>, and <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5989\" onclick=\"get_ticket_and_populate_wrapper('5989'); return false;\" title=\"condor_gpu_discovery -config should not write to stderr\">#5989</a></span>  (By John (TJ) Knoeller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2016-Oct-04 16:27</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/8a52b708edc0f2d0f9c39bdd2b02f6db08939e1d\">[49369]</a></span>: fix bug <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=5946\" onclick=\"get_ticket_and_populate_wrapper('5946'); return false;\" title=\"MAX_JOBS_PER_OWNER broken if job specifies an accounting_group\">#5946</a></span>, MAX_JOBS_PER_OWNER broken if job specifies an accounting_group ===VersionHistory:Pending===  (By John (TJ) Knoeller )</td></tr>\n</tbody></table>", "type": "defect", "last_change": "2016-Dec-01 13:29", "status": "resolved", "created": "2016-Oct-04 13:07", "fixed_version": "2016-Oct-04 13:07", "broken_version": "v080307", "priority": "2", "subsystem": "DaemonsSubmitNode", "assigned_to": "johnkn", "derived_from": "#4641", "creator": "tannenba", "rust": "", "customer_group": "users", "visibility": "public", "notify": "tannenba@cs.wisc.edu", "due_date": ""}