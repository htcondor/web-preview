{"id": 6147, "title": "Ticket #6147: Implement condor_annex -setup.", "description": "<blockquote>\nTodd L Miller wrote:\n\n<p></p><div class=\"verbatim\">\n<pre>        The \"for the first time\" instructions include the following steps:\n\n1. Create a (private) S3 bucket\n2. Create an EC2 instance profile\n3. Create a pair ofAWS Lambda functions\n4. Create a security group\n5. Create an SSH key pair\n6. Obtaining an Access Key\n\n        #6 must occur before any automation of the other steps is possible.\n\n        It turns out that CloudFormation will generate a (unique) bucket\nname for you if you don't specify one, so #1-#4 could probably be merged\ninto a single CloudFormation template.\n\n        #5 could be automated (and the EC2 GAHP already has the necessary\nfunction), but not, as far as I can tell, through CloudFormation.\n</pre></div>\n\n\n<p>We could therefore:\n</p><ul>\n<li>write a <span class=\"wiki\"><a class=\"missing\" href=\"wiki?p=CloudFormation\" title=\"Cloud Formation\">CloudFormation</a></span> template for #1-#4;\n</li><li>write code to create the stack from condor_annex, wait for it complete, dump its outputs into configuration;\n</li><li>and call the existing code to create a new keypair and tell the user (and config) about it.</li></ul>\n</blockquote>", "remarks": "<blockquote>\n</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-29 17:29</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/1c984ecabeb8365be07f865d5d6dafb7957ad325\">[50379]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>) Make -setup tolerate partial setups.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-29 17:00</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/d13167ed853443fc50e095212d368ea85d90d023\">[50377]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>, <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6149\" onclick=\"get_ticket_and_populate_wrapper('6149'); return false;\" title=\"Implement condor_annex -check-setup\">#6149</a></span>) Add default AWS account keys location. Implement -check-setup.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-29 13:35</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/7eea46535fbfcff83e88750571f40c73c6d7761f\">[50376]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>) Create an SSH keypair for the user, in case we need it.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-27 15:57</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/c48a5ad97fc46f9d31268cab3845cc3981ac894e\">[50375]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>) Append configuration to ~/.condor/user_config by default.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-24 16:53</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/cc663db5a11d42312ff1eab0b31f8e7bcb63ac27\">[50374]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>) First pass at config-file writer.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-23 17:28</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/3b143e228024cb530b5393f57ec2f08762b3c3ae\">[50373]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>) Does all but step no. 5, and the part where it dumps the configuration in the right place. Also need to set, or add to param table, defaults for instance type and image id; we can't set the default for sfr_config_file.  (By Todd L Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2017-Mar-22 11:25</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ee91d96d1eb690893a00b28978b9008c53e75ef4\">[50372]</a></span>: (<span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=6147\" onclick=\"get_ticket_and_populate_wrapper('6147'); return false;\" title=\"Implement condor_annex -setup.\">#6147</a></span>) Clean up EC2 GAHP command #defines.  (By Todd L Miller )</td></tr>\n</tbody></table>", "type": "experimental", "last_change": "2017-Apr-04 17:35", "status": "resolved", "created": "2017-Feb-15 14:25", "fixed_version": "2017-Feb-15 14:25", "broken_version": "", "priority": "2", "subsystem": "Annex", "assigned_to": "tlmiller", "derived_from": "#6111", "creator": "tlmiller", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tlmiller@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}