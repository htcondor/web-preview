{"id": 4153, "title": "Ticket #4153: add relro and PIE to build for improved security hardening", "description": "<blockquote>\nFrom security policy description:\n\n<p></p><ul>\nPartial relro is when you have -Wl,-z,relro in the LDFLAGS for building libraries.\nPartial relro means that some ELF sections are reordered so that overflows in some\nlikely sections don't affect others and the local offset table is readonly.\n\n<p>To get full relro, you also need to have: -Wl,-z,bind_now (or -Wl,-z,now) added to LDFLAGS. What this\ndoes is make the Global Offset table and Procedure Lookup Table readonly. This takes\nsome time, so its only worth it for apps that have a real possibility of being\nattacked. This would be setuid/setgid/setcap and daemons. There are some security\ncritical apps that can have this too. If the apps likely parses files from an untrusted\nsource (internet), then it might also want to have full relro.\n\n</p><p>To enable PIE, you would pass -fPIE -DPIE in the CFLAGS and -pie in the LDFLAGS. What\nPIE does is randomize the locations of important items such as the base address of an\nexecutable and position of libraries, heap, and stack, in a process's address space.\nSometimes this is called ASLR. Its designed to make buffer/heap overflow, return into\nlibc attacks much harder. Part of the way it does this is to make a new section in the\nELF image that is writable to redirect function calls to the correct address (offsets).\nThis has to be writable because each invocation will have different layouts and needs\nto be fixed up. So, when you have an application with PIE, you want full relro so that\nthese sections become readonly and not part of an attacker's target areas.</p></ul>\n</blockquote>", "remarks": "<blockquote>\n<em>2014-Jan-10 16:57:15 by eje:</em> <br/>\n\ntopic branch: V8_0-gt4153-relro-pie\n\n<p></p><hr/>\n<em>2014-Jan-17 13:37:14 by eje:</em> <br/>\n\nEnabling relro/pie doesn't work for non-proper builds, because the required flags aren't passed into the non-proper external build configurations.  I made the relro/pie logic contingent on proper build.\n\n<p>With that in mind, adding this to 8.0 series is probably not relevant, as there is no effective change to UW builds.\n\n</p><p></p><hr/>\n<em>2014-May-19 15:31:38 by eje:</em> <br/>\n\nDoes this need doc?  It's in the build logic, and won't (currently) apply upstream because it requires proper build.\n\n<p></p><hr/>\n<em>2014-May-19 16:34:51 by tannenba:</em> <br/>\n\nMy vote would be just a blurb in the version history.</blockquote>", "derived_tickets": "", "attachments": "<html><head></head><body></body></html>", "check_ins": "<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n<tbody><tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-22 14:07</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/e1fcad80dba7d4fabf4cf192c5aaa2031ca5fbd1\">[40216]</a></span>: rewrite 8.1.6 version history item and place it into the 8.1.6 subsection of the version history. <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4153\" onclick=\"get_ticket_and_populate_wrapper('4153'); return false;\" title=\"add relro and PIE to build for improved security hardening\">#4153</a></span>  (By Karen Miller )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-22 10:49</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/fc76276231f7c332b6dd34e3735c5df401f7a6b0\">[40211]</a></span>: fix latex error <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4153\" onclick=\"get_ticket_and_populate_wrapper('4153'); return false;\" title=\"add relro and PIE to build for improved security hardening\">#4153</a></span>  (By Greg Thain )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-May-22 09:46</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/482d6bc97f4893ff56355e9e9334db75584375fc\">[40208]</a></span>: Version history for <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4153\" onclick=\"get_ticket_and_populate_wrapper('4153'); return false;\" title=\"add relro and PIE to build for improved security hardening\">#4153</a></span>  (By Tim Theisen )</td></tr>\n<tr><td align=\"right\" valign=\"top\" width=\"160\">2014-Apr-11 12:59</td>\n<td align=\"center\" valign=\"top\" width=\"30\">\n<span class=\"icon dot\">\u00a0</span></td>\n<td align=\"left\" valign=\"top\"> \nCheck-in <span class=\"chng\"><a href=\"https://github.com/htcondor/htcondor/commit/ff40743bdedc5245aae695aa1e292b580196e578\">[39911]</a></span>: Add relro and PIE to HTCondor build ===GT:Fixed=== <span class=\"ticket\"><a class=\"resolved\" href=\"/wiki-archive/tickets/?ticket=4153\" onclick=\"get_ticket_and_populate_wrapper('4153'); return false;\" title=\"add relro and PIE to build for improved security hardening\">#4153</a></span> Conflicts: src/classad/CMakeLists.txt  (By Erik Erlandson )</td></tr>\n</tbody></table>", "type": "enhance", "last_change": "2014-Jul-15 20:44", "status": "resolved", "created": "2014-Jan-10 16:42", "fixed_version": "2014-Jan-10 16:42", "broken_version": "", "priority": "2", "subsystem": "Packaging", "assigned_to": "tim", "derived_from": "", "creator": "eje", "rust": "", "customer_group": "other", "visibility": "public", "notify": "tstclair@redhat.com, eje@cs.wisc.edu, johnkn@cs.wisc.edu, tannenba@cs.wisc.edu", "due_date": ""}